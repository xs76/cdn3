!function(){function w(t,i,e){return t.call.apply(t.bind,arguments)}function x(i,e,t){var s;if(i)return 2<arguments.length?(s=Array.prototype.slice.call(arguments,2),function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,s),i.apply(e,t)}):function(){return i.apply(e,arguments)};throw Error()}function g(t,i,e){return(g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:x).apply(null,arguments)}var r=Date.now||function(){return+new Date};function H(t,i){this.a=t,this.o=i||t,this.c=this.o.document}var U=!!window.FontFace;function h(t,i,e,s){if(i=t.c.createElement(i),e)for(var a in e)e.hasOwnProperty(a)&&("style"==a?i.style.cssText=e[a]:i.setAttribute(a,e[a]));return s&&i.appendChild(t.c.createTextNode(s)),i}function c(t,i,e){(t=(t=t.c.getElementsByTagName(i)[0])||document.documentElement).insertBefore(e,t.lastChild)}function e(t){t.parentNode&&t.parentNode.removeChild(t)}function _(t,i,e){i=i||[],e=e||[];for(var s=t.className.split(/\s+/),a=0;a<i.length;a+=1){for(var n=!1,o=0;o<s.length;o+=1)if(i[a]===s[o]){n=!0;break}n||s.push(i[a])}for(i=[],a=0;a<s.length;a+=1){for(n=!1,o=0;o<e.length;o+=1)if(s[a]===e[o]){n=!0;break}n||i.push(s[a])}t.className=i.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function n(t,i){for(var e=t.className.split(/\s+/),s=0,a=e.length;s<a;s++)if(e[s]==i)return!0;return!1}function f(t,i,e){function s(){o&&a&&(o(n),o=null)}i=h(t,"link",{rel:"stylesheet",href:i,media:"all"});var a=!1,n=null,o=e||null;U?(i.onload=function(){a=!0,s()},i.onerror=function(){a=!0,n=Error("Stylesheet failed to load"),s()}):setTimeout(function(){a=!0,s()},0),c(t,"head",i)}function s(t,i,e,s){var a,n,o=t.c.getElementsByTagName("head")[0];return o?(a=h(t,"script",{src:i}),n=!1,a.onload=a.onreadystatechange=function(){n||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(n=!0,e&&e(null),a.onload=a.onreadystatechange=null,"HEAD"==a.parentNode.tagName&&o.removeChild(a))},o.appendChild(a),setTimeout(function(){n||(n=!0,e&&e(Error("Script load timeout")))},s||5e3),a):null}function C(){this.a=0,this.c=null}function y(t){return t.a++,function(){t.a--,a(t)}}function M(t,i){t.c=i,a(t)}function a(t){0==t.a&&t.c&&(t.c(),t.c=null)}function o(t){this.a=t||"-"}function N(t,i){this.c=t,this.f=4,this.a="n";t=(i||"n4").match(/^([nio])([1-9])$/i);t&&(this.a=t[1],this.f=parseInt(t[2],10))}function l(t){var i=[];t=t.split(/,\s*/);for(var e=0;e<t.length;e++){var s=t[e].replace(/['"]/g,"");-1!=s.indexOf(" ")||/^\d/.test(s)?i.push("'"+s+"'"):i.push(s)}return i.join(",")}function u(t){return t.a+t.f}function m(t){var i="normal";return"o"===t.a?i="oblique":"i"===t.a&&(i="italic"),i}function Y(t,i){this.c=t,this.f=t.o.document.documentElement,this.h=i,this.a=new o("-"),this.j=!1!==i.events,this.g=!1!==i.classes}function S(t){var i,e,s;t.g&&(i=n(t.f,t.a.c("wf","active")),e=[],s=[t.a.c("wf","loading")],i||e.push(t.a.c("wf","inactive")),_(t.f,e,s)),E(t,"inactive")}function E(t,i,e){t.j&&t.h[i]&&(e?t.h[i](e.c,u(e)):t.h[i]())}function B(){this.c={}}function d(t,i){this.c=t,this.f=i,this.a=h(this.c,"span",{"aria-hidden":"true"},this.f)}function p(t){c(t.c,"body",t.a)}function T(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+l(t.c)+";font-style:"+m(t)+";font-weight:"+t.f+"00;"}function I(t,i,e,s,a,n){this.g=t,this.j=i,this.a=s,this.c=e,this.f=a||3e3,this.h=n||void 0}function b(t,i,e,s,a,n,o){this.v=t,this.B=i,this.c=e,this.a=s,this.s=o||"BESbswy",this.f={},this.w=a||3e3,this.u=n||null,this.m=this.j=this.h=this.g=null,this.g=new d(this.c,this.s),this.h=new d(this.c,this.s),this.j=new d(this.c,this.s),this.m=new d(this.c,this.s),t=T(t=new N(this.a.c+",serif",u(this.a))),this.g.a.style.cssText=t,t=T(t=new N(this.a.c+",sans-serif",u(this.a))),this.h.a.style.cssText=t,t=T(t=new N("serif",u(this.a))),this.j.a.style.cssText=t,t=T(t=new N("sans-serif",u(this.a))),this.m.a.style.cssText=t,p(this.g),p(this.h),p(this.j),p(this.m)}o.prototype.c=function(t){for(var i=[],e=0;e<arguments.length;e++)i.push(arguments[e].replace(/[\W_]+/g,"").toLowerCase());return i.join(this.a)},I.prototype.start=function(){var a=this.c.o.document,n=this,o=r(),t=new Promise(function(e,s){!function i(){var t;r()-o>=n.f?s():a.fonts.load(m(t=n.a)+" "+t.f+"00 300px "+l(t.c),n.h).then(function(t){1<=t.length?e():setTimeout(i,25)},function(){s()})}()}),e=null,i=new Promise(function(t,i){e=setTimeout(i,n.f)});Promise.race([i,t]).then(function(){e&&(clearTimeout(e),e=null),n.g(n.a)},function(){n.j(n.a)})};var A={D:"serif",C:"sans-serif"},i=null;function P(){var t;return null===i&&(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),i=!!t&&(parseInt(t[1],10)<536||536===parseInt(t[1],10)&&parseInt(t[2],10)<=11)),i}function O(t,i,e){for(var s in A)if(A.hasOwnProperty(s)&&i===t.f[A[s]]&&e===t.f[A[s]])return!0;return!1}function L(t){var i=t.g.a.offsetWidth,e=t.h.a.offsetWidth;i===t.f.serif&&e===t.f["sans-serif"]||P()&&O(t,i,e)?r()-t.A>=t.w?P()&&O(t,i,e)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?R(t,t.v):R(t,t.B):setTimeout(g(function(){L(this)},t),50):R(t,t.v)}function R(t,i){setTimeout(g(function(){e(this.g.a),e(this.h.a),e(this.j.a),e(this.m.a),i(this.a)},t),0)}function v(t,i,e){this.c=t,this.a=i,this.f=0,this.m=this.j=!1,this.s=e}b.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=r(),L(this)};var G=null;function D(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&_(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),E(t,"active")):S(t.a))}function F(t){this.j=t,this.a=new B,this.h=0,this.f=this.g=!0}function W(t,i){this.c=t,this.a=i}function K(t,i){this.c=t,this.a=i}function j(t,i){this.c=t||"https://fonts.googleapis.com/css",this.a=[],this.f=[],this.g=i||""}v.prototype.g=function(t){var i=this.a;i.g&&_(i.f,[i.a.c("wf",t.c,u(t).toString(),"active")],[i.a.c("wf",t.c,u(t).toString(),"loading"),i.a.c("wf",t.c,u(t).toString(),"inactive")]),E(i,"fontactive",t),this.m=!0,D(this)},v.prototype.h=function(t){var i,e,s,a=this.a;a.g&&(i=n(a.f,a.a.c("wf",t.c,u(t).toString(),"active")),e=[],s=[a.a.c("wf",t.c,u(t).toString(),"loading")],i||e.push(a.a.c("wf",t.c,u(t).toString(),"inactive")),_(a.f,e,s)),E(a,"fontinactive",t),D(this)},F.prototype.load=function(t){this.c=new H(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes;var s=this,i=new Y(this.c,t),e=t,a=[],t=e.timeout,a=(function(t){t.g&&_(t.f,[t.a.c("wf","loading")]),E(t,"loading")}(i),function(t,i,e){var s,a,n=[];for(s in i)i.hasOwnProperty(s)&&(a=t.c[s])&&n.push(a(i[s],e));return n}(s.a,e,s.c)),n=new v(s.c,i,t);for(s.h=a.length,i=0,e=a.length;i<e;i++)a[i].load(function(t,i,e){var c,l,m,d,p;c=n,l=t,m=i,d=e,p=0==--(t=s).h,(t.f||t.g)&&setTimeout(function(){var t=d||null,i=m||{};if(0===l.length&&p)S(c.a);else{c.f+=l.length,p&&(c.j=p);for(var e=[],s=0;s<l.length;s++){var a,n=l[s],o=i[n.c],r=c.a,h=n;r.g&&_(r.f,[r.a.c("wf",h.c,u(h).toString(),"loading")]),E(r,"fontloading",h),r=(G=(r=null)===G?!!window.FontFace&&(h=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),a=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor),h?42<parseInt(h[1],10):!a):G)?new I(g(c.g,c),g(c.h,c),c.c,n,c.s,o):new b(g(c.g,c),g(c.h,c),c.c,n,c.s,t,o),e.push(r)}for(s=0;s<e.length;s++)e[s].start()}},0)})},W.prototype.load=function(o){var r,i=this,h=i.a.projectId,t=i.a.version;h?(r=i.c.o,s(this.c,(i.a.api||"https://fast.fonts.net/jsapi")+"/"+h+".js"+(t?"?v="+t:""),function(t){t?o([]):(r["__MonotypeConfiguration__"+h]=function(){return i.a},function t(){if(r["__mti_fntLst"+h]){var i,e=r["__mti_fntLst"+h](),s=[];if(e)for(var a=0;a<e.length;a++){var n=e[a].fontfamily;null!=e[a].fontStyle&&null!=e[a].fontWeight?(i=e[a].fontStyle+e[a].fontWeight,s.push(new N(n,i))):s.push(new N(n))}o(s)}else setTimeout(function(){t()},50)}())}).id="__MonotypeAPIScript__"+h):o([])},K.prototype.load=function(t){for(var i=this.a.urls||[],e=this.a.families||[],s=this.a.testStrings||{},a=new C,n=0,o=i.length;n<o;n++)f(this.c,i[n],y(a));var r=[];for(n=0,o=e.length;n<o;n++)if((i=e[n].split(":"))[1])for(var h=i[1].split(","),c=0;c<h.length;c+=1)r.push(new N(i[0],h[c]));else r.push(new N(i[0]));M(a,function(){t(r,s)})};function z(t){this.f=t,this.a=[],this.c={}}var X={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},V={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},Z={i:"i",italic:"i",n:"n",normal:"n"},J=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function q(t,i){this.c=t,this.a=i}var Q={Arimo:!0,Cousine:!0,Tinos:!0};function $(t,i){this.c=t,this.a=i}function tt(t,i){this.c=t,this.f=i,this.a=[]}q.prototype.load=function(t){for(var i=new C,e=this.c,s=new j(this.a.api,this.a.text),a=this.a.families,n=s,o=a,r=o.length,h=0;h<r;h++){var c=o[h].split(":"),l=(3==c.length&&n.f.push(c.pop()),"");2==c.length&&""!=c[1]&&(l=":"),n.a.push(c.join(l))}for(var m=new z(a),d=m,p=d.f.length,g=0;g<p;g++){var _=d.f[g].split(":"),u=_[0].replace(/\+/g," "),S=["n4"];if(2<=_.length){var E,T,I=_[1],b=[];if(I)for(var A=(I=I.split(",")).length,P=0;P<A;P++)(T=!(T=I[P]).match(/^[\w-]+$/)||null==(E=J.exec(T.toLowerCase()))?"":[T=null==(T=E[2])||""==T?"n":Z[T],E=null==(E=E[1])||""==E?"4":V[E]||(isNaN(E)?"4":E.substr(0,1))].join(""))&&b.push(T);0<b.length&&(S=b),3==_.length&&(b=[],0<(_=(_=_[2])?_.split(","):b).length)&&(_=X[_[0]])&&(d.c[u]=_)}for(d.c[u]||(_=X[u])&&(d.c[u]=_),_=0;_<S.length;_+=1)d.a.push(new N(u,S[_]))}f(e,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var i=t.a.length,e=[],s=0;s<i;s++)e.push(t.a[s].replace(/ /g,"+"));return i=t.c+"?family="+e.join("%7C"),0<t.f.length&&(i+="&subset="+t.f.join(",")),0<t.g.length&&(i+="&text="+encodeURIComponent(t.g)),i}(s),y(i)),M(i,function(){t(m.a,m.c,Q)})},$.prototype.load=function(o){var t=this.a.id,r=this.c.o;t?s(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",function(t){if(t)o([]);else if(r.Typekit&&r.Typekit.config&&r.Typekit.config.fn){t=r.Typekit.config.fn;for(var i=[],e=0;e<t.length;e+=2)for(var s=t[e],a=t[e+1],n=0;n<a.length;n++)i.push(new N(s,a[n]));try{r.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}o(i)}},2e3):o([])},tt.prototype.load=function(h){var t=this.f.id,i=this.c.o,c=this;t?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[t]=function(t,i){for(var e,s,a,n=0,o=i.fonts.length;n<o;++n){var r=i.fonts[n];c.a.push(new N(r.name,(r="font-weight:"+r.weight+";font-style:"+r.style,a=s=e=void 0,e=4,s="n",a=null,r&&((a=r.match(/(normal|oblique|italic)/i))&&a[1]&&(s=a[1].substr(0,1).toLowerCase()),a=r.match(/([1-9]00|normal|bold)/i))&&a[1]&&(/bold/i.test(a[1])?e=7:/[1-9]00/.test(a[1])&&(e=parseInt(a[1].substr(0,1),10))),s+e)))}h(c.a)},s(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+((i=this.c).o.location.hostname||i.a.location.hostname)+"/"+t+".js",function(t){t&&h([])})):h([])};var t=new F(window),k=(t.a.c.custom=function(t,i){return new K(i,t)},t.a.c.fontdeck=function(t,i){return new tt(i,t)},t.a.c.monotype=function(t,i){return new W(i,t)},t.a.c.typekit=function(t,i){return new $(i,t)},t.a.c.google=function(t,i){return new q(i,t)},{load:g(t.load,t)});"function"==typeof define&&define.amd?define(function(){return k}):"undefined"!=typeof module&&module.exports?module.exports=k:(window.WebFont=k,window.WebFontConfig&&t.load(window.WebFontConfig))}();var AzerionIntegration,Fabrique,Game,__extends=this&&this.__extends||function(){var s=function(t,i){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}))(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function e(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}(),Constants=(!function(t){function i(){this._fileList=null,this._jsIndex=0,this._hasLoaded=!1,this._callback=null}i.prototype.init=function(t){this._fileList=[],this._jsIndex=0,this._hasLoaded=!1,this._callback=t,this._loadProjectJson()},i.prototype.xhrLoad=function(t,i,e,s){var a=new XMLHttpRequest,n=(a.open("GET",i,!0),a.responseType="text",this);a.onload=function(){return n[e](t,a)},a.onerror=function(){return n[s](t,a)},a.send()},i.prototype.jsonLoadComplete=function(t,i){for(var e=JSON.parse(i.responseText),s=e.developmentDependencies,a=0;a<s.length;a++)for(var n=e[s[a]],o=0;o<n.length;o++)this.addToFileList("script",n[o],n[o]);this._loadJsFile()},i.prototype.jsonLoadFailed=function(){},i.prototype.fileComplete=function(t){var t=this._fileList[t],i=(t.loaded=!0,t.data=document.createElement("script"),t.data.language="javascript",t.data.type="text/javascript",t.data.src=t.url,t.data.defer=!1,document.head.appendChild(t.data),this);t.data.onload=function(){i.loadNext()},t.data.onerror=function(){}},i.prototype.loadNext=function(){0<this.totalQueuedFiles()?(this._jsIndex++,this._loadJsFile()):this.finishLoad()},i.prototype.finishLoad=function(){this._hasLoaded=!0,this._callback.call(this)},i.prototype.fileError=function(t){this._fileList[t]},i.prototype.addToFileList=function(t,i,e,s){var a,n={key:i,url:e,data:null,error:!1,loaded:!1};for(a in s)s.hasOwnProperty(a)&&(n[a]=s[a]);!1===this.checkKeyExists(i)&&this._fileList.push(n)},i.prototype.checkKeyExists=function(t){if(0<this._fileList.length)for(var i=0;i<this._fileList.length;i++)if(this._fileList[i].key===t)return!0;return!1},i.prototype.totalQueuedFiles=function(){for(var t=0,i=0;i<this._fileList.length;i++)!1===this._fileList[i].loaded&&t++;return t},i.prototype._loadProjectJson=function(){this.xhrLoad(null,"project.json","jsonLoadComplete","jsonLoadFailed")},i.prototype._loadJsFile=function(){var t=this._fileList[this._jsIndex];t.url=t.url+"?v="+(new Date).getTime(),this.xhrLoad(this._jsIndex,t.url,"fileComplete","fileError")},t.Boot=i}(Game=Game||{}),function(){function t(){}return t.GAME_SCALE=1,t.MIN_FONT_SIZE_DEFAULT=10,t.CALCULATED_WIDTH=1280,t.CALCULATED_HEIGHT=720,t.GAME_WIDTH=1280,t.GAME_HEIGHT=720,t.LANDSCAPE_LOCKED=!1,t.PORTRAIT_LOCKED=!1,t.CURRENT_ORIENTATION="",t.MORE_GAMES="http://www.agame.com/?utm_source="+window.location.host+"&utm_medium=html5&utm_term=bomb-it-7&utm_content=logo&utm_campaign=brandedgames",t.BOMB_IT_2="http://www.a10.com/action-games/bomb-it-2",t.BOMB_IT_3="http://www.a10.com/action-games/bomb-it-3",t.BOMB_IT_4="http://www.a10.com/action-games/bomb-it-4",t.BOMB_IT_5="http://www.a10.com/action-games/bomb-it-5",t.BOMB_IT_6="http://www.a10.com/action-games/bomb-it-6",t.GAME_TITLE="Bomb It 7",t.GAMEDISTRIBUTION_ID="db1820b13aaf424f89230c60b221e711",t.useCheats=!1,t}()),Images=function(){function t(){}return t.preloadList=[],t.list=[],t}(),Atlases=function(){function t(){}return t.preloadList=[t.Interface="interface"],t.list=[],t}();!function(r){h=Phaser.Group,__extends(i,h),i.prototype.createExplosionAnimation=function(){this.animationExplosion=this.game.add.ph2AnimationObject(0,0,"bomb_explosion_center","atlas_anim"),this.animationExplosion.scaleX=1.1,this.animationExplosion.scaleY=1.1,this.animationExplosion.visible=!1,this.add(this.animationExplosion)},i.prototype.checkTimer=function(){this.hasExploded&&(this.timer+=this.game.time.elapsedMS,500<=this.timer)&&this.endExplosion()},i.prototype.createDangerCells=function(){for(var t=1;t<this.power+1;t++)this.direction!==r.DIRECTION.ALL&&this.direction!==r.DIRECTION.LEFT||(!(this.gridPositionX-t<0)&&this.grid.cells[this.gridPositionX-t][this.gridPositionY].isEmpty?this.addToDangerCells(this.gridPositionX-t,this.gridPositionY,t):t=this.power+1);for(t=1;t<this.power+1;t++)this.direction!==r.DIRECTION.ALL&&this.direction!==r.DIRECTION.RIGHT||(!(this.gridPositionX+t>r.SETTINGS.GRID_WIDTH-1)&&this.grid.cells[this.gridPositionX+t][this.gridPositionY].isEmpty?this.addToDangerCells(this.gridPositionX+t,this.gridPositionY,t):t=this.power+1);for(t=1;t<this.power+1;t++)this.direction!==r.DIRECTION.ALL&&this.direction!==r.DIRECTION.UP||(!(this.gridPositionY-t<0)&&this.grid.cells[this.gridPositionX][this.gridPositionY-t].isEmpty?this.addToDangerCells(this.gridPositionX,this.gridPositionY-t,t):t=this.power+1);for(t=1;t<this.power+1;t++)this.direction!==r.DIRECTION.ALL&&this.direction!==r.DIRECTION.DOWN||(!(this.gridPositionY+t>r.SETTINGS.GRID_HEIGHT-1)&&this.grid.cells[this.gridPositionX][this.gridPositionY+t].isEmpty?this.addToDangerCells(this.gridPositionX,this.gridPositionY+t,t):t=this.power+1)},i.prototype.createExplosion=function(){for(var t=1;t<this.power+1;t++)this.direction!==r.DIRECTION.ALL&&this.direction!==r.DIRECTION.LEFT||(t=this.gridPositionX-t<0?this.power+1:this.grid.cells[this.gridPositionX-t][this.gridPositionY].isEmpty?this.checkEmpty(this.gridPositionX-t,this.gridPositionY,t,r.DIRECTION.LEFT):(this.checkNotEmpty(this.gridPositionX-t,this.gridPositionY,r.DIRECTION.LEFT),this.power+1));for(t=1;t<this.power+1;t++)this.direction!==r.DIRECTION.ALL&&this.direction!==r.DIRECTION.RIGHT||(t=this.gridPositionX+t>r.SETTINGS.GRID_WIDTH-1?this.power+1:this.grid.cells[this.gridPositionX+t][this.gridPositionY].isEmpty?this.checkEmpty(this.gridPositionX+t,this.gridPositionY,t,r.DIRECTION.RIGHT):(this.checkNotEmpty(this.gridPositionX+t,this.gridPositionY,r.DIRECTION.RIGHT),this.power+1));for(t=1;t<this.power+1;t++)this.direction!==r.DIRECTION.ALL&&this.direction!==r.DIRECTION.UP||(t=this.gridPositionY-t<0?this.power+1:this.grid.cells[this.gridPositionX][this.gridPositionY-t].isEmpty?this.checkEmpty(this.gridPositionX,this.gridPositionY-t,t,r.DIRECTION.UP):(this.checkNotEmpty(this.gridPositionX,this.gridPositionY-t,r.DIRECTION.UP),this.power+1));for(t=1;t<this.power+1;t++)this.direction!==r.DIRECTION.ALL&&this.direction!==r.DIRECTION.DOWN||(t=this.gridPositionY+t>r.SETTINGS.GRID_HEIGHT-1?this.power+1:this.grid.cells[this.gridPositionX][this.gridPositionY+t].isEmpty?this.checkEmpty(this.gridPositionX,this.gridPositionY+t,t,r.DIRECTION.DOWN):(this.checkNotEmpty(this.gridPositionX,this.gridPositionY+t,r.DIRECTION.DOWN),this.power+1))},i.prototype.checkEmpty=function(t,i,e,s){var a=this.grid.cells[t][i],n=a.gridPositionY>this.gridPositionY||a.gridPositionY<this.gridPositionY?0:90,o=e===this.power;return a.cellContains===r.MAP.SPECIAL_TILE?this.createFire(t,i,n,s,o):a.cellContains===r.MAP.ITEM||a.isItem?(this.grid.removeItemFromArray(a,!0),this.createFire(t,i,n,s,o)):a.cellContains===r.MAP.FREE?this.createFire(t,i,n,s,o):a.cellContains!==r.MAP.COIN&&!a.isCoin||this.grid.coinPickedUp(a,!0),e},i.prototype.checkNotEmpty=function(t,i,e){var s=this.grid.cells[t][i],a=s.gridPositionY>this.gridPositionY||s.gridPositionY<this.gridPositionY?90:0;s.cellContains===r.MAP.BLOCK||s.isBox?(this.createFireBlock(t,i,a,e,!0),this.grid.destroyBox(this.grid.cells[t][i]),null===this.player||this.player.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",r.MISSION.DESTROY_20_BLOCKS_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",r.MISSION.DESTROY_30_BLOCKS),this.grid.gameMode===r.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",r.MISSION.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",r.MISSION.DESTROY_120_BLOCKS_IN_ARCADE)))):s.cellContains===r.MAP.BOMB?this.grid.explodeBomb(this.grid.cells[t][i]):s.cellContains===r.MAP.ITEM||s.isItem?this.grid.removeItemFromArray(s,!0):s.cellContains!==r.MAP.COIN&&!s.isCoin||this.grid.coinPickedUp(s,!0)},i.prototype.createFire=function(t,i,e,s,a){var n=this.grid.cells[t][i];this.previousCellsContains.push(n.cellContains),e=new r.FireExplosion(this.game,n,e,s,a),n.isDangerCell=!0,null!==this.player?n.dangerOwner=this.player:n.dangerOwner=null,this.grid.rowsGroup[0].add(e),this.explosion.push(e),this.cellsUsed.push(n),this.grid.astarGrid.grid[t][i].weight=0},i.prototype.createFireBlock=function(t,i,e,s,a){t=this.grid.cells[t][i],i=new r.FireExplosion(this.game,t,e,s,a);this.grid.rowsGroup[t.gridPositionY].add(i),this.explosion.push(i)},i.prototype.addToDangerCells=function(t,i,e){var s=this.grid.cells[t][i];this.fireCells.push(s),this.grid.astarGrid.grid[t][i].weight=32},i.prototype.endExplosion=function(){var t,i,e,s;for(this.gridCell.isDangerCell=!1,this.gridCell.isEmpty=!0,s=this.grid.getItemAtCell(this.gridCell),this.gridCell.cellContains=null!==s?r.MAP.ITEM:r.MAP.FREE,t=0;t<this.cellsUsed.length;t++)i=this.cellsUsed[t].gridPositionX,e=this.cellsUsed[t].gridPositionY,this.cellsUsed[t].isDangerCell=!1,this.cellsUsed[t].cellContains=this.previousCellsContains[t],this.grid.astarGrid.grid[i][e].weight=1;for(t=this.explosion.length-1;0<=t;t--)this.explosion[t].visible=!1;this.grid.destroyBombExplosion(this.gridCell),this.destroyBombExplosion()},i.prototype.addDangerCellsToAstarGrid=function(){for(var t,i=this.fireCells.length,e=0;e<i;e++)t=this.fireCells[e],this.grid.astarGrid.grid[t.gridPositionX][t.gridPositionY].weight=0},i.prototype.makeExplosion=function(){this.visible=!0,this.animationExplosion.visible=!0,this.animationExplosion.ph2Animations.play("bomb_explosion_center2",1,!1),this.gridCell.isDangerCell=!0,null!==this.player?this.gridCell.dangerOwner=this.player:this.gridCell.dangerOwner=null,this.hasExploded=!0,this.game.ph2AudioManager.playEffect("bomb",!1),this.createExplosion()},i.prototype.update=function(){this.gameStatus!==r.GAME_STATUS.PAUSED&&this.checkTimer()},i.prototype.destroyBombExplosion=function(){this.grid.gameMode===r.GAME_MODE.ICE_MAN?this.resetBombExplosionValues():(this.animationExplosion.ph2Animations.stop(),this.animationExplosion.destroy(!0),this.destroy())},i.prototype.resetBombExplosionValues=function(){this.gameScale=r.SETTINGS.SCALE,this.timer=0,this.explosion=[],this.cellsUsed=[],this.fireCells=[],this.previousCellsContains=[],this.hasExploded=!1,this.visible=!1};var h,t=i;function i(t,i,e,s,a,n){var o=h.call(this,t)||this;return o.x=e.centerX,o.y=e.centerY,o.game=t,o.player=a,o.previousContain=e.cellContains,o.grid=i,o.gridCell=e,o.gridPositionX=e.gridPositionX,o.gridPositionY=e.gridPositionY,o.gameScale=r.SETTINGS.SCALE,o.timer=0,o.power=s,o.explosion=[],o.cellsUsed=[],o.fireCells=[],o.previousCellsContains=[],o.direction=n||r.DIRECTION.ALL,o.hasExploded=!1,o.visible=!1,o.createExplosionAnimation(),o.createDangerCells(),o}r.BombExplosion=t}(Game=Game||{}),function(c){l=Phaser.Group,__extends(i,l),i.prototype.createBombAnimation=function(){var t=.4*c.SETTINGS.CELL_HEIGHT*c.SETTINGS.SCALE;this.bombAnimation=this.game.add.ph2AnimationObject(0,t,this.keyName,"atlas_anim"),this.bombAnimation.ph2Animations.play("bomb_anim",1,!0),this.addChild(this.bombAnimation)},i.prototype.pauseBomb=function(){this.gameStatus=c.GAME_STATUS.PAUSED,this.bombAnimation.ph2Animations.pause()},i.prototype.resumeBomb=function(){this.gameStatus=c.GAME_STATUS.PLAYING,this.bombAnimation.ph2Animations.resume()},i.prototype.update=function(){this.gameStatus===c.GAME_STATUS.PAUSED||this.gameStatus===c.GAME_STATUS.GAME_OVER||this.falling||(this.isExploding||this.checkTimer(),this.isWarning||this.checkWarningTimer(),this.isKicked&&(this.checkPlayers(),this.checkMovement()))},i.prototype.checkTimer=function(){this.ignoreTimer||(this.timer+=this.game.time.elapsedMS,this.timer>=this.timeToExplode&&this.explode())},i.prototype.checkWarningTimer=function(){this.timerWarning+=this.game.time.elapsedMS,this.timerWarning>=.75*c.SETTINGS.BOMB_TIMER&&(this.isWarning=!0,this.bombExplosion.addDangerCellsToAstarGrid())},i.prototype.checkPlayers=function(){var t,i;if(this.grid.gameMode===c.GAME_MODE.ICE_MAN)for(t=0;t<this.players.length;t++)(i=this.players[t]).gridPositionX===this.gridPositionX&&i.gridPositionY===this.gridPositionY&&this.explode()},i.prototype.checkMovement=function(){var t,i,e;if(!this.isExploding)switch(this.direction){case c.DIRECTION.LEFT:this.moveKickLeft(),t=this.gridPositionX-1,i=this.gridPositionY,e=(this.gridPositionX-1<=0?this.grid.cells[0]:this.grid.cells[t])[i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*c.SETTINGS.CELL_WIDTH&&this.updateBombCell(e);break;case c.DIRECTION.RIGHT:this.moveKickRight(),t=this.gridPositionX+1,i=this.gridPositionY,e=(this.gridPositionX+1>=c.SETTINGS.GRID_WIDTH-1?this.grid.cells[c.SETTINGS.GRID_WIDTH-1]:this.grid.cells[t])[i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*c.SETTINGS.CELL_WIDTH&&this.updateBombCell(e);break;case c.DIRECTION.UP:this.moveKickUp(),t=this.gridPositionX,i=this.gridPositionY-1,e=this.gridPositionY-1<=0?this.grid.cells[t][0]:this.grid.cells[t][i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*c.SETTINGS.CELL_HEIGHT&&this.updateBombCell(e);break;case c.DIRECTION.DOWN:this.moveKickDown(),t=this.gridPositionX,i=this.gridPositionY+1,e=this.gridPositionY+1>=c.SETTINGS.GRID_HEIGHT-1?this.grid.cells[t][c.SETTINGS.GRID_HEIGHT-1]:this.grid.cells[t][i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*c.SETTINGS.CELL_HEIGHT&&this.updateBombCell(e)}},i.prototype.updateBombCell=function(t){var i=!0;0<this.cellsKicked.length&&this.gridCell.gridPositionX===this.cellsKicked[this.cellKickedIndex].gridPositionX&&this.gridCell.gridPositionY===this.cellsKicked[this.cellKickedIndex].gridPositionY&&(i=!1,this.gridCell.cellContains=this.cellsKickedContains[this.cellKickedIndex],this.cellKickedIndex++,this.cellKickedIndex>=this.cellsKickedContains.length)&&(this.cellKickedIndex=this.cellsKickedContains.length-1),i&&(this.gridCell.cellContains=c.MAP.FREE),this.gridPositionY!==t.gridPositionY&&this.grid.rowsGroup[t.gridPositionY].add(this),this.gridCell.isEmpty=!0,this.gridPositionX=t.gridPositionX,this.gridPositionY=t.gridPositionY,this.gridCell=t,this.gridCell.isEmpty=!1,this.gridCell.cellContains=c.MAP.BOMB},i.prototype.moveKickLeft=function(){var t=this.grid.cells[0][this.gridPositionY];this.x<=t.centerX||(0!==this.gridPositionX&&(t=this.grid.cells[this.gridPositionX-1][this.gridPositionY],this.grid.cells[this.gridPositionX][this.gridPositionY],!t.isEmpty)&&this.x-.5*c.SETTINGS.CELL_WIDTH*this.gameScale<=t.right?t.cellContains===c.MAP.JELLY&&(this.direction=c.DIRECTION.RIGHT):this.x-=this.kickedSpeed*this.gameScale*this.game.time.elapsedMS)},i.prototype.moveKickRight=function(){var t=this.grid.cells[c.SETTINGS.GRID_WIDTH-1][this.gridPositionY];this.x>=t.centerX||(this.gridPositionX!==c.SETTINGS.GRID_WIDTH-1&&(t=this.grid.cells[this.gridPositionX+1][this.gridPositionY],this.grid.cells[this.gridPositionX][this.gridPositionY],!t.isEmpty)&&this.x+.5*c.SETTINGS.CELL_WIDTH*this.gameScale>=t.left?t.cellContains===c.MAP.JELLY&&(this.direction=c.DIRECTION.LEFT):this.x+=this.kickedSpeed*this.gameScale*this.game.time.elapsedMS)},i.prototype.moveKickUp=function(){var t=this.grid.cells[this.gridPositionX][0];this.y<=t.centerY||0!==this.gridPositionY&&(t=this.grid.cells[this.gridPositionX][this.gridPositionY-1],this.grid.cells[this.gridPositionX][this.gridPositionY],!t.isEmpty)&&this.y-.5*c.SETTINGS.CELL_HEIGHT*this.gameScale<=t.bottom||(this.y-=this.kickedSpeed*this.gameScale*this.game.time.elapsedMS)},i.prototype.moveKickDown=function(){var t=this.grid.cells[this.gridPositionX][c.SETTINGS.GRID_HEIGHT-1];this.y>=t.centerY||this.gridPositionY!==c.SETTINGS.GRID_HEIGHT-1&&(t=this.grid.cells[this.gridPositionX][this.gridPositionY+1],this.grid.cells[this.gridPositionX][this.gridPositionY],!t.isEmpty)&&this.y+.5*c.SETTINGS.CELL_HEIGHT*this.gameScale>=t.top||(this.y+=this.kickedSpeed*this.gameScale*this.game.time.elapsedMS)},i.prototype.bombKicked=function(t,i){var e;if(!this.falling){switch(this.direction=t,this.ignoreTimer=i||!1,t){case c.DIRECTION.UP:if(0===this.gridPositionY)return;for(e=this.gridPositionY-1;0<=e;e--)this.cellsKicked.push(this.grid.cells[this.gridPositionX][e]),this.cellsKickedContains.push(this.grid.cells[this.gridPositionX][e].cellContains);break;case c.DIRECTION.DOWN:if(this.gridPositionY===c.SETTINGS.GRID_HEIGHT-1)return;for(e=this.gridPositionY+1;e<c.SETTINGS.GRID_HEIGHT-1;e++)this.cellsKicked.push(this.grid.cells[this.gridPositionX][e]),this.cellsKickedContains.push(this.grid.cells[this.gridPositionX][e].cellContains);break;case c.DIRECTION.LEFT:if(0===this.gridPositionX)return;for(e=this.gridPositionX-1;0<=e;e--)this.cellsKicked.push(this.grid.cells[e][this.gridPositionY]),this.cellsKickedContains.push(this.grid.cells[e][this.gridPositionY].cellContains);break;case c.DIRECTION.RIGHT:if(this.gridPositionX===c.SETTINGS.GRID_WIDTH-1)return;for(e=this.gridPositionX+1;e<c.SETTINGS.GRID_WIDTH-1;e++)this.cellsKicked.push(this.grid.cells[e][this.gridPositionY]),this.cellsKickedContains.push(this.grid.cells[e][this.gridPositionY].cellContains)}this.isKicked=!0}},i.prototype.createFall=function(){var t=this.game.rnd.integerInRange(750,1e3),i=this.gridCell.centerY;this.falling=!0,this.y=this.gridCell.centerY-c.SETTINGS.GRID_HEIGHT*c.SETTINGS.CELL_HEIGHT,this.timeToExplode=this.game.rnd.integerInRange(5e3,7e3),this.game.add.tween(this).to({y:i},t,Phaser.Easing.Bounce.Out,!0).onComplete.add(this.fallComplete,this)},i.prototype.fallComplete=function(){this.falling=!1},i.prototype.explode=function(){this.isKicked=!1,this.isExploding=!0,this.isWarning=!0,this.gridCell.isEmpty=!0,this.bombExplosion.gridCell=this.gridCell,this.bombExplosion.x=this.gridCell.centerX,this.bombExplosion.y=this.gridCell.centerY,this.bombExplosion.gridPositionX=this.gridPositionX,this.bombExplosion.gridPositionY=this.gridPositionY,this.bombExplosion.createDangerCells(),this.bombExplosion.makeExplosion(),this.grid.rowsGroup[this.gridCell.gridPositionY].add(this.bombExplosion),this.grid.removeBombFromArray(this.gridCell),this.destroyBomb()},i.prototype.destroyBomb=function(){this.grid.gameMode===c.GAME_MODE.ICE_MAN?(this.resetBombValues(),this.visible=!1,this.gameStatus=c.GAME_STATUS.GAME_OVER):(this.alive=!1,this.bombAnimation.ph2Animations.stop(),this.bombAnimation.destroy(!0),this.destroy())},i.prototype.resetBombValues=function(){this.timer=0,this.timerWarning=0,this.timeToExplode=c.SETTINGS.BOMB_TIMER,this.kickedSpeed=c.SETTINGS.BOMB_SPEED_KICKED,this.gameStatus=c.GAME_STATUS.PLAYING,this.gameScale=c.SETTINGS.SCALE,this.isExploding=!1,this.isWarning=!1,this.isKicked=!1,this.falling=!1,this.ignoreTimer=!1,this.previousCellContains=null,this.cellKickedIndex=0,this.cellsKicked=[],this.cellsKickedContains=[]};var l,t=i;function i(t,i,e,s,a,n,o,r){var h=l.call(this,t)||this;return h.x=n.centerX,h.y=n.centerY,h.game=t,h.keyName=s,h.grid=a,h.gridCell=n,h.gridPositionX=n.gridPositionX,h.gridPositionY=n.gridPositionY,h.power=o,h.player=r,h.players=a.players,h.timer=0,h.timerWarning=0,h.timeToExplode=c.SETTINGS.BOMB_TIMER,h.kickedSpeed=c.SETTINGS.BOMB_SPEED_KICKED,h.gameStatus=c.GAME_STATUS.PLAYING,h.gameScale=c.SETTINGS.SCALE,h.isExploding=!1,h.isWarning=!1,h.isKicked=!1,h.falling=!1,h.ignoreTimer=!1,h.bombExplosion=new c.BombExplosion(h.game,h.grid,h.gridCell,h.power,h.player),h.grid.bombExplosions.push(h.bombExplosion),h.previousCellContains=null,h.cellKickedIndex=0,h.cellsKicked=[],h.cellsKickedContains=[],h.createBombAnimation(),h}c.Bomb=t}(Game=Game||{}),function(e){function t(t,i){this.game=t,this.grid=i,this.bombs=[],this.redBombs=[],this.createPools()}t.prototype.createPools=function(){for(var t=0;t<15;t++)this.createBomb();for(t=0;t<5;t++)this.createRedBomb()},t.prototype.createBomb=function(){var t=this.grid.cells[0][0],t=new e.Bomb(this.game,0,0,"bomb",this.grid,t,2,null);return t.gameStatus=e.GAME_STATUS.GAME_OVER,t.visible=!1,this.bombs.push(t),t},t.prototype.createRedBomb=function(){var t=this.grid.cells[0][0],t=new e.Bomb(this.game,0,0,"bomb_red",this.grid,t,5,null);return t.gameStatus=e.GAME_STATUS.GAME_OVER,t.visible=!1,this.redBombs.push(t),t},t.prototype.getBomb=function(t){var i=this.getFirstBombDead();return(i=null===i?this.createBomb():i).x=t.centerX,i.y=t.centerY,i.gridCell=t,i.gridPositionX=t.gridPositionX,i.gridPositionY=t.gridPositionY,i.gameStatus=e.GAME_STATUS.PLAYING,i.visible=!0,i.bombExplosion.gridCell=i.gridCell,i.bombExplosion.x=i.gridCell.centerX,i.bombExplosion.y=i.gridCell.centerY,i.bombExplosion.gridPositionX=i.gridPositionX,i.bombExplosion.gridPositionY=i.gridPositionY,i.bombExplosion.createDangerCells(),i},t.prototype.getRedBomb=function(t){var i=this.getFirstRedBombDead();return(i=null===i?this.createRedBomb():i).x=t.centerX,i.y=t.centerY,i.gridCell=t,i.gridPositionX=t.gridPositionX,i.gridPositionY=t.gridPositionY,i.gameStatus=e.GAME_STATUS.PLAYING,i.visible=!0,i.bombExplosion.gridCell=i.gridCell,i.bombExplosion.x=i.gridCell.centerX,i.bombExplosion.y=i.gridCell.centerY,i.bombExplosion.gridPositionX=i.gridPositionX,i.bombExplosion.gridPositionY=i.gridPositionY,i.bombExplosion.createDangerCells(),i},t.prototype.getFirstBombDead=function(){for(var t=0;t<this.bombs.length;t++)if(this.bombs[t].gameStatus===e.GAME_STATUS.GAME_OVER&&!this.bombs[t].visible)return this.bombs[t];return null},t.prototype.getFirstRedBombDead=function(){for(var t=0;t<this.redBombs.length;t++)if(this.redBombs[t].gameStatus===e.GAME_STATUS.GAME_OVER&&!this.redBombs[t].visible)return this.redBombs[t];return null},e.BombsPool=t}(Game=Game||{}),function(a){h=Phaser.Group,__extends(i,h),i.prototype.createAnimations=function(t){var i,e,s=this;this.treasureBox?(i=.5*a.SETTINGS.CELL_WIDTH*a.SETTINGS.SCALE,e=a.SETTINGS.CELL_HEIGHT*a.SETTINGS.SCALE,this.animationTreasureBox=this.game.add.ph2AnimationObject(i,e,"box","atlas_anim"),this.animationTreasureBox.ph2Animations.play("box_in",1,!1).onComplete.add(function(){s.boxDestroyed||s.animationTreasureBox.ph2Animations.play("box_stand",1,!0)},this),this.add(this.animationTreasureBox)):(i=.5*a.SETTINGS.CELL_WIDTH*a.SETTINGS.SCALE,e=.5*a.SETTINGS.CELL_HEIGHT*a.SETTINGS.SCALE,this.spriteBox=new Phaser.Sprite(this.game,i,e,"atlas_gameplay",t),this.spriteBox.anchor.set(.5,.5),this.add(this.spriteBox)),this.animationExplosion=this.game.add.ph2AnimationObject(i,e,"brick_explosion","atlas_anim"),this.animationExplosion.visible=!1,this.add(this.animationExplosion)},i.prototype.destroyBox=function(){var t=this;this.boxDestroyed=!0,this.treasureBox?(this.animationTreasureBox.visible=!1,this.animationTreasureBox.ph2Animations.stop(),this.animationTreasureBox.destroy()):this.spriteBox.visible=!1,this.animationExplosion.visible=!0,this.animationExplosion.ph2Animations.play("brick_explosion_anim",1,!1).onComplete.add(function(){t.gridCell.cellContains=a.MAP.FREE,t.gridCell.isBox=!1,t.gridCell.isEmpty=!0,t.revealItem(),t.animationExplosion.ph2Animations.stop(),t.animationExplosion.destroy(!0),t.destroy()})},i.prototype.revealItem=function(){this.grid.gameStatus!==a.GAME_STATUS.GAME_OVER&&this.grid.gameStatus!==a.GAME_STATUS.PAUSED&&this.grid.createPowerUp(this.gridCell)},i.prototype.stopAnimations=function(){this.animationExplosion.ph2Animations.stop(),this.animationExplosion.destroy(),this.treasureBox&&(this.animationTreasureBox.ph2Animations.stop(),this.animationTreasureBox.destroy())};var h,t=i;function i(t,i,e,s,a,n,o){var r=h.call(this,t)||this;return r.x=i,r.y=e,r.game=t,r.grid=a,r.gridCell=n,r.gridPositionX=n.gridPositionX,r.gridPositionY=n.gridPositionY,r.canBeDestroyed=!0,r.boxDestroyed=!1,r.treasureBox=o||!1,r.createAnimations(s),r}a.Box=t}(Game=Game||{}),function(s){a=Phaser.Group,__extends(i,a),i.prototype.createAnimations=function(){this.animationCoin=this.game.add.ph2AnimationObject(0,0,"coin","atlas_anim"),this.animationCoin.ph2Animations.play("coin_stand",1,!0),this.addChild(this.animationCoin),this.animationDestroy=this.game.add.ph2AnimationObject(0,0,"brick_explosion","atlas_anim"),this.animationDestroy.visible=!1,this.addChild(this.animationDestroy)},i.prototype.throwCoinUp=function(){var t,i=this,e=this.grid.obtainFreeCell();null===e?this.destroyCoin():(e.cellContains=s.MAP.COIN,e.isCoin=!0,t=e.gridPositionY>this.gridCell.gridPositionY+1?this.gridCell.centerY-25:e.centerY-50*s.SETTINGS.SCALE,this.game.add.tween(this).to({y:t},750,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){i.game.add.tween(i).to({y:e.centerY},750,Phaser.Easing.Quartic.In,!0)},this),this.game.add.tween(this).to({x:e.centerX},1500,"Linear",!0).onComplete.add(function(){i.throwComplete(e)},this))},i.prototype.throwComplete=function(t){null!=this.grid.rowsGroup&&null!=this.grid.items&&(this.gridPositionX=t.gridPositionX,this.gridPositionY=t.gridPositionY,this.canBePickedUp=!0,this.grid.rowsGroup[t.gridPositionY].add(this),this.grid.coins.push(this))},i.prototype.destroyCoin=function(){this.alreadyDestroyed||(this.alreadyDestroyed=!0,this.animationDestroy.ph2Animations.stop(),this.animationDestroy.destroy(),this.animationCoin.ph2Animations.stop(),this.animationCoin.destroy(),this.destroy())},i.prototype.destroyAnimation=function(){void 0!==this.animationDestroy&&null!==this.animationDestroy&&(this.animationDestroy.visible=!0,this.animationDestroy.ph2Animations.play("brick_explosion_anim",1,!1).onComplete.add(this.destroyCoin,this))};var a,t=i;function i(t,i,e){var s=a.call(this,t)||this;return s.x=i.centerX,s.y=i.centerY,s.game=t,s.grid=e,s.gridCell=i,s.gridPositionX=i.gridPositionX,s.gridPositionY=i.gridPositionY,s.canBePickedUp=!1,s.alreadyDestroyed=!1,s.createAnimations(),s}s.Coin=t}(Game=Game||{}),function(c){e=Phaser.Group,__extends(i,e),i.prototype.createComics=function(){var t=.5*this.game.width,i=.5*this.game.height;this.overlayComics=new c.Overlay(this.game,1,"bg_black"),this.overlayComics.kill(),this.introComic1=this.game.add.ph2AnimationObject(t,i,"intro","atlas_intro"),this.introComic2=this.game.add.ph2AnimationObject(t,i,"intro2","atlas_intro"),this.gameCompleteComic=this.game.add.ph2AnimationObject(t,i,"game_completed","atlas_game_completed_comic"),this.introComic1.visible=!1,this.introComic2.visible=!1,this.gameCompleteComic.visible=!1,this.add(this.overlayComics),this.add(this.introComic1),this.add(this.introComic2),this.add(this.gameCompleteComic)},i.prototype.addTouchListeners=function(){this.introComic1.inputEnabled=!0,this.introComic2.inputEnabled=!0,this.gameCompleteComic.inputEnabled=!0,this.introComic1.events.onInputUp.add(this.skipIntro1,this),this.introComic2.events.onInputUp.add(this.skipIntro2,this),this.gameCompleteComic.events.onInputUp.add(this.skipGameComplete,this)},i.prototype.skipIntro1=function(){Ph2.AnimationSystem.findObject("page1/image1",this.introComic1).alpha<1&&(this.firstSkipComic1=!1,this.secondSkipComic1=!0),this.firstSkipComic1?(this.currentAnimation.getTimelineMax().seek(5.5,!1),this.firstSkipComic1=!1,this.secondSkipComic1=!0):this.secondSkipComic1&&(this.currentAnimation.stop(!0,!0),this.firstSkipComic1=!1,this.secondSkipComic1=!1,this.hideComics())},i.prototype.skipIntro2=function(){this.currentAnimation.stop(!0,!0),this.hideComics()},i.prototype.skipGameComplete=function(){Ph2.AnimationSystem.findObject("skin/image1",this.gameCompleteComic).alpha<1&&(this.firstSkipGameComplete=!1,this.secondSkipGameComplete=!0),this.firstSkipGameComplete?(this.currentAnimation.getTimelineMax().seek(3.2,!1),this.firstSkipGameComplete=!1,this.secondSkipGameComplete=!0):this.secondSkipGameComplete&&(this.currentAnimation.stop(!0,!0),this.firstSkipGameComplete=!1,this.secondSkipGameComplete=!1,this.hideComics())},i.prototype.createMaskIntroComic1=function(){var t=Ph2.AnimationSystem.findObject("page1/image1",this.introComic1),i=Ph2.AnimationSystem.findObject("page1/image2",this.introComic1),e=Ph2.AnimationSystem.findObject("page1/image3",this.introComic1),s=Ph2.AnimationSystem.findObject("page2/image1",this.introComic1),a=c.SETTINGS.SCALE,n=new Phaser.Polygon([new Phaser.Point(150*a,-262*a),new Phaser.Point(-130*a,-262*a),new Phaser.Point(-130*a,320*a),new Phaser.Point(103*a,320*a)]),o=new Phaser.Polygon([new Phaser.Point(-242*a,-142*a),new Phaser.Point(273*a,-142*a),new Phaser.Point(268*a,137*a),new Phaser.Point(-265*a,98*a)]),r=new Phaser.Polygon([new Phaser.Point(-262*a,-168*a),new Phaser.Point(237*a,-126*a),new Phaser.Point(273*a,151*a),new Phaser.Point(-291*a,151*a)]),a=new Phaser.Polygon([new Phaser.Point(-304*a,-158*a),new Phaser.Point(308*a,-158*a),new Phaser.Point(219*a,69*a),new Phaser.Point(-304*a,210*a)]),h=this.game.add.graphics(0,0);h.beginFill(65331),h.drawPolygon(n.points),h.endFill(),(n=this.game.add.graphics(0,0)).beginFill(65331),n.drawPolygon(o.points),n.endFill(),(o=this.game.add.graphics(0,0)).beginFill(65331),o.drawPolygon(r.points),o.endFill(),(r=this.game.add.graphics(0,0)).beginFill(65331),r.drawPolygon(a.points),r.endFill(),t.addChild(h),t.mask=h,i.addChild(n),i.mask=n,e.addChild(o),e.mask=o,s.addChild(r),s.mask=r},i.prototype.createMaskGameCompleteComic=function(){var t=Ph2.AnimationSystem.findObject("skin/image1",this.gameCompleteComic),i=Ph2.AnimationSystem.findObject("skin/image2",this.gameCompleteComic),e=Ph2.AnimationSystem.findObject("skin/image3",this.gameCompleteComic),s=Ph2.AnimationSystem.findObject("skin/image4",this.gameCompleteComic),a=c.SETTINGS.SCALE,n=new Phaser.Polygon([new Phaser.Point(-407*a,-137*a),new Phaser.Point(405*a,-137*a),new Phaser.Point(405*a,160*a),new Phaser.Point(-407*a,160*a)]),o=new Phaser.Polygon([new Phaser.Point(-163*a,-135*a),new Phaser.Point(253*a,-135*a),new Phaser.Point(76*a,130*a),new Phaser.Point(-163*a,130*a)]),r=new Phaser.Polygon([new Phaser.Point(-151*a,-140*a),new Phaser.Point(218*a,-140*a),new Phaser.Point(218*a,124*a),new Phaser.Point(-330*a,124*a)]),a=new Phaser.Polygon([new Phaser.Point(-405*a,-292*a),new Phaser.Point(403*a,-292*a),new Phaser.Point(403*a,291*a),new Phaser.Point(-405*a,291*a)]),h=this.game.add.graphics(0,0);h.beginFill(65331),h.drawPolygon(n.points),h.endFill(),(n=this.game.add.graphics(0,0)).beginFill(65331),n.drawPolygon(o.points),n.endFill(),(o=this.game.add.graphics(0,0)).beginFill(65331),o.drawPolygon(r.points),o.endFill(),(r=this.game.add.graphics(0,0)).beginFill(65331),r.drawPolygon(a.points),r.endFill(),t.addChild(h),t.mask=h,i.addChild(n),i.mask=n,e.addChild(o),e.mask=o,s.addChild(r),s.mask=r},i.prototype.showIntroComic1=function(){return this.overlayComics.revive(),this.introComic1.visible=!0,this.firstSkipComic1=!0,this.secondSkipComic1=!1,this.currentAnimation=this.introComic1.ph2Animations.play("intro_play",1,!1),this.currentAnimation},i.prototype.showIntroComic2=function(){return this.overlayComics.revive(),this.introComic2.visible=!0,this.currentAnimation=this.introComic2.ph2Animations.play("intro2_play",1,!1),this.currentAnimation},i.prototype.showGameCompleteComic2=function(t){var i;switch(t){case 0:i="hero1_gc";break;case 1:i="hero2_gc";break;case 2:i="hero3_gc";break;case 3:i="hero4_gc";break;case 4:i="hero5_gc";break;case 5:i="hero6_gc";break;case 6:i="hero7_gc";break;case 7:i="hero8_gc";break;default:i="hero1_gc"}return this.overlayComics.revive(),this.gameCompleteComic.visible=!0,this.firstSkipGameComplete=!0,this.secondSkipGameComplete=!1,Ph2.AnimationSystem.findObject("skin",this.gameCompleteComic).ph2Animations.play(i,1,!1),this.currentAnimation=this.gameCompleteComic.ph2Animations.play("game_completed_play",1,!1),this.currentAnimation},i.prototype.hideComics=function(){this.overlayComics.kill(),this.introComic1.visible=!1,this.introComic2.visible=!1,this.gameCompleteComic.visible=!1},i.prototype.resizeComic=function(){var t=.5*this.game.width,i=.5*this.game.height;this.overlayComics.width=this.game.width,this.overlayComics.height=this.game.height,this.introComic1.x=t,this.introComic1.y=i,this.introComic2.x=t,this.introComic2.y=i,this.gameCompleteComic.x=t,this.gameCompleteComic.y=i},i.prototype.resizeOverlay=function(){var t,i=Constants.CALCULATED_WIDTH,e=Constants.CALCULATED_HEIGHT,s=800*c.SETTINGS.SCALE;i<s?(t=e*(s=i/s),this.overlayComics.x=-(i-i*s),this.overlayComics.y=-(e-t),this.overlayComics.width=this.game.width+this.game.width*s,this.overlayComics.height=this.game.height+this.game.height*s):(this.overlayComics.x=0,this.overlayComics.y=0,this.overlayComics.width=this.game.width,this.overlayComics.height=this.game.height)};var e,t=i;function i(t){var i=e.call(this,t)||this;return i.game=t,i.firstSkipComic1=!0,i.secondSkipComic1=!1,i.firstSkipGameComplete=!0,i.secondSkipGameComplete=!1,i.createComics(),i.createMaskIntroComic1(),i.createMaskGameCompleteComic(),i.addTouchListeners(),i}c.Comic=t}(Game=Game||{}),function(o){r=Phaser.Group,__extends(i,r),i.prototype.createExplosion=function(){this.explosion=this.game.add.ph2AnimationObject(0,0,this.keyName,"atlas_anim"),this.explosion.ph2Animations.play(this.animationName,1,!1),this.addChild(this.explosion)};var r,t=i;function i(t,i,e,s,a){var n=r.call(this,t)||this;switch(n.x=i.centerX,n.y=i.centerY,n.game=t,n.gridCell=i,n.angle=e,s){case o.DIRECTION.UP:n.angle=0;break;case o.DIRECTION.DOWN:n.angle=180;break;case o.DIRECTION.LEFT:n.angle=270;break;case o.DIRECTION.RIGHT:n.angle=90}return a?(n.keyName="bomb_explosion_edge",n.animationName="anim_explosion_edge"):(n.keyName="bomb_explosion_line",n.animationName="anim_explosion_line"),n.createExplosion(),n}o.FireExplosion=t}(Game=Game||{}),function(g){l=Phaser.Group,__extends(i,l),i.prototype.defineAssets=function(){switch(this.mapTheme===g.MAP_THEME.RANDOM?this.mapThemeSelected=this.game.rnd.integerInRange(0,8):this.mapThemeSelected=this.mapTheme,this.mapThemeSelected){case g.MAP_THEME.CLASSROOM:this.possibleBlockers=["brick_h5.png","brick_h6.png","brick_h7.png","brick_h8.png","brick_h9.png"],this.possibleWalls=["brick_h1.png","brick_h2.png","brick_h3.png","brick_h4.png"],this.possibleTiles=["tile_classroom.png"],this.centerName="classroom_base.png";break;case g.MAP_THEME.FOREST:this.possibleBlockers=["brick_b5.png","brick_b6.png","brick_b7.png","brick_b8.png","brick_b9.png"],this.possibleWalls=["brick_b1.png","brick_b2.png","brick_b3.png","brick_b4.png"],this.possibleTiles=["tile_forest.png"],this.centerName="center_forest_base.png";break;case g.MAP_THEME.RACE_TRACK:this.possibleBlockers=["brick_a5.png","brick_a6.png","brick_a7.png","brick_a8.png","brick_a9.png"],this.possibleWalls=["brick_a1.png","brick_a2.png","brick_a3.png","brick_a4.png"],this.possibleTiles=["tile_race_track.png"],this.centerName="center_race_track.png";break;case g.MAP_THEME.RANCH:this.possibleBlockers=["brick_i5.png","brick_i6.png","brick_i7.png","brick_i8.png"],this.possibleWalls=["brick_i1.png","brick_i2.png","brick_i3.png","brick_i4.png"],this.possibleTiles=["tile_ranch.png"],this.centerName="center_ranch.png";break;case g.MAP_THEME.CHRISTMAS:this.possibleBlockers=["brick_d5.png","brick_d6.png","brick_d7.png","brick_d8.png","brick_d9.png"],this.possibleWalls=["brick_d1.png","brick_d2.png","brick_d3.png","brick_d4.png"],this.possibleTiles=["tile_christmas.png"],this.centerName="center_christmas_base.png";break;case g.MAP_THEME.BEACH:this.possibleBlockers=["brick_c5.png","brick_c6.png","brick_c7.png","brick_c8.png","brick_c9.png"],this.possibleWalls=["brick_c1.png","brick_c2.png","brick_c3.png","brick_c4.png"],this.possibleTiles=["tile_beach.png"],this.centerName="center_beach.png";break;case g.MAP_THEME.BAKERY:this.possibleBlockers=["brick_f5.png","brick_f6.png","brick_f7.png","brick_f8.png","brick_f9.png"],this.possibleWalls=["brick_f1.png","brick_f2.png","brick_f3.png","brick_f4.png"],this.possibleTiles=["tile_bakery.png"],this.centerName="center_bakery_base.png";break;case g.MAP_THEME.BOUTIQUE:this.possibleBlockers=["brick_g5.png","brick_g6.png","brick_g7.png","brick_g8.png","brick_g9.png"],this.possibleWalls=["brick_g1.png","brick_g2.png","brick_g3.png","brick_g4.png"],this.possibleTiles=["tile_boutique.png"],this.centerName="center_boutique.png";break;case g.MAP_THEME.TOY_STORE:this.possibleBlockers=["brick_e5.png","brick_e6.png","brick_e7.png","brick_e8.png","brick_e9.png"],this.possibleWalls=["brick_e1.png","brick_e2.png","brick_e3.png","brick_e4.png"],this.possibleTiles=["tile_toy_store.png"],this.centerName="center_toy_store_base.png"}this.chosenTile=this.possibleTiles[this.game.rnd.integerInRange(0,this.possibleTiles.length-1)],this.chosenWalls=_.sample(this.possibleWalls,2),this.tileGroup=new Phaser.Group(this.game),this.mainGroup=new Phaser.Group(this.game),this.joystickGroup=new Phaser.Group(this.game),this.add(this.tileGroup),this.add(this.mainGroup),this.add(this.joystickGroup)},i.prototype.createDarkness=function(){var t,i;this.difficulty===g.DIFFICULTY.HARD&&this.playerMode===g.PLAYER_MODE.SINGLE_PLAYER&&(i=t=void 0,t=g.SETTINGS.SCALE*g.SETTINGS.CELL_WIDTH*(g.SETTINGS.GRID_WIDTH+2),i=g.SETTINGS.SCALE*g.SETTINGS.CELL_HEIGHT*(g.SETTINGS.GRID_HEIGHT+2),this.darknessGroup=new Phaser.Group(this.game),this.add(this.darknessGroup),this.hardDarkness=new g.HardDarkness(this.game,t,i),this.darknessGroup.add(this.hardDarkness))},i.prototype.createChancesArray=function(){for(var t,i,e,s=g.SETTINGS.ON_BLOCK_DESTROY.length,a=0;a<s;a++)for(e=(i=g.SETTINGS.ON_BLOCK_DESTROY[a]).chance,t=0;t<e;t++)this.onBlockDestroyChances.push(i);for(s=g.SETTINGS.POWER_UP_CHANCES.length,a=0;a<s;a++)for(e=(i=g.SETTINGS.POWER_UP_CHANCES[a]).chance,t=0;t<e;t++)this.powerupChances.push(i);for(s=g.SETTINGS.WEAPON_CHANCES.length,a=0;a<s;a++)for(e=(i=g.SETTINGS.WEAPON_CHANCES[a]).chance,t=0;t<e;t++)this.weaponChances.push(i);for(s=g.SETTINGS.MOUNT_CHANCES.length,a=0;a<s;a++)for(e=(i=g.SETTINGS.MOUNT_CHANCES[a]).chance,t=0;t<e;t++)this.mountChances.push(i);for(s=g.SETTINGS.TREASURE_BOXES.length,a=0;a<s;a++)for(e=(i=g.SETTINGS.TREASURE_BOXES[a]).chance,t=0;t<e;t++)this.treasureBoxChances.push(i);for(s=g.SETTINGS.PACMAN_POWER_UPS.length,a=0;a<s;a++)for(e=(i=g.SETTINGS.PACMAN_POWER_UPS[a]).chance,t=0;t<e;t++)this.pacmanChances.push(i)},i.prototype.createTileGroups=function(){for(var t,i=0;i<g.SETTINGS.GRID_HEIGHT+2;i++)(t=new Phaser.Group(this.game)).name="row_"+i,this.add(t),this.rowsGroup.push(t)},i.prototype.createOuterWall=function(){var t,i,e,s,a=.5*g.SETTINGS.CELL_WIDTH*this.gameScale,n=.5*g.SETTINGS.CELL_HEIGHT*this.gameScale,o=this.initialX-g.SETTINGS.CELL_WIDTH*this.gameScale,r=this.initialY-g.SETTINGS.CELL_HEIGHT*this.gameScale,h=this.initialY+g.SETTINGS.CELL_HEIGHT*g.SETTINGS.GRID_HEIGHT*this.gameScale,c=g.SETTINGS.GRID_WIDTH+2,l=this.initialX-2*g.SETTINGS.CELL_WIDTH*this.gameScale,m=this.initialY-2*g.SETTINGS.CELL_HEIGHT*this.gameScale,d=g.SETTINGS.CELL_WIDTH*(g.SETTINGS.GRID_WIDTH+4)*this.gameScale,p=g.SETTINGS.CELL_HEIGHT*(g.SETTINGS.GRID_HEIGHT+4)*this.gameScale,l=new Phaser.TileSprite(this.game,l,m,d,p,"atlas_gameplay",this.chosenTile);for(this.tileGroup.add(l),t=0;t<c;t++)e=new Phaser.Sprite(this.game,o+a,r+n,"atlas_gameplay",this.chosenWalls[0]),s=new Phaser.Sprite(this.game,o+a,h+n,"atlas_gameplay",this.chosenWalls[0]),e.anchor.set(.5),s.anchor.set(.5),o+=g.SETTINGS.CELL_WIDTH*this.gameScale,this.rowsGroup[0].add(e),this.rowsGroup[this.rowsGroup.length-1].add(s),e.sendToBack(),s.sendToBack();for(o=this.initialX-g.SETTINGS.CELL_WIDTH*this.gameScale,i=this.initialX+g.SETTINGS.CELL_WIDTH*g.SETTINGS.GRID_WIDTH*this.gameScale,r=this.initialY,t=0;t<g.SETTINGS.GRID_HEIGHT;t++)e=new Phaser.Sprite(this.game,o+a,r+n,"atlas_gameplay",this.chosenWalls[0]),s=new Phaser.Sprite(this.game,i+a,r+n,"atlas_gameplay",this.chosenWalls[0]),e.anchor.set(.5),s.anchor.set(.5),r+=g.SETTINGS.CELL_HEIGHT*this.gameScale,this.rowsGroup[t].add(e),this.rowsGroup[t].add(s)},i.prototype.createGrid=function(){for(var t,i,e=this.initialX,s=this.initialY,a=[],n=[],o=[],r=[],h=0;h<g.SETTINGS.GRID_WIDTH;h++){for(t=0;t<g.SETTINGS.GRID_HEIGHT;t++)i=new g.GridCell(this.game,e,s,this.chosenTile,h,t),n.push(i),o.push(1),r.push(0),s+=g.SETTINGS.CELL_HEIGHT*this.gameScale;this.cells.push(n),this.gridData.push(r),a.push(o),o=[],n=[],r=[],s=this.initialY,e+=g.SETTINGS.CELL_WIDTH*this.gameScale}this.astarGrid=new Graph(a)},i.prototype.createMap=function(){var t,i,e,s,a,n,o,r,h=this.chosenWalls.length-1,c=.5*g.SETTINGS.CELL_WIDTH*this.gameScale,l=.5*g.SETTINGS.CELL_HEIGHT*this.gameScale,m=g.SETTINGS.GRID_WIDTH,d=g.SETTINGS.GRID_HEIGHT;switch(this.mapThemeSelected){case g.MAP_THEME.BEACH:r="beach",e=this.game.cache.getJSON("maps_special"),a=this.game.rnd.integerInRange(0,e[r].length-1);break;case g.MAP_THEME.FOREST:r="forest",e=this.game.cache.getJSON("maps_special"),a=this.game.rnd.integerInRange(0,e[r].length-1);break;case g.MAP_THEME.RACE_TRACK:r="race_track",e=this.game.cache.getJSON("maps_special"),a=this.game.rnd.integerInRange(0,e[r].length-1),this.redCarRoute=e[r][a].car_red,this.whiteCarRoute=e[r][a].car_white;break;case g.MAP_THEME.RANCH:r="ranch",e=this.game.cache.getJSON("maps_special"),a=this.game.rnd.integerInRange(0,e[r].length-1);break;case g.MAP_THEME.TOY_STORE:r="forest",e=this.game.cache.getJSON("maps_special"),a=this.game.rnd.integerInRange(0,e[r].length-1);break;default:r="maps",e=this.game.cache.getJSON("maps_generic"),a=this.game.rnd.integerInRange(0,e[r].length-1)}for(s=e[r][a].grid,this.blockersTotal=e[r][a].blockers,this.mapNumber=a,t=0;t<m;t++)for(i=0;i<d;i++)this.gridData[t][i]=s[i][t],s[i][t]!==g.GRID_DATA.WALL&&s[i][t]!==g.GRID_DATA.TOTEM||(n=this.cells[t][i],this.astarGrid.grid[t][i].weight=0,n.isEmpty=!1,n.cellContains=g.MAP.WALL,o=this.chosenWalls[this.game.rnd.integerInRange(0,h)],s[i][t]===g.GRID_DATA.WALL?((o=new Phaser.Sprite(this.game,n.x+c,n.y+l,"atlas_gameplay",o)).anchor.set(.5),this.rowsGroup[i].add(o)):s[i][t]===g.GRID_DATA.TOTEM&&(this.centerMapPositionX.push(n.gridPositionX),this.centerMapPositionY.push(n.gridPositionY)))},i.prototype.createMapCenter=function(){var t,i,e,s;switch(this.centerMap=null,s=this.centerMapPositionY[this.centerMapPositionY.length-1],t=this.centerMapPositionX[4],i=this.centerMapPositionY[4],e=this.cells[t][i],this.mapThemeSelected){case g.MAP_THEME.CHRISTMAS:this.centerMap=new g.Christmas(this.game,this,e);break;case g.MAP_THEME.CLASSROOM:this.centerMap=new g.Classroom(this.game,this,e);break;case g.MAP_THEME.BOUTIQUE:this.centerMap=new g.Boutique(this.game,this,e);break;case g.MAP_THEME.FOREST:this.centerMap=new g.Forest(this.game,this,e);break;case g.MAP_THEME.BEACH:this.centerMap=new g.Beach(this.game,this,e);break;case g.MAP_THEME.RANCH:this.centerMap=new g.Ranch(this.game,this,e);break;case g.MAP_THEME.TOY_STORE:this.centerMap=new g.ToyStore(this.game,this,e);break;case g.MAP_THEME.BAKERY:this.centerMap=new g.Bakery(this.game,this,e);break;case g.MAP_THEME.RACE_TRACK:this.centerMap=new g.RaceTrack(this.game,this,e)}(this.mapThemeSelected===g.MAP_THEME.RACE_TRACK?this.rowsGroup[s-1]:this.rowsGroup[s]).add(this.centerMap),this.mapThemeSelected===g.MAP_THEME.RACE_TRACK&&(new g.RaceCar(this.game,this,this.redCarRoute,"red"),new g.RaceCar(this.game,this,this.whiteCarRoute,"white"))},i.prototype.createSpecialTiles=function(){for(var t,i,e,s,a,n,o,r,h,c,l=[],m=0,d=0;d<g.SETTINGS.GRID_HEIGHT;d++)for(t=0;t<g.SETTINGS.GRID_WIDTH;t++)if(this.gridData[t][d]===g.GRID_DATA.RACE_TRACK)(e=this.cells[t][d]).isForcedFreeCell=!0,i=new g.RaceTile(this.game,this,e,this.mapNumber);else if(this.gridData[t][d]===g.GRID_DATA.LANDING_CELL)(e=this.cells[t][d]).isForcedFreeCell=!0,this.beachLandingCells.push(e);else if(this.gridData[t][d]===g.GRID_DATA.SPECIAL_TILE)switch((e=this.cells[t][d]).cellContains=g.MAP.SPECIAL_TILE,e.isForcedFreeCell=!0,this.mapThemeSelected){case g.MAP_THEME.BEACH:e.isSpecialTile=!0,this.gridData[t-1][d]===g.GRID_DATA.FORCE_FREE_CELL?(s=this.cells[t-1][d],a=this.cells[t+1][d],this.astarGrid.grid[t-1][d].weight=0,this.astarGrid.grid[t+1][d].weight=0):this.gridData[t][d-1]===g.GRID_DATA.FORCE_FREE_CELL&&(s=this.cells[t][d-1],a=this.cells[t][d+1],this.astarGrid.grid[t][d-1].weight=0,this.astarGrid.grid[t][d+1].weight=0),i=new g.Hammock(this.game,e.left,e.top,this,e,s,a);break;case g.MAP_THEME.FOREST:if(0===this.mapNumber)switch(m){case 0:n="blue";break;case 1:n="yellow";break;case 2:case 3:n="green";break;case 4:n="yellow";break;default:n="blue"}else if(1===this.mapNumber)switch(m){case 0:n="yellow";break;case 1:case 2:n="green";break;default:n="yellow"}else if(2===this.mapNumber)switch(m){case 0:n="blue";break;case 1:n="yellow";break;case 2:case 3:n="green";break;case 4:n="yellow";break;default:n="blue"}i=new g.Portal(this.game,this,e,n),m++,l.push(i);break;case g.MAP_THEME.RACE_TRACK:if(0===this.mapNumber)switch(m){case 0:c=g.DIRECTION.RIGHT;break;case 1:case 2:c=g.DIRECTION.LEFT;break;default:c=g.DIRECTION.RIGHT}else switch(m){case 0:c=g.DIRECTION.LEFT;break;case 1:c=g.DIRECTION.DOWN;break;case 2:c=g.DIRECTION.UP;break;default:c=g.DIRECTION.RIGHT}i=new g.Booster(this.game,this,e,c),m++;break;case g.MAP_THEME.RANCH:h=new g.Horse(this.game,this,e),this.horses.push(h);break;case g.MAP_THEME.TOY_STORE:i=new g.Warning(this.game,this,e)}if(this.mapThemeSelected===g.MAP_THEME.FOREST)for(t=0;t<l.length;t++)for(o=l[t],d=0;d<l.length;d++)r=l[d],"blue"===o.portalColor?"blue"===o.portalColor&&"blue"===r.portalColor&&o!==r&&(o.oppositePortal=r):"green"===o.portalColor?"green"===o.portalColor&&"green"===r.portalColor&&o!==r&&(o.oppositePortal=r):"yellow"===o.portalColor&&"yellow"===o.portalColor&&"yellow"===r.portalColor&&o!==r&&(o.oppositePortal=r)},i.prototype.createStartingCells=function(){for(var t,i=0;i<g.SETTINGS.GRID_HEIGHT;i++)for(t=0;t<g.SETTINGS.GRID_WIDTH;t++)this.gridData[t][i]===g.GRID_DATA.PLAYER&&(this.cells[t][i].isForcedFreeCell=!0,this.playersX.push(t),this.playersY.push(i),0<=t-1&&(this.cells[t-1][i].isForcedFreeCell=!0),t+1<=g.SETTINGS.GRID_WIDTH-1&&(this.cells[t+1][i].isForcedFreeCell=!0),0<=i-1&&(this.cells[t][i-1].isForcedFreeCell=!0),i+1<=g.SETTINGS.GRID_HEIGHT-1)&&(this.cells[t][i+1].isForcedFreeCell=!0),this.gridData[t][i]===g.GRID_DATA.FORCE_FREE_CELL&&(this.cells[t][i].isForcedFreeCell=!0)},i.prototype.createPlayers=function(){var t,i,e,s,a,n,o,r=[];for(r.push(this.cells[this.playersX[0]][this.playersY[0]]),r.push(this.cells[this.playersX[1]][this.playersY[1]]),r.push(this.cells[this.playersX[2]][this.playersY[2]]),r.push(this.cells[this.playersX[3]][this.playersY[3]]),o=(n=this.playerMode===g.PLAYER_MODE.SINGLE_PLAYER?1:2)+this.totalEnemies,t=0;t<n;t++)i=this.charactersChosen[t],s=this.obtainHeroName(i),i=new g.PlayerHuman(this.game,r[t].centerX,r[t].centerY,s,this,this.playersX[t],this.playersY[t],t,this.playerMode),this.players.push(i),this.rowsGroup[r[t].gridPositionY].add(i);for(;this.players.length<o;)a=this.players.length,s=this.obtainHeroName(this.charactersChosen[a]),e=new g.PlayerAI(this.game,r[a].centerX,r[a].centerY,s,this,this.playersX[a],this.playersY[a],a,this.difficulty),this.players.push(e),this.rowsGroup[r[a].gridPositionY].add(e);this.players[0].lives=g.Instances.DataManager.getLivesPlayer1(),this.playerMode===g.PLAYER_MODE.MULTI_PLAYER&&(this.players[1].lives=g.Instances.DataManager.getLivesPlayer2())},i.prototype.createSpawneableCells=function(){var t,i,e;for(this.spawneableCells=[],t=1;t<g.SETTINGS.GRID_WIDTH-1;t++)for(i=1;i<g.SETTINGS.GRID_HEIGHT-1;i++)(e=this.cells[t][i]).cellContains!==g.MAP.WALL&&this.spawneableCells.push(e)},i.prototype.obtainHeroName=function(t){switch(t){case 0:return"gp_hero1";case 1:return"gp_hero2";case 2:return"gp_hero3";case 3:return"gp_hero4";case 4:return"gp_hero5";case 5:return"gp_hero6";case 6:return"gp_hero7";case 7:return"gp_hero8"}},i.prototype.createBoxes=function(){if(this.gameMode!==g.GAME_MODE.NEW_PACMAN&&this.gameMode!==g.GAME_MODE.ICE_MAN)for(var t,i,e,s=_.sample(this.possibleBlockers,3),a=0;a<g.SETTINGS.GRID_WIDTH;a++)for(t=0;t<g.SETTINGS.GRID_HEIGHT;t++)if(this.cells[a][t].isEmpty&&!this.cells[a][t].isForcedFreeCell){if(this.cells[a][t].isForcedFreeCell)return;if(30<this.game.rnd.integerInRange(1,100)&&((i=this.cells[a][t]).isEmpty=!1,i.cellContains=g.MAP.BLOCK,i.isBox=!0,e=s[this.game.rnd.integerInRange(0,2)],e=new g.Box(this.game,i.x,i.y,e,this,i),this.astarGrid.grid[a][t].weight=0,this.boxes.push(e),this.rowsGroup[t].add(e),this.blockersCreated++,this.blockersCreated>=this.blockersTotal))return}},i.prototype.obtainFreeCell=function(){for(var t,i=[],e=0;e<this.spawneableCells.length;e++)(t=this.spawneableCells[e]).isEmpty&&t.cellContains===g.MAP.FREE&&i.push(t);return i.length<=0?null:_.sample(i)},i.prototype.createPowerUp=function(t){if(this.gameStatus!==g.GAME_STATUS.GAME_OVER){var i,e,s,a,n=this.game.rnd.integerInRange(0,99),o=this.game.rnd.integerInRange(0,99),n=this.onBlockDestroyChances[n].name;if("nothing"!==n){if(this.gameMode===g.GAME_MODE.BATTLE_ROYALE)"hammer"===(e=this.weaponChances[o]).name&&(e.name="shield");else if(this.gameMode===g.GAME_MODE.STAR_COLLECTOR)"ice_gun"===(e=this.weaponChances[o]).name&&(e.name="shield");else switch(n){case"power_up":e=this.powerupChances[o];break;case"weapon":e=this.weaponChances[o];break;case"mount":e=this.mountChances[o]}switch(e.name){case"bomb":s=g.ITEM_TYPE.BOMB,i="icon_bomb",a=g.POWER_UP_TYPE.POWER_UP;break;case"power":s=g.ITEM_TYPE.POWER,i="icon_power_blast",a=g.POWER_UP_TYPE.POWER_UP;break;case"speed":s=g.ITEM_TYPE.SPEED,i="icon_speed",a=g.POWER_UP_TYPE.POWER_UP;break;case"shield":s=g.ITEM_TYPE.SHIELD,i="icon_shield",a=g.POWER_UP_TYPE.POWER_UP;break;case"push":s=g.ITEM_TYPE.KICK_BOMBS,i="icon_super_gloves",a=g.POWER_UP_TYPE.POWER_UP;break;case"invincibility":s=g.ITEM_TYPE.INVINCIBILITY,i="icon_invincibility",a=g.POWER_UP_TYPE.POWER_UP;break;case"heart":s=g.ITEM_TYPE.HEART,i="icon_life",a=g.POWER_UP_TYPE.POWER_UP;break;case"flamethrower":s=g.ITEM_TYPE.FLAMETHROWER,i="icon_flamethrower",a=g.POWER_UP_TYPE.WEAPON;break;case"hammer":s=g.ITEM_TYPE.HAMMER,i="icon_hammer",a=g.POWER_UP_TYPE.WEAPON;break;case"laser_gun":s=g.ITEM_TYPE.LASER_GUN,i="icon_lightning_gun",a=g.POWER_UP_TYPE.WEAPON;break;case"ice_gun":s=g.ITEM_TYPE.ICE_GUN,i="icon_ice_gun",a=g.POWER_UP_TYPE.WEAPON;break;case"lightning_gun":s=g.ITEM_TYPE.LIGHTING_GUN,i="icon_laser_gun",a=g.POWER_UP_TYPE.WEAPON;break;case"doll_bomb":s=g.ITEM_TYPE.DOLL_BOMB,i="icon_doll_bomb",a=g.POWER_UP_TYPE.WEAPON;break;case"mighty_hammer":s=g.ITEM_TYPE.MIGHTY_HAMMER,i="icon_mighty_hammer",a=g.POWER_UP_TYPE.WEAPON;break;case"horse":s=g.ITEM_TYPE.HORSE,i="icon_horse",a=g.POWER_UP_TYPE.MOUNT;break;case"skate":s=g.ITEM_TYPE.SKATEBOARD,i="icon_skate",a=g.POWER_UP_TYPE.MOUNT;break;case"cart":s=g.ITEM_TYPE.SHOPPING_CART,i="icon_cart",a=g.POWER_UP_TYPE.MOUNT;break;case"stag":s=g.ITEM_TYPE.STAG,i="icon_stag",a=g.POWER_UP_TYPE.MOUNT;break;default:return}n=new g.Item(this.game,t,i,s,a),t.cellContains=g.MAP.ITEM,t.isItem=!0,this.rowsGroup[t.gridPositionY].add(n),this.items.push(n)}}},i.prototype.createRandomPacmanPowerUp=function(){if(!(4<=this.pacmanPowerUps)){var t,i,e,s=this.game.rnd.integerInRange(0,99),s=this.pacmanChances[s],a=this.obtainFreeCell();switch(s.name){case"speed":t=g.ITEM_TYPE.SPEED,i=g.POWER_UP_TYPE.POWER_UP,e="icon_speed";break;case"shield":t=g.ITEM_TYPE.SHIELD,i=g.POWER_UP_TYPE.POWER_UP,e="icon_shield";break;case"heart":t=g.ITEM_TYPE.HEART,i=g.POWER_UP_TYPE.POWER_UP,e="icon_life";break;case"invincibility":t=g.ITEM_TYPE.INVINCIBILITY,i=g.POWER_UP_TYPE.POWER_UP,e="icon_invincibility"}null!==a&&(s=new g.Item(this.game,a,e,t,i),a.cellContains=g.MAP.ITEM,a.isItem=!0,this.rowsGroup[a.gridPositionY].add(s),this.items.push(s),this.pacmanPowerUps++)}},i.prototype.createStar=function(){var t,i=this.obtainFreeCell();null!==i&&((t=new g.Star(this.game,i,this)).canBePickedUp=!0,i.isStar=!0,i.cellContains=g.MAP.STAR,this.stars.push(t),this.rowsGroup[i.gridPositionY].add(t))},i.prototype.createMonster=function(){var t=this.obtainFreeCell();null!==t&&(t=new g.Monster(this.game,this,t),this.monsters.push(t))},i.prototype.addBomb=function(t,i){this.bombs.push(t),this.rowsGroup[i.gridPositionY].add(t),this.astarGrid.grid[t.gridPositionX][t.gridPositionY].weight=0},i.prototype.removeBombFromArray=function(t){for(var i=this.bombs.length-1;0<=i;i--)this.bombs[i].gridPositionX===t.gridPositionX&&this.bombs[i].gridPositionY===t.gridPositionY&&(this.bombs.splice(i,1),i=-1);this.astarGrid.grid[t.gridPositionX][t.gridPositionY].weight=1},i.prototype.getItemAtCell=function(t){for(var i=this.items.length-1;0<=i;i--)if(this.items[i].gridPositionX===t.gridPositionX&&this.items[i].gridPositionY===t.gridPositionY)return this.items[i];return null},i.prototype.coinPickedUp=function(t,i){for(var e,s=this.coins.length-1;0<=s;s--)if((e=this.coins[s]).canBePickedUp&&e.gridPositionX===t.gridPositionX&&e.gridPositionY===t.gridPositionY)return this.coins.splice(s,1),i?e.destroyAnimation():e.destroyCoin(),t.cellContains=g.MAP.FREE,!(t.isCoin=!1);return!1},i.prototype.starPickedUp=function(t){for(var i,e=this.stars.length-1;0<=e;e--)if((i=this.stars[e]).canBePickedUp&&i.gridPositionX===t.gridPositionX&&i.gridPositionY===t.gridPositionY)return this.stars.splice(e,1),i.destroy(),t.cellContains=g.MAP.FREE,!(t.isStar=!1);return!1},i.prototype.removeItemFromArray=function(t,i){for(var e=this.items.length-1;0<=e;e--)this.items[e].gridPositionX===t.gridPositionX&&this.items[e].gridPositionY===t.gridPositionY&&(t.isEmpty=!0,t.isItem=!1,t.cellContains=g.MAP.FREE,i?this.items[e].destroyItem():this.items[e].destroyItemComplete(),this.items.splice(e,1),e=-1,this.gameMode===g.GAME_MODE.NEW_PACMAN)&&this.pacmanPowerUps--},i.prototype.explodeBomb=function(t){var i;for(this.clearAstarCell(t),i=this.bombs.length-1;0<=i;i--)this.bombs[i].gridPositionX===t.gridPositionX&&this.bombs[i].gridPositionY===t.gridPositionY&&(this.bombs[i].explode(),i=0)},i.prototype.destroyBox=function(t){var i;for(this.clearAstarCell(t),i=this.boxes.length-1;0<=i;i--)this.boxes[i].gridPositionX===t.gridPositionX&&this.boxes[i].gridPositionY===t.gridPositionY&&(this.boxes[i].destroyBox(),this.boxes.splice(i,1))},i.prototype.destroyBombExplosion=function(t){for(var i=this.bombExplosions.length-1;0<=i;i--)this.bombExplosions[i].gridPositionX===t.gridPositionX&&this.bombExplosions[i].gridPositionY===t.gridPositionY&&this.bombExplosions.splice(i,1);for(i=this.bombExplosions.length-1;0<=i;i--)this.bombExplosions[i].gridPositionX===t.gridPositionX&&this.bombExplosions[i].gridPositionY===t.gridPositionY&&this.bombExplosions.splice(i,1)},i.prototype.clearAstarCell=function(t){this.astarGrid.grid[t.gridPositionX][t.gridPositionY].weight=1},i.prototype.checkWeapons=function(){if(null!==this.weapons)for(var t=this.weapons.length-1;0<=t;t--)this.weapons[t].alive||this.weapons.splice(t,1)},i.prototype.startLightningShake=function(){var t=g.SETTINGS.SCALE*g.SETTINGS.CELL_WIDTH*.25,t=this.startingY+t;this.tweenLightningShake=this.game.add.tween(this).to({y:t},65,Phaser.Easing.Elastic.InOut,!0,0,2,!0),this.tweenLightningShake.onComplete.add(this.stopLightningShake,this)},i.prototype.stopLightningShake=function(){null!==this.tweenLightningShake&&(this.x=this.startingX,this.y=this.startingY)},i.prototype.startHammerShake=function(t){var i;null!==this.tweenHammerShake&&this.stopHammerShake(this.hammerShakePlayer),i=g.SETTINGS.SCALE*g.SETTINGS.CELL_WIDTH*.25,i=this.startingY+i,this.hammerShakePlayer=t,this.tweenHammerShake=this.game.add.tween(this).to({y:i},65,Phaser.Easing.Elastic.InOut,!0,0,-1,!0)},i.prototype.stopHammerShake=function(t){null!==this.tweenHammerShake&&(this.hammerShakePlayer===t&&this.tweenHammerShake.stop(),this.x=this.startingX,this.y=this.startingY)},i.prototype.gameOver=function(){var t;for(this.gameStatus=g.GAME_STATUS.GAME_OVER,t=0;t<this.players.length;t++)this.players[t].gameOver();for(t=0;t<this.bombs.length;t++)this.bombs[t].gameStatus=g.GAME_STATUS.GAME_OVER;for(t=0;t<this.bombExplosions.length;t++)this.bombExplosions[t].gameStatus=g.GAME_STATUS.GAME_OVER;for(t=0;t<this.weapons.length;t++)this.weapons[t].gameStatus=g.GAME_STATUS.GAME_OVER;null!==this.centerMap&&(this.centerMap.gameStatus=g.GAME_STATUS.GAME_OVER),null!==this.tweenHammerShake&&this.tweenHammerShake.pause()},i.prototype.pauseGrid=function(){var t;for(this.game.ph2AnimationManager.pauseAll(),this.gameStatus=g.GAME_STATUS.PAUSED,t=0;t<this.players.length;t++)this.players[t].pausePlayer();for(t=0;t<this.bombs.length;t++)this.bombs[t].pauseBomb();for(t=0;t<this.bombExplosions.length;t++)this.bombExplosions[t].gameStatus=this.gameStatus;for(t=0;t<this.items.length;t++)this.items[t].animationPowerUp.ph2Animations.pause();for(t=0;t<this.weapons.length;t++)this.weapons[t].gameStatus=g.GAME_STATUS.PAUSED;null!==this.centerMap&&this.centerMap.animationCenter.ph2Animations.pause(),null!==this.tweenHammerShake&&this.tweenHammerShake.pause()},i.prototype.resumeGrid=function(){var t;for(this.gameStatus=g.GAME_STATUS.PLAYING,this.game.ph2AnimationManager.resumeAll(),t=0;t<this.players.length;t++)this.players[t].resumePlayer();for(t=0;t<this.bombs.length;t++)this.bombs[t].resumeBomb();for(t=0;t<this.bombExplosions.length;t++)this.bombExplosions[t].gameStatus=this.gameStatus;for(t=0;t<this.items.length;t++)this.items[t].animationPowerUp.ph2Animations.resume();for(t=0;t<this.weapons.length;t++)this.weapons[t].gameStatus=g.GAME_STATUS.PLAYING;null!==this.centerMap&&this.centerMap.animationCenter.ph2Animations.resume(),null!==this.tweenHammerShake&&this.tweenHammerShake.resume()},i.prototype.createPacmanPowerUps=function(){this.gameStatus!==g.GAME_STATUS.PAUSED&&this.gameStatus!==g.GAME_STATUS.GAME_OVER&&(this.timerPacman+=this.game.time.elapsedMS,5e3<=this.timerPacman)&&(this.timerPacman=0,this.pacmanPowerUps<4)&&this.createRandomPacmanPowerUp()},i.prototype.update=function(){l.prototype.update.call(this),this.checkWeapons(),this.gameMode===g.GAME_MODE.NEW_PACMAN&&this.createPacmanPowerUps(),this.difficulty===g.DIFFICULTY.HARD&&this.playerMode===g.PLAYER_MODE.SINGLE_PLAYER&&this.hardDarkness.updateVisionRadius(this.players[0].x,this.players[0].y)},i.prototype.shutdownGrid=function(){var t;for(this.game.ph2AnimationManager.stopAll(),t=this.boxes.length-1;0<=t;t--)this.boxes[t].stopAnimations();this.tileGroup.destroy(!0),this.mainGroup.destroy(!0),this.joystickGroup.destroy(!0),this.cells=null,this.players=null,this.bombs=null,this.boxes=null,this.items=null,this.weapons=null,this.bombExplosions=null,this.astarGrid=null,this.initialX=null,this.initialY=null,this.tileGroup=null,this.mainGroup=null,this.joystickGroup=null,this.gridData=null,this.playersX=null,this.playersY=null,this.blockersTotal=null,this.blockersCreated=null,this.chosenTile=null,this.chosenWalls=null,this.possibleBlockers=null,this.possibleWalls=null,this.possibleTiles=null,this.centerName=null,this.centerMapPositionX=null,this.centerMapPositionY=null,this.weaponChances=null,this.powerupChances=null,this.gameScale=null},i.prototype.cheatDestroy=function(){for(var t=this.boxes.length-1;0<=t;t--)this.destroyBox(this.boxes[t].gridCell)};var l,t=i;function i(t,i,e,s,a,n,o){var r,h,c=l.call(this,t)||this;if(c.game=t,c.difficulty=i,c.playerMode=s,c.charactersChosen=n,c.gameMode=e,c.totalEnemies=o,c.mapTheme=a,c.rowsGroup=[],c.cells=[],c.players=[],c.bombs=[],c.boxes=[],c.items=[],c.weapons=[],c.bombExplosions=[],c.gridData=[],c.playersX=[],c.playersY=[],c.coins=[],c.stars=[],c.redCarRoute=[],c.whiteCarRoute=[],c.horses=[],c.monsters=[],c.beachLandingCells=[],c.spawneableCells=[],c.possibleBlockers=[],c.possibleWalls=[],c.possibleTiles=[],c.centerMapPositionX=[],c.centerMapPositionY=[],c.chosenWalls=[],c.pacmanChances=[],c.onBlockDestroyChances=[],c.weaponChances=[],c.powerupChances=[],c.treasureBoxChances=[],c.mountChances=[],c.survivalBombTimer=0,c.survivalPowerUpTimer=0,c.timeToCreatePowerUp=6e4,c.boxTimer=0,c.blockersCreated=0,c.blockersTotal=0,c.gameScale=g.SETTINGS.SCALE,c.initialX=0,c.initialY=0,c.tweenHammerShake=null,c.tweenLightningShake=null,c.hammerShakePlayer=0,c.mapNumber=0,c.pacmanPowerUps=0,c.timerPacman=0,c.defineAssets(),c.createChancesArray(),c.createTileGroups(),c.createGrid(),c.createMap(),c.createOuterWall(),c.createMapCenter(),c.createSpecialTiles(),c.createStartingCells(),c.createBoxes(),c.createPlayers(),c.createSpawneableCells(),c.createDarkness(),c.gameMode===g.GAME_MODE.NEW_PACMAN)c.createRandomPacmanPowerUp(),c.createRandomPacmanPowerUp(),c.createRandomPacmanPowerUp();else if(c.gameMode===g.GAME_MODE.STAR_COLLECTOR)for(h=c.game.rnd.integerInRange(7,8),r=0;r<h;r++)c.createStar();else if(c.gameMode===g.GAME_MODE.ICE_MAN)for(r=0;r<24;r++)c.createMonster();return c.gameStatus=g.GAME_STATUS.PLAYING,c}g.Grid=t}(Game=Game||{}),function(o){o.GridCell=function(t,i,e,s,a,n){this.x=i,this.y=e,this.top=this.y,this.bottom=this.y+o.SETTINGS.CELL_HEIGHT*o.SETTINGS.SCALE,this.left=this.x,this.right=this.x+o.SETTINGS.CELL_WIDTH*o.SETTINGS.SCALE,this.game=t,this.gridPositionX=a,this.gridPositionY=n,this.centerX=this.x+.5*o.SETTINGS.CELL_WIDTH*o.SETTINGS.SCALE,this.centerY=this.y+.5*o.SETTINGS.CELL_HEIGHT*o.SETTINGS.SCALE,this.isEmpty=!0,this.isDangerCell=!1,this.isForcedFreeCell=!1,this.isSpecialTile=!1,this.isItem=!1,this.isBox=!1,this.isFlag=!1,this.isCoin=!1,this.isStunCell=!1,this.isPortal=!1,this.isWarningClaw=!1,this.isStar=!1,this.cellContains=o.MAP.FREE,this.dangerWeapon=!1,this.dangerOwner=null,this.cream=null,this.hammock=null,this.portal=null,this.warningClaw=null}}(Game=Game||{}),function(r){h=Phaser.Sprite,__extends(i,h),i.prototype.updateVisionRadius=function(t,i){var e;this.shadowTexture.context.fillStyle="rgb(5,5,5)",this.shadowTexture.context.fillRect(0,0,this.screenWidth,this.screenHeight),(e=this.shadowTexture.context.createRadialGradient(t,i,.25*this.lightRadius,t,i,this.lightRadius)).addColorStop(0,"rgba(255, 255, 255, 1.0)"),e.addColorStop(1,"rgba(255, 255, 255, 0.0)"),this.shadowTexture.context.beginPath(),this.shadowTexture.context.fillStyle=e,this.shadowTexture.context.arc(t,i,this.lightRadius,0,2*Math.PI),this.shadowTexture.context.fill(),this.shadowTexture.dirty=!0};var h,t=i;function i(t,i,e){var s=this,a=t.add.bitmapData(i,e),n=-(r.SETTINGS.CELL_HEIGHT*r.SETTINGS.SCALE),o=-(r.SETTINGS.CELL_WIDTH*r.SETTINGS.SCALE)-20*r.SETTINGS.SCALE;return(s=h.call(this,t,n,o,a)||this).game=t,s.lightRadius=600*r.SETTINGS.SCALE,s.screenWidth=i,s.screenHeight=e,s.shadowTexture=a,s.blendMode=PIXI.blendModes.MULTIPLY,s}r.HardDarkness=t}(Game=Game||{}),function(a){n=Phaser.Group,__extends(i,n),i.prototype.createHorseAnimation=function(){var t=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*.3;this.horseAnimation=this.game.add.ph2AnimationObject(0,t,"horse","atlas_anim"),this.addChild(this.horseAnimation),this.grid.rowsGroup[this.gridPositionY].add(this)},i.prototype.update=function(){n.prototype.update.call(this),this.grid.gameStatus!==a.GAME_STATUS.PAUSED&&this.grid.gameStatus!==a.GAME_STATUS.GAME_OVER&&(this.isMoving?this.checkMovement():this.checkTimer())},i.prototype.checkTimer=function(){this.timerToMove+=this.game.time.elapsedMS,this.timerToMove>=this.delayToMove&&(this.timerToMove=0,this.isMoving=!0)},i.prototype.checkMovement=function(){var t,i,e;switch(this.direction){case a.DIRECTION.LEFT:this.moveHorseLeft(),t=this.gridPositionX-1,i=this.gridPositionY,e=(this.gridPositionX-1<=0?this.grid.cells[0]:this.grid.cells[t])[i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*a.SETTINGS.CELL_WIDTH&&this.updateHorseCell(e);break;case a.DIRECTION.RIGHT:this.moveHorseRight(),t=this.gridPositionX+1,i=this.gridPositionY,e=(this.gridPositionX+1>=a.SETTINGS.GRID_WIDTH-1?this.grid.cells[a.SETTINGS.GRID_WIDTH-1]:this.grid.cells[t])[i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*a.SETTINGS.CELL_WIDTH&&this.updateHorseCell(e);break;case a.DIRECTION.UP:this.moveHorseUp(),t=this.gridPositionX,i=this.gridPositionY-1,e=this.gridPositionY-1<=0?this.grid.cells[t][0]:this.grid.cells[t][i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*a.SETTINGS.CELL_HEIGHT&&this.updateHorseCell(e);break;case a.DIRECTION.DOWN:this.moveHorseDown(),t=this.gridPositionX,i=this.gridPositionY+1,e=this.gridPositionY+1>=a.SETTINGS.GRID_HEIGHT-1?this.grid.cells[t][a.SETTINGS.GRID_HEIGHT-1]:this.grid.cells[t][i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*a.SETTINGS.CELL_HEIGHT&&this.updateHorseCell(e)}},i.prototype.updateHorseCell=function(t){this.gridCell.isStunCell=!1,this.gridPositionX=t.gridPositionX,this.gridPositionY=t.gridPositionY,this.gridCell=t,this.gridCell.isStunCell=!0,this.grid.rowsGroup[this.gridPositionY].add(this)},i.prototype.moveHorseLeft=function(){var t=this.grid.cells[0][this.gridPositionY];this.x<=t.centerX||0!==this.gridPositionX&&!(t=this.grid.cells[this.gridPositionX-1][this.gridPositionY]).isEmpty&&this.x-.5*a.SETTINGS.CELL_WIDTH*this.gameScale<=t.right?this.chooseNextDirection():(t=this.x-this.movingSpeed*this.gameScale*this.game.time.elapsedMS,0<=this.gridPositionX-1?this.grid.cells[this.gridPositionX-1][this.gridPositionY].centerX<=t&&(this.x-=this.movingSpeed*this.gameScale*this.game.time.elapsedMS):this.grid.cells[0][this.gridPositionY].left<=t&&(this.x-=this.movingSpeed*this.gameScale*this.game.time.elapsedMS))},i.prototype.moveHorseRight=function(){var t=this.grid.cells[a.SETTINGS.GRID_WIDTH-1][this.gridPositionY];this.x>=t.centerX||this.gridPositionX!==a.SETTINGS.GRID_WIDTH-1&&!(t=this.grid.cells[this.gridPositionX+1][this.gridPositionY]).isEmpty&&this.x+.5*a.SETTINGS.CELL_WIDTH*this.gameScale>=t.left?this.chooseNextDirection():(t=this.x+this.movingSpeed*this.gameScale*this.game.time.elapsedMS,this.gridPositionX+1<=a.SETTINGS.GRID_WIDTH-1?t<=this.grid.cells[this.gridPositionX+1][this.gridPositionY].centerX&&(this.x+=this.movingSpeed*this.gameScale*this.game.time.elapsedMS):t<=this.grid.cells[a.SETTINGS.GRID_WIDTH-1][this.gridPositionY].right&&(this.x+=this.movingSpeed*this.gameScale*this.game.time.elapsedMS))},i.prototype.moveHorseUp=function(){var t=this.grid.cells[this.gridPositionX][0];this.y<=t.centerY||0!==this.gridPositionY&&!(t=this.grid.cells[this.gridPositionX][this.gridPositionY-1]).isEmpty&&this.y-.5*a.SETTINGS.CELL_HEIGHT*this.gameScale<=t.bottom?this.chooseNextDirection():(t=this.y-this.movingSpeed*this.gameScale*this.game.time.elapsedMS,0<=this.gridPositionY-1?this.grid.cells[this.gridPositionX][this.gridPositionY-1].centerY<=t&&(this.y-=this.movingSpeed*this.gameScale*this.game.time.elapsedMS):this.grid.cells[this.gridPositionX][0].top<=t&&(this.y-=this.movingSpeed*this.gameScale*this.game.time.elapsedMS))},i.prototype.moveHorseDown=function(){var t=this.grid.cells[this.gridPositionX][a.SETTINGS.GRID_HEIGHT-1];this.y>=t.centerY||this.gridPositionY!==a.SETTINGS.GRID_HEIGHT-1&&!(t=this.grid.cells[this.gridPositionX][this.gridPositionY+1]).isEmpty&&this.y+.5*a.SETTINGS.CELL_HEIGHT*this.gameScale>=t.top?this.chooseNextDirection():(t=this.y+this.movingSpeed*this.gameScale*this.game.time.elapsedMS,this.gridPositionY+1<=a.SETTINGS.GRID_HEIGHT-1?t<=this.grid.cells[this.gridPositionX][this.gridPositionY+1].centerY&&(this.y+=this.movingSpeed*this.gameScale*this.game.time.elapsedMS):t<=this.grid.cells[this.gridPositionX][a.SETTINGS.GRID_HEIGHT-1].bottom&&(this.y+=this.movingSpeed*this.gameScale*this.game.time.elapsedMS))},i.prototype.chooseNextDirection=function(){var t,i,e,s=[];if(0===this.gridPositionY||!(i=this.grid.cells[this.gridPositionX][this.gridPositionY-1]).isEmpty&&i.cellContains!==a.MAP.FREE||s.push(a.DIRECTION.UP),this.gridPositionY===a.SETTINGS.GRID_HEIGHT-1||!(i=this.grid.cells[this.gridPositionX][this.gridPositionY+1]).isEmpty&&i.cellContains!==a.MAP.FREE||s.push(a.DIRECTION.DOWN),0===this.gridPositionX||!(i=this.grid.cells[this.gridPositionX-1][this.gridPositionY]).isEmpty&&i.cellContains!==a.MAP.FREE||s.push(a.DIRECTION.LEFT),this.gridPositionX===a.SETTINGS.GRID_WIDTH-1||!(i=this.grid.cells[this.gridPositionX+1][this.gridPositionY]).isEmpty&&i.cellContains!==a.MAP.FREE||s.push(a.DIRECTION.RIGHT),0<s.length){switch(i=this.game.rnd.integerInRange(0,s.length-1),this.direction=s[i],this.direction){case a.DIRECTION.UP:e="horse_run_back",t=1;break;case a.DIRECTION.DOWN:e="horse_run_front",t=1;break;case a.DIRECTION.LEFT:e="horse_run_side",t=1;break;case a.DIRECTION.RIGHT:e="horse_run_side",t=-1;break;default:e="horse_run_back",t=1}this.horseAnimation.scaleX=t,this.horseAnimation.ph2Animations.play(e,1,!0)}};var n,t=i;function i(t,i,e){var s=n.call(this,t)||this;return s.game=t,s.grid=i,s.gridCell=e,s.gridCell.isStunCell=!0,s.gridPositionX=e.gridPositionX,s.gridPositionY=e.gridPositionY,s.x=e.centerX,s.y=e.centerY,s.movingSpeed=.15,s.gameStatus=a.GAME_STATUS.PLAYING,s.gameScale=a.SETTINGS.SCALE,s.isMoving=!1,s.timerToMove=0,s.delayToMove=750,s.createHorseAnimation(),s.chooseNextDirection(),s}a.Horse=t}(Game=Game||{}),function(e){o=Phaser.Group,__extends(i,o),i.prototype.createAnimations=function(t){var i=e.SETTINGS.SCALE*e.SETTINGS.CELL_HEIGHT*.3;this.animationPowerUp=this.game.add.ph2AnimationObject(0,i,t,"atlas_anim"),this.animationPowerUp.ph2Animations.play("icon_anim",1,!0),this.add(this.animationPowerUp),this.animationExplosion=this.game.add.ph2AnimationObject(0,0,"brick_explosion","atlas_anim"),this.animationExplosion.visible=!1,this.add(this.animationExplosion)},i.prototype.destroyItem=function(){var t=this;this.animationPowerUp.visible=!1,this.animationExplosion.visible=!0,this.animationExplosion.ph2Animations.play("brick_explosion_anim",1,!1).onComplete.add(function(){t.destroyItemComplete()},this)},i.prototype.destroyItemComplete=function(){this.animationPowerUp.ph2Animations.stop(),this.animationExplosion.ph2Animations.stop(),this.destroy(!0)};var o,t=i;function i(t,i,e,s,a){var n=o.call(this,t)||this;return n.x=i.centerX,n.y=i.centerY,n.game=t,n.gridCell=i,n.itemType=s,n.powerUpType=a,n.gridPositionX=i.gridPositionX,n.gridPositionY=i.gridPositionY,n.createAnimations(e),n}e.Item=t}(Game=Game||{}),function(t){s=Phaser.Group,__extends(e,s),e.prototype.update=function(){s.prototype.update.call(this)},e.prototype.destroyCenter=function(){this.animationCenter.ph2Animations.stop(),this.animationCenter.destroy()};var s,i=e;function e(t,i,e){t=s.call(this,t)||this;return t.grid=i,t.gridCell=e,t}t.MapCenter=i}(Game=Game||{}),function(h){function t(t,i,e,s,a,n,o,r){switch(this.game=t,this.id=i,this.reward=s,this.requirement=e,this.name=r,this.timer=a,this.levels=n,this.avoid=o,this.failed=!1,this.progress=0,this.levelsPassed=0,this.active=!1,this.complete=!1,this.startCountdown=!1,this.hasLevels=0<n,this.hasTimer=0<a,this.progressArray=[],i){case h.MISSION.FIGHT_IN_ALL_ARENAS_IN_ARCADE_MODE:case h.MISSION.FIGHT_IN_ALL_ARENAS_IN_BATTLE_ROYALE_MODE:case h.MISSION.FIGHT_IN_ALL_ARENAS_IN_PACMAN_MODE:case h.MISSION.FIGHT_IN_ALL_ARENAS_IN_STAR_BATTLE_MODE:case h.MISSION.FIGHT_IN_ALL_ARENAS_IN_FREEZE_MODE:this.missionMapPlayed=!0;break;default:this.missionMapPlayed=!1}switch(i){case h.MISSION.USE_4_TYPE_OF_WEAPONS_IN_LEVEL:case h.MISSION.USE_4_TYPES_OF_WEAPONS_IN_1_LEVEL_IN_ARCADE:case h.MISSION.USE_ALL_THE_WEAPONS:this.missionWeaponUsage=!0;break;default:this.missionWeaponUsage=!1}i===h.MISSION.RIDE_2_KINDS_OF_VEHICLES_IN_1_LEVEL?this.missionMountUsage=!0:this.missionMountUsage=!1,i===h.MISSION.PLAY_ALL_MODES&&(this.missionModesPlayed=!0)}t.prototype.checkMissionProgress=function(t){this.missionMapPlayed?this.checkMapsPlayed(t):this.missionModesPlayed?this.checkModesPlayed(t):this.missionMountUsage?this.checkMountsUsed(t):this.missionWeaponUsage?this.checkWeaponsUsed(t):this.hasTimer?this.checkTimerMissions():this.checkNormalMissions()},t.prototype.checkNormalMissions=function(){this.progress++,this.progress>=this.requirement&&(this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this))},t.prototype.checkTimerMissions=function(){(this.id!==h.MISSION.CLEAR_LEVEL_IN_120_SECONDS_IN_FROZEN&&this.id!==h.MISSION.CLEAR_LEVEL_BATTLE_ROYALE_120_SECONDS&&this.id!==h.MISSION.CLEAR_LEVEL_ARCADE_IN_120_SECONDS&&this.id!==h.MISSION.CLEAR_LEVEL_STAR_COLLECTOR_120_SECONDS&&this.id!==h.MISSION.CLEAR_LEVEL_IN_PACMAN_IN_120_SECONDS||this.startCountdown)&&this.progress++,this.hasTimer&&!this.startCountdown&&(this.startCountdown=!0,this.timeStarted=this.game.time.now),this.progress>=this.requirement&&(this.timeEnded=this.game.time.now,this.timeEnded-this.timeStarted<=this.timer?(this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this)):(this.complete=!1,this.startCountdown=!1,this.progress=0,this.timeStarted=0,this.timeEnded=0))},t.prototype.checkModesPlayed=function(t){for(var i=!1,e=0;e<this.progressArray.length;e++)t===this.progressArray[e]&&(i=!0);i||this.progressArray.push(t),5<=this.progressArray.length&&(this.progress++,this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this))},t.prototype.checkMountsUsed=function(t){for(var i=!1,e=0;e<this.progressArray.length;e++)t===this.progressArray[e]&&(i=!0);i||this.progressArray.push(t),4<=this.progressArray.length&&(this.progress++,this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this))},t.prototype.checkMapsPlayed=function(t){for(var i=!1,e=0;e<this.progressArray.length;e++)t===this.progressArray[e]&&(i=!0);i||this.progressArray.push(t),9<=this.progressArray.length&&(this.progress++,this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this))},t.prototype.checkWeaponsUsed=function(t){for(var i=!1,e=0;e<this.progressArray.length;e++)t===this.progressArray[e]&&(i=!0);i||(this.progress++,this.progressArray.push(t)),this.id===h.MISSION.USE_4_TYPES_OF_WEAPONS_IN_1_LEVEL_IN_ARCADE||this.id===h.MISSION.USE_4_TYPE_OF_WEAPONS_IN_LEVEL?4<=this.progress&&(this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this)):this.id===h.MISSION.USE_ALL_THE_WEAPONS&&7<=this.progress&&(this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this))},t.prototype.avoidMissionFailed=function(){this.failed=!0,this.restartMission()},t.prototype.checkAvoidMissionProgress=function(){this.failed?this.failed=!1:(this.progress++,this.progress>=this.requirement&&(this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this)))},t.prototype.restartMission=function(){this.progress=0,this.levelsPassed=0,this.active=!1,this.complete=!1,this.startCountdown=!1,this.progressArray=[],this.timeStarted=0,this.timeEnded=0},t.prototype.completeMissionWithCheats=function(){this.progress=this.requirement,this.complete=!0,this.game.ph2NotificationManager.postNotification("_SHOW_MISSION_COMPLETE",this)},h.Mission=t}(Game=Game||{}),function(t){s=Phaser.Group,__extends(e,s),e.prototype.update=function(){s.prototype.update.call(this)},e.prototype.initiateDestruction=function(){this.destroyed=!0,this.tweenMountLose=this.game.add.tween(this).to({alpha:.5},500,"Linear",!0,0,-1,!0)};var s,i=e;function e(t,i,e){t=s.call(this,t)||this;return t.grid=i,t.player=e,t.speed=0,t.destroyed=!1,t.destroyTimer=0,t.tweenMountLose=null,t}t.Mount=i}(Game=Game||{}),function(o){a=Phaser.Group,__extends(i,a),i.prototype.createAnimations=function(){var t,i,e=o.SETTINGS.SCALE*o.SETTINGS.CELL_HEIGHT*.3;switch(this.direction){case o.DIRECTION.UP:t="monster_back_stand",i=1;break;case o.DIRECTION.DOWN:t="monster_front_stand",i=1;break;case o.DIRECTION.LEFT:t="monster_side_stand",i=-1;break;case o.DIRECTION.RIGHT:t="monster_side_stand",i=1;break;default:t="monster_front_stand",i=1}this.animationMonster=this.game.add.ph2AnimationObject(0,e,"monster","atlas_anim"),this.animationMonster.ph2Animations.play(t,1,!0),this.animationMonster.scaleX=i,this.grid.rowsGroup[this.gridPositionY].add(this),this.add(this.animationMonster)},i.prototype.restartAI=function(){this.idle=!1,this.notSafe=!1,this.moving=!1,this.awaitingNewAction=!0,this.idleTimer=0,this.currentPathCell=0,this.freeCells=[],this.pathCells=[]},i.prototype.update=function(){a.prototype.update.call(this),this.grid.gameStatus!==o.GAME_STATUS.GAME_OVER&&this.grid.gameStatus!==o.GAME_STATUS.PAUSED&&(this.checkFrozen(),this.updateIdle(),this.updateMovement(),this.updateSense(),this.checkAnimation(),this.updateState(),this.checkDangerZone())},i.prototype.checkAnimation=function(){if(!this.frozen)switch(this.direction){case o.DIRECTION.UP:this.currentState=o.MONSTER_STATE.STAND_BACK;break;case o.DIRECTION.DOWN:this.currentState=o.MONSTER_STATE.STAND_FRONT;break;case o.DIRECTION.LEFT:this.currentState=o.MONSTER_STATE.STAND_LEFT;break;case o.DIRECTION.RIGHT:this.currentState=o.MONSTER_STATE.STAND_RIGHT;break;default:this.currentState=o.MONSTER_STATE.STAND_FRONT}},i.prototype.checkFrozen=function(){this.frozen&&(this.frozenTimer+=this.game.time.elapsedMS,1e4<=this.frozenTimer)&&this.unfrozeMonster()},i.prototype.updateState=function(){switch(this.currentState){case o.MONSTER_STATE.STAND_FRONT:this.animationState!==o.MONSTER_STATE.STAND_FRONT&&(this.animationState=o.MONSTER_STATE.STAND_FRONT,this.animationMonster.ph2Animations.play("monster_front_stand",1,!0),this.animationMonster.scaleX=1);break;case o.MONSTER_STATE.STAND_BACK:this.animationState!==o.MONSTER_STATE.STAND_BACK&&(this.animationState=o.MONSTER_STATE.STAND_BACK,this.animationMonster.ph2Animations.play("monster_back_stand",1,!0),this.animationMonster.scaleX=1);break;case o.MONSTER_STATE.STAND_LEFT:this.animationState!==o.MONSTER_STATE.STAND_LEFT&&(this.animationState=o.MONSTER_STATE.STAND_LEFT,this.animationMonster.ph2Animations.play("monster_side_stand",1,!0),this.animationMonster.scaleX=-1);break;case o.MONSTER_STATE.STAND_RIGHT:this.animationState!==o.MONSTER_STATE.STAND_RIGHT&&(this.animationState=o.MONSTER_STATE.STAND_RIGHT,this.animationMonster.ph2Animations.play("monster_side_stand",1,!0),this.animationMonster.scaleX=1);break;case o.MONSTER_STATE.FROZEN_FRONT:this.animationState!==o.MONSTER_STATE.FROZEN_FRONT&&(this.animationState=o.MONSTER_STATE.FROZEN_FRONT,this.animationMonster.ph2Animations.play("monster_front_frozen",1,!1),this.animationMonster.scaleX=1);break;case o.MONSTER_STATE.FROZEN_BACK:this.animationState!==o.MONSTER_STATE.FROZEN_BACK&&(this.animationState=o.MONSTER_STATE.FROZEN_BACK,this.animationMonster.ph2Animations.play("monster_back_frozen",1,!1),this.animationMonster.scaleX=1);break;case o.MONSTER_STATE.FROZEN_LEFT:this.animationState!==o.MONSTER_STATE.FROZEN_LEFT&&(this.animationState=o.MONSTER_STATE.FROZEN_LEFT,this.animationMonster.ph2Animations.play("monster_side_frozen",1,!1),this.animationMonster.scaleX=-1);break;case o.MONSTER_STATE.FROZEN_RIGHT:this.animationState!==o.MONSTER_STATE.FROZEN_RIGHT&&(this.animationState=o.MONSTER_STATE.FROZEN_RIGHT,this.animationMonster.ph2Animations.play("monster_side_frozen",1,!1),this.animationMonster.scaleX=1);break;case o.MONSTER_STATE.UNFROZEN_FRONT:this.animationState!==o.MONSTER_STATE.UNFROZEN_FRONT&&(this.animationState=o.MONSTER_STATE.UNFROZEN_FRONT,this.animationMonster.ph2Animations.play("monster_front_unfrozen",1,!1),this.animationMonster.scaleX=1);break;case o.MONSTER_STATE.UNFROZEN_BACK:this.animationState!==o.MONSTER_STATE.UNFROZEN_BACK&&(this.animationState=o.MONSTER_STATE.UNFROZEN_BACK,this.animationMonster.ph2Animations.play("monster_back_unfrozen",1,!1),this.animationMonster.scaleX=1);break;case o.MONSTER_STATE.UNFROZEN_LEFT:this.animationState!==o.MONSTER_STATE.UNFROZEN_LEFT&&(this.animationState=o.MONSTER_STATE.UNFROZEN_LEFT,this.animationMonster.ph2Animations.play("monster_side_unfrozen",1,!1),this.animationMonster.scaleX=-1);break;case o.MONSTER_STATE.UNFROZEN_RIGHT:this.animationState!==o.MONSTER_STATE.UNFROZEN_RIGHT&&(this.animationState=o.MONSTER_STATE.UNFROZEN_RIGHT,this.animationMonster.ph2Animations.play("monster_side_unfrozen",1,!1),this.animationMonster.scaleX=1)}},i.prototype.postUpdate=function(){this.checkActualGridLocation()},i.prototype.updateIdle=function(){this.idle&&(this.idleTimer+=this.game.time.elapsedMS,100<=this.idleTimer)&&(this.idle=!1,this.idleTimer=0)},i.prototype.updateMovement=function(){this.moving?this.checkSafeMovement():(this.chooseCellToMove(),this.findFreeCells(),this.findClearPath())},i.prototype.updateSense=function(){this.checkFreeCells()},i.prototype.checkFreeCells=function(){var t;this.freeCells=[],0<this.gridPositionX&&(t=this.grid.cells[this.gridPositionX-1][this.gridPositionY]).isEmpty&&this.freeCells.push(t),this.gridPositionX<o.SETTINGS.GRID_WIDTH-1&&(t=this.grid.cells[this.gridPositionX+1][this.gridPositionY]).isEmpty&&this.freeCells.push(t),0<this.gridPositionY&&(t=this.grid.cells[this.gridPositionX][this.gridPositionY-1]).isEmpty&&this.freeCells.push(t),this.gridPositionY<o.SETTINGS.GRID_HEIGHT-1&&(t=this.grid.cells[this.gridPositionX][this.gridPositionY+1]).isEmpty&&this.freeCells.push(t)},i.prototype.findFreeCells=function(){var t,i,e,s,a,n;for(this.freeCells=[],e=this.gridPositionX-1<0?0:this.gridPositionX-1,s=this.gridPositionX+1>o.SETTINGS.GRID_WIDTH-1?o.SETTINGS.GRID_WIDTH-1:this.gridPositionX+1,a=this.gridPositionY-1<0?0:this.gridPositionY-1,n=this.gridPositionY+1>o.SETTINGS.GRID_HEIGHT-1?o.SETTINGS.GRID_HEIGHT-1:this.gridPositionY+1,t=0;t<o.SETTINGS.GRID_WIDTH;t++)for(i=a;i<n+1;i++)this.grid.cells[t][i].isEmpty&&this.freeCells.push(this.grid.cells[t][i]);for(t=0;t<this.grid.cells[this.gridPositionX].length;t++)for(i=e;i<s+1;i++)this.grid.cells[i][t].isEmpty&&this.freeCells.push(this.grid.cells[i][t])},i.prototype.findClearPath=function(){var t,i,e,s,a=999,n=[],o=this.grid.astarGrid.grid[this.gridPositionX][this.gridPositionY];if(this.notSafe)for(t=0;t<this.freeCells.length;t++)e=this.freeCells[t],i=this.grid.astarGrid.grid[e.gridPositionX][e.gridPositionY],0<(s=astar.search(this.grid.astarGrid,o,i)).length&&s.length<a&&(a=(n=s).length);else{if(this.freeCells.length<=0)return void this.restartAI();e=_.sample(this.freeCells),i=this.grid.astarGrid.grid[e.gridPositionX][e.gridPositionY],n=astar.search(this.grid.astarGrid,o,i)}for(this.pathCells=[],t=0;t<n.length;t++)this.pathCells.push(this.grid.cells[n[t].x][n[t].y]);0<this.pathCells.length&&(this.moving=!0,this.currentPathCell=0,this.previousCell=this.gridCell,this.safeCell=this.pathCells[this.currentPathCell],this.nextSafeDirection(this.gridPositionX,this.gridPositionY,this.safeCell))},i.prototype.chooseCellToMove=function(){for(var t,i=[],e=0;e<this.freeCells.length;e++)i.push(this.freeCells[e]);0<i.length?(t=this.game.rnd.integerInRange(0,i.length-1),this.destinationCell=i[t],this.notSafe=!1,this.awaitingNewAction=!1,this.gridPositionX-1===this.destinationCell.gridPositionX?this.direction=o.DIRECTION.LEFT:this.gridPositionX+1===this.destinationCell.gridPositionX?this.direction=o.DIRECTION.RIGHT:this.gridPositionY-1===this.destinationCell.gridPositionY?this.direction=o.DIRECTION.UP:this.gridPositionY+1===this.destinationCell.gridPositionY&&(this.direction=o.DIRECTION.DOWN)):this.notSafe=!0},i.prototype.canPressButtons=function(){if(this.grid.gameStatus!==o.GAME_STATUS.GAME_OVER&&this.grid.gameStatus!==o.GAME_STATUS.PAUSED&&!this.frozen)switch(this.safeDirection){case o.DIRECTION.UP:this.inputUpPressed();break;case o.DIRECTION.DOWN:this.inputDownPressed();break;case o.DIRECTION.LEFT:this.inputLeftPressed();break;case o.DIRECTION.RIGHT:this.inputRightPressed()}},i.prototype.inputLeftPressed=function(){var t;this.direction=o.DIRECTION.LEFT,t=this.x-this.speed*o.SETTINGS.SCALE*this.game.time.elapsedMS,0<=this.gridPositionX-1?this.grid.cells[this.gridPositionX-1][this.gridPositionY].centerX<=t&&this.moveMonsterLeft():this.grid.cells[0][this.gridPositionY].left<=t&&this.moveMonsterLeft(),this.y=this.grid.cells[this.gridPositionX][this.gridPositionY].centerY},i.prototype.inputRightPressed=function(){var t;this.direction=o.DIRECTION.RIGHT,t=this.x+this.speed*o.SETTINGS.SCALE*this.game.time.elapsedMS,this.gridPositionX+1<=o.SETTINGS.GRID_WIDTH-1?t<=this.grid.cells[this.gridPositionX+1][this.gridPositionY].centerX&&this.moveMonsterRight():t<=this.grid.cells[o.SETTINGS.GRID_WIDTH-1][this.gridPositionY].right&&this.moveMonsterRight(),this.y=this.grid.cells[this.gridPositionX][this.gridPositionY].centerY},i.prototype.inputUpPressed=function(){var t;this.direction=o.DIRECTION.UP,t=this.y-this.speed*o.SETTINGS.SCALE*this.game.time.elapsedMS,0<=this.gridPositionY-1?this.grid.cells[this.gridPositionX][this.gridPositionY-1].centerY<=t&&this.moveMonsterUp():this.grid.cells[this.gridPositionX][0].top<=t&&this.moveMonsterUp(),this.x=this.grid.cells[this.gridPositionX][this.gridPositionY].centerX},i.prototype.inputDownPressed=function(){var t;this.direction=o.DIRECTION.DOWN,t=this.y+this.speed*o.SETTINGS.SCALE*this.game.time.elapsedMS,this.gridPositionY+1<=o.SETTINGS.GRID_HEIGHT-1?t<=this.grid.cells[this.gridPositionX][this.gridPositionY+1].centerY&&this.moveMonsterDown():t<=this.grid.cells[this.gridPositionX][o.SETTINGS.GRID_HEIGHT-1].bottom&&this.moveMonsterDown(),this.x=this.grid.cells[this.gridPositionX][this.gridPositionY].centerX},i.prototype.moveMonsterLeft=function(){this.x-=this.speed*o.SETTINGS.SCALE*this.game.time.elapsedMS},i.prototype.moveMonsterRight=function(){this.x+=this.speed*o.SETTINGS.SCALE*this.game.time.elapsedMS},i.prototype.moveMonsterUp=function(){this.y-=this.speed*o.SETTINGS.SCALE*this.game.time.elapsedMS},i.prototype.moveMonsterDown=function(){this.y+=this.speed*o.SETTINGS.SCALE*this.game.time.elapsedMS},i.prototype.checkSafeMovement=function(){this.frozen||(this.safeCell.isEmpty&&!this.safeCell.isDangerCell||(this.findFreeCells(),this.findClearPath()),this.canPressButtons(),Phaser.Math.distance(this.previousCell.centerX,this.previousCell.centerY,this.x,this.y)>=o.SETTINGS.CELL_WIDTH*o.SETTINGS.SCALE&&(this.currentPathCell++,this.previousCell=this.safeCell,this.currentPathCell<this.pathCells.length?(this.safeCell=this.pathCells[this.currentPathCell],this.nextSafeDirection(this.gridPositionX,this.gridPositionY,this.safeCell)):(this.idle=!0,this.moving=!1,this.awaitingNewAction=!0),this.awaitingNewAction=!0))},i.prototype.nextSafeDirection=function(t,i,e){t-1===e.gridPositionX?this.safeDirection=o.DIRECTION.LEFT:t+1===e.gridPositionX?this.safeDirection=o.DIRECTION.RIGHT:i-1===e.gridPositionY?this.safeDirection=o.DIRECTION.UP:i+1===e.gridPositionY&&(this.safeDirection=o.DIRECTION.DOWN)},i.prototype.frozeMonster=function(t){if(!this.frozen)switch(this.frozen=!0,this.frozenTimer=0,this.direction){case o.DIRECTION.UP:this.currentState=o.MONSTER_STATE.FROZEN_BACK;break;case o.DIRECTION.DOWN:this.currentState=o.MONSTER_STATE.FROZEN_FRONT;break;case o.DIRECTION.LEFT:this.currentState=o.MONSTER_STATE.FROZEN_LEFT;break;case o.DIRECTION.RIGHT:this.currentState=o.MONSTER_STATE.FROZEN_RIGHT;break;default:this.currentState=o.MONSTER_STATE.FROZEN_BACK}},i.prototype.unfrozeMonster=function(){if(this.frozen)switch(this.frozen=!1,this.frozenTimer=0,null!==this.frozenBy&&(this.frozenBy.totalFreeze--,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS")),this.frozenBy=null,this.direction){case o.DIRECTION.UP:this.currentState=o.MONSTER_STATE.UNFROZEN_BACK;break;case o.DIRECTION.DOWN:this.currentState=o.MONSTER_STATE.UNFROZEN_FRONT;break;case o.DIRECTION.LEFT:this.currentState=o.MONSTER_STATE.UNFROZEN_LEFT;break;case o.DIRECTION.RIGHT:this.currentState=o.MONSTER_STATE.UNFROZEN_RIGHT;break;default:this.currentState=o.MONSTER_STATE.UNFROZEN_BACK}},i.prototype.checkDangerZone=function(){null===this.gridCell||this.frozen||!this.gridCell.isDangerCell||this.gridCell.isSpecialTile||(this.frozeMonster(this.gridCell),null!==this.gridCell.dangerOwner&&(this.frozenBy=this.gridCell.dangerOwner,this.frozenBy.totalFreeze++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.frozenBy.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",o.MISSION.FREEZE_5_IN_10_SECONDS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",o.MISSION.FREEZE_12_IN_10_SECONDS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",o.MISSION.FREEZE_25_MONSTERS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",o.MISSION.FREEZE_100_MONSTERS),this.grid.mapThemeSelected===o.MAP_THEME.FOREST&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",o.MISSION.FREEZE_50_MONSTERS_IN_FOREST))))},i.prototype.checkActualGridLocation=function(){var t,i;switch(this.direction){case o.DIRECTION.LEFT:0!==this.gridPositionX&&(t=Math.floor(this.x/(o.SETTINGS.CELL_WIDTH*o.SETTINGS.SCALE)))!==this.gridPositionX&&(t===this.gridPositionX-1?this.grid.cells[t][this.gridPositionY].isEmpty&&(this.gridCell=this.grid.cells[t][this.gridPositionY],this.gridPositionX=t):this.grid.cells[this.gridPositionX-1][this.gridPositionY].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX-1][this.gridPositionY],this.gridPositionX=this.gridPositionX-1,this.x=this.gridCell.right));break;case o.DIRECTION.RIGHT:this.gridPositionX!==o.SETTINGS.GRID_WIDTH-1&&(t=Math.floor(this.x/(o.SETTINGS.CELL_WIDTH*o.SETTINGS.SCALE)))!==this.gridPositionX&&(t===this.gridPositionX+1?this.grid.cells[t][this.gridPositionY].isEmpty&&(this.gridCell=this.grid.cells[t][this.gridPositionY],this.gridPositionX=t):this.grid.cells[this.gridPositionX+1][this.gridPositionY].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX+1][this.gridPositionY],this.gridPositionX=this.gridPositionX+1,this.x=this.gridCell.left));break;case o.DIRECTION.UP:0!==this.gridPositionY&&(i=Math.floor(this.y/(o.SETTINGS.CELL_HEIGHT*o.SETTINGS.SCALE)))!==this.gridPositionY&&(i===this.gridPositionY-1?this.grid.cells[this.gridPositionX][i].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX][i],this.gridPositionY=i):this.grid.cells[this.gridPositionX][this.gridPositionY-1].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX][this.gridPositionY-1],this.gridPositionY=this.gridPositionY-1,this.y=this.gridCell.bottom),this.grid.rowsGroup[this.gridPositionY].addChild(this));break;case o.DIRECTION.DOWN:this.gridPositionY!==o.SETTINGS.GRID_HEIGHT-1&&(i=Math.floor(this.y/(o.SETTINGS.CELL_HEIGHT*o.SETTINGS.SCALE)))!==this.gridPositionY&&(i===this.gridPositionY+1?this.grid.cells[this.gridPositionX][i].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX][i],this.gridPositionY=i):this.grid.cells[this.gridPositionX][this.gridPositionY+1].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX][this.gridPositionY+1],this.gridPositionY=this.gridPositionY+1,this.y=this.gridCell.top),this.grid.rowsGroup[this.gridPositionY].addChild(this))}};var a,t=i;function i(t,i,e){var s=a.call(this,t)||this;switch(s.game=t,s.grid=i,s.gridCell=e,s.gridPositionX=e.gridPositionX,s.gridPositionY=e.gridPositionY,s.x=e.centerX,s.y=e.centerY,s.frozen=!1,s.idle=!0,s.moving=!1,s.notSafe=!1,s.awaitingNewAction=!0,s.speed=.05,s.idleTimer=0,s.currentPathCell=0,s.freeCells=[],s.pathCells=[],s.previousCellX=0,s.previousCellY=0,s.frozenTimer=0,s.frozenBy=null,s.game.rnd.integerInRange(0,3)){case 0:s.direction=o.DIRECTION.UP;break;case 1:s.direction=o.DIRECTION.DOWN;break;case 2:s.direction=o.DIRECTION.LEFT;break;case 3:s.direction=o.DIRECTION.RIGHT;break;default:s.direction=o.DIRECTION.UP}return s.createAnimations(),s}o.Monster=t}(Game=Game||{}),function(t){s=Phaser.TileSprite,__extends(e,s),e.prototype.kill=function(){this.alive=!1,this.exists=!1,this.visible=!1},e.prototype.revive=function(){this.alive=!0,this.exists=!0,this.visible=!0};var s,i=e;function e(t,i,e){e=s.call(this,t,0,0,t.world.width,t.world.height,e)||this;return e.game=t,e.alpha=i||1,e.inputEnabled=!0,e.kill(),e}t.Overlay=i}(Game=Game||{}),function(c){l=Phaser.Group,__extends(i,l),i.prototype.obtainSkins=function(){c.Instances.DataManager=c.Instances.DataManager,"gp_hero1"===this.keyName||"gp_hero3"===this.keyName||"gp_hero6"===this.keyName?this.heads=["head1","decor1","decor2","decor3"]:this.heads=["head1","head2","head3","head4"],this.faces=["face1","face2","face3","face4"],this.bodies=["body1","body2","body3","body4"],this.outfitCounter=0},i.prototype.createSpine=function(){var t,i,e,s;switch(this.playerID){case 0:this.outfit=c.Instances.DataManager.getOutfitPlayer1();break;case 1:this.outfit=c.Instances.DataManager.getOutfitPlayer2();break;case 2:this.outfit=c.Instances.DataManager.getOutfitPlayer3();break;case 3:this.outfit=c.Instances.DataManager.getOutfitPlayer4()}t=this.heads[this.outfit.head],i=this.faces[this.outfit.face],e=this.bodies[this.outfit.body],s=c.SETTINGS.SCALE*c.SETTINGS.CELL_HEIGHT*.3,this.spine=this.game.add.spine(0,s,this.keyName),"gp_hero1"!==this.keyName&&"gp_hero3"!==this.keyName&&"gp_hero6"!==this.keyName||"head1"===t?this.spine.createCombinedSkin("outfit","normal0",t,i,e):this.spine.createCombinedSkin("outfit","normal0","head1",t,i,e),this.spine.setSkinByName("outfit"),this.spine.setAnimationByName(0,"stand_front",!0),this.spine.setToSetupPose(),this.spine.scale.setTo(c.SETTINGS.SCALE),this.add(this.spine),this.playerState=c.PLAYER_STATE.STAND_FRONT},i.prototype.createPlayerElements=function(){var t=this.grid.rowsGroup.length-1;switch(this.animationRainbow=this.game.add.ph2AnimationObject(0,0,"rainbows","atlas_anim"),this.animationRainbow.visible=!1,this.grid.rowsGroup[t].add(this.animationRainbow),this.rainbowOffset=c.SETTINGS.SCALE*c.SETTINGS.CELL_HEIGHT*.3,this.animationPowerUps=this.game.add.ph2AnimationObject(0,0,"powerup_number","atlas_anim"),this.animationPowerUps.visible=!1,this.grid.rowsGroup[t].add(this.animationPowerUps),this.gameMode){case c.GAME_MODE.BATTLE_ROYALE:this.createWeapon(c.ITEM_TYPE.HAMMER);break;case c.GAME_MODE.ICE_MAN:this.createWeapon(c.ITEM_TYPE.ICE_GUN)}this.gameMode===c.GAME_MODE.ICE_MAN&&(this.iceBlock=new Phaser.Sprite(this.game,0,0,"atlas_anim","hero_ice.png"),this.iceBlock.anchor.set(.5),this.iceBlock.visible=!1,this.add(this.iceBlock))},i.prototype.createWeaponSkin=function(t){var i,e,s;switch(t=t===c.ITEM_TYPE.SHIELD&&this.weaponActive?this.weaponCurrentType:t){case c.ITEM_TYPE.ICE_GUN:i="ice_gun";break;case c.ITEM_TYPE.FLAMETHROWER:i="flamethrower";break;case c.ITEM_TYPE.LASER_GUN:i="lightning_gun";break;case c.ITEM_TYPE.LIGHTING_GUN:i="laser_gun";break;case c.ITEM_TYPE.HAMMER:i="hammer";break;case c.ITEM_TYPE.MIGHTY_HAMMER:i="mighty_hammer";break;case c.ITEM_TYPE.SHIELD:i="shield";break;case c.ITEM_TYPE.DOLL_BOMB:i="doll_bomb"}t=this.heads[this.outfit.head],e=this.faces[this.outfit.face],s=this.bodies[this.outfit.body],this.outfitCounter++,"gp_hero1"!==this.keyName&&"gp_hero3"!==this.keyName&&"gp_hero6"!==this.keyName||"head1"===t?this.shieldActive&&this.weaponActive?this.spine.createCombinedSkin("outfit"+this.outfitCounter,"normal0",t,e,s,i,"shield"):this.spine.createCombinedSkin("outfit"+this.outfitCounter,"normal0",t,e,s,i):this.shieldActive&&this.weaponActive?this.spine.createCombinedSkin("outfit"+this.outfitCounter,"normal0","head1",t,e,s,i,"shield"):this.spine.createCombinedSkin("outfit"+this.outfitCounter,"normal0","head1",t,e,s,i),this.spine.setSkinByName("outfit"+this.outfitCounter),this.animationState=null},i.prototype.clearWeaponSkin=function(){var t,i,e=this.heads[this.outfit.head],s=this.faces[this.outfit.face],a=this.bodies[this.outfit.body];if(this.shieldActive)t="shield",i=!0;else if(this.weaponActive)switch(this.weaponCurrentType){case c.ITEM_TYPE.ICE_GUN:t="ice_gun",i=!0;break;case c.ITEM_TYPE.FLAMETHROWER:t="flamethrower",i=!0;break;case c.ITEM_TYPE.LASER_GUN:t="lightning_gun",i=!0;break;case c.ITEM_TYPE.LIGHTING_GUN:t="laser_gun",i=!0;break;case c.ITEM_TYPE.HAMMER:t="hammer",i=!0;break;case c.ITEM_TYPE.MIGHTY_HAMMER:t="mighty_hammer",i=!0;break;case c.ITEM_TYPE.DOLL_BOMB:t="doll_bomb",i=!0}else i=!1;this.outfitCounter++,"gp_hero1"!==this.keyName&&"gp_hero3"!==this.keyName&&"gp_hero6"!==this.keyName||"head1"===e?i?this.spine.createCombinedSkin("outfit"+this.outfitCounter,"normal0",e,s,a,t):this.spine.createCombinedSkin("outfit"+this.outfitCounter,"normal0",e,s,a):i?this.spine.createCombinedSkin("outfit"+this.outfitCounter,"normal0","head1",e,s,a,t):this.spine.createCombinedSkin("outfit"+this.outfitCounter,"normal0","head1",e,s,a),this.spine.setSkinByName("outfit"+this.outfitCounter),this.animationState=null},i.prototype.createInitialBlinking=function(){this.alpha=1,this.blinking=!0,this.initialBlinking=!0,this.tweenInvulnerable=this.game.add.tween(this).to({alpha:.5},100,"Linear",!0,0,-1,!0)},i.prototype.checkHorseJump=function(t){var i,e=!1;switch(t){case c.DIRECTION.UP:0<=this.gridPositionY-2&&(i=this.grid.cells[this.gridPositionX][this.gridPositionY-2]);break;case c.DIRECTION.DOWN:this.gridPositionY+2<=c.SETTINGS.GRID_HEIGHT-1&&(i=this.grid.cells[this.gridPositionX][this.gridPositionY+2]);break;case c.DIRECTION.LEFT:0<=this.gridPositionX-2&&(i=this.grid.cells[this.gridPositionX-2][this.gridPositionY]);break;case c.DIRECTION.RIGHT:this.gridPositionX+2<=c.SETTINGS.GRID_WIDTH-1&&(i=this.grid.cells[this.gridPositionX+2][this.gridPositionY])}return null!=i&&i.isEmpty&&(e=!0,this.mount.direction=null,this.mount.jumpCell(i),this.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.JUMP_BY_RIDING_A_HORSE_10_TIMES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.JUMP_BY_RIDING_A_HORSE_20_TIMES))),e},i.prototype.checkStagAttack=function(t){t.cellContains!==c.MAP.BLOCK&&!t.isBox||(this.grid.destroyBox(t),this.mount.attackBlock(),this.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.DESTROY_15_BLOCKS_WHEN_RIDING_WAPITI_1_LEVEL),this.grid.gameMode===c.GAME_MODE.ARCADE&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.DESTROY_15_BLOCKS_WHEN_RIDING_WAPITI_IN_ARCADE_MODE_1_LEVEL))},i.prototype.checkLeft=function(){var t;return!(this.jumping||this.attacking||(t=this.grid.cells[0][this.gridPositionY],this.x<=t.centerX?(this.x=this.gridCell.centerX,1):0!==this.gridPositionX&&!(t=this.grid.cells[this.gridPositionX-1][this.gridPositionY]).isEmpty&&(t.cellContains===c.MAP.BOMB&&this.canKickBombs&&this.kickBomb(t,c.DIRECTION.LEFT),this.x-this.cellOffset<=t.right)&&(this.x=this.gridCell.centerX,this.onMount&&(this.mountType===c.ITEM_TYPE.HORSE?this.checkHorseJump(this.direction):this.mountType===c.ITEM_TYPE.STAG&&this.checkStagAttack(t)),1)))},i.prototype.checkRight=function(){var t;return!(this.jumping||this.attacking||(t=this.grid.cells[c.SETTINGS.GRID_WIDTH-1][this.gridPositionY],this.x>=t.centerX?(this.x=this.gridCell.centerX,1):this.gridPositionX!==c.SETTINGS.GRID_WIDTH-1&&!(t=this.grid.cells[this.gridPositionX+1][this.gridPositionY]).isEmpty&&(t.cellContains===c.MAP.BOMB&&this.canKickBombs&&this.kickBomb(t,c.DIRECTION.RIGHT),this.x+this.cellOffset>=t.left)&&(this.x=this.gridCell.centerX,this.onMount&&(this.mountType===c.ITEM_TYPE.HORSE?this.checkHorseJump(this.direction):this.mountType===c.ITEM_TYPE.STAG&&this.checkStagAttack(t)),1)))},i.prototype.checkUp=function(){var t;return!(this.jumping||this.attacking||(t=this.grid.cells[this.gridPositionX][0],this.y<=t.centerY?(this.y=this.gridCell.centerY,1):0!==this.gridPositionY&&!(t=this.grid.cells[this.gridPositionX][this.gridPositionY-1]).isEmpty&&(t.cellContains===c.MAP.BOMB&&this.canKickBombs&&this.kickBomb(t,c.DIRECTION.UP),this.y-this.cellOffset<=t.bottom)&&(this.y=this.gridCell.centerY,this.onMount&&(this.mountType===c.ITEM_TYPE.HORSE?this.checkHorseJump(this.direction):this.mountType===c.ITEM_TYPE.STAG&&this.checkStagAttack(t)),1)))},i.prototype.checkDown=function(){var t;return!(this.jumping||this.attacking||(t=this.grid.cells[this.gridPositionX][c.SETTINGS.GRID_HEIGHT-1],this.y>=t.centerY?(this.y=this.gridCell.centerY,1):this.gridPositionY!==c.SETTINGS.GRID_HEIGHT-1&&!(t=this.grid.cells[this.gridPositionX][this.gridPositionY+1]).isEmpty&&(t.cellContains===c.MAP.BOMB&&this.canKickBombs&&this.kickBomb(t,c.DIRECTION.DOWN),this.y+this.cellOffset>=t.top)&&(this.y=this.gridCell.centerY,this.onMount&&(this.mountType===c.ITEM_TYPE.HORSE?this.checkHorseJump(this.direction):this.mountType===c.ITEM_TYPE.STAG&&this.checkStagAttack(t)),1)))},i.prototype.inputLeftPressed=function(){var t;if(this.onMount)switch(this.mountType){case c.ITEM_TYPE.HORSE:this.playerState=c.PLAYER_STATE.HORSE_SIDE;break;case c.ITEM_TYPE.SKATEBOARD:this.playerState=c.PLAYER_STATE.SKATE_SIDE;break;case c.ITEM_TYPE.SHOPPING_CART:this.playerState=c.PLAYER_STATE.SHOPPING_CART_SIDE;break;case c.ITEM_TYPE.STAG:this.playerState=c.PLAYER_STATE.STAG_SIDE}else this.playerState=c.PLAYER_STATE.WALK_SIDE;this.direction=c.DIRECTION.LEFT,this.keyPressed=!0,this.checkLeft()&&(t=this.x-this.speed*this.gameScale*this.game.time.elapsedMS,0<=this.gridPositionX-1?this.grid.cells[this.gridPositionX-1][this.gridPositionY].centerX<=t&&this.movePlayerLeft():this.grid.cells[0][this.gridPositionY].left<=t&&this.movePlayerLeft(),this.y=this.grid.cells[this.gridPositionX][this.gridPositionY].centerY,this.movingAnimation=!0)},i.prototype.inputRightPressed=function(){var t;if(this.onMount)switch(this.mountType){case c.ITEM_TYPE.HORSE:this.playerState=c.PLAYER_STATE.HORSE_SIDE;break;case c.ITEM_TYPE.SKATEBOARD:this.playerState=c.PLAYER_STATE.SKATE_SIDE;break;case c.ITEM_TYPE.SHOPPING_CART:this.playerState=c.PLAYER_STATE.SHOPPING_CART_SIDE;break;case c.ITEM_TYPE.STAG:this.playerState=c.PLAYER_STATE.STAG_SIDE}else this.playerState=c.PLAYER_STATE.WALK_SIDE;this.direction=c.DIRECTION.RIGHT,this.keyPressed=!0,this.checkRight()&&(t=this.x+this.speed*this.gameScale*this.game.time.elapsedMS,this.gridPositionX+1<=c.SETTINGS.GRID_WIDTH-1?t<=this.grid.cells[this.gridPositionX+1][this.gridPositionY].centerX&&this.movePlayerRight():t<=this.grid.cells[c.SETTINGS.GRID_WIDTH-1][this.gridPositionY].right&&this.movePlayerRight(),this.y=this.grid.cells[this.gridPositionX][this.gridPositionY].centerY,this.movingAnimation=!0,this.spine.autoUpdate=!0)},i.prototype.inputUpPressed=function(){var t;if(this.onMount)switch(this.mountType){case c.ITEM_TYPE.HORSE:this.playerState=c.PLAYER_STATE.HORSE_BACK;break;case c.ITEM_TYPE.SKATEBOARD:this.playerState=c.PLAYER_STATE.SKATE_BACK;break;case c.ITEM_TYPE.SHOPPING_CART:this.playerState=c.PLAYER_STATE.SHOPPING_CART_BACK;break;case c.ITEM_TYPE.STAG:this.playerState=c.PLAYER_STATE.STAG_BACK}else this.playerState=c.PLAYER_STATE.WALK_BACK;this.direction=c.DIRECTION.UP,this.keyPressed=!0,this.checkUp()&&(t=this.y-this.speed*this.gameScale*this.game.time.elapsedMS,0<=this.gridPositionY-1?this.grid.cells[this.gridPositionX][this.gridPositionY-1].centerY<=t&&this.movePlayerUp():this.grid.cells[this.gridPositionX][0].top<=t&&this.movePlayerUp(),this.x=this.grid.cells[this.gridPositionX][this.gridPositionY].centerX,this.movingAnimation=!0,this.spine.autoUpdate=!0)},i.prototype.inputDownPressed=function(){var t;if(this.onMount)switch(this.mountType){case c.ITEM_TYPE.HORSE:this.playerState=c.PLAYER_STATE.HORSE_FRONT;break;case c.ITEM_TYPE.SKATEBOARD:this.playerState=c.PLAYER_STATE.SKATE_FRONT;break;case c.ITEM_TYPE.SHOPPING_CART:this.playerState=c.PLAYER_STATE.SHOPPING_CART_FRONT;break;case c.ITEM_TYPE.STAG:this.playerState=c.PLAYER_STATE.STAG_FRONT}else this.playerState=c.PLAYER_STATE.WALK_FRONT;this.direction=c.DIRECTION.DOWN,this.keyPressed=!0,this.checkDown()&&(t=this.y+this.speed*this.gameScale*this.game.time.elapsedMS,this.gridPositionY+1<=c.SETTINGS.GRID_HEIGHT-1?t<=this.grid.cells[this.gridPositionX][this.gridPositionY+1].centerY&&this.movePlayerDown():t<=this.grid.cells[this.gridPositionX][c.SETTINGS.GRID_HEIGHT-1].bottom&&this.movePlayerDown(),this.x=this.grid.cells[this.gridPositionX][this.gridPositionY].centerX,this.movingAnimation=!0,this.spine.autoUpdate=!0)},i.prototype.movePlayerLeft=function(){if(this.onMount)switch(this.mountType){case c.ITEM_TYPE.HORSE:case c.ITEM_TYPE.SKATEBOARD:case c.ITEM_TYPE.SHOPPING_CART:case c.ITEM_TYPE.STAG:this.x-=this.mount.speed*this.gameScale*this.game.time.elapsedMS}else this.x-=this.speed*this.gameScale*this.game.time.elapsedMS},i.prototype.movePlayerRight=function(){if(this.onMount)switch(this.mountType){case c.ITEM_TYPE.HORSE:case c.ITEM_TYPE.SKATEBOARD:case c.ITEM_TYPE.SHOPPING_CART:case c.ITEM_TYPE.STAG:this.x+=this.mount.speed*this.gameScale*this.game.time.elapsedMS}else this.x+=this.speed*this.gameScale*this.game.time.elapsedMS},i.prototype.movePlayerUp=function(){if(this.onMount)switch(this.mountType){case c.ITEM_TYPE.HORSE:case c.ITEM_TYPE.SKATEBOARD:case c.ITEM_TYPE.SHOPPING_CART:case c.ITEM_TYPE.STAG:this.y-=this.mount.speed*this.gameScale*this.game.time.elapsedMS}else this.y-=this.speed*this.gameScale*this.game.time.elapsedMS},i.prototype.movePlayerDown=function(){if(this.onMount)switch(this.mountType){case c.ITEM_TYPE.HORSE:case c.ITEM_TYPE.SKATEBOARD:case c.ITEM_TYPE.SHOPPING_CART:case c.ITEM_TYPE.STAG:this.y+=this.mount.speed*this.gameScale*this.game.time.elapsedMS}else this.y+=this.speed*this.gameScale*this.game.time.elapsedMS},i.prototype.gameOver=function(){if(this.gameStatus=c.GAME_STATUS.GAME_OVER,!this.dead){switch(this.direction){case c.DIRECTION.UP:this.playerState=c.PLAYER_STATE.STAND_BACK,this.scale.x=1;break;case c.DIRECTION.DOWN:this.playerState=c.PLAYER_STATE.STAND_FRONT,this.scale.x=1;break;case c.DIRECTION.LEFT:this.playerState=c.PLAYER_STATE.STAND_SIDE,this.scale.x=1;break;case c.DIRECTION.RIGHT:this.playerState=c.PLAYER_STATE.STAND_SIDE,this.scale.x=-1;break;default:this.playerState=c.PLAYER_STATE.STAND_FRONT}this.updateState()}},i.prototype.frozePlayer=function(t){this.frozen||(this.frozen=!0,this.freezeTimer=0,this.iceBlock.visible=!0)},i.prototype.unfrozePlayer=function(){this.frozen&&(this.frozen=!1,this.freezeTimer=0,this.iceBlock.visible=!1,null!==this.frozenBy&&(this.frozenBy.totalFreeze--,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS")),this.frozenBy=null,this.invulnerable=!0,this.tweenInvulnerable=this.game.add.tween(this).to({alpha:.5},100,"Linear",!0,0,-1,!0))},i.prototype.killPlayer=function(t,i){this.dead||(this.attacking&&null!==this.weaponUsed&&this.weaponUsed.playerKilled(),this.playerState=c.PLAYER_STATE.DEATH,this.dead=!0,this.onCream=!1,this.spine.autoUpdate=!0,this.gameStatus=c.GAME_STATUS.GAME_OVER,this.attacking=!0,this.animationPowerUps.visible=!1,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.game.ph2AudioManager.playEffect("dead",!1),this.gameMode===c.GAME_MODE.NEW_PACMAN&&this.isAI&&this.dropCoins(),this.gameMode===c.GAME_MODE.STAR_COLLECTOR&&this.dropStars(),this.gameMode===c.GAME_MODE.ARCADE&&this.lives--,i&&null!==this.gridCell.dangerOwner&&this.gridCell.dangerOwner.playerID!==this.playerID&&(this.gridCell.dangerOwner.totalKills++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.game.ph2NotificationManager.postNotification("_ADD_SCORE_KILLS",t.dangerOwner.playerID)))},i.prototype.killPlayerComplete=function(){if(this.grid.gameStatus!==c.GAME_STATUS.GAME_OVER&&this.grid.gameStatus!==c.GAME_STATUS.PAUSED){switch(this.removeWeapons(),this.clearWeaponSkin(),this.gameMode){case c.GAME_MODE.BATTLE_ROYALE:case c.GAME_MODE.ICE_MAN:case c.GAME_MODE.STAR_COLLECTOR:this.revivePlayer();break;case c.GAME_MODE.NEW_PACMAN:this.isAI&&this.revivePlayer()}this.deathComplete=!0}},i.prototype.revivePlayer=function(){var t=this.grid.cells[this.startingX][this.startingY];this.dead=!1,this.deathComplete=!1,this.gameStatus=c.GAME_STATUS.PLAYING,this.gridPositionX=this.startingX,this.gridPositionY=this.startingY,this.gridCell=t,this.x=t.centerX,this.y=t.centerY,this.grid.rowsGroup[this.gridPositionY].add(this),this.attacking=!1,this.direction=c.DIRECTION.DOWN,this.playerState=c.PLAYER_STATE.STAND_FRONT,this.scale.x=1,this.scale.y=1,this.gameMode===c.GAME_MODE.BATTLE_ROYALE?this.createWeapon(c.ITEM_TYPE.HAMMER):this.gameMode===c.GAME_MODE.NEW_PACMAN?this.createWeapon(c.ITEM_TYPE.FLAMETHROWER):this.gameMode===c.GAME_MODE.ICE_MAN&&this.createWeapon(c.ITEM_TYPE.ICE_GUN),this.createInitialBlinking()},i.prototype.dropCoins=function(){for(var t,i=0,e=this.grid.rowsGroup.length-1,s=this.game.rnd.integerInRange(25,30),a=0;a<this.grid.spawneableCells.length;a++)this.grid.spawneableCells[a].isEmpty&&this.grid.spawneableCells[a].cellContains===c.MAP.FREE&&i++;for(i<s&&(s=i),a=0;a<s;a++)t=new c.Coin(this.game,this.gridCell,this.grid),this.grid.rowsGroup[e].add(t),t.throwCoinUp()},i.prototype.dropStars=function(){for(var t,i=this.grid.rowsGroup.length-1,e=0;e<this.totalStars;e++)t=new c.Star(this.game,this.gridCell,this.grid),this.grid.rowsGroup[i].add(t),t.throwStarUp();this.totalStars=0},i.prototype.actionKeyPressed=function(){this.jumping||this.attacking||this.gameMode===c.GAME_MODE.NEW_PACMAN||(this.gameMode===c.GAME_MODE.ARCADE||this.gameMode===c.GAME_MODE.STAR_COLLECTOR?this.weaponActive?this.useWeapon():this.putBomb():this.gameMode!==c.GAME_MODE.BATTLE_ROYALE&&this.gameMode!==c.GAME_MODE.ICE_MAN||this.useWeapon())},i.prototype.putBomb=function(){var t,i=this.grid.cells[this.gridPositionX][this.gridPositionY];!i.isEmpty||this.bombsOnGround.length>=this.bombs||(i.isEmpty=!1,i.cellContains=c.MAP.BOMB,t=new c.Bomb(this.game,i.centerX,i.centerY,"bomb",this.grid,i,this.power,this),this.game.ph2AudioManager.playEffect("addBomb",!1),this.grid.addBomb(t,i),this.bombsOnGround.push(t))},i.prototype.kickBomb=function(t,i){for(var e,s=0;s<this.grid.bombs.length;s++)(e=this.grid.bombs[s]).gridPositionX!==t.gridPositionX||e.gridPositionY!==t.gridPositionY||e.isKicked||e.bombKicked(i)},i.prototype.useWeapon=function(){this.attacking||this.jumping||this.losingMount||this.weaponActive&&(this.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_ALL_THE_WEAPONS,this.weaponCurrentType),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_4_TYPE_OF_WEAPONS_IN_LEVEL,this.weaponCurrentType),this.gameMode===c.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_4_TYPES_OF_WEAPONS_IN_1_LEVEL_IN_ARCADE,this.weaponCurrentType),this.weaponCurrentType===c.ITEM_TYPE.LIGHTING_GUN)&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_LIGHTNING_GUN_3_TIMES_IN_1_LEVEL_IN_ARCADE),this.weaponCurrentType===c.ITEM_TYPE.MIGHTY_HAMMER&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_ANGRY_HAMMER_3_TIMES_IN_LEVEL),this.weaponCurrentType===c.ITEM_TYPE.DOLL_BOMB&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_DOLL_BOMB_3_TIMES_IN_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_DOLL_BOMB_5_TIMES))),this.weapons[this.weaponCurrentUses].direction=this.direction,this.weaponUsed=this.weapons[this.weaponCurrentUses],this.weapons[this.weaponCurrentUses].useWeapon())&&(Ph2.AnimationSystem.findObject("hero_number",this.animationPowerUps).frameName="x1.png",this.checkWeaponUses(),this.weaponCurrentUses>=this.weaponTotalUses)&&(this.weaponActive=!1)},i.prototype.checkWeaponUses=function(){this.grid.weapons.push(this.weapons[this.weaponCurrentUses]),this.weaponCurrentType===c.ITEM_TYPE.HAMMER?this.gameMode!==c.GAME_MODE.BATTLE_ROYALE&&this.weaponCurrentUses++:this.weaponCurrentType===c.ITEM_TYPE.FLAMETHROWER&&this.isAI&&this.gameMode===c.GAME_MODE.NEW_PACMAN||this.weaponCurrentUses++},i.prototype.checkNextWeapon=function(){this.gameMode===c.GAME_MODE.BATTLE_ROYALE?this.createWeapon(c.ITEM_TYPE.HAMMER):this.gameMode===c.GAME_MODE.ICE_MAN?this.createWeapon(c.ITEM_TYPE.ICE_GUN):this.gameMode===c.GAME_MODE.NEW_PACMAN&&this.isAI?this.createWeapon(c.ITEM_TYPE.FLAMETHROWER):this.clearWeaponSkin()},i.prototype.createWeapon=function(t){var i,e;switch(this.removeWeapons(),this.weaponActive=!0,this.weaponCurrentType=t,this.changeWeaponIndicator(t),this.createWeaponSkin(t),t){case c.ITEM_TYPE.HAMMER:for(i=0;i<2;i++)e=new c.Hammer(this.game,this.grid,this,t),this.weapons.push(e),this.weaponCurrentUses=0,this.weaponTotalUses=2;break;case c.ITEM_TYPE.LIGHTING_GUN:for(i=0;i<1;i++)e=new c.LightningGun(this.game,this.grid,this,t),this.weapons.push(e),this.weaponCurrentUses=0,this.weaponTotalUses=1;break;case c.ITEM_TYPE.FLAMETHROWER:for(i=0;i<2;i++)e=new c.Flamethrower(this.game,this.grid,this,t),this.weapons.push(e),this.weaponCurrentUses=0,this.weaponTotalUses=2;this.isAI||this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_10_FLAMETHROWERS);break;case c.ITEM_TYPE.LASER_GUN:for(i=0;i<2;i++)e=new c.LaserGun(this.game,this.grid,this,t),this.weapons.push(e),this.weaponCurrentUses=0,this.weaponTotalUses=2;break;case c.ITEM_TYPE.DOLL_BOMB:for(i=0;i<1;i++)e=new c.DollBomb(this.game,this.grid,this,t),this.weapons.push(e),this.weaponCurrentUses=0,this.weaponTotalUses=1;break;case c.ITEM_TYPE.MIGHTY_HAMMER:for(i=0;i<1;i++)e=new c.MightyHammer(this.game,this.grid,this,t),this.weapons.push(e),this.weaponCurrentUses=0,this.weaponTotalUses=1;break;case c.ITEM_TYPE.ICE_GUN:for(i=0;i<2;i++)e=new c.IceGun(this.game,this.grid,this,t),this.weapons.push(e),this.weaponCurrentUses=0,this.weaponTotalUses=2}this.weaponUsed=this.weapons[0]},i.prototype.changeWeaponIndicator=function(t){var i,e,s,a;switch(t){case c.ITEM_TYPE.FLAMETHROWER:s="head_icon_flamethrower.png",a="x2.png";break;case c.ITEM_TYPE.HAMMER:s="head_icon_hammer.png",a="x2.png";break;case c.ITEM_TYPE.LASER_GUN:s="head_icon_lightning_gun.png",a="x2.png";break;case c.ITEM_TYPE.LIGHTING_GUN:s="head_icon_laser_gun.png",a="x1.png";break;case c.ITEM_TYPE.MIGHTY_HAMMER:s="head_icon_mighty_hammer.png",a="x1.png";break;case c.ITEM_TYPE.DOLL_BOMB:s="head_icon_doll.png",a="x1.png";break;case c.ITEM_TYPE.ICE_GUN:s="head_icon_ice_gun.png",a="x1.png"}e=Ph2.AnimationSystem.findObject("hero_powerup",this.animationPowerUps),i=Ph2.AnimationSystem.findObject("hero_number",this.animationPowerUps),e.frameName=s,i.frameName=a,this.gameMode!==c.GAME_MODE.ARCADE?this.animationPowerUps.visible=t!==c.ITEM_TYPE.HAMMER:this.animationPowerUps.visible=!0},i.prototype.removeWeapons=function(){this.weaponActive=!1,this.weapons=[]},i.prototype.checkInitialBlinking=function(){this.initialBlinking&&(this.blinkTimer+=this.game.time.elapsedMS,this.blinkTimer>=c.SETTINGS.INITIAL_BLINKING_TIME)&&(this.blinkTimer=0,this.initialBlinking=!1,this.blinking=!1,this.tweenInvulnerable.stop(!0),this.tweenInvulnerable=null,this.alpha=1)},i.prototype.checkActualGridLocation=function(){var t,i;if((this.movingAnimation||this.onCream)&&!this.jumping){switch(this.direction){case c.DIRECTION.LEFT:0!==this.gridPositionX&&(t=Math.floor(this.x/(c.SETTINGS.CELL_WIDTH*this.gameScale)))!==this.gridPositionX&&(t===this.gridPositionX-1?this.grid.cells[t][this.gridPositionY].isEmpty&&(this.gridCell=this.grid.cells[t][this.gridPositionY],this.gridPositionX=t):this.grid.cells[this.gridPositionX-1][this.gridPositionY].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX-1][this.gridPositionY],this.gridPositionX=this.gridPositionX-1,this.x=this.gridCell.right));break;case c.DIRECTION.RIGHT:this.gridPositionX!==c.SETTINGS.GRID_WIDTH-1&&(t=Math.floor(this.x/(c.SETTINGS.CELL_WIDTH*this.gameScale)))!==this.gridPositionX&&(t===this.gridPositionX+1?this.grid.cells[t][this.gridPositionY].isEmpty&&(this.gridCell=this.grid.cells[t][this.gridPositionY],this.gridPositionX=t):this.grid.cells[this.gridPositionX+1][this.gridPositionY].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX+1][this.gridPositionY],this.gridPositionX=this.gridPositionX+1,this.x=this.gridCell.left));break;case c.DIRECTION.UP:0!==this.gridPositionY&&(i=Math.floor(this.y/(c.SETTINGS.CELL_HEIGHT*this.gameScale)))!==this.gridPositionY&&(i===this.gridPositionY-1?this.grid.cells[this.gridPositionX][i].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX][i],this.gridPositionY=i):this.grid.cells[this.gridPositionX][this.gridPositionY-1].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX][this.gridPositionY-1],this.gridPositionY=this.gridPositionY-1,this.y=this.gridCell.bottom),this.grid.rowsGroup[this.gridPositionY].addChild(this),this.grid.rowsGroup[this.gridPositionY].addChild(this.animationRainbow));break;case c.DIRECTION.DOWN:this.gridPositionY!==c.SETTINGS.GRID_HEIGHT-1&&(i=Math.floor(this.y/(c.SETTINGS.CELL_HEIGHT*this.gameScale)))!==this.gridPositionY&&(i===this.gridPositionY+1?this.grid.cells[this.gridPositionX][i].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX][i],this.gridPositionY=i):this.grid.cells[this.gridPositionX][this.gridPositionY+1].isEmpty&&(this.gridCell=this.grid.cells[this.gridPositionX][this.gridPositionY+1],this.gridPositionY=this.gridPositionY+1,this.y=this.gridCell.top),this.grid.rowsGroup[this.gridPositionY].addChild(this),this.grid.rowsGroup[this.gridPositionY].addChild(this.animationRainbow))}this.gridCell!==this.cellEndPortal&&(this.cellEndPortal=null)}},i.prototype.checkItemPickUp=function(){var t;if(null!==this.gridCell&&(!this.isAI||this.gameMode!==c.GAME_MODE.NEW_PACMAN)&&(this.gridCell.cellContains===c.MAP.ITEM||this.gridCell.isItem)&&null!==(t=this.grid.getItemAtCell(this.gridCell)))if(this.grid.removeItemFromArray(this.gridCell,!1),this.game.ph2AudioManager.playEffect("sound_getItem",!1),this.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_100_PROPS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_200_PROPS)),t.powerUpType===c.POWER_UP_TYPE.POWER_UP)switch(t.itemType){case c.ITEM_TYPE.BOMB:this.bombs>=c.SETTINGS.MAX_BOMBS||(this.bombs++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"));break;case c.ITEM_TYPE.POWER:this.power>=c.SETTINGS.MAX_BOMB_POWER||(this.power++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.isAI)||this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_15_POWER_BLASTS);break;case c.ITEM_TYPE.SPEED:this.speedPickedUp>=c.SETTINGS.MAX_SPEED||(this.speed=this.speed+this.speed*c.SETTINGS.SPEED_INCREASE,this.speedPickedUp++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_5_SPEEDUPS_PROPS_IN_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_25_SPEEDUPS),this.gameMode===c.GAME_MODE.ARCADE&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_5_SPEEDUPS_PROPS_IN_LEVEL_IN_ARCADE));break;case c.ITEM_TYPE.KICK_BOMBS:this.canKickBombs=!0;break;case c.ITEM_TYPE.SHIELD:this.shieldActive=!0,this.createWeaponSkin(c.ITEM_TYPE.SHIELD);break;case c.ITEM_TYPE.HEART:this.lives++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS");break;case c.ITEM_TYPE.INVINCIBILITY:this.invincibilityTimer=0,this.invincible=!0,this.animationRainbow.visible=!0,this.animationRainbow.ph2Animations.play("rainbows_stand",1,!0),this.soundInvincibility=this.game.ph2AudioManager.playEffect("sound_inv",!1),this.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_INVINCIBILITY_3_TIMES_IN_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_20_INVINCIBILITY))}else t.powerUpType===c.POWER_UP_TYPE.WEAPON?this.createWeapon(t.itemType):t.powerUpType===c.POWER_UP_TYPE.MOUNT&&this.createMount(t.itemType)},i.prototype.checkOwnBombs=function(){for(var t=this.bombsOnGround.length-1;0<=t;t--)this.bombsOnGround[t].alive||this.bombsOnGround.splice(t,1)},i.prototype.checkDangerZone=function(){null===this.gridCell||this.invulnerable||this.invincible||this.jumping||this.blinking||this.losingMount||this.teleporting||this.frozen||!this.gridCell.isDangerCell||this.gridCell.dangerWeapon&&this.gridCell.dangerOwner===this||(this.onMount?(this.gridCell.isSpecialTile||null===this.gridCell.dangerOwner||this.gridCell.dangerOwner.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_4_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_10_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_34_ENEMIES)),this.loseMount()):this.shieldActive?(this.gridCell.isSpecialTile||null===this.gridCell.dangerOwner||this.gridCell.dangerOwner.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_4_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_10_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_34_ENEMIES)),this.shieldActive=!1,this.invulnerable=!0,this.tweenInvulnerable=this.game.add.tween(this).to({alpha:.5},100,"Linear",!0,0,-1,!0),this.clearWeaponSkin()):this.gridCell.isSpecialTile?(this.killPlayer(this.gridCell,!1),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.AVOID_CLAWS_3_CONTINUOUS_LEVELS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.AVOID_CLAWS_TOYSHOP_ARENA)):this.gameMode===c.GAME_MODE.ICE_MAN?(this.frozePlayer(this.gridCell),null!==this.gridCell.dangerOwner&&(this.frozenBy=this.gridCell.dangerOwner,this.frozenBy.totalFreeze++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.frozenBy.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_4_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_10_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_34_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.FREEZE_5_IN_10_SECONDS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.FREEZE_12_IN_10_SECONDS)))):(null===this.gridCell.dangerOwner||this.gridCell.dangerOwner.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_4_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_10_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.ATTACK_34_ENEMIES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.KILL_2_ENEMIES_IN_10_SECONDS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.KILL_4_ENEMIES_IN_10_SECONDS),this.gridCell.dangerWeapon||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.KILL_10_ENEMIES_USING_BOMBS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.KILL_30_ENEMIES_USING_BOMBS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.KILL_50_ENEMIES_USING_BOMBS)),this.gameMode===c.GAME_MODE.STAR_COLLECTOR&&(3<=this.totalStars?this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.KILL_AN_ENEMY_WITH_3_OR_MORE_STARS):1<=this.totalStars&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.KILL_AN_ENEMY_WITH_1_OR_MORE_STARS))),this.killPlayer(this.gridCell,!0)))},i.prototype.checkEnemyInvulnerability=function(t){this.invulnerable||this.invincible||this.jumping||this.blinking||this.losingMount||(this.onMount?this.loseMount():this.shieldActive?(this.shieldActive=!1,this.invulnerable=!0,this.tweenInvulnerable=this.game.add.tween(this).to({alpha:.5},100,"Linear",!0,0,-1,!0),this.clearWeaponSkin()):(this.killPlayer(this.gridCell,!1),this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.game.ph2NotificationManager.postNotification("_ADD_SCORE_KILLS",t.playerID),t.totalKills++,t.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.KILL_ENEMY_USING_INVINCIBILITY),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.USE_INVINCIBILITY_TO_KILL_4_ENEMIES_IN_1_LEVEL)),this.updateState()))},i.prototype.checkInvulnerability=function(){this.invulnerable&&(this.invulnerabilityTimer+=this.game.time.elapsedMS,2e3<=this.invulnerabilityTimer)&&(this.invulnerable=!1,this.invulnerabilityTimer=0,this.tweenInvulnerable.stop(!0),this.tweenInvulnerable=null,this.alpha=1)},i.prototype.checkInvincibility=function(){var t,i,e;if(this.invincible){for(i=this.grid.players,t=0;t<i.length;t++)e=i[t],this.gridPositionX!==e.gridPositionX||this.gridPositionY!==e.gridPositionY||e.dead||e.invulnerable||e.invincible||e.checkEnemyInvulnerability(this);this.invincibilityTimer+=this.game.time.elapsedMS,1e4<=this.invincibilityTimer&&(this.invincible=!1,this.invincibilityTimer=0,this.animationRainbow.ph2Animations.stop(),this.animationRainbow.visible=!1,this.game.ph2AudioManager.stopEffect(this.soundInvincibility))}},i.prototype.checkAnimation=function(){switch(this.movingAnimation||(this.isStand=!0,this.checkStandAnimation()),this.direction){case c.DIRECTION.UP:this.currentDirection!==c.DIRECTION.UP&&(this.isStand=!1,this.scale.x=1,this.movingAnimation=!0,this.currentDirection=c.DIRECTION.UP,this.playerState=c.PLAYER_STATE.WALK_BACK);break;case c.DIRECTION.DOWN:this.currentDirection!==c.DIRECTION.DOWN&&(this.scale.x=1,this.isStand=!1,this.movingAnimation=!0,this.currentDirection=c.DIRECTION.DOWN,this.playerState=c.PLAYER_STATE.WALK_FRONT);break;case c.DIRECTION.LEFT:this.currentDirection!==c.DIRECTION.LEFT&&(this.scale.x=1,this.isStand=!1,this.movingAnimation=!0,this.currentDirection=c.DIRECTION.LEFT,this.playerState=c.PLAYER_STATE.WALK_SIDE);break;case c.DIRECTION.RIGHT:this.currentDirection!==c.DIRECTION.RIGHT&&(this.scale.x=-1,this.isStand=!1,this.movingAnimation=!0,this.currentDirection=c.DIRECTION.RIGHT,this.playerState=c.PLAYER_STATE.WALK_SIDE)}},i.prototype.checkIndicators=function(){this.invincible?(this.animationRainbow.visible=!0,this.animationRainbow.x=this.x,this.animationRainbow.y=this.y+this.rainbowOffset):this.animationRainbow.visible=!1,this.animationPowerUps.visible=!this.dead,this.weaponActive?this.gameMode===c.GAME_MODE.BATTLE_ROYALE?this.animationPowerUps.visible=this.weaponCurrentType!==c.ITEM_TYPE.HAMMER:this.gameMode===c.GAME_MODE.ICE_MAN?this.animationPowerUps.visible=this.weaponCurrentType!==c.ITEM_TYPE.ICE_GUN:this.animationPowerUps.visible=!0:this.animationPowerUps.visible=!1,this.onMount&&this.mount.jumping?(this.animationPowerUps.x=this.x,this.animationPowerUps.y=this.y-20*c.SETTINGS.SCALE):(this.animationPowerUps.x=this.x,this.animationPowerUps.y=this.y+20*c.SETTINGS.SCALE)},i.prototype.checkHammocks=function(){var t;!this.gridCell.isSpecialTile||this.jumping||(t=this.gridCell.hammock.hammockSteppedOn(),this.playerJump(t),this.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.JUMP_BY_HAMMOCK_2_TIMES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.JUMP_BY_HAMMOCK_10_TIMES))},i.prototype.checkBoosters=function(){var t,i,e,s,a,n,o=this;if(this.gridCell.isBooster&&!this.inBooster){switch(n=[],i=this.gridCell.gridPositionX,e=this.gridCell.gridPositionY,s=this.gridCell.booster,this.inBooster=!0,this.game.ph2AudioManager.playEffect("sound_speed_up",!1),s.direction){case c.DIRECTION.UP:for(t=e-1;e-4<t;t--)this.grid.cells[i][t].cellContains!==c.MAP.BLOCK&&this.grid.cells[i][t].cellContains!==c.MAP.WALL&&n.push(this.grid.cells[i][t]);break;case c.DIRECTION.DOWN:for(t=e+1;t<e+4;t++)this.grid.cells[i][t].cellContains!==c.MAP.BLOCK&&this.grid.cells[i][t].cellContains!==c.MAP.WALL&&n.push(this.grid.cells[i][t]);break;case c.DIRECTION.LEFT:for(t=i-1;i-4<t;t--)this.grid.cells[t][e].cellContains!==c.MAP.BLOCK&&this.grid.cells[t][e].cellContains!==c.MAP.WALL&&n.push(this.grid.cells[t][e]);break;case c.DIRECTION.RIGHT:for(t=i+1;t<i+4;t++)this.grid.cells[t][e].cellContains!==c.MAP.BLOCK&&this.grid.cells[t][e].cellContains!==c.MAP.WALL&&n.push(this.grid.cells[t][e])}0<n.length&&(this.direction=s.direction,a=n[n.length-1],this.game.add.tween(this).to({x:a.centerX,y:a.centerY},750,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){o.inBooster=!1,o.gridPositionX=a.gridPositionX,o.gridPositionY=a.gridPositionY,o.gridCell=a},this))}},i.prototype.checkPortals=function(){var t;this.teleporting||this.gridCell.isPortal&&this.cellEndPortal!==this.gridCell&&(t=this.gridCell.portal.oppositePortal,this.beginTeleport(t))},i.prototype.beginTeleport=function(t){var i=this;this.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.TRANSFER_BY_TREE_HOLES_6_TIMES),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.TRANSFER_BY_TREE_HOLES_10_TIMES_IN_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.TRANSFER_BY_TREE_HOLES_20_TIMES_IN_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.TRANSFER_BY_TREE_HOLES_46_TIMES)),this.teleporting=!0,this.game.ph2AudioManager.playEffect("sound_tree_hole",!1),this.tweenTeleport=this.game.add.tween(this).to({alpha:0},500,"Linear",!0),this.tweenTeleport.onComplete.add(function(){i.endTeleport(t)},this)},i.prototype.endTeleport=function(t){var i=this;this.gridCell=t.gridCell,this.cellEndPortal=t.gridCell,this.x=t.gridCell.centerX,this.y=t.gridCell.centerY,this.gridPositionX=t.gridPositionX,this.gridPositionY=t.gridPositionY,this.grid.rowsGroup[this.gridPositionY].add(this),this.tweenTeleport=this.game.add.tween(this).to({alpha:1},500,"Linear",!0),this.tweenTeleport.onComplete.add(function(){i.teleporting=!1},this)},i.prototype.playerJump=function(t){var i=this,e=this.grid.rowsGroup.length-1,s=t.gridPositionY>this.gridPositionY?this.gridCell.centerY-150*c.SETTINGS.SCALE:t.centerY-50*c.SETTINGS.SCALE;this.jumping=!0,this.gridCell=t,this.gridPositionX=t.gridPositionX,this.gridPositionY=t.gridPositionY,this.grid.rowsGroup[e].add(this),this.tweenJumpX=this.game.add.tween(this).to({x:t.centerX},1100,"Linear",!0),this.tweenJumpX.onComplete.add(this.endJump,this),this.tweenJumpY=this.game.add.tween(this).to({y:s},550,Phaser.Easing.Quartic.Out,!0),this.tweenJumpY.onComplete.add(function(){i.tweenJumpY=i.game.add.tween(i).to({y:t.centerY},550,Phaser.Easing.Quartic.In,!0)},this)},i.prototype.endJump=function(){this.gridPositionX=this.gridCell.gridPositionX,this.gridPositionY=this.gridCell.gridPositionY,this.grid.rowsGroup[this.gridPositionY].add(this),this.jumping=!1,this.tweenJumpX=null,this.tweenJumpY=null},i.prototype.checkCream=function(){var t,i;this.gridCell.isSpecialTile&&!this.dead&&(this.onCream=!0,this.gridCell.isSpecialTile=!1,this.gridCell.cream.visible=!1,this.gridCell.cream.destroy(),this.gridCell.cream=null,t=this.gridCell.centerX,i=this.gridCell.centerY,this.tweenCreamCell=this.game.add.tween(this).to({x:t,y:i},500,"Linear",!0),this.game.ph2AudioManager.playEffect("sound_butter",!1))},i.prototype.checkCoins=function(){this.isAI||(this.gridCell.cellContains===c.MAP.COIN||this.gridCell.isCoin)&&this.grid.coinPickedUp(this.gridCell,!1)&&(this.totalCoins++,this.game.ph2AudioManager.playEffect("sound_coin",!1),this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.game.ph2NotificationManager.postNotification("_ADD_SCORE_COINS",this.playerID),this.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.COLLECT_600_COINS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.COLLECT_1500_COINS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_20_COINS_IN_10_SECONDS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.GET_40_COINS_IN_10_SECONDS)))},i.prototype.checkStars=function(){(this.gridCell.cellContains===c.MAP.STAR||this.gridCell.isStar)&&this.grid.starPickedUp(this.gridCell)&&(this.totalStars++,this.game.ph2AudioManager.playEffect("sound_star",!1),this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"),this.game.ph2NotificationManager.postNotification("_ADD_SCORE_STARS",this.playerID),this.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.COLLECT_20_STARS),this.mapTheme===c.MAP_THEME.RACE_TRACK?this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.COLLECT_20_STARS_IN_RACE_ARENA):this.mapTheme===c.MAP_THEME.RANCH&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.COLLECT_60_STARS_IN_RANCH_ARENA)))},i.prototype.checkMonsters=function(){var t,i,e;if(!this.frozen&&!this.invulnerable)for(e=this.grid.monsters,t=0;t<e.length;t++)(i=e[t]).frozen||i.gridPositionX===this.gridPositionX&&i.gridPositionY===this.gridPositionY&&this.frozePlayer(this.gridCell)},i.prototype.pausePlayer=function(){this.gameStatus=c.GAME_STATUS.PAUSED,this.spine.autoUpdate=!1,this.onMount&&(this.mount.spine.autoUpdate=!1,null!==this.mount.tweenMountLose)&&this.mount.tweenMountLose.pause(),this.jumping&&(this.tweenJumpX.pause(),this.tweenJumpY.pause()),null!==this.tweenInvulnerable&&this.tweenInvulnerable.pause()},i.prototype.resumePlayer=function(){this.gameStatus=c.GAME_STATUS.PLAYING,this.spine.autoUpdate=!0,this.onMount&&(this.mount.spine.autoUpdate=!0,null!==this.mount.tweenMountLose)&&this.mount.tweenMountLose.resume(),this.jumping&&(this.tweenJumpX.resume(),this.tweenJumpY.resume()),null!==this.tweenInvulnerable&&this.tweenInvulnerable.resume()},i.prototype.update=function(){this.gameStatus===c.GAME_STATUS.GAME_OVER||this.gameStatus===c.GAME_STATUS.PAUSED||this.dead||(this.mapTheme===c.MAP_THEME.BAKERY&&this.checkCream(),this.mapTheme===c.MAP_THEME.BEACH&&this.checkHammocks(),this.mapTheme===c.MAP_THEME.FOREST&&this.checkPortals(),this.mapTheme===c.MAP_THEME.RACE_TRACK&&this.checkBoosters(),this.gameMode===c.GAME_MODE.NEW_PACMAN&&this.checkCoins(),this.gameMode===c.GAME_MODE.STAR_COLLECTOR&&this.checkStars(),this.gameMode===c.GAME_MODE.ICE_MAN&&this.checkMonsters(),this.onMount&&this.updateMount(),this.onCream&&this.doCreamAnimation(),this.frozen&&this.checkFreezeTime(),this.checkInitialBlinking(),this.checkItemPickUp(),this.checkOwnBombs(),this.checkInvulnerability(),this.checkInvincibility(),this.checkAnimation(),this.checkIndicators(),this.checkDangerZone(),this.checkStun(),this.updateState())},i.prototype.postUpdate=function(){this.checkActualGridLocation()},i.prototype.doCreamAnimation=function(){var t;if(this.creamTimer+=this.game.time.elapsedMS,this.creamTurnTimer+=this.game.time.elapsedMS,50<=this.creamTurnTimer){switch(this.creamTurnTimer=0,this.currentIceDirection){case c.DIRECTION.UP:this.currentIceDirection=c.DIRECTION.RIGHT,t="stand_side",this.scale.x=-1;break;case c.DIRECTION.RIGHT:this.currentIceDirection=c.DIRECTION.DOWN,t="stand_front",this.scale.x=1;break;case c.DIRECTION.DOWN:this.currentIceDirection=c.DIRECTION.LEFT,t="stand_side",this.scale.x=1;break;case c.DIRECTION.LEFT:this.currentIceDirection=c.DIRECTION.UP,t="stand_back",this.scale.x=1}this.spine.setAnimationByName(0,t,!0),this.spine.setToSetupPose()}2e3<=this.creamTimer&&(this.creamTimer=0,this.creamTurnTimer=0,this.onCream=!1,this.direction=null,this.animationState=null,this.playerState=null)},i.prototype.checkFreezeTime=function(){this.freezeTimer+=this.game.time.elapsedMS,3e3<=this.freezeTimer&&this.unfrozePlayer()},i.prototype.checkStun=function(){if(!(this.dead||this.invulnerable||this.invincible))if(this.stunned){if(this.stunTimer+=this.game.time.elapsedMS,this.stunTimer>=c.SETTINGS.TIME_STUNNED)switch(this.stunTimer=0,this.stunned=!1,this.direction){case c.DIRECTION.UP:this.playerState=c.PLAYER_STATE.STAND_BACK;break;case c.DIRECTION.DOWN:this.playerState=c.PLAYER_STATE.STAND_FRONT;break;case c.DIRECTION.LEFT:case c.DIRECTION.RIGHT:this.playerState=c.PLAYER_STATE.STAND_SIDE}}else if(this.gridCell.isStunCell){switch(this.stunned=!0,this.game.ph2AudioManager.playEffect("sound_stun",!1),this.direction){case c.DIRECTION.UP:this.playerState=c.PLAYER_STATE.DIZZY_BACK;break;case c.DIRECTION.DOWN:this.playerState=c.PLAYER_STATE.DIZZY_FRONT;break;case c.DIRECTION.LEFT:case c.DIRECTION.RIGHT:this.playerState=c.PLAYER_STATE.DIZZY_SIDE}this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.AVOID_CARS_RACE_ARENA),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.AVOID_CARS_3_LEVELS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.AVOID_CARS_5_LEVELS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.AVOID_HORSES_ARENA_1_LEVEL),this.gameMode===c.GAME_MODE.BATTLE_ROYALE&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.AVOID_HORSES_BATTLE_ROYALE_1_LEVEL)}},i.prototype.onStand=function(){this.checkStandAnimation()},i.prototype.checkStandAnimation=function(){if(this.isStand=!0,this.onMount){if(this.mountType===c.ITEM_TYPE.HORSE)switch(this.direction){case c.DIRECTION.UP:this.playerState=c.PLAYER_STATE.HORSE_BACK_STAND,this.scale.x=1;break;case c.DIRECTION.DOWN:this.playerState=c.PLAYER_STATE.HORSE_FRONT_STAND,this.scale.x=1;break;case c.DIRECTION.LEFT:this.playerState=c.PLAYER_STATE.HORSE_SIDE_STAND,this.scale.x=1;break;case c.DIRECTION.RIGHT:this.playerState=c.PLAYER_STATE.HORSE_SIDE_STAND,this.scale.x=-1;break;default:this.playerState=c.PLAYER_STATE.HORSE_FRONT_STAND}else if(this.mountType===c.ITEM_TYPE.SHOPPING_CART)switch(this.direction){case c.DIRECTION.UP:this.playerState=c.PLAYER_STATE.SHOPPING_CART_BACK_STAND,this.scale.x=1;break;case c.DIRECTION.DOWN:this.playerState=c.PLAYER_STATE.SHOPPING_CART_FRONT_STAND,this.scale.x=1;break;case c.DIRECTION.LEFT:this.playerState=c.PLAYER_STATE.SHOPPING_CART_SIDE_STAND,this.scale.x=1;break;case c.DIRECTION.RIGHT:this.playerState=c.PLAYER_STATE.SHOPPING_CART_SIDE_STAND,this.scale.x=-1;break;default:this.playerState=c.PLAYER_STATE.SHOPPING_CART_FRONT_STAND}else if(this.mountType===c.ITEM_TYPE.SKATEBOARD)switch(this.direction){case c.DIRECTION.UP:this.playerState=c.PLAYER_STATE.SKATE_BACK_STAND,this.scale.x=1;break;case c.DIRECTION.DOWN:this.playerState=c.PLAYER_STATE.SKATE_FRONT_STAND,this.scale.x=1;break;case c.DIRECTION.LEFT:this.playerState=c.PLAYER_STATE.SKATE_SIDE_STAND,this.scale.x=1;break;case c.DIRECTION.RIGHT:this.playerState=c.PLAYER_STATE.SKATE_SIDE_STAND,this.scale.x=-1;break;default:this.playerState=c.PLAYER_STATE.SKATE_FRONT_STAND}else if(this.mountType===c.ITEM_TYPE.STAG)switch(this.direction){case c.DIRECTION.UP:this.playerState=c.PLAYER_STATE.STAG_BACK_STAND,this.scale.x=1;break;case c.DIRECTION.DOWN:this.playerState=c.PLAYER_STATE.STAG_FRONT_STAND,this.scale.x=1;break;case c.DIRECTION.LEFT:this.playerState=c.PLAYER_STATE.STAG_SIDE_STAND,this.scale.x=1;break;case c.DIRECTION.RIGHT:this.playerState=c.PLAYER_STATE.STAG_SIDE_STAND,this.scale.x=-1;break;default:this.playerState=c.PLAYER_STATE.STAG_FRONT_STAND}}else switch(this.direction){case c.DIRECTION.UP:this.playerState=c.PLAYER_STATE.STAND_BACK;break;case c.DIRECTION.DOWN:this.playerState=c.PLAYER_STATE.STAND_FRONT;break;case c.DIRECTION.LEFT:case c.DIRECTION.RIGHT:this.playerState=c.PLAYER_STATE.STAND_SIDE}},i.prototype.updateState=function(){var t;if(!this.onCream){switch((t=this).playerState){case c.PLAYER_STATE.STAND_FRONT:this.animationState!==c.PLAYER_STATE.STAND_FRONT&&(this.animationState=c.PLAYER_STATE.STAND_FRONT,this.spine.setAnimationByName(0,"stand_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.STAND_BACK:this.animationState!==c.PLAYER_STATE.STAND_BACK&&(this.animationState=c.PLAYER_STATE.STAND_BACK,this.spine.setAnimationByName(0,"stand_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.STAND_SIDE:this.animationState!==c.PLAYER_STATE.STAND_SIDE&&(this.animationState=c.PLAYER_STATE.STAND_SIDE,this.spine.setAnimationByName(0,"stand_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.DEATH:this.animationState!==c.PLAYER_STATE.DEATH&&(this.animationState=c.PLAYER_STATE.DEATH,this.spine.setAnimationByName(0,"death",!1).onComplete=function(){t.killPlayerComplete()},this.spine.setToSetupPose());break;case c.PLAYER_STATE.DIZZY_BACK:this.animationState!==c.PLAYER_STATE.DIZZY_BACK&&(this.animationState=c.PLAYER_STATE.DIZZY_BACK,this.spine.setAnimationByName(0,"dizzy_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.DIZZY_FRONT:this.animationState!==c.PLAYER_STATE.DIZZY_FRONT&&(this.animationState=c.PLAYER_STATE.DIZZY_FRONT,this.spine.setAnimationByName(0,"dizzy_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.DIZZY_SIDE:this.animationState!==c.PLAYER_STATE.DIZZY_SIDE&&(this.animationState=c.PLAYER_STATE.DIZZY_SIDE,this.spine.setAnimationByName(0,"dizzy_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.FACE1_FRONT:case c.PLAYER_STATE.FACE1_SIDE:case c.PLAYER_STATE.FACE2_FRONT:case c.PLAYER_STATE.FACE2_SIDE:break;case c.PLAYER_STATE.HORSE_BACK:this.animationState!==c.PLAYER_STATE.HORSE_BACK&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.HORSE_BACK,this.spine.setAnimationByName(0,"horse_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.HORSE_FRONT:this.animationState!==c.PLAYER_STATE.HORSE_FRONT&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.HORSE_FRONT,this.spine.setAnimationByName(0,"horse_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.HORSE_SIDE:this.animationState!==c.PLAYER_STATE.HORSE_SIDE&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.HORSE_SIDE,this.spine.setAnimationByName(0,"horse_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.HORSE_BACK_STAND:this.animationState!==c.PLAYER_STATE.HORSE_BACK_STAND&&(this.animationState=c.PLAYER_STATE.HORSE_BACK_STAND,this.spine.setAnimationByName(0,"horse_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.HORSE_FRONT_STAND:this.animationState!==c.PLAYER_STATE.HORSE_FRONT_STAND&&(this.animationState=c.PLAYER_STATE.HORSE_FRONT_STAND,this.spine.setAnimationByName(0,"horse_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.HORSE_SIDE_STAND:this.animationState!==c.PLAYER_STATE.HORSE_SIDE_STAND&&(this.animationState=c.PLAYER_STATE.HORSE_SIDE_STAND,this.spine.setAnimationByName(0,"horse_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SKATE_FRONT:this.animationState!==c.PLAYER_STATE.SKATE_FRONT&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.SKATE_FRONT,this.spine.setAnimationByName(0,"skate_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SKATE_SIDE:this.animationState!==c.PLAYER_STATE.SKATE_SIDE&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.SKATE_SIDE,this.spine.setAnimationByName(0,"skate_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SKATE_BACK:this.animationState!==c.PLAYER_STATE.SKATE_BACK&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.SKATE_BACK,this.spine.setAnimationByName(0,"skate_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SKATE_FRONT_STAND:this.animationState!==c.PLAYER_STATE.SKATE_FRONT_STAND&&(this.animationState=c.PLAYER_STATE.SKATE_FRONT_STAND,this.spine.setAnimationByName(0,"skate_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SKATE_SIDE_STAND:this.animationState!==c.PLAYER_STATE.SKATE_SIDE_STAND&&(this.animationState=c.PLAYER_STATE.SKATE_SIDE_STAND,this.spine.setAnimationByName(0,"skate_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SKATE_BACK_STAND:this.animationState!==c.PLAYER_STATE.SKATE_BACK_STAND&&(this.animationState=c.PLAYER_STATE.SKATE_BACK_STAND,this.spine.setAnimationByName(0,"skate_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SHOPPING_CART_BACK:this.animationState!==c.PLAYER_STATE.SHOPPING_CART_BACK&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.SHOPPING_CART_BACK,this.spine.setAnimationByName(0,"cart_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SHOPPING_CART_SIDE:this.animationState!==c.PLAYER_STATE.SHOPPING_CART_SIDE&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.SHOPPING_CART_SIDE,this.spine.setAnimationByName(0,"cart_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SHOPPING_CART_FRONT:this.animationState!==c.PLAYER_STATE.SHOPPING_CART_FRONT&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.SHOPPING_CART_FRONT,this.spine.setAnimationByName(0,"cart_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SHOPPING_CART_BACK_STAND:this.animationState!==c.PLAYER_STATE.SHOPPING_CART_BACK_STAND&&(this.animationState=c.PLAYER_STATE.SHOPPING_CART_BACK_STAND,this.spine.setAnimationByName(0,"cart_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SHOPPING_CART_SIDE_STAND:this.animationState!==c.PLAYER_STATE.SHOPPING_CART_SIDE_STAND&&(this.animationState=c.PLAYER_STATE.SHOPPING_CART_SIDE_STAND,this.spine.setAnimationByName(0,"cart_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.SHOPPING_CART_FRONT_STAND:this.animationState!==c.PLAYER_STATE.SHOPPING_CART_FRONT_STAND&&(this.animationState=c.PLAYER_STATE.SHOPPING_CART_FRONT_STAND,this.spine.setAnimationByName(0,"cart_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.STAG_BACK:this.animationState!==c.PLAYER_STATE.STAG_BACK&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.STAG_BACK,this.spine.setAnimationByName(0,"stag_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.STAG_FRONT:this.animationState!==c.PLAYER_STATE.STAG_FRONT&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.STAG_FRONT,this.spine.setAnimationByName(0,"stag_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.STAG_SIDE:this.animationState!==c.PLAYER_STATE.STAG_SIDE&&(this.isStand=!1,this.animationState=c.PLAYER_STATE.STAG_SIDE,this.spine.setAnimationByName(0,"stag_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.STAG_BACK_STAND:this.animationState!==c.PLAYER_STATE.STAG_BACK_STAND&&(this.animationState=c.PLAYER_STATE.STAG_BACK_STAND,this.spine.setAnimationByName(0,"stag_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.STAG_FRONT_STAND:this.animationState!==c.PLAYER_STATE.STAG_FRONT_STAND&&(this.animationState=c.PLAYER_STATE.STAG_FRONT_STAND,this.spine.setAnimationByName(0,"stag_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.STAG_SIDE_STAND:this.animationState!==c.PLAYER_STATE.STAG_SIDE_STAND&&(this.animationState=c.PLAYER_STATE.STAG_SIDE_STAND,this.spine.setAnimationByName(0,"stag_side",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.WALK_BACK:this.animationState!==c.PLAYER_STATE.WALK_BACK&&(this.animationState=c.PLAYER_STATE.WALK_BACK,this.spine.setAnimationByName(0,"walk_back",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.WALK_FRONT:this.animationState!==c.PLAYER_STATE.WALK_FRONT&&(this.animationState=c.PLAYER_STATE.WALK_FRONT,this.spine.setAnimationByName(0,"walk_front",!0),this.spine.setToSetupPose());break;case c.PLAYER_STATE.WALK_SIDE:this.animationState!==c.PLAYER_STATE.WALK_SIDE&&(this.animationState=c.PLAYER_STATE.WALK_SIDE,this.spine.setAnimationByName(0,"walk_side",!0),this.spine.setToSetupPose())}this.dead&&this.playerState!==c.PLAYER_STATE.DEATH&&(this.playerState=c.PLAYER_STATE.DEATH)}},i.prototype.createMount=function(t){var i;switch(null!==this.mount&&(this.add(this.spine),this.mount.destroy(!0),this.mount=null),t){case c.ITEM_TYPE.HORSE:this.mount=new c.HorseMount(this.game,this.grid,this,this.direction),this.game.ph2AudioManager.playEffect("sound_frog",!1),i=0;break;case c.ITEM_TYPE.SKATEBOARD:this.mount=new c.Skateboard(this.game,this.grid,this,this.direction),this.game.ph2AudioManager.playEffect("getPlane",!1),i=0;break;case c.ITEM_TYPE.SHOPPING_CART:this.mount=new c.ShoppingCart(this.game,this.grid,this,this.direction),this.game.ph2AudioManager.playEffect("sound_tractor",!1),i=0;break;case c.ITEM_TYPE.STAG:this.mount=new c.Stag(this.game,this.grid,this,this.direction),this.game.ph2AudioManager.playEffect("sound_sealion",!1),i=0}this.onMount=!0,this.mountType=t,this.mount.direction=this.direction,this.add(this.mount),this.spine.position.set(0,i),this.mount.bone.addChild(this.spine),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",c.MISSION.RIDE_2_KINDS_OF_VEHICLES_IN_1_LEVEL,this.mountType)},i.prototype.loseMount=function(){this.add(this.spine),this.losingMount=!0,this.mount.initiateDestruction(),this.game.time.events.add(1200,this.destroyMount,this)},i.prototype.destroyMount=function(){var t=c.SETTINGS.SCALE*c.SETTINGS.CELL_HEIGHT*.3;this.mount.alpha=0,this.onMount=!1,this.mountType=null,this.losingMount=!1,this.spine.position.set(0,t),this.mount.destroy(!0),this.invulnerable=!0,this.tweenInvulnerable=this.game.add.tween(this).to({alpha:.5},100,"Linear",!0,0,-1,!0)},i.prototype.updateMount=function(){null!==this.mount&&this.mount.update()},i.prototype.cheatItem=function(t){switch(t){case c.ITEM_TYPE.BOMB:this.bombs>=c.SETTINGS.MAX_BOMBS||(this.bombs++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"));break;case c.ITEM_TYPE.POWER:this.power>=c.SETTINGS.MAX_BOMB_POWER||(this.power++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"));break;case c.ITEM_TYPE.SPEED:this.speedPickedUp>=c.SETTINGS.MAX_SPEED||(this.speed=this.speed+this.speed*c.SETTINGS.SPEED_INCREASE,this.speedPickedUp++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS"));break;case c.ITEM_TYPE.KICK_BOMBS:this.canKickBombs=!0;break;case c.ITEM_TYPE.SHIELD:this.shieldActive=!0,this.createWeaponSkin(c.ITEM_TYPE.SHIELD);break;case c.ITEM_TYPE.HEART:this.lives++,this.game.ph2NotificationManager.postNotification("_UPDATE_UIS");break;case c.ITEM_TYPE.INVINCIBILITY:this.invincibilityTimer=0,this.invincible=!0,this.animationRainbow.visible=!0,this.animationRainbow.ph2Animations.play("rainbows_stand",1,!0)}},i.prototype.cheatWeapon=function(t){this.createWeapon(t)},i.prototype.cheatMount=function(t){this.createMount(t)};var l,t=i;function i(t,i,e,s,a,n,o,r){var h=l.call(this,t)||this;return h.x=i,h.y=e,h.keyName=s,h.game=t,h.grid=a,h.gridCell=a.cells[n][o],h.gridPositionX=n,h.gridPositionY=o,h.startingX=n,h.startingY=o,h.playerID=r,h.mapTheme=a.mapThemeSelected,h.gameMode=a.gameMode,h.gameScale=c.SETTINGS.SCALE,h.direction=c.DIRECTION.DOWN,h.speed=c.SETTINGS.INITIAL_SPEED,h.iceSpeed=.75*c.SETTINGS.INITIAL_SPEED,h.lives=c.SETTINGS.INITIAL_LIVES,h.gameStatus=c.GAME_STATUS.PLAYING,h.speedPickedUp=1,h.power=1,h.bombs=1,h.weaponTotalUses=0,h.weaponCurrentUses=0,h.bombsOnGround=[],h.weapons=[],h.cellEndPortal=null,h.mount=null,h.frozenBy=null,h.tweenPositioning=null,h.tweenTeleport=null,h.tweenJumpX=null,h.tweenJumpY=null,h.tweenInvulnerable=null,h.frozen=!1,h.attacking=!1,h.movingAnimation=!1,h.initialBlinking=!0,h.dead=!1,h.deathComplete=!1,h.canKickBombs=!1,h.shieldActive=!1,h.invincible=!1,h.invulnerable=!1,h.stunned=!1,h.isAI=!1,h.onCream=!1,h.keyPressed=!1,h.jumping=!1,h.blinking=!1,h.onMount=!1,h.losingMount=!1,h.isStand=!0,h.inBooster=!1,h.teleporting=!1,h.creamTimer=0,h.creamTurnTimer=0,h.stunTimer=0,h.invulnerabilityTimer=0,h.invincibilityTimer=0,h.blinkTimer=0,h.totalKills=0,h.totalCoins=0,h.totalFreeze=0,h.totalStars=0,h.scoreLevelDestruction=0,h.scoreKillEnemies=0,h.cellOffset=c.SETTINGS.CELL_WIDTH*h.gameScale*.5,h.currentIceDirection=c.DIRECTION.DOWN,h.obtainSkins(),h.createSpine(),h.createPlayerElements(),h.createInitialBlinking(),h}c.Player=t}(Game=Game||{}),function(c){l=c.Player,__extends(i,l),i.prototype.createInputController=function(){this.inputController=new c.InputController(this.game,this)},i.prototype.createPlayerIndicator=function(){},i.prototype.checkPlayerIndicator=function(){},i.prototype.update=function(){l.prototype.update.call(this),this.gameStatus!==c.GAME_STATUS.GAME_OVER&&this.gameStatus!==c.GAME_STATUS.PAUSED&&(this.inputController.checkInput(),this.checkPlayerIndicator())};var l,t=i;function i(t,i,e,s,a,n,o,r,h){t=l.call(this,t,i,e,s,a,n,o,r)||this;return t.playerMode=h,t.indicatorTimer=0,t.grid.difficulty===c.DIFFICULTY.EASY&&(t.shieldActive=!0,t.createWeaponSkin(c.ITEM_TYPE.SHIELD)),t.createInputController(),t.createPlayerIndicator(),t}c.PlayerHuman=t}(Game=Game||{}),function(m){l=m.Player,__extends(i,l),i.prototype.restartAI=function(){this.idle=!1,this.notSafe=!1,this.moving=!1,this.awaitingNewAction=!0,this.awaitingStunToEnd=!1,this.idleTimer=0,this.currentPathCell=0,this.freeCells=[],this.dangerCells=[],this.pathCells=[]},i.prototype.update=function(){l.prototype.update.call(this),this.waitStunToRestart(),this.gameStatus===m.GAME_STATUS.GAME_OVER||this.gameStatus===m.GAME_STATUS.PAUSED||this.dead||this.attacking||this.frozen||(this.updateIdle(),this.updateMovement(),this.checkSameCell(),this.updateSense())},i.prototype.waitStunToRestart=function(){this.stunned?this.awaitingStunToEnd=!0:this.awaitingStunToEnd&&(this.awaitingStunToEnd=!1,this.restartAI())},i.prototype.updateIdle=function(){this.idle&&(this.idleTimer+=this.game.time.elapsedMS,100<=this.idleTimer)&&(this.idle=!1,this.idleTimer=0)},i.prototype.updateMovement=function(){this.idle?this.movingAnimation=!1:this.moving?(this.movingAnimation=!0,this.checkSafeMovement()):(this.chooseCellToMove(),this.findFreeCells(),this.game.rnd.integerInRange(1,100)<=this.chanceToSearchPlayer||this.timeToKill>=this.timesToSearchPlayer?(this.timeToKill=0,this.findPathToPlayers()):(this.timeToKill++,this.findClearPath()))},i.prototype.checkSameCell=function(){this.dead||this.notSafe||this.jumping||this.attacking||this.frozen||this.stunned||(this.timerSameCell+=this.game.time.elapsedMS,this.timerSameCell>=this.timeCheckCell&&(this.timerSameCell=0,this.previousCellX===this.gridPositionX&&this.previousCellY===this.gridPositionY?this.restartAI():(this.previousCellX=this.gridPositionX,this.previousCellY=this.gridPositionY)))},i.prototype.updateSense=function(){this.checkFireCells(),this.checkFreeCells()},i.prototype.checkFireCells=function(){var t,i,e;for(this.dangerCells=[],t=0;t<this.grid.bombs.length;t++)for(e=this.grid.bombs[t].bombExplosion,i=0;i<e.fireCells.length;i++)this.dangerCells.push(e.fireCells[i])},i.prototype.checkFreeCells=function(){var t,i,e,s,a;for(this.freeCells=[],0<this.gridPositionX&&(e=this.grid.cells[this.gridPositionX-1][this.gridPositionY]).isEmpty&&this.freeCells.push(e),this.gridPositionX<m.SETTINGS.GRID_WIDTH-1&&(e=this.grid.cells[this.gridPositionX+1][this.gridPositionY]).isEmpty&&this.freeCells.push(e),0<this.gridPositionY&&(e=this.grid.cells[this.gridPositionX][this.gridPositionY-1]).isEmpty&&this.freeCells.push(e),this.gridPositionY<m.SETTINGS.GRID_HEIGHT-1&&(e=this.grid.cells[this.gridPositionX][this.gridPositionY+1]).isEmpty&&this.freeCells.push(e),t=0;t<this.dangerCells.length;t++)for(s=this.dangerCells[t],i=this.freeCells.length-1;0<=i;i--)a=this.freeCells[i],s.gridPositionX===a.gridPositionX&&s.gridPositionY===a.gridPositionY&&this.freeCells.splice(i,1)},i.prototype.findFreeCells=function(){var t,i,e,s,a,n,o,r;for(this.freeCells=[],e=this.gridPositionX-1<0?0:this.gridPositionX-1,s=this.gridPositionX+1>m.SETTINGS.GRID_WIDTH-1?m.SETTINGS.GRID_WIDTH-1:this.gridPositionX+1,a=this.gridPositionY-1<0?0:this.gridPositionY-1,n=this.gridPositionY+1>m.SETTINGS.GRID_HEIGHT-1?m.SETTINGS.GRID_HEIGHT-1:this.gridPositionY+1,t=0;t<m.SETTINGS.GRID_WIDTH;t++)for(i=a;i<n+1;i++)this.grid.cells[t][i].isEmpty&&this.freeCells.push(this.grid.cells[t][i]);for(t=0;t<this.grid.cells[this.gridPositionX].length;t++)for(i=e;i<s+1;i++)this.grid.cells[i][t].isEmpty&&this.freeCells.push(this.grid.cells[i][t]);for(t=this.freeCells.length-1;0<=t;t--)for(o=this.freeCells[t],i=0;i<this.dangerCells.length;i++)r=this.dangerCells[i],o.gridPositionX===r.gridPositionX&&o.gridPositionY===r.gridPositionY&&(this.freeCells.splice(t,1),i=this.dangerCells.length)},i.prototype.findClearPath=function(){var t,i,e,s,a=999,n=[],o=this.grid.astarGrid.grid[this.gridPositionX][this.gridPositionY];if(this.notSafe)for(t=0;t<this.freeCells.length;t++)e=this.freeCells[t],i=this.grid.astarGrid.grid[e.gridPositionX][e.gridPositionY],0<(s=astar.search(this.grid.astarGrid,o,i)).length&&s.length<a&&(a=(n=s).length);else{if(this.freeCells.length<=0)return void this.restartAI();e=_.sample(this.freeCells),i=this.grid.astarGrid.grid[e.gridPositionX][e.gridPositionY],n=astar.search(this.grid.astarGrid,o,i)}for(this.pathCells=[],t=0;t<n.length;t++)this.pathCells.push(this.grid.cells[n[t].x][n[t].y]);0<this.pathCells.length&&(this.moving=!0,this.currentPathCell=0,this.previousCell=this.gridCell,this.safeCell=this.pathCells[this.currentPathCell],this.nextSafeDirection(this.gridPositionX,this.gridPositionY,this.safeCell))},i.prototype.findPathToPlayers=function(){var t,i=this.grid.playerMode===m.PLAYER_MODE.SINGLE_PLAYER?this.grid.players[0]:this.grid.players[this.game.rnd.integerInRange(0,1)],e=this.grid.astarGrid.grid[this.gridPositionX][this.gridPositionY],i=this.grid.astarGrid.grid[i.gridPositionX][i.gridPositionY],s=astar.search(this.grid.astarGrid,e,i);for(this.pathCells=[],t=0;t<s.length;t++)this.pathCells.push(this.grid.cells[s[t].x][s[t].y]);0<this.pathCells.length?(this.moving=!0,this.currentPathCell=0,this.previousCell=this.gridCell,this.safeCell=this.pathCells[this.currentPathCell],this.nextSafeDirection(this.gridPositionX,this.gridPositionY,this.safeCell)):this.moveNextToPlayers()},i.prototype.moveNextToPlayers=function(){var t,i,e,s,a,n,o,r,h=this.grid.playerMode===m.PLAYER_MODE.SINGLE_PLAYER?this.grid.players[0]:this.grid.players[this.game.rnd.integerInRange(0,1)],c=this.grid.astarGrid.grid[this.gridPositionX][this.gridPositionY];switch(h.gridPositionX<this.gridPositionX?r=m.DIRECTION.LEFT:h.gridPositionX>this.gridPositionX?r=m.DIRECTION.RIGHT:h.gridPositionY<this.gridPositionY?r=m.DIRECTION.UP:h.gridPositionY>this.gridPositionY&&(r=m.DIRECTION.DOWN),e=this.gridPositionX-1<0?0:this.gridPositionX-1,s=this.gridPositionX+1>m.SETTINGS.GRID_WIDTH-1?m.SETTINGS.GRID_WIDTH-1:this.gridPositionX+1,a=this.gridPositionY-1<0?0:this.gridPositionY-1,n=this.gridPositionY+1>m.SETTINGS.GRID_HEIGHT-1?m.SETTINGS.GRID_HEIGHT-1:this.gridPositionY+1,this.freeCells=[],r){case m.DIRECTION.LEFT:for(t=this.gridPositionX;0<=t;t--)for(i=a;i<n+1;i++)this.grid.cells[t][i].isEmpty&&this.freeCells.push(this.grid.cells[t][i]);break;case m.DIRECTION.RIGHT:for(t=this.gridPositionX;t<m.SETTINGS.GRID_WIDTH-1;t++)for(i=a;i<n+1;i++)this.grid.cells[t][i].isEmpty&&this.freeCells.push(this.grid.cells[t][i]);break;case m.DIRECTION.UP:for(t=this.gridPositionY;0<=t;t--)for(i=e;i<s+1;i++)this.grid.cells[i][t].isEmpty&&this.freeCells.push(this.grid.cells[i][t]);break;case m.DIRECTION.DOWN:for(t=this.gridPositionY;t<m.SETTINGS.GRID_HEIGHT-1;t++)for(i=e;i<s+1;i++)this.grid.cells[i][t].isEmpty&&this.freeCells.push(this.grid.cells[i][t])}if(this.freeCells.length<=0)this.findClearPath();else{for(h=_.sample(this.freeCells),r=this.grid.astarGrid.grid[h.gridPositionX][h.gridPositionY],o=astar.search(this.grid.astarGrid,c,r),this.pathCells=[],t=0;t<o.length;t++)this.pathCells.push(this.grid.cells[o[t].x][o[t].y]);0<this.pathCells.length?(this.moving=!0,this.currentPathCell=0,this.previousCell=this.gridCell,this.safeCell=this.pathCells[this.currentPathCell],this.nextSafeDirection(this.gridPositionX,this.gridPositionY,this.safeCell)):this.findClearPath()}},i.prototype.chooseCellToMove=function(){for(var t,i=[],e=0;e<this.freeCells.length;e++)i.push(this.freeCells[e]);0<i.length?(t=this.game.rnd.integerInRange(0,i.length-1),this.destinationCell=i[t],this.notSafe=!1,this.awaitingNewAction=!1,this.gridPositionX-1===this.destinationCell.gridPositionX?this.direction=m.DIRECTION.LEFT:this.gridPositionX+1===this.destinationCell.gridPositionX?this.direction=m.DIRECTION.RIGHT:this.gridPositionY-1===this.destinationCell.gridPositionY?this.direction=m.DIRECTION.UP:this.gridPositionY+1===this.destinationCell.gridPositionY&&(this.direction=m.DIRECTION.DOWN)):this.notSafe=!0},i.prototype.canPressButtons=function(){if(this.gameStatus!==m.GAME_STATUS.GAME_OVER&&this.gameStatus!==m.GAME_STATUS.PAUSED&&!this.dead&&!this.jumping&&!(this.attacking||this.losingMount||this.stunned||this.teleporting||this.onCream||this.inBooster||this.frozen))switch(this.safeDirection){case m.DIRECTION.UP:this.inputUpPressed();break;case m.DIRECTION.DOWN:this.inputDownPressed();break;case m.DIRECTION.LEFT:this.inputLeftPressed();break;case m.DIRECTION.RIGHT:this.inputRightPressed()}},i.prototype.checkSafeMovement=function(){this.dead||(this.safeCell.isEmpty&&!this.safeCell.isDangerCell||(this.findFreeCells(),this.game.rnd.integerInRange(1,100)<=this.chanceToSearchPlayer||this.timeToKill>=this.timesToSearchPlayer?(this.timeToKill=0,this.findPathToPlayers()):(this.timeToKill++,this.findClearPath())),this.canPressButtons(),Phaser.Math.distance(this.previousCell.centerX,this.previousCell.centerY,this.x,this.y)>=m.SETTINGS.CELL_WIDTH*m.SETTINGS.SCALE&&(this.currentPathCell++,this.previousCell=this.safeCell,this.currentPathCell<this.pathCells.length?(this.safeCell=this.pathCells[this.currentPathCell],this.checkAdjacentCells(),this.nextSafeDirection(this.gridPositionX,this.gridPositionY,this.safeCell)):(this.idle=!0,this.moving=!1,this.awaitingNewAction=!0,this.weaponActive?this.checkWeaponToUse():this.mountType===m.ITEM_TYPE.STAG?this.checkUseStag():this.mountType===m.ITEM_TYPE.HORSE?this.checkUseHorse():this.checkCellsToBomb()),this.awaitingNewAction=!0))},i.prototype.checkCellsToBomb=function(){var t,i=!1;0<this.gridPositionX&&((t=this.grid.cells[this.gridPositionX-1][this.gridPositionY]).isEmpty||t.cellContains!==m.MAP.BLOCK||(i=!0)),this.gridPositionX<m.SETTINGS.GRID_WIDTH-1&&((t=this.grid.cells[this.gridPositionX+1][this.gridPositionY]).isEmpty||t.cellContains!==m.MAP.BLOCK||(i=!0)),0<this.gridPositionY&&((t=this.grid.cells[this.gridPositionX][this.gridPositionY-1]).isEmpty||t.cellContains!==m.MAP.BLOCK||(i=!0)),this.gridPositionY<m.SETTINGS.GRID_HEIGHT-1&&((t=this.grid.cells[this.gridPositionX][this.gridPositionY+1]).isEmpty||t.cellContains!==m.MAP.BLOCK||(i=!0)),this.checkBombsNearby()&&(i||this.checkPlayersNearby())&&this.putBomb()},i.prototype.checkBombsNearby=function(){for(var t,i=0,e=this.gridPositionX,s=this.gridPositionY,a=[],n=s-2<=0?0:s-2,o=e+2>=m.SETTINGS.GRID_WIDTH?m.SETTINGS.GRID_WIDTH:e+2,r=s+2>=m.SETTINGS.GRID_HEIGHT?m.SETTINGS.GRID_HEIGHT:s+2,h=e-2<=0?0:e-2;h<o;h++)for(t=n;t<r;t++)a.push(this.grid.cells[h][t]);for(h=0;h<a.length;h++)a[h].cellContains===m.MAP.BOMB&&i++;return!(0<i)},i.prototype.canAttack=function(){return this.gameStatus!==m.GAME_STATUS.GAME_OVER&&this.gameStatus!==m.GAME_STATUS.PAUSED&&!(this.dead||this.jumping||this.attacking||this.losingMount)&&(!(this.teleporting||this.onCream||this.inBooster||this.frozen)||void 0)},i.prototype.checkPlayersNearby=function(){for(var t,i,e=0;e<this.grid.players.length;e++)if(this.grid.players[e].playerID!==this.playerID&&(i=Math.abs(this.gridPositionX-this.grid.players[e].gridPositionX),t=Math.abs(this.gridPositionY-this.grid.players[e].gridPositionY),i<=2)&&t<=2)if(i=this.game.rnd.integerInRange(1,100),this.grid.difficulty===m.DIFFICULTY.EASY){if(i<=30)return!0}else{if(this.grid.difficulty!==m.DIFFICULTY.NORMAL)return!0;if(i<=75)return!0}return!1},i.prototype.nextSafeDirection=function(t,i,e){t-1===e.gridPositionX?this.safeDirection=m.DIRECTION.LEFT:t+1===e.gridPositionX?this.safeDirection=m.DIRECTION.RIGHT:i-1===e.gridPositionY?this.safeDirection=m.DIRECTION.UP:i+1===e.gridPositionY&&(this.safeDirection=m.DIRECTION.DOWN)},i.prototype.checkAdjacentCells=function(){this.weaponActive&&this.weaponCurrentType===m.ITEM_TYPE.HAMMER&&this.useHammer()},i.prototype.checkUseStag=function(){var t;switch(this.direction){case m.DIRECTION.UP:0<=this.gridPositionY-1&&(t=this.grid.cells[this.gridPositionX][this.gridPositionY-1],this.checkStagAttack(t));break;case m.DIRECTION.DOWN:this.gridPositionY+1<m.SETTINGS.GRID_HEIGHT&&(t=this.grid.cells[this.gridPositionX][this.gridPositionY+1],this.checkStagAttack(t));break;case m.DIRECTION.LEFT:0<=this.gridPositionX-1&&(t=this.grid.cells[this.gridPositionX-1][this.gridPositionY],this.checkStagAttack(t));break;case m.DIRECTION.RIGHT:this.gridPositionX+1<m.SETTINGS.GRID_WIDTH&&(t=this.grid.cells[this.gridPositionX+1][this.gridPositionY],this.checkStagAttack(t));break;default:this.checkCellsToBomb()}},i.prototype.checkUseHorse=function(){this.checkCellsToBomb()},i.prototype.checkWeaponToUse=function(){if(this.canAttack())switch(this.weaponCurrentType){case m.ITEM_TYPE.HAMMER:this.useHammer();break;case m.ITEM_TYPE.FLAMETHROWER:this.useFlamethrower();break;case m.ITEM_TYPE.LASER_GUN:case m.ITEM_TYPE.LIGHTING_GUN:case m.ITEM_TYPE.MIGHTY_HAMMER:case m.ITEM_TYPE.DOLL_BOMB:this.useWeapon();break;case m.ITEM_TYPE.ICE_GUN:this.grid.gameMode===m.GAME_MODE.ICE_MAN?this.useIceWeapon():this.useWeapon()}},i.prototype.useIceWeapon=function(){for(var t,i,e,s=this.gridPositionX,a=this.gridPositionY,n=this.grid.monsters,o=[],r=!1,h=0<=a-3?a-3:0,c=a+3<m.SETTINGS.GRID_HEIGHT?a+3:m.SETTINGS.GRID_HEIGHT,l=h;l<c;l++)o.push(this.grid.cells[s][l]);for(c=s+3<m.SETTINGS.GRID_WIDTH?s+3:m.SETTINGS.GRID_WIDTH,l=0<=s-3?s-3:0;l<c;l++)o.push(this.grid.cells[l][s]);for(t=0;t<n.length;t++)for(i=n[t],l=0;l<o.length;l++)i.gridPositionX===s?i.gridPositionY<a?(r=!0,e=m.DIRECTION.UP,t=n.length,l=o.length):i.gridPositionY>a&&(r=!0,e=m.DIRECTION.DOWN,t=n.length,l=o.length):i.gridPositionY===a&&(i.gridPositionX<s?(r=!0,e=m.DIRECTION.LEFT,t=n.length,l=o.length):i.gridPositionX>s&&(r=!0,e=m.DIRECTION.RIGHT,t=n.length,l=o.length));r&&(this.direction=e,this.useWeapon())},i.prototype.checkPlayerNextCell=function(t,i){for(var e=0;e<this.grid.players.length;e++)if(this.grid.players[e].gridCell===t)return this.direction=i,this.useWeapon(),!0;return!1},i.prototype.useHammer=function(){var t;if(this.canAttack()){if(0<this.gridPositionX-1){if(t=this.grid.cells[this.gridPositionX-1][this.gridPositionY],this.checkPlayerNextCell(t,m.DIRECTION.LEFT))return;if(t.cellContains===m.MAP.BLOCK)return this.direction=m.DIRECTION.LEFT,void this.useWeapon()}if(this.gridPositionX+1<m.SETTINGS.GRID_WIDTH-1){if(t=this.grid.cells[this.gridPositionX+1][this.gridPositionY],this.checkPlayerNextCell(t,m.DIRECTION.RIGHT))return;if(t.cellContains===m.MAP.BLOCK)return this.direction=m.DIRECTION.RIGHT,void this.useWeapon()}if(0<this.gridPositionY-1){if(t=this.grid.cells[this.gridPositionX][this.gridPositionY-1],this.checkPlayerNextCell(t,m.DIRECTION.UP))return;if(t.cellContains===m.MAP.BLOCK)return this.direction=m.DIRECTION.UP,void this.useWeapon()}this.gridPositionY+1<m.SETTINGS.GRID_HEIGHT-1&&(t=this.grid.cells[this.gridPositionX][this.gridPositionY+1],this.checkPlayerNextCell(t,m.DIRECTION.DOWN)||t.cellContains===m.MAP.BLOCK&&(this.direction=m.DIRECTION.DOWN,this.useWeapon()))}},i.prototype.useFlamethrower=function(){var t,i,e;if(this.canAttack()){if(0<this.gridPositionX-1)for((e=this.gridPositionX-3)<0&&(e=0),t=this.gridPositionX-1;e<=t;t--){if(i=this.grid.cells[t][this.gridPositionY],this.checkPlayerNextCell(i,m.DIRECTION.LEFT))return;if(i.cellContains===m.MAP.BLOCK)return this.direction=m.DIRECTION.LEFT,void this.useWeapon()}if(this.gridPositionX+1<m.SETTINGS.GRID_WIDTH-1)for((e=this.gridPositionX+3)>m.SETTINGS.GRID_WIDTH-1&&(e=m.SETTINGS.GRID_WIDTH),t=this.gridPositionX+1;t<e;t++){if(i=this.grid.cells[t][this.gridPositionY],this.checkPlayerNextCell(i,m.DIRECTION.RIGHT))return;if(i.cellContains===m.MAP.BLOCK)return this.direction=m.DIRECTION.RIGHT,void this.useWeapon()}if(0<this.gridPositionY-1)for((e=this.gridPositionY-3)<0&&(e=0),t=this.gridPositionY-1;e<=t;t--){if(i=this.grid.cells[this.gridPositionX][t],this.checkPlayerNextCell(i,m.DIRECTION.UP))return;if(i.cellContains===m.MAP.BLOCK)return this.direction=m.DIRECTION.UP,void this.useWeapon()}if(this.gridPositionY+1<m.SETTINGS.GRID_HEIGHT-1)for((e=this.gridPositionY+3)>m.SETTINGS.GRID_HEIGHT-1&&(e=m.SETTINGS.GRID_HEIGHT),t=this.gridPositionY+1;t<e;t++){if(i=this.grid.cells[this.gridPositionX][t],this.checkPlayerNextCell(i,m.DIRECTION.DOWN))return;if(i.cellContains===m.MAP.BLOCK)return this.direction=m.DIRECTION.DOWN,void this.useWeapon()}}};var l,t=i;function i(t,i,e,s,a,n,o,r,h){var c=l.call(this,t,i,e,s,a,n,o,r)||this;switch(c.isAI=!0,c.idle=!0,c.moving=!1,c.notSafe=!1,c.awaitingNewAction=!0,c.awaitingStunToEnd=!1,c.idleTimer=0,c.currentPathCell=0,c.lives=1,c.freeCells=[],c.dangerCells=[],c.pathCells=[],c.previousCellX=0,c.previousCellY=0,c.timeCheckCell=1e3,c.timerSameCell=1e3,c.difficulty=h,c.timeToKill=0,c.difficulty){case m.DIFFICULTY.EASY:c.timesToSearchPlayer=m.SETTINGS.TIMES_TO_SEARCH_PLAYER_EASY,c.chanceToSearchPlayer=m.SETTINGS.CHANCE_TO_SEARCH_PLAYER_EASY;break;case m.DIFFICULTY.NORMAL:c.timesToSearchPlayer=m.SETTINGS.TIMES_TO_SEARCH_PLAYER_NORMAL,c.chanceToSearchPlayer=m.SETTINGS.CHANCE_TO_SEARCH_PLAYER_NORMAL;break;case m.DIFFICULTY.HARD:c.timesToSearchPlayer=m.SETTINGS.TIMES_TO_SEARCH_PLAYER_HARD,c.chanceToSearchPlayer=m.SETTINGS.CHANCE_TO_SEARCH_PLAYER_HARD}return c.grid.gameMode===m.GAME_MODE.NEW_PACMAN&&c.createWeapon(m.ITEM_TYPE.FLAMETHROWER),c}m.PlayerAI=t}(Game=Game||{}),function(n){o=Phaser.Group,__extends(i,o),i.prototype.createCarAnimation=function(){n.SETTINGS.SCALE,n.SETTINGS.CELL_HEIGHT;var t="white"===this.carColor?"car_white_right.png":"car_red_right.png";this.carSprite=new Phaser.Sprite(this.game,0,0,"atlas_anim",t),this.carSprite.anchor.set(.5),this.addChild(this.carSprite),this.grid.rowsGroup[this.gridPositionY].add(this)},i.prototype.createRoute=function(t){for(var i,e,s=t.length,a=0;a<s;a++)i=t[a][0],e=t[a][1],i=this.grid.cells[i][e],this.pathCells.push(i);this.x=this.pathCells[0].centerX,this.y=this.pathCells[0].centerY,this.gridCell=this.pathCells[0],this.gridPositionX=this.pathCells[0].gridPositionX,this.gridPositionY=this.pathCells[0].gridPositionY,this.previousCell=this.pathCells[0],this.nextCell=this.pathCells[1]},i.prototype.pauseTrain=function(){this.gameStatus=n.GAME_STATUS.PAUSED},i.prototype.resumeTrain=function(){this.gameStatus=n.GAME_STATUS.PLAYING},i.prototype.update=function(){o.prototype.update.call(this),this.grid.gameStatus!==n.GAME_STATUS.PAUSED&&this.grid.gameStatus!==n.GAME_STATUS.GAME_OVER&&this.isMoving&&(this.updateCarCell(),this.checkMovement())},i.prototype.checkMovement=function(){switch(this.direction){case n.DIRECTION.UP:this.moveCarUp();break;case n.DIRECTION.DOWN:this.moveCarDown();break;case n.DIRECTION.LEFT:this.moveCarLeft();break;case n.DIRECTION.RIGHT:this.moveCarRight()}this.checkNextCellPassedBy(),(this.direction===n.DIRECTION.LEFT||this.direction===n.DIRECTION.RIGHT?Math.abs(this.x-this.nextCell.centerX):Math.abs(this.y-this.nextCell.centerY))>.25*n.SETTINGS.CELL_WIDTH*n.SETTINGS.SCALE||(this.currentPathCell++,this.currentPathCell>=this.pathCells.length&&(this.currentPathCell=0),this.x=this.nextCell.centerX,this.y=this.nextCell.centerY,this.nextCell=this.pathCells[this.currentPathCell],this.nextSafeDirection(this.nextCell))},i.prototype.checkNextCellPassedBy=function(){this.direction===n.DIRECTION.LEFT?this.x<this.nextCell.centerX&&(this.x=this.nextCell.centerX):this.direction===n.DIRECTION.RIGHT?this.x>this.nextCell.centerX&&(this.x=this.nextCell.centerX):this.direction===n.DIRECTION.UP?this.y<this.nextCell.centerY&&(this.y=this.nextCell.centerY):this.direction===n.DIRECTION.DOWN&&this.y>this.nextCell.centerY&&(this.y=this.nextCell.centerY)},i.prototype.nextSafeDirection=function(t){t.gridPositionX<this.gridPositionX?(this.direction=n.DIRECTION.LEFT,this.carSprite.scale.x=1,this.carSprite.frameName="white"===this.carColor?"car_white_right.png":"car_red_right.png"):t.gridPositionX>this.gridPositionX?(this.direction=n.DIRECTION.RIGHT,this.carSprite.scale.x=-1,this.carSprite.frameName="white"===this.carColor?"car_white_right.png":"car_red_right.png"):t.gridPositionY<this.gridPositionY?(this.direction=n.DIRECTION.UP,this.carSprite.scale.x=1,this.carSprite.frameName="white"===this.carColor?"car_white_back.png.png":"car_red_back.png"):t.gridPositionY>this.gridPositionY&&(this.direction=n.DIRECTION.DOWN,this.carSprite.scale.x=1,this.carSprite.frameName="white"===this.carColor?"car_white_front.png":"car_red_front.png")},i.prototype.updateCarCell=function(){var t,i;switch(this.direction){case n.DIRECTION.LEFT:(t=Math.floor(this.x/(n.SETTINGS.CELL_WIDTH*this.gameScale)))!==this.gridPositionX&&(t===this.gridPositionX-1?(this.gridCell.isStunCell=!1,this.gridCell=this.grid.cells[t][this.gridPositionY],this.gridPositionX=t):(this.gridCell.isStunCell=!1,this.gridCell=this.grid.cells[this.gridPositionX-1][this.gridPositionY],this.gridPositionX=this.gridPositionX-1,this.x=this.gridCell.right),this.gridCell.isStunCell=!0);break;case n.DIRECTION.RIGHT:(t=Math.floor(this.x/(n.SETTINGS.CELL_WIDTH*this.gameScale)))!==this.gridPositionX&&(t===this.gridPositionX+1?(this.gridCell.isStunCell=!1,this.gridCell=this.grid.cells[t][this.gridPositionY],this.gridPositionX=t):(this.gridCell.isStunCell=!1,this.gridCell=this.grid.cells[this.gridPositionX+1][this.gridPositionY],this.gridPositionX=this.gridPositionX+1,this.x=this.gridCell.left),this.gridCell.isStunCell=!0);break;case n.DIRECTION.UP:(i=Math.floor(this.y/(n.SETTINGS.CELL_HEIGHT*this.gameScale)))!==this.gridPositionY&&(i===this.gridPositionY-1?(this.gridCell.isStunCell=!1,this.gridCell=this.grid.cells[this.gridPositionX][i],this.gridPositionY=i):(this.gridCell.isStunCell=!1,this.gridCell=this.grid.cells[this.gridPositionX][this.gridPositionY-1],this.gridPositionY=this.gridPositionY-1,this.y=this.gridCell.bottom),this.gridCell.isStunCell=!0,this.grid.rowsGroup[this.gridPositionY].add(this));break;case n.DIRECTION.DOWN:(i=Math.floor(this.y/(n.SETTINGS.CELL_HEIGHT*this.gameScale)))!==this.gridPositionY&&(i===this.gridPositionY+1?(this.gridCell.isStunCell=!1,this.gridCell=this.grid.cells[this.gridPositionX][i],this.gridPositionY=i):(this.gridCell.isStunCell=!1,this.gridCell=this.grid.cells[this.gridPositionX][this.gridPositionY+1],this.gridPositionY=this.gridPositionY+1,this.y=this.gridCell.top),this.gridCell.isStunCell=!0,this.grid.rowsGroup[this.gridPositionY].add(this))}},i.prototype.moveCarLeft=function(){var t=this.x-this.movingSpeed*this.gameScale*this.game.time.elapsedMS;0<=this.gridPositionX-1?this.grid.cells[this.gridPositionX-1][this.gridPositionY].centerX<=t&&(this.x-=this.movingSpeed*this.gameScale*this.game.time.elapsedMS):this.grid.cells[0][this.gridPositionY].left<=t&&(this.x-=this.movingSpeed*this.gameScale*this.game.time.elapsedMS)},i.prototype.moveCarRight=function(){var t=this.x+this.movingSpeed*this.gameScale*this.game.time.elapsedMS;this.gridPositionX+1<=n.SETTINGS.GRID_WIDTH-1?t<=this.grid.cells[this.gridPositionX+1][this.gridPositionY].centerX&&(this.x+=this.movingSpeed*this.gameScale*this.game.time.elapsedMS):t<=this.grid.cells[n.SETTINGS.GRID_WIDTH-1][this.gridPositionY].right&&(this.x+=this.movingSpeed*this.gameScale*this.game.time.elapsedMS)},i.prototype.moveCarUp=function(){var t=this.y-this.movingSpeed*this.gameScale*this.game.time.elapsedMS;0<=this.gridPositionY-1?this.grid.cells[this.gridPositionX][this.gridPositionY-1].centerY<=t&&(this.y-=this.movingSpeed*this.gameScale*this.game.time.elapsedMS):this.grid.cells[this.gridPositionX][0].top<=t&&(this.y-=this.movingSpeed*this.gameScale*this.game.time.elapsedMS)},i.prototype.moveCarDown=function(){var t=this.y+this.movingSpeed*this.gameScale*this.game.time.elapsedMS;this.gridPositionY+1<=n.SETTINGS.GRID_HEIGHT-1?t<=this.grid.cells[this.gridPositionX][this.gridPositionY+1].centerY&&(this.y+=this.movingSpeed*this.gameScale*this.game.time.elapsedMS):t<=this.grid.cells[this.gridPositionX][n.SETTINGS.GRID_HEIGHT-1].bottom&&(this.y+=this.movingSpeed*this.gameScale*this.game.time.elapsedMS)};var o,t=i;function i(t,i,e,s){var a=o.call(this,t)||this;return a.game=t,a.grid=i,a.carColor=s,a.movingSpeed=.175,a.gameStatus=n.GAME_STATUS.PLAYING,a.gameScale=n.SETTINGS.SCALE,a.isMoving=!0,a.previousCell=a.gridCell,a.pathCells=[],a.currentPathCell=0,a.timerSound=0,a.createRoute(e),a.createCarAnimation(),a.nextSafeDirection(a.nextCell),a}n.RaceCar=t}(Game=Game||{}),function(s){a=Phaser.Sprite,__extends(i,a),i.prototype.throwStarUp=function(){var t,i=this,e=this.grid.obtainFreeCell();null===e?this.destroy():(e.cellContains=s.MAP.STAR,e.isStar=!0,t=e.gridPositionY>this.gridCell.gridPositionY+1?this.gridCell.centerY-25:e.centerY-50*s.SETTINGS.SCALE,this.game.add.tween(this).to({y:t},750,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){i.game.add.tween(i).to({y:e.centerY},750,Phaser.Easing.Quartic.In,!0)},this),this.game.add.tween(this).to({x:e.centerX},1500,"Linear",!0).onComplete.add(function(){i.throwComplete(e)},this))},i.prototype.throwComplete=function(t){null!==this.grid.rowsGroup&&null!==this.grid.items&&(this.gridPositionX=t.gridPositionX,this.gridPositionY=t.gridPositionY,this.canBePickedUp=!0,this.grid.rowsGroup[t.gridPositionY].add(this),this.grid.stars.push(this))};var a,t=i;function i(t,i,e){var s=a.call(this,t,i.centerX,i.centerY,"atlas_gameplay","toy_store_star.png")||this;return s.anchor.set(.5),s.game=t,s.grid=e,s.gridCell=i,s.gridPositionX=i.gridPositionX,s.gridPositionY=i.gridPositionY,s.canBePickedUp=!1,s}s.Star=t}(Game=Game||{}),function(t){o=Phaser.Group,__extends(e,o),e.prototype.update=function(){o.prototype.update.call(this)};var o,i=e;function e(t,i,e,s,a){var n=o.call(this,t)||this;return n.x=i,n.y=e,n.game=t,n.grid=s,n.gridCell=a,n.gridPositionX=a.gridPositionX,n.gridPositionY=a.gridPositionY,n}t.Tile=i}(Game=Game||{}),function(t){n=Phaser.Group,__extends(e,n),e.prototype.update=function(){n.prototype.update.call(this)},e.prototype.useWeapon=function(){this.startingGridX=this.player.gridPositionX,this.startingGridY=this.player.gridPositionY},e.prototype.playerKilled=function(){this.weaponDisabled=!0};var n,i=e;function e(t,i,e,s){var a=n.call(this,t)||this;return a.game=t,a.x=0,a.y=0,a.player=e,a.grid=i,a.weaponType=s,a.weaponDisabled=!1,a.weaponUsed=!1,a}t.Weapon=i}(Game=Game||{}),function(a){s=a.MapCenter,__extends(i,s),i.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_christmas","atlas_anim"),this.animationCenter.ph2Animations.play("center_christmas_play",1,!0),this.add(this.animationCenter)},i.prototype.update=function(){s.prototype.update.call(this),this.grid.gameStatus!==a.GAME_STATUS.GAME_OVER&&this.grid.gameStatus!==a.GAME_STATUS.PLAYING&&(this.timerPowerUps+=this.game.time.elapsedMS,this.timerPowerUps>=this.timeToThrowPowerUp)&&(this.timerPowerUps=0,this.createPowerUps())},i.prototype.createPowerUps=function(){var t=this.chooseRandomCell();null!==t&&(this.grid.gameMode===a.GAME_MODE.NEW_PACMAN?this.grid.createRandomPacmanPowerUp():this.grid.createPowerUp(t))},i.prototype.chooseRandomCell=function(){for(var t,i,e=[],s=0;s<a.SETTINGS.GRID_WIDTH;s++)for(t=0;t<a.SETTINGS.GRID_HEIGHT;t++)(i=this.grid.cells[s][t]).cellContains===a.MAP.FREE&&e.push(i);return e.length<=0?null:_.sample(e)};var s,t=i;function i(t,i,e){t=s.call(this,t,i,e)||this;return t.timerPowerUps=0,t.timeToThrowPowerUp=5e3,t.createCenter(),t}a.Christmas=t}(Game=Game||{}),function(n){s=n.MapCenter,__extends(i,s),i.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_classroom","atlas_anim"),this.animationCenter.ph2Animations.play("center_classroom_stand",1,!0),this.add(this.animationCenter)},i.prototype.update=function(){s.prototype.update.call(this),this.grid.gameStatus===n.GAME_STATUS.GAME_OVER||this.grid.gameStatus===n.GAME_STATUS.PAUSED||this.isThrowingBomb||(this.timerTeacher+=this.game.time.elapsedMS,this.timerTeacher>=this.timeToBomb&&this.startWriting())},i.prototype.startWriting=function(){var t;this.timerTeacher=0,this.isThrowingBomb=!0,(t=this.animationCenter.ph2Animations.play("center_classroom_play",1,!1)).onEvent.add(this.throwBomb,this),t.onComplete.add(this.stopWriting,this)},i.prototype.stopWriting=function(){this.isThrowingBomb=!1,this.animationCenter.ph2Animations.play("center_classroom_stand",1,!0)},i.prototype.throwBomb=function(){var t=this,i=this.grid.rowsGroup.length-1,e=this.grid.players.length-1,e=this.game.rnd.integerInRange(0,e),s=this.grid.players[e].gridCell,a=new n.Bomb(this.game,this.gridCell.centerX,this.gridCell.centerX,"bomb",this.grid,s,1,null);this.grid.rowsGroup[i].add(a),e=s.gridPositionY>this.gridCell.gridPositionY+1?this.gridCell.centerY-25:s.centerY-50*n.SETTINGS.SCALE,a.centerX=this.gridCell.centerX,a.centerY=this.gridCell.centerY,this.game.add.tween(a).to({y:e},250,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){t.game.add.tween(a).to({y:s.centerY},250,Phaser.Easing.Quartic.In,!0)},this),this.game.add.tween(a).to({x:s.centerX},500,"Linear",!0).onComplete.add(function(){t.throwComplete(a,s)},this),this.game.ph2AudioManager.playEffect("sound_teacher_angry",!1)},i.prototype.throwComplete=function(t,i){i.isEmpty=!1,i.cellContains=n.MAP.BOMB,t.gridCell=i,this.grid.addBomb(t,i)};var s,t=i;function i(t,i,e){t=s.call(this,t,i,e)||this;return t.timerTeacher=0,t.timeToBomb=16e3,t.isThrowingBomb=!1,t.createCenter(),t}n.Classroom=t}(Game=Game||{}),function(t){s=t.MapCenter,__extends(e,s),e.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_boutique","atlas_anim"),this.animationCenter.ph2Animations.play("center_boutique_play",1,!0),this.add(this.animationCenter)};var s,i=e;function e(t,i,e){t=s.call(this,t,i,e)||this;return t.bubbleTimer=0,t.bubbleCounter=0,t.timeToCreateBubble=5e3,t.createCenter(),t}t.Boutique=i}(Game=Game||{}),function(t){s=t.MapCenter,__extends(e,s),e.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_forest","atlas_anim"),this.animationCenter.ph2Animations.play("center_forest_anim",1,!0),this.add(this.animationCenter)};var s,i=e;function e(t,i,e){t=s.call(this,t,i,e)||this;return t.createCenter(),t}t.Forest=i}(Game=Game||{}),function(t){s=t.MapCenter,__extends(e,s),e.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_beach","atlas_anim"),this.animationCenter.ph2Animations.play("center_beach_play",1,!0),this.add(this.animationCenter)};var s,i=e;function e(t,i,e){t=s.call(this,t,i,e)||this;return t.createCenter(),t}t.Beach=i}(Game=Game||{}),function(t){s=t.MapCenter,__extends(e,s),e.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_ranch","atlas_anim"),this.animationCenter.ph2Animations.play("center_ranch_play",1,!0),this.add(this.animationCenter)};var s,i=e;function e(t,i,e){t=s.call(this,t,i,e)||this;return t.createCenter(),t}t.Ranch=i}(Game=Game||{}),function(l){s=l.MapCenter,__extends(i,s),i.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_toy_store","atlas_anim"),this.animationCenter.ph2Animations.play("center_toy_store_stand",1,!0),this.add(this.animationCenter)},i.prototype.update=function(){s.prototype.update.call(this),this.grid.gameStatus===l.GAME_STATUS.PAUSED||this.grid.gameStatus===l.GAME_STATUS.GAME_OVER||this.rocketLaunched||(this.launchTimeCounter+=this.game.time.elapsedMS,this.launchTimeCounter>=this.launchTime&&this.launchRocket())},i.prototype.launchRocket=function(){var t;this.rocketLaunched=!0,this.launchTimeCounter=0,(t=this.animationCenter.ph2Animations.play("center_toy_store_play",1,!1)).onEvent.add(this.searchCells,this),t.onComplete.add(this.resetRocket,this),this.game.ph2AudioManager.playEffect("sound_rocket_start",!1)},i.prototype.resetRocket=function(){this.animationCenter.ph2Animations.play("center_toy_store_stand",1,!0),this.launchTimeCounter=0,this.rocketLaunched=!1},i.prototype.searchCells=function(){var t,i;for(this.game.ph2AudioManager.playEffect("sound_rocket_exp",!1),t=this.chooseRandomCell(),i=this.chooseRandomCell();t===i;)i=this.chooseRandomCell();this.throwPowerUp(t),this.throwPowerUp(i)},i.prototype.chooseRandomCell=function(){for(var t,i,e=[],s=0;s<l.SETTINGS.GRID_WIDTH;s++)for(t=0;t<l.SETTINGS.GRID_HEIGHT;t++)(i=this.grid.cells[s][t]).cellContains===l.MAP.FREE&&e.push(i);return _.sample(e)},i.prototype.throwPowerUp=function(t){var i=this,e=t.gridPositionY>this.explodeCell.gridPositionY+1?this.explodeCell.centerY-25:t.centerY-50*l.SETTINGS.SCALE,s=this.createPowerUp(t);s.centerX=this.explodeCell.centerX,s.centerY=this.explodeCell.centerY,this.game.add.tween(s).to({y:e},750,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){i.game.add.tween(s).to({y:t.centerY},750,Phaser.Easing.Quartic.In,!0)},this),this.game.add.tween(s).to({x:t.centerX},1500,"Linear",!0).onComplete.add(function(){i.throwComplete(s,t)},this)},i.prototype.throwComplete=function(t,i){null!=this.grid.rowsGroup&&null!=this.grid.items&&(i.isItem=!0,i.cellContains=l.MAP.ITEM,this.grid.rowsGroup[i.gridPositionY].add(t),this.grid.items.push(t))},i.prototype.createPowerUp=function(t){var i,e,s,a,n=this.grid.rowsGroup.length-1,o=this.game.rnd.integerInRange(0,99),r=this.game.rnd.integerInRange(0,99),h=this.grid.onBlockDestroyChances[o].name,c=this.grid.gameMode;if("nothing"===h&&(h=this.grid.onBlockDestroyChances[o-=25].name),c===l.GAME_MODE.BATTLE_ROYALE)"hammer"===(e=this.grid.weaponChances[r]).name&&(e.name="shield");else if(c===l.GAME_MODE.NEW_PACMAN)e=this.grid.pacmanChances[r];else switch(h){case"power_up":e=this.grid.powerupChances[r];break;case"weapon":e=this.grid.weaponChances[r];break;case"mount":e=this.grid.mountChances[r]}switch(e.name){case"bomb":s=l.ITEM_TYPE.BOMB,i="icon_bomb",a=l.POWER_UP_TYPE.POWER_UP;break;case"power":s=l.ITEM_TYPE.POWER,i="icon_power_blast",a=l.POWER_UP_TYPE.POWER_UP;break;case"speed":s=l.ITEM_TYPE.SPEED,i="icon_speed",a=l.POWER_UP_TYPE.POWER_UP;break;case"shield":s=l.ITEM_TYPE.SHIELD,i="icon_shield",a=l.POWER_UP_TYPE.POWER_UP;break;case"push":s=l.ITEM_TYPE.KICK_BOMBS,i="icon_super_gloves",a=l.POWER_UP_TYPE.POWER_UP;break;case"invincibility":s=l.ITEM_TYPE.INVINCIBILITY,i="icon_invincibility",a=l.POWER_UP_TYPE.POWER_UP;break;case"heart":s=l.ITEM_TYPE.HEART,i="icon_life",a=l.POWER_UP_TYPE.POWER_UP;break;case"flamethrower":s=l.ITEM_TYPE.FLAMETHROWER,i="icon_flamethrower",a=l.POWER_UP_TYPE.WEAPON;break;case"hammer":s=l.ITEM_TYPE.HAMMER,i="icon_hammer",a=l.POWER_UP_TYPE.WEAPON;break;case"laser_gun":s=l.ITEM_TYPE.LASER_GUN,i="icon_lightning_gun",a=l.POWER_UP_TYPE.WEAPON;break;case"ice_gun":s=l.ITEM_TYPE.ICE_GUN,i="icon_ice_gun",a=l.POWER_UP_TYPE.WEAPON;break;case"lightning_gun":s=l.ITEM_TYPE.LIGHTING_GUN,i="icon_laser_gun",a=l.POWER_UP_TYPE.WEAPON;break;case"doll_bomb":s=l.ITEM_TYPE.DOLL_BOMB,i="icon_doll_bomb",a=l.POWER_UP_TYPE.WEAPON;break;case"mighty_hammer":s=l.ITEM_TYPE.MIGHTY_HAMMER,i="icon_mighty_hammer",a=l.POWER_UP_TYPE.WEAPON;break;case"horse":s=l.ITEM_TYPE.HORSE,i="icon_horse",a=l.POWER_UP_TYPE.MOUNT;break;case"skate":s=l.ITEM_TYPE.SKATEBOARD,i="icon_skate",a=l.POWER_UP_TYPE.MOUNT;break;case"cart":s=l.ITEM_TYPE.SHOPPING_CART,i="icon_cart",a=l.POWER_UP_TYPE.MOUNT;break;case"stag":s=l.ITEM_TYPE.STAG,i="icon_stag",a=l.POWER_UP_TYPE.MOUNT;break;default:return}return o=new l.Item(this.game,t,i,s,a),this.grid.rowsGroup[n].add(o),o};var s,t=i;function i(t,i,e){t=s.call(this,t,i,e)||this;return t.rocketLaunched=!1,t.launchTime=14e3,t.launchTimeCounter=0,t.explodeCell=t.grid.cells[t.gridCell.gridPositionX][2],t.createCenter(),t}l.ToyStore=t}(Game=Game||{}),function(l){s=l.MapCenter,__extends(i,s),i.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_bakery","atlas_anim"),this.add(this.animationCenter)},i.prototype.update=function(){s.prototype.update.call(this),this.grid.gameStatus===l.GAME_STATUS.PAUSED||this.grid.gameStatus===l.GAME_STATUS.GAME_OVER||this.isActive||(this.timerSpawn+=this.game.time.elapsedMS,this.timerSpawn>=this.timeToActivate&&(this.isActive=!0,this.timerSpawn=0,this.openCake()))},i.prototype.openCake=function(){var t=this.animationCenter.ph2Animations.play("center_bakery_play",1,!1);t.onComplete.add(this.resetCake,this),t.onEvent.add(this.searchCells,this)},i.prototype.resetCake=function(){this.timerSpawn=0,this.isActive=!1},i.prototype.searchCells=function(){var t,i;for(this.game.ph2AudioManager.playEffect("sound_chimney",!1),t=this.chooseRandomCell(),i=this.chooseRandomCell();t===i;)i=this.chooseRandomCell();this.throwPowerUp(t),this.throwPowerUp(i)},i.prototype.chooseRandomCell=function(){for(var t,i,e=[],s=0;s<l.SETTINGS.GRID_WIDTH;s++)for(t=0;t<l.SETTINGS.GRID_HEIGHT;t++)(i=this.grid.cells[s][t]).cellContains===l.MAP.FREE&&e.push(i);return _.sample(e)},i.prototype.throwPowerUp=function(t){var i,e,s,a=this;0===this.game.rnd.integerInRange(0,1)?(s=t.gridPositionY>this.spawnCell.gridPositionY+1?this.spawnCell.centerY-25:t.centerY-50*l.SETTINGS.SCALE,e=this.createCream(this.spawnCell),this.game.add.tween(e).to({y:s},750,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){a.game.add.tween(e).to({y:t.top},750,Phaser.Easing.Quartic.In,!0)},this),this.game.add.tween(e).to({x:t.left},1500,"Linear",!0).onComplete.add(function(){a.throwComplete(e,t,!1)},this)):(s=t.gridPositionY>this.spawnCell.gridPositionY+1?this.spawnCell.centerY-25:t.centerY-50*l.SETTINGS.SCALE,(i=this.createPowerUp(t)).centerX=this.spawnCell.centerX,i.centerY=this.spawnCell.centerY,this.game.add.tween(i).to({y:s},750,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){a.game.add.tween(i).to({y:t.centerY},750,Phaser.Easing.Quartic.In,!0)},this),this.game.add.tween(i).to({x:t.centerX},1500,"Linear",!0).onComplete.add(function(){a.throwComplete(i,t,!0)},this))},i.prototype.throwComplete=function(t,i,e){null!=this.grid.rowsGroup&&null!=this.grid.items&&(e?(i.isItem=!0,i.cellContains=l.MAP.ITEM,this.grid.items.push(t),this.grid.rowsGroup[i.gridPositionY]):(i.isSpecialTile=!0,i.cream=t,this.grid.rowsGroup[0])).add(t)},i.prototype.createCream=function(t){var i=this.grid.rowsGroup.length-1,e=new l.Cream(this.game,this.grid,t);return e.x=t.left,e.y=t.top,this.grid.rowsGroup[i].add(e),e},i.prototype.createPowerUp=function(t){var i,e,s,a,n=this.grid.rowsGroup.length-1,o=this.game.rnd.integerInRange(0,99),r=this.game.rnd.integerInRange(0,99),h=this.grid.onBlockDestroyChances[o].name,c=this.grid.gameMode;if("nothing"===h&&(h=this.grid.onBlockDestroyChances[o-=25].name),c===l.GAME_MODE.BATTLE_ROYALE)"hammer"===(e=this.grid.weaponChances[r]).name&&(e.name="shield");else if(c===l.GAME_MODE.NEW_PACMAN)e=this.grid.pacmanChances[r];else switch(h){case"power_up":e=this.grid.powerupChances[r];break;case"weapon":e=this.grid.weaponChances[r];break;case"mount":e=this.grid.mountChances[r]}switch(e.name){case"bomb":s=l.ITEM_TYPE.BOMB,i="icon_bomb",a=l.POWER_UP_TYPE.POWER_UP;break;case"power":s=l.ITEM_TYPE.POWER,i="icon_power_blast",a=l.POWER_UP_TYPE.POWER_UP;break;case"speed":s=l.ITEM_TYPE.SPEED,i="icon_speed",a=l.POWER_UP_TYPE.POWER_UP;break;case"shield":s=l.ITEM_TYPE.SHIELD,i="icon_shield",a=l.POWER_UP_TYPE.POWER_UP;break;case"push":s=l.ITEM_TYPE.KICK_BOMBS,i="icon_super_gloves",a=l.POWER_UP_TYPE.POWER_UP;break;case"invincibility":s=l.ITEM_TYPE.INVINCIBILITY,i="icon_invincibility",a=l.POWER_UP_TYPE.POWER_UP;break;case"heart":s=l.ITEM_TYPE.HEART,i="icon_life",a=l.POWER_UP_TYPE.POWER_UP;break;case"flamethrower":s=l.ITEM_TYPE.FLAMETHROWER,i="icon_flamethrower",a=l.POWER_UP_TYPE.WEAPON;break;case"hammer":s=l.ITEM_TYPE.HAMMER,i="icon_hammer",a=l.POWER_UP_TYPE.WEAPON;break;case"laser_gun":s=l.ITEM_TYPE.LASER_GUN,i="icon_lightning_gun",a=l.POWER_UP_TYPE.WEAPON;break;case"ice_gun":s=l.ITEM_TYPE.ICE_GUN,i="icon_ice_gun",a=l.POWER_UP_TYPE.WEAPON;break;case"lightning_gun":s=l.ITEM_TYPE.LIGHTING_GUN,i="icon_laser_gun",a=l.POWER_UP_TYPE.WEAPON;break;case"doll_bomb":s=l.ITEM_TYPE.DOLL_BOMB,i="icon_doll_bomb",a=l.POWER_UP_TYPE.WEAPON;break;case"mighty_hammer":s=l.ITEM_TYPE.MIGHTY_HAMMER,i="icon_mighty_hammer",a=l.POWER_UP_TYPE.WEAPON;break;case"horse":s=l.ITEM_TYPE.HORSE,i="icon_horse",a=l.POWER_UP_TYPE.MOUNT;break;case"skate":s=l.ITEM_TYPE.SKATEBOARD,i="icon_skate",a=l.POWER_UP_TYPE.MOUNT;break;case"cart":s=l.ITEM_TYPE.SHOPPING_CART,i="icon_cart",a=l.POWER_UP_TYPE.MOUNT;break;case"stag":s=l.ITEM_TYPE.STAG,i="icon_stag",a=l.POWER_UP_TYPE.MOUNT;break;default:return}return o=new l.Item(this.game,t,i,s,a),this.grid.rowsGroup[n].add(o),o},i.prototype.changePowerUp=function(){return 0===this.game.rnd.integerInRange(0,1)?"speed":"shield"};var s,t=i;function i(t,i,e){t=s.call(this,t,i,e)||this;return t.timerSpawn=0,t.timeToActivate=7e3,t.isActive=!1,t.spawnCell=t.grid.cells[t.gridCell.gridPositionX-1][t.gridCell.gridPositionY-1],t.createCenter(),t}l.Bakery=t}(Game=Game||{}),function(t){s=t.MapCenter,__extends(e,s),e.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_race_track","atlas_anim"),this.animationCenter.ph2Animations.play("center_race_track_play",1,!0),this.add(this.animationCenter),this.grid.cells[6][6].isForcedFreeCell=!0,this.grid.cells[7][6].isForcedFreeCell=!0,this.grid.cells[8][6].isForcedFreeCell=!0,this.grid.cells[6][7].isForcedFreeCell=!0,this.grid.cells[7][7].isForcedFreeCell=!0,this.grid.cells[8][7].isForcedFreeCell=!0,this.grid.cells[6][6].cellContains=t.MAP.FREE,this.grid.cells[7][6].cellContains=t.MAP.FREE,this.grid.cells[8][6].cellContains=t.MAP.FREE,this.grid.cells[6][7].cellContains=t.MAP.FREE,this.grid.cells[7][7].cellContains=t.MAP.FREE,this.grid.cells[8][7].cellContains=t.MAP.FREE,this.grid.cells[6][6].isEmpty=!0,this.grid.cells[7][6].isEmpty=!0,this.grid.cells[8][6].isEmpty=!0,this.grid.cells[6][7].isEmpty=!0,this.grid.cells[7][7].isEmpty=!0,this.grid.cells[8][7].isEmpty=!0,this.grid.astarGrid.grid[6][6].weight=1,this.grid.astarGrid.grid[7][6].weight=1,this.grid.astarGrid.grid[8][6].weight=1,this.grid.astarGrid.grid[6][7].weight=1,this.grid.astarGrid.grid[7][7].weight=1,this.grid.astarGrid.grid[8][7].weight=1};var s,i=e;function e(t,i,e){t=s.call(this,t,i,e)||this;return t.createCenter(),t}t.RaceTrack=i}(Game=Game||{}),function(a){n=a.Mount,__extends(i,n),i.prototype.createSpine=function(){var t,i=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*.3;switch(this.spine=this.game.add.spine(0,i,"pony"),this.bone=this.spine.slotContainers[10].children[0],this.player.direction){case a.DIRECTION.UP:this.horseState=a.HORSE_STATE.STAND_BACK,t="stand_back";break;case a.DIRECTION.DOWN:this.horseState=a.HORSE_STATE.STAND_FRONT,t="stand_front";break;case a.DIRECTION.LEFT:this.horseState=a.HORSE_STATE.STAND_LEFT,t="stand_side";break;case a.DIRECTION.RIGHT:this.horseState=a.HORSE_STATE.STAND_RIGHT,t="stand_side"}this.spine.setAnimationByName(0,t,!0),this.spine.scale.setTo(a.SETTINGS.SCALE),this.spine.setToSetupPose(),this.add(this.spine)},i.prototype.update=function(){n.prototype.update.call(this),this.updateDirection(),this.updateState()},i.prototype.updateState=function(){switch(this.horseState){case a.HORSE_STATE.WALK_BACK:this.horseAnimation!==a.HORSE_STATE.WALK_BACK&&(this.horseAnimation=a.HORSE_STATE.WALK_BACK,this.spine.setAnimationByName(0,"walk_back",!0),this.spine.setToSetupPose());break;case a.HORSE_STATE.WALK_FRONT:this.horseAnimation!==a.HORSE_STATE.WALK_FRONT&&(this.horseAnimation=a.HORSE_STATE.WALK_FRONT,this.spine.setAnimationByName(0,"walk_front",!0),this.spine.setToSetupPose());break;case a.HORSE_STATE.WALK_LEFT:this.horseAnimation!==a.HORSE_STATE.WALK_LEFT&&(this.horseAnimation=a.HORSE_STATE.WALK_LEFT,this.spine.setAnimationByName(0,"walk_side",!0),this.spine.setToSetupPose());break;case a.HORSE_STATE.WALK_RIGHT:this.horseAnimation!==a.HORSE_STATE.WALK_RIGHT&&(this.horseAnimation=a.HORSE_STATE.WALK_RIGHT,this.spine.setAnimationByName(0,"walk_side",!0),this.spine.setToSetupPose());break;case a.HORSE_STATE.BACK_JUMP:this.horseAnimation!==a.HORSE_STATE.BACK_JUMP&&(this.horseState=null,this.horseAnimation=null,this.spine.setAnimationByName(0,"jump_back",!1),this.spine.setToSetupPose());break;case a.HORSE_STATE.FRONT_JUMP:this.horseAnimation!==a.HORSE_STATE.FRONT_JUMP&&(this.horseState=null,this.horseAnimation=null,this.spine.setAnimationByName(0,"jump_front",!1),this.spine.setToSetupPose());break;case a.HORSE_STATE.LEFT_JUMP:this.horseAnimation!==a.HORSE_STATE.LEFT_JUMP&&(this.horseState=null,this.horseAnimation=null,this.spine.setAnimationByName(0,"jump_side",!1),this.spine.setToSetupPose());break;case a.HORSE_STATE.RIGHT_JUMP:this.horseAnimation!==a.HORSE_STATE.RIGHT_JUMP&&(this.horseState=null,this.horseAnimation=null,this.spine.setAnimationByName(0,"jump_side",!1),this.spine.setToSetupPose());break;case a.HORSE_STATE.STAND_BACK:this.horseAnimation!==a.HORSE_STATE.STAND_BACK&&(this.horseAnimation=a.HORSE_STATE.STAND_BACK,this.spine.setAnimationByName(0,"stand_back",!0),this.spine.setToSetupPose());break;case a.HORSE_STATE.STAND_FRONT:this.horseAnimation!==a.HORSE_STATE.STAND_FRONT&&(this.horseAnimation=a.HORSE_STATE.STAND_FRONT,this.spine.setAnimationByName(0,"stand_front",!0),this.spine.setToSetupPose());break;case a.HORSE_STATE.STAND_LEFT:this.horseAnimation!==a.HORSE_STATE.STAND_LEFT&&(this.horseAnimation=a.HORSE_STATE.STAND_LEFT,this.spine.setAnimationByName(0,"stand_side",!0),this.spine.setToSetupPose());break;case a.HORSE_STATE.STAND_RIGHT:this.horseAnimation!==a.HORSE_STATE.STAND_RIGHT&&(this.horseAnimation=a.HORSE_STATE.STAND_RIGHT,this.spine.setAnimationByName(0,"stand_side",!0),this.spine.setToSetupPose())}},i.prototype.updateDirection=function(){if(!this.jumping)if(this.player.isStand)switch(this.player.direction){case a.DIRECTION.UP:this.horseState=a.HORSE_STATE.STAND_BACK,this.direction=a.DIRECTION.UP;break;case a.DIRECTION.DOWN:this.horseState=a.HORSE_STATE.STAND_FRONT,this.direction=a.DIRECTION.DOWN;break;case a.DIRECTION.LEFT:this.horseState=a.HORSE_STATE.STAND_LEFT,this.direction=a.DIRECTION.LEFT;break;case a.DIRECTION.RIGHT:this.horseState=a.HORSE_STATE.STAND_RIGHT,this.direction=a.DIRECTION.RIGHT}else switch(this.player.direction){case a.DIRECTION.UP:this.horseState=a.HORSE_STATE.WALK_BACK,this.direction=a.DIRECTION.UP;break;case a.DIRECTION.DOWN:this.horseState=a.HORSE_STATE.WALK_FRONT,this.direction=a.DIRECTION.DOWN;break;case a.DIRECTION.LEFT:this.horseState=a.HORSE_STATE.WALK_LEFT,this.direction=a.DIRECTION.LEFT;break;case a.DIRECTION.RIGHT:this.horseState=a.HORSE_STATE.WALK_RIGHT,this.direction=a.DIRECTION.RIGHT}},i.prototype.jumpCell=function(t){var i,e=this;switch(this.landingCell=t,this.player.jumping=!0,this.jumping=!0,this.player.direction!==a.DIRECTION.UP&&this.grid.rowsGroup[this.landingCell.gridPositionY].add(this.player),this.player.direction){case a.DIRECTION.UP:this.horseState=a.HORSE_STATE.BACK_JUMP;break;case a.DIRECTION.DOWN:this.horseState=a.HORSE_STATE.FRONT_JUMP;break;case a.DIRECTION.LEFT:this.horseState=a.HORSE_STATE.LEFT_JUMP;break;case a.DIRECTION.RIGHT:this.horseState=a.HORSE_STATE.RIGHT_JUMP}i=this.player.y-a.SETTINGS.GRID_HEIGHT*a.SETTINGS.SCALE,this.player.direction===a.DIRECTION.LEFT||this.player.direction===a.DIRECTION.RIGHT?(this.game.add.tween(this.player).to({x:t.centerX},750,"Linear",!0).onComplete.add(this.onFinishJumping,this),this.game.add.tween(this.player).to({y:i},375,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){e.game.add.tween(e.player).to({y:t.centerY},375,Phaser.Easing.Quartic.In,!0)},this)):(this.game.add.tween(this.player).to({x:t.centerX},750,"Linear",!0).onComplete.add(this.onFinishJumping,this),this.game.add.tween(this.player).to({y:i},375,Phaser.Easing.Quartic.Out,!0).onComplete.add(function(){e.game.add.tween(e.player).to({y:t.centerY},375,Phaser.Easing.Quartic.In,!0).onComplete.add(e.onFinishJumping,e)},this))},i.prototype.onFinishJumping=function(){this.player.gridCell=this.landingCell,this.player.gridPositionX=this.landingCell.gridPositionX,this.player.gridPositionY=this.landingCell.gridPositionY,this.player.x=this.landingCell.centerX,this.player.y=this.landingCell.centerY,this.grid.rowsGroup[this.player.gridPositionY].add(this.player),this.player.jumping=!1,this.jumping=!1,this.direction=null};var n,t=i;function i(t,i,e,s){t=n.call(this,t,i,e)||this;return t.createSpine(),t.jumping=!1,t.speed=a.SETTINGS.INITIAL_SPEED-.1*a.SETTINGS.INITIAL_SPEED,t}a.HorseMount=t}(Game=Game||{}),function(a){n=a.Mount,__extends(i,n),i.prototype.createSpine=function(){var t,i=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*.3;switch(this.spine=this.game.add.spine(0,i,"cart"),this.bone=this.spine.slotContainers[5].children[0],this.player.direction){case a.DIRECTION.UP:this.truckState=a.MOUNT_STATE.BACK_STAND,t="stand_back";break;case a.DIRECTION.DOWN:this.truckState=a.MOUNT_STATE.FRONT_STAND,t="stand_front";break;case a.DIRECTION.LEFT:case a.DIRECTION.RIGHT:this.truckState=a.MOUNT_STATE.SIDE_STAND,t="stand_side"}this.spine.setAnimationByName(0,t,!0),this.spine.scale.setTo(a.SETTINGS.SCALE),this.spine.setToSetupPose(),this.add(this.spine)},i.prototype.update=function(){n.prototype.update.call(this),this.updateState(),this.updateDirection()},i.prototype.updateState=function(){switch(this.truckState){case a.MOUNT_STATE.BACK:this.truckAnimation!==a.MOUNT_STATE.BACK&&(this.truckAnimation=a.MOUNT_STATE.BACK,this.spine.setAnimationByName(0,"walk_back",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.FRONT:this.truckAnimation!==a.MOUNT_STATE.FRONT&&(this.truckAnimation=a.MOUNT_STATE.FRONT,this.spine.setAnimationByName(0,"walk_front",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.SIDE:this.truckAnimation!==a.MOUNT_STATE.SIDE&&(this.truckAnimation=a.MOUNT_STATE.SIDE,this.spine.setAnimationByName(0,"walk_side",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.FRONT_STAND:this.truckAnimation!==a.MOUNT_STATE.FRONT_STAND&&(this.truckAnimation=a.MOUNT_STATE.FRONT_STAND,this.spine.setAnimationByName(0,"stand_front",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.BACK_STAND:this.truckAnimation!==a.MOUNT_STATE.BACK_STAND&&(this.truckAnimation=a.MOUNT_STATE.BACK_STAND,this.spine.setAnimationByName(0,"stand_back",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.SIDE_STAND:this.truckAnimation!==a.MOUNT_STATE.SIDE_STAND&&(this.truckAnimation=a.MOUNT_STATE.SIDE_STAND,this.spine.setAnimationByName(0,"stand_side",!0),this.spine.setToSetupPose())}},i.prototype.updateDirection=function(){if(this.player.isStand)switch(this.player.direction){case a.DIRECTION.UP:this.direction=a.DIRECTION.UP,this.truckState=a.MOUNT_STATE.BACK_STAND;break;case a.DIRECTION.DOWN:this.direction=a.DIRECTION.DOWN,this.truckState=a.MOUNT_STATE.FRONT_STAND;break;case a.DIRECTION.LEFT:this.direction=a.DIRECTION.LEFT,this.truckState=a.MOUNT_STATE.SIDE_STAND;break;case a.DIRECTION.RIGHT:this.direction=a.DIRECTION.RIGHT,this.truckState=a.MOUNT_STATE.SIDE_STAND}else switch(this.player.direction){case a.DIRECTION.UP:this.direction=a.DIRECTION.UP,this.truckState=a.MOUNT_STATE.BACK;break;case a.DIRECTION.DOWN:this.direction=a.DIRECTION.DOWN,this.truckState=a.MOUNT_STATE.FRONT;break;case a.DIRECTION.LEFT:this.direction=a.DIRECTION.LEFT,this.truckState=a.MOUNT_STATE.SIDE;break;case a.DIRECTION.RIGHT:this.direction=a.DIRECTION.RIGHT,this.truckState=a.MOUNT_STATE.SIDE}};var n,t=i;function i(t,i,e,s){t=n.call(this,t,i,e)||this;return t.speed=a.SETTINGS.INITIAL_SPEED+.3*a.SETTINGS.INITIAL_SPEED,t.createSpine(),t}a.ShoppingCart=t}(Game=Game||{}),function(a){n=a.Mount,__extends(i,n),i.prototype.createSpine=function(){var t,i=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*.3;switch(this.spine=this.game.add.spine(0,i,"stag"),this.bone=this.spine.slotContainers[7].children[0],this.player.direction){case a.DIRECTION.UP:this.walrusState=a.STAG_STATE.STAND_BACK,t="stand_back";break;case a.DIRECTION.DOWN:this.walrusState=a.STAG_STATE.STAND_FRONT,t="stand_front";break;case a.DIRECTION.LEFT:this.walrusState=a.STAG_STATE.STAND_LEFT,t="stand_side";break;case a.DIRECTION.RIGHT:this.walrusState=a.STAG_STATE.STAND_RIGHT,t="stand_side"}this.spine.setAnimationByName(0,t,!0),this.spine.scale.setTo(a.SETTINGS.SCALE),this.spine.setToSetupPose(),this.add(this.spine)},i.prototype.update=function(){n.prototype.update.call(this),this.updateState(),this.updateDirection()},i.prototype.updateState=function(){var t=this;switch(this.walrusState){case a.STAG_STATE.BACK_WALK:this.walrusAnimation!==a.STAG_STATE.BACK_WALK&&(this.walrusAnimation=a.STAG_STATE.BACK_WALK,this.spine.setAnimationByName(0,"walk_back",!0),this.spine.setToSetupPose());break;case a.STAG_STATE.FRONT_WALK:this.walrusAnimation!==a.STAG_STATE.FRONT_WALK&&(this.walrusAnimation=a.STAG_STATE.FRONT_WALK,this.spine.setAnimationByName(0,"walk_front",!0),this.spine.setToSetupPose());break;case a.STAG_STATE.SIDE_WALK_LEFT:this.walrusAnimation!==a.STAG_STATE.SIDE_WALK_LEFT&&(this.walrusAnimation=a.STAG_STATE.SIDE_WALK_LEFT,this.spine.setAnimationByName(0,"walk_side",!0),this.spine.setToSetupPose());break;case a.STAG_STATE.SIDE_WALK_RIGHT:this.walrusAnimation!==a.STAG_STATE.SIDE_WALK_RIGHT&&(this.walrusAnimation=a.STAG_STATE.SIDE_WALK_RIGHT,this.spine.setAnimationByName(0,"walk_side",!0),this.spine.setToSetupPose());break;case a.STAG_STATE.BACK_ATTACK:this.walrusAnimation!==a.STAG_STATE.BACK_ATTACK&&(this.walrusAnimation=a.STAG_STATE.BACK_ATTACK,this.spine.setAnimationByName(0,"hit_back",!1).onComplete=function(){t.onAttackComplete()},this.spine.setToSetupPose());break;case a.STAG_STATE.FRONT_ATTACK:this.walrusAnimation!==a.STAG_STATE.FRONT_ATTACK&&(this.walrusAnimation=a.STAG_STATE.FRONT_ATTACK,this.spine.setAnimationByName(0,"hit_front",!1).onComplete=function(){t.onAttackComplete()},this.spine.setToSetupPose());break;case a.STAG_STATE.SIDE_ATTACK_LEFT:this.walrusAnimation!==a.STAG_STATE.SIDE_ATTACK_LEFT&&(this.walrusAnimation=a.STAG_STATE.SIDE_ATTACK_LEFT,this.spine.setAnimationByName(0,"hit_side",!1).onComplete=function(){t.onAttackComplete()},this.spine.setToSetupPose());break;case a.STAG_STATE.SIDE_ATTACK_RIGHT:this.walrusAnimation!==a.STAG_STATE.SIDE_ATTACK_RIGHT&&(this.walrusAnimation=a.STAG_STATE.SIDE_ATTACK_RIGHT,this.spine.setAnimationByName(0,"hit_side",!1).onComplete=function(){t.onAttackComplete()},this.spine.setToSetupPose());break;case a.STAG_STATE.STAND_BACK:this.walrusAnimation!==a.STAG_STATE.STAND_BACK&&(this.walrusAnimation=a.STAG_STATE.STAND_BACK,this.spine.setAnimationByName(0,"stand_back",!0),this.spine.setToSetupPose());break;case a.STAG_STATE.STAND_FRONT:this.walrusAnimation!==a.STAG_STATE.STAND_FRONT&&(this.walrusAnimation=a.STAG_STATE.STAND_FRONT,this.spine.setAnimationByName(0,"stand_front",!0),this.spine.setToSetupPose());break;case a.STAG_STATE.STAND_LEFT:this.walrusAnimation!==a.STAG_STATE.STAND_LEFT&&(this.walrusAnimation=a.STAG_STATE.STAND_LEFT,this.spine.setAnimationByName(0,"stand_side",!0),this.spine.setToSetupPose());break;case a.STAG_STATE.STAND_RIGHT:this.walrusAnimation!==a.STAG_STATE.STAND_RIGHT&&(this.walrusAnimation=a.STAG_STATE.STAND_RIGHT,this.spine.setAnimationByName(0,"stand_side",!0),this.spine.setToSetupPose())}},i.prototype.updateDirection=function(){if(!this.attackingBlock)if(this.player.isStand)switch(this.player.direction){case a.DIRECTION.UP:this.direction=a.DIRECTION.UP,this.walrusState=a.STAG_STATE.STAND_BACK;break;case a.DIRECTION.DOWN:this.direction=a.DIRECTION.DOWN,this.walrusState=a.STAG_STATE.STAND_FRONT;break;case a.DIRECTION.LEFT:this.direction=a.DIRECTION.LEFT,this.walrusState=a.STAG_STATE.STAND_LEFT;break;case a.DIRECTION.RIGHT:this.direction=a.DIRECTION.RIGHT,this.walrusState=a.STAG_STATE.STAND_RIGHT}else switch(this.player.direction){case a.DIRECTION.UP:this.direction=a.DIRECTION.UP,this.walrusState=a.STAG_STATE.BACK_WALK;break;case a.DIRECTION.DOWN:this.direction=a.DIRECTION.DOWN,this.walrusState=a.STAG_STATE.FRONT_WALK;break;case a.DIRECTION.LEFT:this.direction=a.DIRECTION.LEFT,this.walrusState=a.STAG_STATE.SIDE_WALK_LEFT;break;case a.DIRECTION.RIGHT:this.direction=a.DIRECTION.RIGHT,this.walrusState=a.STAG_STATE.SIDE_WALK_RIGHT}},i.prototype.attackBlock=function(){switch(this.player.attacking=!0,this.attackingBlock=!0,this.game.ph2AudioManager.playEffect("sound_sealionAttack",!1),this.player.direction){case a.DIRECTION.UP:this.walrusState=a.STAG_STATE.BACK_ATTACK;break;case a.DIRECTION.DOWN:this.walrusState=a.STAG_STATE.FRONT_ATTACK;break;case a.DIRECTION.LEFT:this.walrusState=a.STAG_STATE.SIDE_ATTACK_LEFT;break;case a.DIRECTION.RIGHT:this.walrusState=a.STAG_STATE.SIDE_ATTACK_RIGHT}},i.prototype.onAttackComplete=function(){this.player.attacking=!1,this.attackingBlock=!1,this.direction=null};var n,t=i;function i(t,i,e,s){t=n.call(this,t,i,e)||this;return t.attackingBlock=!1,t.speed=a.SETTINGS.INITIAL_SPEED+.2*a.SETTINGS.INITIAL_SPEED,t.createSpine(),t}a.Stag=t}(Game=Game||{}),function(a){n=a.Mount,__extends(i,n),i.prototype.createSpine=function(){var t,i=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*.3;switch(this.spine=this.game.add.spine(0,i,"skate"),this.bone=this.spine.slotContainers[2].children[0],this.player.direction){case a.DIRECTION.UP:this.skateState=a.MOUNT_STATE.BACK_STAND,t="back_stand";break;case a.DIRECTION.DOWN:this.skateState=a.MOUNT_STATE.FRONT_STAND,t="front_stand";break;case a.DIRECTION.LEFT:case a.DIRECTION.RIGHT:this.skateState=a.MOUNT_STATE.SIDE_STAND,t="side_stand"}this.spine.setAnimationByName(0,t,!0),this.spine.scale.setTo(a.SETTINGS.SCALE),this.spine.setToSetupPose(),this.add(this.spine)},i.prototype.update=function(){n.prototype.update.call(this),this.updateState(),this.updateDirection()},i.prototype.updateState=function(){switch(this.skateState){case a.MOUNT_STATE.BACK:this.skateAnimation!==a.MOUNT_STATE.BACK&&(this.skateAnimation=a.MOUNT_STATE.BACK,this.spine.setAnimationByName(0,"back",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.FRONT:this.skateAnimation!==a.MOUNT_STATE.FRONT&&(this.skateAnimation=a.MOUNT_STATE.FRONT,this.spine.setAnimationByName(0,"front",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.SIDE:this.skateAnimation!==a.MOUNT_STATE.SIDE&&(this.skateAnimation=a.MOUNT_STATE.SIDE,this.spine.setAnimationByName(0,"side",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.SIDE_STAND:this.skateAnimation!==a.MOUNT_STATE.SIDE_STAND&&(this.skateAnimation=a.MOUNT_STATE.SIDE_STAND,this.spine.setAnimationByName(0,"side_stand",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.BACK_STAND:this.skateAnimation!==a.MOUNT_STATE.BACK_STAND&&(this.skateAnimation=a.MOUNT_STATE.BACK_STAND,this.spine.setAnimationByName(0,"back_stand",!0),this.spine.setToSetupPose());break;case a.MOUNT_STATE.FRONT_STAND:this.skateAnimation!==a.MOUNT_STATE.FRONT_STAND&&(this.skateAnimation=a.MOUNT_STATE.FRONT_STAND,this.spine.setAnimationByName(0,"front_stand",!0),this.spine.setToSetupPose())}},i.prototype.updateDirection=function(){if(this.player.isStand)switch(this.player.direction){case a.DIRECTION.UP:this.direction=a.DIRECTION.UP,this.skateState=a.MOUNT_STATE.BACK_STAND;break;case a.DIRECTION.DOWN:this.direction=a.DIRECTION.DOWN,this.skateState=a.MOUNT_STATE.FRONT_STAND;break;case a.DIRECTION.LEFT:this.direction=a.DIRECTION.LEFT,this.skateState=a.MOUNT_STATE.SIDE_STAND;break;case a.DIRECTION.RIGHT:this.direction=a.DIRECTION.RIGHT,this.skateState=a.MOUNT_STATE.SIDE_STAND}else switch(this.player.direction){case a.DIRECTION.UP:this.direction=a.DIRECTION.UP,this.skateState=a.MOUNT_STATE.BACK;break;case a.DIRECTION.DOWN:this.direction=a.DIRECTION.DOWN,this.skateState=a.MOUNT_STATE.FRONT;break;case a.DIRECTION.LEFT:this.direction=a.DIRECTION.LEFT,this.skateState=a.MOUNT_STATE.SIDE;break;case a.DIRECTION.RIGHT:this.direction=a.DIRECTION.RIGHT,this.skateState=a.MOUNT_STATE.SIDE}};var n,t=i;function i(t,i,e,s){t=n.call(this,t,i,e)||this;return t.speed=a.SETTINGS.INITIAL_SPEED+.4*a.SETTINGS.INITIAL_SPEED,t.createSpine(),t}a.Skateboard=t}(Game=Game||{}),function(a){n=a.Weapon,__extends(i,n),i.prototype.createAnimations=function(){var t=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*.3;this.animationBomb=this.game.add.ph2AnimationObject(0,t,"doll_bomb","atlas_weapons0"),this.animationBomb.visible=!1,this.add(this.animationBomb)},i.prototype.update=function(){n.prototype.update.call(this)},i.prototype.useWeapon=function(){var t,i,e,s;switch(n.prototype.useWeapon.call(this),t=this.grid.rowsGroup.length-(s=1),a.SETTINGS.SCALE,a.SETTINGS.CELL_WIDTH,i=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*2,this.gridCell=this.player.gridCell,this.gridPositionX=this.gridCell.gridPositionX,this.gridPositionY=this.gridCell.gridPositionY,this.player.direction){case a.DIRECTION.UP:this.x=this.gridCell.centerX,this.y=this.gridCell.centerY+i,e="doll_bomb_up";break;case a.DIRECTION.DOWN:this.x=this.gridCell.centerX,this.y=this.gridCell.centerY+i,e="doll_bomb_down";break;case a.DIRECTION.LEFT:this.x=this.gridCell.centerX,this.y=this.gridCell.centerY+i,e="doll_bomb_side",s=-1;break;case a.DIRECTION.RIGHT:this.x=this.gridCell.centerX,this.y=this.gridCell.centerY+i,e="doll_bomb_side"}return this.animationBomb.scaleX=s,this.animationBomb.visible=!0,this.grid.rowsGroup[t].add(this),this.checkCells(),(t=this.animationBomb.ph2Animations.play(e,1,!1)).onEvent.add(this.explode,this),t.onComplete.add(this.endExplosion,this),this.game.ph2AudioManager.playEffect("sound_wawa_fire",!1),this.weaponUsed=!0,this.player.weaponActive=!1,this.player.clearWeaponSkin(),this.player.checkNextWeapon(),!0},i.prototype.checkCells=function(){var t,i;switch(this.player.direction){case a.DIRECTION.UP:this.gridPositionY=this.gridPositionY-2;break;case a.DIRECTION.DOWN:this.gridPositionY=this.gridPositionY+2;break;case a.DIRECTION.LEFT:this.gridPositionX=this.gridPositionX-2;break;case a.DIRECTION.RIGHT:this.gridPositionX=this.gridPositionX+2}t=this.gridPositionX,i=this.gridPositionY,0<=t&&t<=a.SETTINGS.GRID_WIDTH-1&&0<=i&&i<=a.SETTINGS.GRID_HEIGHT-1&&this.cellsOnFire.push(this.grid.cells[t][i]),0<=t-1&&t-1<=a.SETTINGS.GRID_WIDTH-1&&(this.cellsOnFire.push(this.grid.cells[t-1][i]),0<=i-1&&i-1<=a.SETTINGS.GRID_HEIGHT-1&&this.cellsOnFire.push(this.grid.cells[t-1][i-1]),i+1<=a.SETTINGS.CELL_HEIGHT-1)&&0<=i+1&&this.cellsOnFire.push(this.grid.cells[t-1][i+1]),t+1<=a.SETTINGS.GRID_WIDTH-1&&0<=t+1&&(this.cellsOnFire.push(this.grid.cells[t+1][i]),0<=i-1&&i-1<=a.SETTINGS.GRID_HEIGHT-1&&this.cellsOnFire.push(this.grid.cells[t+1][i-1]),i+1<=a.SETTINGS.CELL_HEIGHT-1)&&0<=i+1&&this.cellsOnFire.push(this.grid.cells[t+1][i+1]),0<=i-1&&i-1<=a.SETTINGS.GRID_HEIGHT-1&&0<=t&&t<=a.SETTINGS.GRID_WIDTH-1&&this.cellsOnFire.push(this.grid.cells[t][i-1]),i+1<=a.SETTINGS.CELL_HEIGHT-1&&0<=i+1&&0<=t&&t<=a.SETTINGS.GRID_WIDTH-1&&this.cellsOnFire.push(this.grid.cells[t][i+1])},i.prototype.explode=function(){var t,i;if(this.game.ph2AudioManager.playEffect("sound_wawa_exp",!1),0<this.cellsOnFire.length)for(t=0;t<this.cellsOnFire.length;t++)null!=(i=this.cellsOnFire[t])&&(i.dangerOwner=this.player,i.dangerWeapon=!0,i.isDangerCell=!0,!i.isBox&&i.cellContains!==a.MAP.BLOCK||(this.grid.destroyBox(i),this.player.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",a.MISSION.DESTROY_20_BLOCKS_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",a.MISSION.DESTROY_30_BLOCKS),this.grid.gameMode===a.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",a.MISSION.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",a.MISSION.DESTROY_120_BLOCKS_IN_ARCADE))),!i.isItem&&i.cellContains!==a.MAP.ITEM||this.grid.removeItemFromArray(i,!0),i.cellContains===a.MAP.BOMB)&&this.grid.explodeBomb(i)},i.prototype.endExplosion=function(){var t,i;if(this.grid.startLightningShake(),0<this.cellsOnFire.length)for(t=0;t<this.cellsOnFire.length;t++)null!=(i=this.cellsOnFire[t])&&(i.isDangerCell=!1,i.dangerWeapon=!1,i.dangerOwner=null)};var n,t=i;function i(t,i,e,s){t=n.call(this,t,i,e,s)||this;return t.cellsOnFire=[],t.createAnimations(),t}a.DollBomb=t}(Game=Game||{}),function(n){a=n.Weapon,__extends(i,a),i.prototype.createAnimations=function(){var t=n.SETTINGS.SCALE*n.SETTINGS.CELL_HEIGHT*.3;this.animationFlamethrower=this.game.add.ph2AnimationObject(0,t,"flamethrower","atlas_weapons0"),this.animationFlamethrower.visible=!1,this.add(this.animationFlamethrower),this.baseFlamethrower=Ph2.AnimationSystem.findObject("base",this.animationFlamethrower)},i.prototype.update=function(){a.prototype.update.call(this)},i.prototype.useWeapon=function(){var t,i,e,s;switch(a.prototype.useWeapon.call(this),this.gridCell=this.player.gridCell,t=this.player.x,e=this.player.y,s=this.grid.rowsGroup.length-1,this.baseFlamethrower.scaleX=1,this.baseFlamethrower.scaleY=1,this.player.direction){case n.DIRECTION.UP:i="flamethrower_up",this.baseFlamethrower.scaleX=1;break;case n.DIRECTION.DOWN:i="flamethrower_down",this.baseFlamethrower.scaleX=1;break;case n.DIRECTION.LEFT:i="flamethrower_side",this.baseFlamethrower.scaleX=1;break;case n.DIRECTION.RIGHT:i="flamethrower_side",this.baseFlamethrower.scaleX=-1}return this.obtainCellsOnFire(),this.player.attacking=!0,this.animationFlamethrower.visible=!0,this.x=t,this.y=e,this.player.direction===n.DIRECTION.UP?(s=this.player.gridPositionY,this.grid.rowsGroup[s].add(this),this.grid.rowsGroup[s].sendToBack(this)):(this.player.direction===n.DIRECTION.RIGHT&&(this.x=t+n.SETTINGS.SCALE*n.SETTINGS.CELL_WIDTH*.5),this.grid.rowsGroup[s].add(this)),(e=this.animationFlamethrower.ph2Animations.play(i,1,!1)).onComplete.add(this.restartCells,this),e.onEvent.add(this.addCellsOnFire,this),this.game.ph2AudioManager.playEffect("useThrower",!1),this.weaponUsed=!0},i.prototype.obtainCellsOnFire=function(){var t,i,e,s=this.gridCell.gridPositionX,a=this.gridCell.gridPositionY;switch(this.player.direction){case n.DIRECTION.UP:for(t=1;t<=3;t++)0<=a-t&&(e=this.grid.cells[s][a-t]).cellContains!==n.MAP.WALL?this.cellsOnFire.push(e):t=4;break;case n.DIRECTION.DOWN:for(t=1;t<=3;t++)a+t<=n.SETTINGS.GRID_HEIGHT-1&&(e=this.grid.cells[s][a+t]).cellContains!==n.MAP.WALL?this.cellsOnFire.push(e):t=4;break;case n.DIRECTION.LEFT:for(t=1;t<=3;t++)0<=s-t&&(e=this.grid.cells[s-t][a]).cellContains!==n.MAP.WALL?this.cellsOnFire.push(e):t=4;break;case n.DIRECTION.RIGHT:for(t=1;t<=3;t++)s+t<=n.SETTINGS.GRID_WIDTH-1&&(e=this.grid.cells[s+t][a]).cellContains!==n.MAP.WALL?this.cellsOnFire.push(e):t=4}switch(this.cellsOnFire.length){case 0:i=.1;break;case 1:i=.3;break;case 2:i=.6;break;case 3:i=1}this.player.direction===n.DIRECTION.LEFT||this.player.direction===n.DIRECTION.RIGHT?this.player.direction===n.DIRECTION.LEFT?this.baseFlamethrower.scaleX=i:this.baseFlamethrower.scaleX=-i:this.baseFlamethrower.scaleY=i},i.prototype.addCellsOnFire=function(){var t,i;if(!this.weaponDisabled)for(t=0;t<this.cellsOnFire.length;t++)(i=this.cellsOnFire[t]).isDangerCell=!0,i.dangerOwner=this.player,i.dangerWeapon=!0,i.cellContains===n.MAP.BOMB&&this.grid.explodeBomb(i),i.cellContains!==n.MAP.BLOCK&&!i.isBox||(this.grid.destroyBox(i),this.player.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",n.MISSION.DESTROY_20_BLOCKS_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",n.MISSION.DESTROY_30_BLOCKS),this.grid.gameMode===n.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",n.MISSION.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",n.MISSION.DESTROY_120_BLOCKS_IN_ARCADE))),i.cellContains!==n.MAP.ITEM&&!i.isItem||this.grid.removeItemFromArray(i,!0),i.cellContains!==n.MAP.COIN&&!i.isCoin||this.grid.coinPickedUp(i,!0)},i.prototype.playerKilled=function(){a.prototype.playerKilled.call(this),this.animationFlamethrower.ph2Animations.stop(),this.animationFlamethrower.visible=!1,this.weaponUsed&&this.restartCells()},i.prototype.restartCells=function(){for(var t=0;t<this.cellsOnFire.length;t++)this.cellsOnFire[t].isDangerCell=!1,this.cellsOnFire[t].dangerOwner=null,this.cellsOnFire[t].dangerWeapon=!1;this.cellsOnFire=[],this.player.dead||(this.player.attacking=!1,this.player.weaponActive)||(this.player.clearWeaponSkin(),this.player.checkNextWeapon())};var a,t=i;function i(t,i,e,s){t=a.call(this,t,i,e,s)||this;return t.cellsOnFire=[],t.createAnimations(),t}n.Flamethrower=t}(Game=Game||{}),function(r){a=r.Weapon,__extends(i,a),i.prototype.createAnimations=function(){var t=r.SETTINGS.SCALE*r.SETTINGS.CELL_HEIGHT*.3;this.animationHammer=this.game.add.ph2AnimationObject(0,t,"hammer","atlas_weapons1"),this.animationHammer.visible=!1,this.add(this.animationHammer)},i.prototype.update=function(){a.prototype.update.call(this)},i.prototype.useWeapon=function(){var t,i,e,s,a,n,o;switch(this.gridCell=this.player.gridCell,t=this.gridCell.gridPositionX,i=this.gridCell.gridPositionY,a=this.player.spine,this.hitConfirmed=!1,o="gp_hero1"===this.player.keyName?(n="weapon_l","weapon_r_back"):(n="weapon","weapon_right"),this.player.direction){case r.DIRECTION.UP:0<=i-1&&(this.cellHit=this.grid.cells[t][i-1],this.hitConfirmed=!0),e="hammer_up",this.animationHammer.scaleX=1,void 0!==a.skeleton.findSlot(o).sprites&&(this.spriteHammer=a.skeleton.findSlot(o).sprites.hammer_back);break;case r.DIRECTION.DOWN:i+1<r.SETTINGS.GRID_HEIGHT&&(this.cellHit=this.grid.cells[t][i+1],this.hitConfirmed=!0),e="hammer_down",this.animationHammer.scaleX=1,void 0!==a.skeleton.findSlot(n).sprites&&(this.spriteHammer=a.skeleton.findSlot(n).sprites.hammer_front);break;case r.DIRECTION.LEFT:0<=t-1&&(this.cellHit=this.grid.cells[t-1][i],this.hitConfirmed=!0),e="hammer_side",this.animationHammer.scaleX=1,void 0!==a.skeleton.findSlot(n).sprites&&(this.spriteHammer=a.skeleton.findSlot(n).sprites.hammer_side);break;case r.DIRECTION.RIGHT:t+1<r.SETTINGS.GRID_WIDTH&&(this.cellHit=this.grid.cells[t+1][i],this.hitConfirmed=!0),e="hammer_side",this.animationHammer.scaleX=-1,void 0!==a.skeleton.findSlot(n).sprites&&(this.spriteHammer=a.skeleton.findSlot(n).sprites.hammer_side)}return this.player.attacking=!0,this.animationHammer.visible=!0,void 0!==this.spriteHammer&&(this.spriteHammer.visible=!1),this.x=this.player.x,this.y=this.player.y,(this.hitConfirmed?this.grid.rowsGroup[this.cellHit.gridPositionY]:this.grid.rowsGroup[this.gridCell.gridPositionY]).add(this),(s=this.animationHammer.ph2Animations.play(e,1,!1)).onComplete.add(this.restartCell,this),s.onEvent.add(this.onHammerHit,this),this.game.ph2AudioManager.playEffect("useSinker",!1),this.weaponUsed=!0},i.prototype.onHammerHit=function(){void 0!==this.cellHit&&null!==this.cellHit&&(this.hitConfirmed&&!this.weaponDisabled?(this.cellHit.isDangerCell=!0,this.cellHit.dangerOwner=this.player,this.cellHit.dangerWeapon=!0,this.cellHit.cellContains===r.MAP.BOMB&&this.grid.explodeBomb(this.cellHit),this.cellHit.cellContains!==r.MAP.BLOCK&&!this.cellHit.isBox||(this.grid.destroyBox(this.cellHit),this.player.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",r.MISSION.DESTROY_20_BLOCKS_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",r.MISSION.DESTROY_30_BLOCKS),this.grid.gameMode===r.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",r.MISSION.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",r.MISSION.DESTROY_120_BLOCKS_IN_ARCADE))),this.cellHit.cellContains!==r.MAP.ITEM&&!this.cellHit.isItem||this.grid.removeItemFromArray(this.cellHit,!0),this.cellHit.cellContains!==r.MAP.COIN&&!this.cellHit.isCoin||this.grid.coinPickedUp(this.cellHit,!0)):this.cellHit=null)},i.prototype.restartCell=function(){this.player.dead||this.player.weaponActive||(this.player.clearWeaponSkin(),this.player.checkNextWeapon()),void 0!==this.spriteHammer&&(this.spriteHammer.visible=!0),this.player.attacking=!1,this.resetCells()},i.prototype.playerKilled=function(){a.prototype.playerKilled.call(this),void 0!==this.animationHammer&&(this.animationHammer.ph2Animations.stop(),this.animationHammer.visible=!1),this.weaponUsed&&this.restartCell()},i.prototype.resetCells=function(){null!=this.cellHit&&(this.cellHit.isDangerCell=!1,this.cellHit.dangerOwner=null,this.cellHit.dangerWeapon=!1)};var a,t=i;function i(t,i,e,s){t=a.call(this,t,i,e,s)||this;return t.hitConfirmed=!1,t.createAnimations(),t}r.Hammer=t}(Game=Game||{}),function(a){n=a.Weapon,__extends(i,n),i.prototype.createAnimations=function(){this.animationIceGun=this.game.add.ph2AnimationObject(0,0,"ice_gun","atlas_weapons0"),this.animationIceGun.visible=!1,this.add(this.animationIceGun),this.animationIce=this.game.add.ph2AnimationObject(0,0,"ice_gun_fx","atlas_weapons0"),this.animationIce.visible=!1,this.add(this.animationIce)},i.prototype.update=function(){n.prototype.update.call(this),this.grid.gameStatus!==a.GAME_STATUS.GAME_OVER&&this.grid.gameStatus!==a.GAME_STATUS.PAUSED&&this.isFlying&&(this.checkMovement(),this.checkPlayers(),this.grid.gameMode===a.GAME_MODE.ICE_MAN)&&this.checkMonsters()},i.prototype.useWeapon=function(){var t,i=this;switch(n.prototype.useWeapon.call(this),this.direction){case a.DIRECTION.UP:if(0===this.player.gridCell.gridPositionY)return;t=90,this.offsetX=a.SETTINGS.SCALE*a.SETTINGS.CELL_WIDTH*.3,this.scale.x=1;break;case a.DIRECTION.DOWN:if(this.player.gridCell.gridPositionY===a.SETTINGS.GRID_HEIGHT-1)return;t=270,this.offsetX=a.SETTINGS.SCALE*a.SETTINGS.CELL_WIDTH*.3,this.scale.x=1;break;case a.DIRECTION.LEFT:if(0===this.player.gridCell.gridPositionX)return;t=0,this.scale.x=1;break;case a.DIRECTION.RIGHT:if(this.player.gridCell.gridPositionX===a.SETTINGS.GRID_WIDTH-1)return;t=0,this.scale.x=-1}return this.createIceCells(),this.player.attacking=!0,this.animationIce.visible=!0,this.animationIce.angle=t,this.animationIce.ph2Animations.play("ice_gun_fx_anim",1,!0),this.gridCell=this.player.gridCell,this.x=this.gridCell.centerX,this.y=this.gridCell.centerY,this.grid.rowsGroup[this.gridCell.gridPositionY].add(this),this.game.ph2AudioManager.playEffect("sound_snowball",!1),this.game.time.events.add(250,function(){i.player.dead||(i.player.attacking=!1,i.player.weaponActive)||(i.player.clearWeaponSkin(),i.player.checkNextWeapon())},this),!0},i.prototype.createIceCells=function(){var t,i,e;switch(this.isFlying=!0,this.direction){case a.DIRECTION.UP:for(e=0<=this.startingGridY-4?this.startingGridY-4:0,t=this.startingGridY-1;e<=t;t--)this.cellsFlying.push(this.grid.cells[this.startingGridX][t]),this.cellsFlyingContains.push(this.grid.cells[this.startingGridX][t].cellContains);break;case a.DIRECTION.DOWN:for(e=this.startingGridY+4<=a.SETTINGS.GRID_HEIGHT-1?this.startingGridY+4:a.SETTINGS.GRID_HEIGHT-1,t=this.startingGridY+1;t<e;t++)this.cellsFlying.push(this.grid.cells[this.startingGridX][t]),this.cellsFlyingContains.push(this.grid.cells[this.startingGridX][t].cellContains);break;case a.DIRECTION.LEFT:for(i=0<=this.startingGridX-4?this.startingGridX-4:0,t=this.startingGridX-1;i<=t;t--)this.cellsFlying.push(this.grid.cells[t][this.startingGridY]),this.cellsFlyingContains.push(this.grid.cells[t][this.startingGridY].cellContains);break;case a.DIRECTION.RIGHT:for(i=this.startingGridX+4<=a.SETTINGS.GRID_WIDTH-1?this.startingGridX+4:a.SETTINGS.GRID_WIDTH-1,t=this.startingGridX+1;t<i;t++)this.cellsFlying.push(this.grid.cells[t][this.startingGridY]),this.cellsFlyingContains.push(this.grid.cells[t][this.startingGridY].cellContains)}},i.prototype.checkMovement=function(){var t,i,e;switch(this.direction){case a.DIRECTION.LEFT:this.moveIceLeft(),t=this.startingGridX-1,i=this.startingGridY,e=(this.startingGridX-1<=0?this.grid.cells[0]:this.grid.cells[t])[i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*a.SETTINGS.CELL_WIDTH*this.gameScale&&this.updateIceCell(e);break;case a.DIRECTION.RIGHT:this.moveIceRight(),t=this.startingGridX+1,i=this.startingGridY,e=(this.startingGridX+1>=a.SETTINGS.GRID_WIDTH-1?this.grid.cells[a.SETTINGS.GRID_WIDTH-1]:this.grid.cells[t])[i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*a.SETTINGS.CELL_WIDTH*this.gameScale&&this.updateIceCell(e);break;case a.DIRECTION.UP:this.moveIceUp(),t=this.startingGridX,i=this.startingGridY-1,e=this.startingGridY-1<=0?this.grid.cells[t][0]:this.grid.cells[t][i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*a.SETTINGS.CELL_HEIGHT*this.gameScale&&this.updateIceCell(e);break;case a.DIRECTION.DOWN:this.moveIceDown(),t=this.startingGridX,i=this.startingGridY+1,e=this.startingGridY+1>=a.SETTINGS.GRID_HEIGHT-1?this.grid.cells[t][a.SETTINGS.GRID_HEIGHT-1]:this.grid.cells[t][i],Phaser.Math.distance(e.centerX,e.centerY,this.x,this.y)<.5*a.SETTINGS.CELL_HEIGHT*this.gameScale&&this.updateIceCell(e)}},i.prototype.checkPlayers=function(){var t,i;if(this.direction===a.DIRECTION.UP||this.direction===a.DIRECTION.DOWN)for(t=0;t<this.grid.players.length;t++){if((i=this.grid.players[t]).dead||i.frozen)return;i.gridPositionX!==this.startingGridX||this.player===i||i.dead||i.gridPositionY===this.gridCell.gridPositionY&&(i.gridCell=this.gridCell,this.createExplosion())}else if(this.direction===a.DIRECTION.LEFT||this.direction===a.DIRECTION.RIGHT)for(t=0;t<this.grid.players.length;t++){if((i=this.grid.players[t]).dead||i.frozen)return;i.gridPositionY!==this.startingGridY||this.player===i||i.dead||i.gridPositionX===this.gridCell.gridPositionX&&(i.gridCell=this.gridCell,this.createExplosion())}},i.prototype.checkMonsters=function(){var t,i;if(this.direction===a.DIRECTION.UP||this.direction===a.DIRECTION.DOWN)for(t=0;t<this.grid.monsters.length;t++)(i=this.grid.monsters[t]).frozen||i.gridPositionX===this.startingGridX&&i.gridPositionY===this.gridCell.gridPositionY&&(i.gridCell=this.gridCell,this.createExplosion());else if(this.direction===a.DIRECTION.LEFT||this.direction===a.DIRECTION.RIGHT)for(t=0;t<this.grid.monsters.length;t++)(i=this.grid.monsters[t]).frozen||i.gridPositionY===this.startingGridY&&i.gridPositionX===this.gridCell.gridPositionX&&(i.gridCell=this.gridCell,this.createExplosion())},i.prototype.moveIceLeft=function(){this.x<=this.grid.cells[0][this.startingGridY].centerX?this.createExplosion():0!==this.startingGridX&&!this.grid.cells[this.startingGridX-1][this.startingGridY].isEmpty&&this.x-.5*a.SETTINGS.CELL_WIDTH*this.gameScale<=this.grid.cells[this.startingGridX-1][this.startingGridY].right?this.iceCollision(this.grid.cells[this.startingGridX-1][this.startingGridY]):this.x-=this.flyingSpeed*this.gameScale*this.game.time.elapsedMS},i.prototype.moveIceRight=function(){this.x>=this.grid.cells[a.SETTINGS.GRID_WIDTH-1][this.startingGridY].centerX?this.createExplosion():this.startingGridX!==a.SETTINGS.GRID_WIDTH-1&&!this.grid.cells[this.startingGridX+1][this.startingGridY].isEmpty&&this.x+.5*a.SETTINGS.CELL_WIDTH*this.gameScale>=this.grid.cells[this.startingGridX+1][this.startingGridY].left?this.iceCollision(this.grid.cells[this.startingGridX+1][this.startingGridY]):this.x+=this.flyingSpeed*this.gameScale*this.game.time.elapsedMS},i.prototype.moveIceUp=function(){this.y<=this.grid.cells[this.startingGridX][0].centerY?this.createExplosion():0!==this.startingGridY&&!this.grid.cells[this.startingGridX][this.startingGridY-1].isEmpty&&this.y-.5*a.SETTINGS.CELL_HEIGHT*this.gameScale<=this.grid.cells[this.startingGridX][this.startingGridY-1].bottom?this.iceCollision(this.grid.cells[this.startingGridX][this.startingGridY-1]):this.y-=this.flyingSpeed*this.gameScale*this.game.time.elapsedMS},i.prototype.moveIceDown=function(){this.y>=this.grid.cells[this.startingGridX][a.SETTINGS.GRID_HEIGHT-1].centerY?this.createExplosion():this.startingGridY!==a.SETTINGS.GRID_HEIGHT-1&&!this.grid.cells[this.startingGridX][this.startingGridY+1].isEmpty&&this.y+.5*a.SETTINGS.CELL_HEIGHT*this.gameScale>=this.grid.cells[this.startingGridX][this.startingGridY+1].y?this.iceCollision(this.grid.cells[this.startingGridX][this.startingGridY+1]):this.y+=this.flyingSpeed*this.gameScale*this.game.time.elapsedMS},i.prototype.updateIceCell=function(t){0<this.cellsFlying.length&&this.gridCell.gridPositionX===this.cellsFlying[this.cellFlyingIndex].gridPositionX&&this.gridCell.gridPositionY===this.cellsFlying[this.cellFlyingIndex].gridPositionY&&(this.gridCell.cellContains=this.cellsFlyingContains[this.cellFlyingIndex],this.gridCell.isDangerCell=!1,this.cellFlyingIndex++,this.cellFlyingIndex>=this.cellsFlying.length&&this.createExplosion(),this.cellFlyingIndex>=this.cellsFlyingContains.length)&&(this.cellFlyingIndex=this.cellsFlyingContains.length-1),this.gridCell.isEmpty=!0,this.gridCell.gridPositionY!==t.gridPositionY&&this.grid.rowsGroup[t.gridPositionY].add(this),this.isFlying&&(this.startingGridX=t.gridPositionX,this.startingGridY=t.gridPositionY,this.gridCell=t,this.gridCell.isDangerCell=!0,this.gridCell.dangerOwner=this.player,!this.gridCell.isItem&&this.gridCell.cellContains!==a.MAP.ITEM||this.grid.removeItemFromArray(this.gridCell,!0))},i.prototype.iceCollision=function(t){switch(t.cellContains){case a.MAP.BLOCK:this.grid.destroyBox(t),this.player.isAI||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",a.MISSION.DESTROY_20_BLOCKS_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",a.MISSION.DESTROY_30_BLOCKS),this.grid.gameMode===a.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",a.MISSION.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",a.MISSION.DESTROY_120_BLOCKS_IN_ARCADE))),this.createExplosion();break;case a.MAP.BOMB:this.grid.explodeBomb(t),this.createExplosion();break;case a.MAP.WALL:this.createExplosion()}},i.prototype.createExplosion=function(){this.gridCell.isDangerCell=!0,this.gridCell.dangerWeapon=!0,this.gridCell.dangerOwner=this.player,this.game.ph2AudioManager.playEffect("",!1),this.animationIce.ph2Animations.play("ice_gun_fx_end",1,!1).onComplete.add(this.destroyIce,this),this.previousContain=this.gridCell.cellContains,this.isFlying=!1},i.prototype.destroyIce=function(){this.animationIce.ph2Animations.stop(),this.gridCell.cellContains=a.MAP.FREE,this.gridCell.isDangerCell=!1,this.gridCell.isEmpty=!0,this.destroy()};var n,t=i;function i(t,i,e,s){t=n.call(this,t,i,e,s)||this;return t.isFlying=!1,t.activeTimer=0,t.power=1,t.cellFlyingIndex=0,t.cellsFlying=[],t.cellsFlyingContains=[],t.gameScale=a.SETTINGS.SCALE,t.flyingSpeed=.5,t.offsetX=0,t.createAnimations(),t}a.IceGun=t}(Game=Game||{}),function(h){a=h.Weapon,__extends(i,a),i.prototype.createAnimations=function(){var t=h.SETTINGS.SCALE*h.SETTINGS.CELL_HEIGHT*.3;this.animationLaser=this.game.add.ph2AnimationObject(0,t,"lightning_gun","atlas_weapons0"),this.animationLaser.visible=!1,this.add(this.animationLaser)},i.prototype.update=function(){a.prototype.update.call(this)},i.prototype.useWeapon=function(){var t,i,e;switch(a.prototype.useWeapon.call(this),this.gridCell=this.player.gridCell,t=this.player.x,i=this.player.y,this.player.direction){case h.DIRECTION.UP:e="lightning_up";break;case h.DIRECTION.DOWN:e="lightning_down";break;case h.DIRECTION.LEFT:e="lightning_side";break;case h.DIRECTION.RIGHT:e="lightning_side",this.animationLaser.scaleX=-1}return this.obtainLaserCells(),this.player.attacking=!0,this.animationLaser.visible=!0,this.x=t,this.y=i,(this.direction===h.DIRECTION.UP?this.grid.rowsGroup[0]:this.grid.rowsGroup[this.gridCell.gridPositionY]).add(this),this.game.ph2AudioManager.playEffect("useLaserReady",!1),this.animationLaser.ph2Animations.play(e,1,!1).onComplete.add(this.restartCells,this),this.weaponUsed=!0},i.prototype.obtainLaserCells=function(){var t,i,e=this.gridCell.gridPositionX,s=this.gridCell.gridPositionY;switch(this.player.direction){case h.DIRECTION.UP:for(t=s-1;0<=t;t--)((i=this.grid.cells[e][t]).cellContains===h.MAP.WALL||this.createLaserCell(i))&&(t=-1);break;case h.DIRECTION.DOWN:for(t=s+1;t<h.SETTINGS.GRID_HEIGHT;t++)((i=this.grid.cells[e][t]).cellContains===h.MAP.WALL||this.createLaserCell(i))&&(t=h.SETTINGS.GRID_HEIGHT);break;case h.DIRECTION.LEFT:for(t=e-1;0<=t;t--)((i=this.grid.cells[t][s]).cellContains===h.MAP.WALL||this.createLaserCell(i))&&(t=-1);break;case h.DIRECTION.RIGHT:for(t=e+1;t<h.SETTINGS.GRID_WIDTH;t++)((i=this.grid.cells[t][s]).cellContains===h.MAP.WALL||this.createLaserCell(i))&&(t=h.SETTINGS.GRID_WIDTH)}},i.prototype.createLaserCell=function(t){var i,e,s,a,n,o=0===this.laserCells.length,r=!1;switch(t.isDangerCell=!0,t.dangerOwner=this.player,t.dangerWeapon=!0,s=t.centerX,a=t.centerY,n=h.SETTINGS.SCALE*h.SETTINGS.CELL_WIDTH*.25,t.cellContains===h.MAP.BOMB&&this.grid.explodeBomb(t),t.cellContains!==h.MAP.BLOCK&&!t.isBox||(i=r=!0,this.grid.destroyBox(t),this.player.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",h.MISSION.DESTROY_20_BLOCKS_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",h.MISSION.DESTROY_30_BLOCKS),this.grid.gameMode===h.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",h.MISSION.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",h.MISSION.DESTROY_120_BLOCKS_IN_ARCADE))),t.cellContains!==h.MAP.ITEM&&!t.isItem||this.grid.removeItemFromArray(t,!0),t.cellContains!==h.MAP.COIN&&!t.isCoin||this.grid.coinPickedUp(t,!0),this.player.direction){case h.DIRECTION.UP:s+=n;break;case h.DIRECTION.DOWN:s-=n}if(i)switch(this.player.direction){case h.DIRECTION.UP:s+=n,a=t.bottom,e="lightning_edge_up1.png";break;case h.DIRECTION.DOWN:s-=n,a=t.top,e="lightning_edge_back1.png";break;case h.DIRECTION.LEFT:s=t.right,e="lightning_edge_l2.png";break;case h.DIRECTION.RIGHT:s=t.left,e="lightning_edge_r1.png"}else e=this.player.direction===h.DIRECTION.LEFT||this.player.direction===h.DIRECTION.RIGHT?"lightning_tile_h.png":"lightning_tile_v.png",this.player.direction!==h.DIRECTION.RIGHT&&this.player.direction!==h.DIRECTION.LEFT||(a-=h.SETTINGS.SCALE*h.SETTINGS.CELL_HEIGHT*.25);return(i=new Phaser.Sprite(this.game,s,a,"atlas_weapons0",e)).anchor.set(.5),o&&this.scaleFirstCell(i),this.grid.rowsGroup[t.gridPositionY].add(i),this.laserCells.push(t),this.laserSprites.push(i),r},i.prototype.scaleFirstCell=function(t){var i,e;switch(this.player.direction){case h.DIRECTION.UP:i=t.y+.5*t.height,e=Math.abs(this.player.y-i),t.y+=.5*e,t.height+=e;break;case h.DIRECTION.DOWN:i=t.y-.5*t.height,e=Math.abs(this.player.y-i),t.y-=.5*e,t.height+=e;break;case h.DIRECTION.LEFT:i=t.x+.5*t.width,e=Math.abs(this.player.x-i),t.x+=.5*e,t.width+=e;break;case h.DIRECTION.RIGHT:i=t.x-.5*t.width,e=Math.abs(this.player.x-i),t.x-=.5*e,t.width+=e;break;default:i=0}},i.prototype.playerKilled=function(){a.prototype.playerKilled.call(this),this.weaponUsed&&this.restartCells()},i.prototype.restartCells=function(){for(var t=0;t<this.laserCells.length;t++)this.laserCells[t].isDangerCell=!1,this.laserCells[t].dangerWeapon=!1,this.laserCells[t].dangerOwner=null;for(t=this.laserSprites.length-1;0<=t;t--)this.laserSprites[t].destroy(),this.laserSprites.splice(t,1);this.player.weaponActive||(this.player.clearWeaponSkin(),this.player.checkNextWeapon()),this.player.attacking=!1,this.animationLaser.ph2Animations.stop(),this.animationLaser.destroy(!0),this.destroy(!0)};var a,t=i;function i(t,i,e,s){t=a.call(this,t,i,e,s)||this;return t.laserCells=[],t.laserSprites=[],t.createAnimations(),t}h.LaserGun=t}(Game=Game||{}),function(h){a=h.Weapon,__extends(i,a),i.prototype.createAnimations=function(){var t=h.SETTINGS.SCALE*h.SETTINGS.CELL_HEIGHT*.3;this.animationGun=this.game.add.ph2AnimationObject(0,t,"laser_gun_fx2","atlas_weapons0"),this.animationGun.visible=!1,this.add(this.animationGun)},i.prototype.update=function(){a.prototype.update.call(this)},i.prototype.useWeapon=function(){return a.prototype.useWeapon.call(this),this.gridCell=this.player.gridCell,this.player.attacking=!0,this.animationGun.visible=!0,this.x=this.player.x,this.y=this.player.y,this.animationGun.ph2Animations.play("laser_gun_fx2_anim",1,!1).onComplete.add(this.shootLightning,this),this.game.ph2AudioManager.playEffect("sound_lightening",!1),this.grid.rowsGroup[0].add(this),this.obtainUsableCells(),!0},i.prototype.obtainUsableCells=function(){var t,i,e,s,a,n=this.gridCell.gridPositionX,o=this.gridCell.gridPositionY,r=0;switch(this.player.direction){case h.DIRECTION.UP:for(s=0,i=o-1;s<=i;i--){for(e=n+r>=h.SETTINGS.GRID_WIDTH?h.SETTINGS.GRID_WIDTH-1:n+r,t=n-r<0?0:n-r;t<e+1;t++)a=this.grid.cells[t][i],this.usableCells.push(a);r++}break;case h.DIRECTION.DOWN:for(s=h.SETTINGS.GRID_HEIGHT,i=o+1;i<s;i++){for(e=n+r>=h.SETTINGS.GRID_WIDTH?h.SETTINGS.GRID_WIDTH-1:n+r,t=n-r<0?0:n-r;t<e+1;t++)a=this.grid.cells[t][i],this.usableCells.push(a);r++}break;case h.DIRECTION.LEFT:for(e=0,t=n-1;e<=t;t--){for(s=o+r>=h.SETTINGS.GRID_HEIGHT?h.SETTINGS.GRID_HEIGHT-1:o+r,i=o-r<0?0:o-r;i<s+1;i++)a=this.grid.cells[t][i],this.usableCells.push(a);r++}break;case h.DIRECTION.RIGHT:for(e=h.SETTINGS.GRID_WIDTH,t=n+1;t<e;t++){for(s=o+r>=h.SETTINGS.GRID_HEIGHT?h.SETTINGS.GRID_HEIGHT-1:o+r,i=o-r<0?0:o-r;i<s+1;i++)a=this.grid.cells[t][i],this.usableCells.push(a);r++}}this.markRandomCells()},i.prototype.markRandomCells=function(){var t,i,e,s=this.usableCells.length,a=0;if(!(s<=0)){if(s<=6)for(t=0;t<s;t++)(i=this.usableCells[t]).cellContains!==h.MAP.WALL&&this.markedCells.push(i);else for(;a<6;)e=this.game.rnd.integerInRange(0,this.usableCells.length-1),(i=this.usableCells[e]).cellContains!==h.MAP.WALL&&(a++,this.markedCells.push(i),this.usableCells.splice(e,1));this.createMarkedCellsAnimation()}},i.prototype.createMarkedCellsAnimation=function(){for(var t,i,e=this.markedCells.length,s=0;s<e;s++)t=this.markedCells[s],(i=this.game.add.ph2AnimationObject(t.centerX,t.centerY,"laser_gun_fx1","atlas_weapons0")).ph2Animations.play("laser_gun_fx1_anim",1,!0),this.grid.rowsGroup[t.gridPositionY].add(i),this.animationMarkedCells.push(i)},i.prototype.shootLightning=function(){var t,i,e,s,a,n,o,r;if(!this.weaponDisabled){switch(r=h.SETTINGS.SCALE*h.SETTINGS.CELL_WIDTH*.25,h.SETTINGS.SCALE,h.SETTINGS.CELL_HEIGHT,this.player.direction){case h.DIRECTION.UP:r=h.SETTINGS.SCALE*h.SETTINGS.CELL_WIDTH*.25;break;case h.DIRECTION.DOWN:r=-h.SETTINGS.SCALE*h.SETTINGS.CELL_WIDTH*.25;break;case h.DIRECTION.LEFT:r=-h.SETTINGS.SCALE*h.SETTINGS.CELL_WIDTH*.15;break;case h.DIRECTION.RIGHT:r=h.SETTINGS.SCALE*h.SETTINGS.CELL_WIDTH*.15}for(i=this.markedCells.length,o=this.grid.rowsGroup.length-1,t=0;t<i;t++)(e=this.markedCells[t]).isDangerCell=!0,e.dangerOwner=this.player,a=Phaser.Math.angleBetween(this.player.x+r,this.player.y,e.centerX,e.centerY),n=Phaser.Math.distance(this.player.x+r,this.player.y,e.centerX,e.centerY)/621,(s=this.game.add.ph2AnimationObject(e.centerX,e.centerY,"laser_gun_fx3","atlas_weapons0")).scaleY=n,s.rotation=a-1.57,n=s.ph2Animations.play("laser_gun_fx3_anim",1,!1),0===t&&n.onComplete.add(this.destroyGun,this),this.grid.rowsGroup[o].add(s),this.animationMarkedCells[t].visible=!1,e.cellContains===h.MAP.BOMB&&this.grid.explodeBomb(e),e.cellContains!==h.MAP.BLOCK&&!e.isBox||(this.grid.destroyBox(e),this.player.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",h.MISSION.DESTROY_20_BLOCKS_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",h.MISSION.DESTROY_30_BLOCKS),this.grid.gameMode===h.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",h.MISSION.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",h.MISSION.DESTROY_120_BLOCKS_IN_ARCADE))),e.cellContains!==h.MAP.ITEM&&!e.isItem||this.grid.removeItemFromArray(e,!0),e.cellContains!==h.MAP.COIN&&!e.isCoin||this.grid.coinPickedUp(e,!0);this.grid.startLightningShake(),i<=0&&(this.player.attacking=!1)}},i.prototype.playerKilled=function(){var t;for(a.prototype.playerKilled.call(this),this.animationGun.ph2Animations.stop(),this.animationGun.visible=!1,t=0;t<this.animationMarkedCells.length;t++)this.animationMarkedCells[t].ph2Animations.stop(),this.animationMarkedCells[t].visible=!1},i.prototype.destroyGun=function(){for(var t,i=this.markedCells.length,e=0;e<i;e++)(t=this.markedCells[e]).isDangerCell=!1,t.dangerOwner=null;for(e=this.animationMarkedCells.length-1;0<=e;e--)this.animationMarkedCells[e].ph2Animations.stop(),this.animationMarkedCells[e].destroy();this.player.weaponActive||(this.player.clearWeaponSkin(),this.player.checkNextWeapon()),this.player.attacking=!1,this.animationGun.ph2Animations.stop(),this.destroy()};var a,t=i;function i(t,i,e,s){t=a.call(this,t,i,e,s)||this;return t.usableCells=[],t.markedCells=[],t.animationMarkedCells=[],t.createAnimations(),t}h.LightningGun=t}(Game=Game||{}),function(a){n=a.Weapon,__extends(i,n),i.prototype.createAnimations=function(){var t=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*.3;this.animationHammer=this.game.add.ph2AnimationObject(0,t,"mighty_hammer","atlas_weapons1"),this.animationHammer.visible=!1,this.add(this.animationHammer)},i.prototype.update=function(){n.prototype.update.call(this),this.checkShockWaves()},i.prototype.checkShockWaves=function(){this.gameStatus!==a.GAME_STATUS.PAUSED&&this.gameStatus!==a.GAME_STATUS.GAME_OVER&&this.creatingShockWaves&&(this.timerShockWaves+=this.game.time.elapsedMS,this.timerShockWaves>=this.timeWave)&&(this.timerShockWaves=0,this.createShockwave())},i.prototype.useWeapon=function(){var t;switch(n.prototype.useWeapon.call(this),this.direction){case a.DIRECTION.UP:this.animationHammer.scaleX=1,t="mighty_hammer_up";break;case a.DIRECTION.DOWN:this.animationHammer.scaleX=1,t="mighty_hammer_down";break;case a.DIRECTION.LEFT:this.animationHammer.scaleX=1,t="mighty_hammer_side";break;case a.DIRECTION.RIGHT:this.animationHammer.scaleX=-1,t="mighty_hammer_side"}return this.player.attacking=!0,this.gridCell=this.player.gridCell,this.animationHammer.visible=!0,this.x=this.player.x,this.y=this.player.y,this.obtainCells(),this.game.ph2AudioManager.playEffect("sound_TerminalHammer",!1),this.grid.rowsGroup[this.gridCell.gridPositionY].add(this),this.animationHammer.ph2Animations.play(t,1,!1).onEvent.add(this.initShockwave,this),this.weaponUsed=!0},i.prototype.playerKilled=function(){var t;if(n.prototype.playerKilled.call(this),this.grid.stopHammerShake(this.player.playerID),this.animationHammer.ph2Animations.stop(),this.animationHammer.visible=!1,this.weaponUsed)for(t=0;t<this.shockWaves.length;t++)this.shockWaves[t].resetCell()},i.prototype.initShockwave=function(){this.weaponDisabled||(this.shockWaveCells.length<=0?(this.player.attacking=!1,this.player.checkNextWeapon()):(this.creatingShockWaves=!0,this.grid.startHammerShake(this.player.playerID)))},i.prototype.createShockwave=function(){var t,i;this.weaponDisabled||(t=this.currentShockWave===this.shockWaveCells.length-1,i=this.shockWaveCells[this.currentShockWave],t&&(this.player.checkNextWeapon(),this.player.attacking=!1),(i=new a.MightyShockwave(this.game,this.grid,this.player,a.ITEM_TYPE.MIGHTY_HAMMER,this.direction,i,t)).useWeapon(),this.shockWaves.push(i),this.currentShockWave++,this.currentShockWave>=this.shockWaveCells.length&&(this.creatingShockWaves=!1))},i.prototype.obtainCells=function(){var t,i,e,s;switch(this.direction){case a.DIRECTION.UP:for(e=this.gridCell.gridPositionX,t=s=this.gridCell.gridPositionY-1;0<=t;t--)i=this.grid.cells[e][t],this.shockWaveCells.push(i);break;case a.DIRECTION.DOWN:for(e=this.gridCell.gridPositionX,t=s=this.gridCell.gridPositionY+1;t<a.SETTINGS.GRID_HEIGHT;t++)i=this.grid.cells[e][t],this.shockWaveCells.push(i);break;case a.DIRECTION.LEFT:for(e=this.gridCell.gridPositionX-1,s=this.gridCell.gridPositionY,t=e;0<=t;t--)i=this.grid.cells[t][s],this.shockWaveCells.push(i);break;case a.DIRECTION.RIGHT:for(e=this.gridCell.gridPositionX+1,s=this.gridCell.gridPositionY,t=e;t<a.SETTINGS.GRID_WIDTH;t++)i=this.grid.cells[t][s],this.shockWaveCells.push(i)}};var n,t=i;function i(t,i,e,s){t=n.call(this,t,i,e,s)||this;return t.shockWaveCells=[],t.shockWaves=[],t.timeWave=100,t.timerShockWaves=0,t.creatingShockWaves=!1,t.currentShockWave=0,t.createAnimations(),t}a.MightyHammer=t}(Game=Game||{}),function(i){r=i.Weapon,__extends(e,r),e.prototype.createFX=function(){var t=this.direction===i.DIRECTION.LEFT||this.direction===i.DIRECTION.RIGHT?"mighty_hammer_fx1":"mighty_hammer_fx2";this.animationFX=this.game.add.ph2AnimationObject(0,0,t,"atlas_weapons1"),this.animationFX.visible=!1,this.direction===i.DIRECTION.RIGHT&&(this.animationFX.scaleX=-1),this.add(this.animationFX),this.grid.rowsGroup[this.gridPositionY].add(this)},e.prototype.useWeapon=function(){var t;r.prototype.useWeapon.call(this),this.animationFX.visible=!0,this.gridCell.isDangerCell=!0,this.gridCell.dangerWeapon=!0,this.gridCell.dangerOwner=this.player,this.gridCell.cellContains===i.MAP.BOMB&&this.grid.explodeBomb(this.gridCell),this.gridCell.cellContains!==i.MAP.BLOCK&&!this.gridCell.isBox||(this.grid.destroyBox(this.gridCell),this.player.isAI)||(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",i.MISSION.DESTROY_20_BLOCKS_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",i.MISSION.DESTROY_30_BLOCKS),this.grid.gameMode===i.GAME_MODE.ARCADE&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",i.MISSION.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",i.MISSION.DESTROY_120_BLOCKS_IN_ARCADE))),this.gridCell.cellContains!==i.MAP.ITEM&&!this.gridCell.isItem||this.grid.removeItemFromArray(this.gridCell,!0),this.gridCell.cellContains!==i.MAP.COIN&&!this.gridCell.isCoin||this.grid.coinPickedUp(this.gridCell,!0),t=this.direction===i.DIRECTION.LEFT||this.direction===i.DIRECTION.RIGHT?"mighty_hammer_fx1_anim":"mighty_hammer_fx2_anim",this.animationFX.ph2Animations.play(t,1,!1).onComplete.add(this.resetCell,this)},e.prototype.resetCell=function(){this.lastWave&&this.grid.stopHammerShake(this.player.playerID),this.gridCell.isDangerCell=!1,this.gridCell.dangerWeapon=!1,this.gridCell.dangerOwner=null,this.animationFX.ph2Animations.stop(),this.animationFX.destroy(),this.destroy()};var r,t=e;function e(t,i,e,s,a,n,o){t=r.call(this,t,i,e,s)||this;return t.direction=a,t.gridCell=n,t.gridPositionX=n.gridPositionX,t.gridPositionY=n.gridPositionY,t.lastWave=o,t.x=n.centerX,t.y=n.centerY,t.createFX(),t}i.MightyShockwave=t}(Game=Game||{}),function(e){a=e.Tile,__extends(i,a),i.prototype.createAnimation=function(){var t,i;switch(this.direction){case e.DIRECTION.UP:t=0;break;case e.DIRECTION.DOWN:t=180;break;case e.DIRECTION.LEFT:t=270;break;case e.DIRECTION.RIGHT:t=90}this.gridCell.centerX,this.gridCell.bottom,i=Phaser.Animation.generateFrameNames("tile_race_track_up",1,4,".png"),this.animationBooster=new Phaser.Sprite(this.game,0,0,"atlas_gameplay","tile_race_track_up1.png"),this.animationBooster.angle=t,this.animationBooster.anchor.set(.5),this.animationBooster.animations.add("stand",i,15,!0),this.animationBooster.animations.play("stand"),this.add(this.animationBooster),this.grid.rowsGroup[0].add(this)};var a,t=i;function i(t,i,e,s){t=a.call(this,t,e.centerX,e.centerY,i,e)||this;return t.direction=s,t.gridCell.isBooster=!0,(t.gridCell.booster=t).createAnimation(),t}e.Booster=t}(Game=Game||{}),function(t){s=t.Tile,__extends(e,s);var s,i=e;function e(t,i,e){t=s.call(this,t,e.left,e.top,i,e)||this;return t.creamTile=new Phaser.Sprite(t.game,0,0,"atlas_gameplay","tile_cream.png"),t.grid.rowsGroup[0].add(t),t.add(t.creamTile),t}t.Cream=i}(Game=Game||{}),function(a){r=a.Tile,__extends(i,r),i.prototype.getHammockSide=function(){var t=this.palmTree1.gridPositionX,i=this.palmTree1.gridPositionY,e=this.palmTree2.gridPositionX,s=this.palmTree2.gridPositionY;this.gridPositionX===t&&this.gridPositionX===e?this.hammockSide="vertical":this.gridPositionY===i&&this.gridPositionY===s&&(this.hammockSide="horizontal"),this.palmTree1.cellContains=a.MAP.WALL,this.palmTree1.isForcedFreeCell=!1,this.palmTree1.isEmpty=!1,this.palmTree2.cellContains=a.MAP.WALL,this.palmTree2.isForcedFreeCell=!1,this.palmTree2.isEmpty=!1},i.prototype.createHammock=function(){var t="horizontal"===this.hammockSide?"hammock_horizontal":"hammock_vertical",i=a.SETTINGS.SCALE*a.SETTINGS.CELL_WIDTH*.5,e=a.SETTINGS.SCALE*a.SETTINGS.CELL_HEIGHT*.5;this.springAnimation=this.game.add.ph2AnimationObject(i,e,"hammock","atlas_anim"),this.springAnimation.ph2Animations.play(t,1,!1),this.springAnimation.ph2Animations.stop(t,!0),this.addChild(this.springAnimation)},i.prototype.update=function(){r.prototype.update.call(this)},i.prototype.hammockSteppedOn=function(){var t="horizontal"===this.hammockSide?"hammock_horizontal":"hammock_vertical",i=this.chooseRandomCell();return this.springAnimation.ph2Animations.play(t,1,!1).onComplete.add(this.restartUsage,this),i},i.prototype.chooseRandomCell=function(){for(var t,i=[],e=0;e<this.grid.beachLandingCells.length;e++)!(t=this.grid.beachLandingCells[e]).isEmpty&&t.cellContains!==a.MAP.FREE||i.push(t);return _.sample(i)},i.prototype.restartUsage=function(){this.used=!1};var r,t=i;function i(t,i,e,s,a,n,o){t=r.call(this,t,i,e,s,a)||this;return t.used=!1,t.palmTree1=n,t.palmTree2=o,t.grid.rowsGroup[t.gridPositionY].add(t),(t.gridCell.hammock=t).getHammockSide(),t.createHammock(),t}a.Hammock=t}(Game=Game||{}),function(t){a=t.Tile,__extends(e,a),e.prototype.createAnimation=function(){var t,i,e;switch(this.portalColor){case"blue":e="forest_portal_blue";break;case"green":e="forest_portal_green";break;case"yellow":e="forest_portal_yellow";break;default:e="forest_portal_blue"}t=this.gridCell.centerX,i=this.gridCell.bottom,this.animationPortal=this.game.add.ph2AnimationObject(t,i,e,"atlas_anim"),this.animationPortal.ph2Animations.play("forest_portal_stand",1,!0),this.grid.rowsGroup[this.gridCell.gridPositionY].add(this.animationPortal)};var a,i=e;function e(t,i,e,s){t=a.call(this,t,e.left,e.top,i,e)||this;return t.portalColor=s,(t.gridCell.portal=t).gridCell.isPortal=!0,t.createAnimation(),t}t.Portal=i}(Game=Game||{}),function(g){a=g.Tile,__extends(i,a),i.prototype.createRail=function(){var t,i,e,s,a,n,o,r,h,c=0,l=this.gridCell.gridPositionX,m=this.gridCell.gridPositionY,d=0===this.mapNumber?(a=g.SETTINGS.TRACK_HORIZONTAL_1,n=g.SETTINGS.TRACK_VERTICAL_1,o=g.SETTINGS.TRACK_UP_LEFT_1,r=g.SETTINGS.TRACK_UP_RIGHT_1,h=g.SETTINGS.TRACK_DOWN_LEFT_1,g.SETTINGS.TRACK_DOWN_RIGHT_1):(a=g.SETTINGS.TRACK_HORIZONTAL_2,n=g.SETTINGS.TRACK_VERTICAL_2,o=g.SETTINGS.TRACK_UP_LEFT_2,r=g.SETTINGS.TRACK_UP_RIGHT_2,h=g.SETTINGS.TRACK_DOWN_LEFT_2,g.SETTINGS.TRACK_DOWN_RIGHT_2),p=!1;if(!p)for(t=0;t<a.length;t++)if(l===a[t].x&&m===a[t].y){i="tile_race_track_line.png",p=!(c=0);break}if(!p)for(t=0;t<n.length;t++)if(l===n[t].x&&m===n[t].y){i="tile_race_track_line.png",c=90,p=!0;break}if(!p)for(t=0;t<o.length;t++)if(l===o[t].x&&m===o[t].y){i="tile_race_track_corner.png",c=270,p=!0;break}if(!p)for(t=0;t<r.length;t++)if(l===r[t].x&&m===r[t].y){i="tile_race_track_corner.png",p=!(c=0);break}if(!p)for(t=0;t<h.length;t++)if(l===h[t].x&&m===h[t].y){i="tile_race_track_corner.png",c=180,p=!0;break}if(!p)for(t=0;t<d.length;t++)if(l===d[t].x&&m===d[t].y){i="tile_race_track_corner.png",c=90,p=!0;break}e=.5*g.SETTINGS.CELL_WIDTH*g.SETTINGS.SCALE,s=.5*g.SETTINGS.CELL_HEIGHT*g.SETTINGS.SCALE,this.gridCell.isForcedFreeCell=!0,this.gridCell.isEmpty=!0,this.gridCell.cellContains=g.MAP.FREE,this.raceSprite=new Phaser.Sprite(this.game,e,s,"atlas_gameplay",i),this.raceSprite.anchor.set(.5),this.raceSprite.angle=c,this.grid.rowsGroup[0].add(this),this.add(this.raceSprite)};var a,t=i;function i(t,i,e,s){t=a.call(this,t,e.left,e.top,i,e)||this;return t.mapNumber=s,t.createRail(),t}g.RaceTile=t}(Game=Game||{}),function(t){s=t.Tile,__extends(e,s),e.prototype.createWarningClaws=function(){this.warningClawAnimation=this.game.add.ph2AnimationObject(0,0,"alert","atlas_anim"),this.grid.rowsGroup[this.gridPositionY].add(this),this.add(this.warningClawAnimation)},e.prototype.update=function(){s.prototype.update.call(this),this.grid.gameStatus===t.GAME_STATUS.GAME_OVER||this.grid.gameStatus===t.GAME_STATUS.PAUSED||this.isActive||(this.activeTimer+=this.game.time.elapsedMS,this.activeTimer>=this.timeToActivate&&(this.activeTimer=0,this.timeToActivate=1e3*this.game.rnd.integerInRange(4,10),this.activateClaws()))},e.prototype.activateClaws=function(){var t=this;this.isActive=!0,this.gridCell.isDangerCell=!0,this.warningClawAnimation.ph2Animations.play("alert_play",1,!1).onComplete.add(function(){t.isActive=!1,t.gridCell.isDangerCell=!1},this)};var s,i=e;function e(t,i,e){t=s.call(this,t,e.centerX,e.centerY,i,e)||this;return t.isActive=!1,t.activeTimer=0,t.timeToActivate=1e3*t.game.rnd.integerInRange(4,10),(t.gridCell.warningClaw=t).gridCell.isWarningClaw=!0,t.createWarningClaws(),t}t.Warning=i}(Game=Game||{}),function(i){function t(t,i){this.game=t,this.player=i,this.isDesktop=this.game.device.desktop,this.upLeftPressed=!1,this.upRightPressed=!1,this.downLeftPressed=!1,this.downRightPressed=!1,this.isDesktop||(this.createController(),this.game.input.maxPointers=2),this.createInputs()}t.prototype.createController=function(){this.joystickPlugin=this.game.plugins.plugins[this.game.plugins.plugins.length-1],this.stick=this.joystickPlugin.addStick(0,0,200,"arcade"),this.stick.alignBottomLeft(0),this.stick.showOnTouch=!0,this.game.input.onDown.remove(this.stick.checkDown,this.stick),this.game.input.onDown.add(this.checkDown,this)},t.prototype.createInputs=function(){this.isDesktop?(0===this.player.playerID?this.player.playerMode===i.PLAYER_MODE.SINGLE_PLAYER?(this.leftKey=this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT),this.rightKey=this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),this.upKey=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),this.downKey=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN),this.actionKey=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)):this.player.playerMode===i.PLAYER_MODE.MULTI_PLAYER&&(this.leftKey=this.game.input.keyboard.addKey(Phaser.Keyboard.A),this.rightKey=this.game.input.keyboard.addKey(Phaser.Keyboard.D),this.upKey=this.game.input.keyboard.addKey(Phaser.Keyboard.W),this.downKey=this.game.input.keyboard.addKey(Phaser.Keyboard.S),this.actionKey=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)):1===this.player.playerID&&(this.leftKey=this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT),this.rightKey=this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),this.upKey=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),this.downKey=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN),this.actionKey=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER)),this.upKey.onDown.add(this.upKeyPressed,this),this.downKey.onDown.add(this.downKeyPressed,this),this.leftKey.onDown.add(this.leftKeyPressed,this),this.rightKey.onDown.add(this.rightKeyPressed,this),this.upKey.onUp.add(this.upKeyReleased,this),this.downKey.onUp.add(this.downKeyReleased,this),this.leftKey.onUp.add(this.leftKeyReleased,this),this.rightKey.onUp.add(this.rightKeyReleased,this),this.actionKey.onDown.add(this.actionKeyPressed,this)):this.stick.onUp.add(this.clearInputs,this)},t.prototype.checkDown=function(t){this.player.gameStatus!==i.GAME_STATUS.GAME_OVER&&null==t.targetObject&&(t.x<this.game.width/2?this.stick.checkDown(t):this.actionKeyPressed(),t.x<this.game.width/2?this.stick.checkDown(t):this.actionKeyPressed())},t.prototype.checkInput=function(){this.canPressButtons()&&(this.isDesktop||this.checkInputsDPad(),this.checkDirectionInputs(),this.checkInputReleased())},t.prototype.checkDirectionInputs=function(){this.leftPressed&&(this.isDesktop&&(this.actionKey.enabled=!0),this.player.inputLeftPressed(),!this.player.movingAnimation&&this.upLeftPressed?this.player.inputUpPressed():this.upLeftPressed=!1,!this.player.movingAnimation&&this.downLeftPressed?this.player.inputDownPressed():this.downLeftPressed=!1),this.rightPressed&&(this.isDesktop&&(this.actionKey.enabled=!0),this.player.inputRightPressed(),!this.player.movingAnimation&&this.upRightPressed?this.player.inputUpPressed():this.upRightPressed=!1,!this.player.movingAnimation&&this.downRightPressed?this.player.inputDownPressed():this.downRightPressed=!1),this.upPressed&&(this.isDesktop&&(this.actionKey.enabled=!0),this.player.inputUpPressed(),!this.player.movingAnimation&&this.upLeftPressed?this.player.inputLeftPressed():this.upLeftPressed=!1,!this.player.movingAnimation&&this.upRightPressed?this.player.inputRightPressed():this.upRightPressed=!1),this.downPressed&&(this.isDesktop&&(this.actionKey.enabled=!0),this.player.inputDownPressed(),!this.player.movingAnimation&&this.downLeftPressed?this.player.inputLeftPressed():this.downLeftPressed=!1,!this.player.movingAnimation&&this.downRightPressed?this.player.inputRightPressed():this.downRightPressed=!1)},t.prototype.checkInputsDPad=function(){this.stick.isDown?this.stick.force<=.65*i.SETTINGS.SCALE||(2===this.stick.quadrant?(this.rightPressed=!1,this.upPressed=!1,this.downPressed=!1,this.leftPressed=!0,225===this.stick.octant&&(this.upLeftPressed=!0,this.downLeftPressed=!1),135===this.stick.octant&&(this.downLeftPressed=!0,this.upLeftPressed=!1)):0===this.stick.quadrant?(this.leftPressed=!1,this.upPressed=!1,this.downPressed=!1,this.rightPressed=!0,315===this.stick.octant&&(this.upRightPressed=!0,this.downRightPressed=!1),45===this.stick.octant&&(this.downRightPressed=!0,this.upRightPressed=!1)):3===this.stick.quadrant?(this.leftPressed=!1,this.rightPressed=!1,this.downPressed=!1,this.upPressed=!0,225===this.stick.octant&&(this.upLeftPressed=!0,this.upRightPressed=!1),315===this.stick.octant&&(this.upRightPressed=!0,this.upLeftPressed=!1)):1===this.stick.quadrant&&(this.leftPressed=!1,this.rightPressed=!1,this.upPressed=!1,this.downPressed=!0,135===this.stick.octant&&(this.downLeftPressed=!0,this.downRightPressed=!1),45===this.stick.octant)&&(this.downRightPressed=!0,this.downLeftPressed=!1)):(this.leftPressed=!1,this.rightPressed=!1,this.upPressed=!1,this.downPressed=!1,this.player.keyPressed=!1)},t.prototype.checkInputReleased=function(){this.upPressed||this.downPressed||this.leftPressed||this.rightPressed||(this.player.keyPressed=!1,this.player.onStand())},t.prototype.upKeyPressed=function(){this.clearInputs(),this.upPressed=!0},t.prototype.downKeyPressed=function(){this.clearInputs(),this.downPressed=!0},t.prototype.leftKeyPressed=function(){this.clearInputs(),this.leftPressed=!0},t.prototype.rightKeyPressed=function(){this.clearInputs(),this.rightPressed=!0},t.prototype.upKeyReleased=function(){this.upPressed=!1},t.prototype.downKeyReleased=function(){this.downPressed=!1},t.prototype.leftKeyReleased=function(){this.leftPressed=!1},t.prototype.rightKeyReleased=function(){this.rightPressed=!1},t.prototype.actionKeyPressed=function(){this.canPressButtons()&&this.player.actionKeyPressed()},t.prototype.clearInputs=function(){this.upPressed=!1,this.downPressed=!1,this.leftPressed=!1,this.rightPressed=!1,this.upLeftPressed=!1,this.upRightPressed=!1,this.downLeftPressed=!1,this.downRightPressed=!1,this.player.keyPressed=!1},t.prototype.canPressButtons=function(){return this.player.gameStatus!==i.GAME_STATUS.GAME_OVER&&this.player.gameStatus!==i.GAME_STATUS.PAUSED&&!this.player.dead&&!this.player.jumping&&!(this.player.attacking||this.player.losingMount||this.player.stunned||this.player.teleporting||this.player.onCream||this.player.inBooster||this.player.frozen)},i.InputController=t}(Game=Game||{}),function(e){function t(t,i,e,s){this.game=t,this.players=i,this.difficulty=e,this.gameMode=s,this.killScores=[0,0,0,0],this.timeScores=[0,0,0,0],this.starScores=[0,0,0,0],this.coinScores=[0,0,0,0],this.totalScores=[0,0,0,0],this.finalScores=[0,0,0,0],this.game.ph2NotificationManager.addObserver("_ADD_SCORE_KILLS",this.addScoreKills,this),this.game.ph2NotificationManager.addObserver("_ADD_SCORE_COINS",this.addScoreCoins,this),this.game.ph2NotificationManager.addObserver("_ADD_SCORE_STARS",this.addScoreStars,this)}t.prototype.addScoreKills=function(t){var i=0;if(this.gameMode===e.GAME_MODE.ARCADE)switch(this.killScores[t]){case 0:i=600;break;case 600:case 900:i=300;break;default:i=0}else i=e.SETTINGS.POINTS_PER_KILL;this.killScores[t]+=i,this.totalScores[t]+=i},t.prototype.addScoreCoins=function(t){this.coinScores[t]+=e.SETTINGS.POINTS_PER_COIN,this.totalScores[t]+=e.SETTINGS.POINTS_PER_COIN},t.prototype.addScoreStars=function(t){this.starScores[t]+=e.SETTINGS.POINTS_PER_STAR,this.totalScores[t]+=e.SETTINGS.POINTS_PER_STAR},t.prototype.addLeftOverTime=function(t,i){this.timeScores[i]+=Math.floor((e.SETTINGS.MATCH_TIME-t)/100),this.totalScores[i]+=Math.floor((e.SETTINGS.MATCH_TIME-t)/100)},t.prototype.getMaxScore=function(){for(var t,i=0,e=0;e<this.totalScores.length;e++)this.totalScores[e]>i&&(i=this.totalScores[e],t=e);return t},t.prototype.cleanScores=function(){for(var t=0;t<4;t++)this.killScores[t]=0,this.timeScores[t]=0,this.starScores[t]=0,this.coinScores[t]=0,this.totalScores[t]=0},e.ScoreManager=t}(Game=Game||{}),function(t){function i(t){this.game=t}i.prototype.checkGameData=function(){null===this.game.storage.getItem("created")&&this.createData()},i.prototype.createData=function(){this.game.storage.setItem("created",JSON.stringify(!0)),this.game.storage.setItem("language",JSON.stringify("en-US")),this.game.storage.setItem("music",JSON.stringify(!0)),this.game.storage.setItem("audio",JSON.stringify(!0)),this.game.storage.setItem("lives_player_1",JSON.stringify(3)),this.game.storage.setItem("lives_player_2",JSON.stringify(3)),this.game.storage.setItem("player_points",JSON.stringify(3e3)),this.game.storage.setItem("total_stars",JSON.stringify(3e3)),this.game.storage.setItem("current_level",JSON.stringify(1)),this.game.storage.setItem("outfit_player_1",JSON.stringify({face:0,head:0,body:0})),this.game.storage.setItem("outfit_player_2",JSON.stringify({face:0,head:0,body:0})),this.game.storage.setItem("outfit_player_3",JSON.stringify({face:0,head:0,body:0})),this.game.storage.setItem("outfit_player_4",JSON.stringify({face:0,head:0,body:0})),this.game.storage.setItem("characters_chosen",JSON.stringify([0,1,2,3])),this.game.storage.setItem("unlocks",JSON.stringify([{character:0,items:[!1,!1,!1,!1,!1,!1,!1,!1,!1]},{character:1,items:[!1,!1,!1,!1,!1,!1,!1,!1,!1]},{character:2,items:[!1,!1,!1,!1,!1,!1,!1,!1,!1]},{character:3,items:[!1,!1,!1,!1,!1,!1,!1,!1,!1]},{character:4,items:[!1,!1,!1,!1,!1,!1,!1,!1,!1]},{character:5,items:[!1,!1,!1,!1,!1,!1,!1,!1,!1]},{character:6,items:[!1,!1,!1,!1,!1,!1,!1,!1,!1]},{character:7,items:[!1,!1,!1,!1,!1,!1,!1,!1,!1]}])),this.game.storage.setItem("equipped_outfits",JSON.stringify([{face:0,head:0,body:0},{face:0,head:0,body:0},{face:0,head:0,body:0},{face:0,head:0,body:0},{face:0,head:0,body:0},{face:0,head:0,body:0},{face:0,head:0,body:0},{face:0,head:0,body:0}])),this.createMissionData()},i.prototype.createMissionData=function(){for(var t=[],i=0;i<93;i++)t.push({id:0,progress:0,progressArray:[],complete:!1,active:!1});this.game.storage.setItem("missions",JSON.stringify(t)),this.game.storage.setItem("activeMissions",JSON.stringify([]))},i.prototype.saveMissions=function(t){this.game.storage.setItem("missions",JSON.stringify(t))},i.prototype.saveActiveMissions=function(t){this.game.storage.setItem("activeMissions",JSON.stringify(t))},i.prototype.saveLanguage=function(t){this.game.storage.setItem("language",JSON.stringify(t))},i.prototype.saveAudio=function(t){this.game.storage.setItem("audio",JSON.stringify(t))},i.prototype.saveMusic=function(t){this.game.storage.setItem("music",JSON.stringify(t))},i.prototype.savePlayersPoints=function(t){this.game.storage.setItem("player_points",JSON.stringify(t))},i.prototype.saveLivesPlayer1=function(t){this.game.storage.setItem("lives_player_1",JSON.stringify(t))},i.prototype.saveLivesPlayer2=function(t){this.game.storage.setItem("lives_player_2",JSON.stringify(t))},i.prototype.saveCurrentLevel=function(t){this.game.storage.setItem("current_level",JSON.stringify(t))},i.prototype.saveCharactersChosen=function(t){this.game.storage.setItem("characters_chosen",JSON.stringify(t))},i.prototype.saveOutfitPlayer1=function(t){this.game.storage.setItem("outfit_player_1",JSON.stringify(t))},i.prototype.saveOutfitPlayer2=function(t){this.game.storage.setItem("outfit_player_2",JSON.stringify(t))},i.prototype.saveOutfitPlayer3=function(t){this.game.storage.setItem("outfit_player_3",JSON.stringify(t))},i.prototype.saveOutfitPlayer4=function(t){this.game.storage.setItem("outfit_player_4",JSON.stringify(t))},i.prototype.saveEquippedOutfits=function(t){this.game.storage.setItem("equipped_outfits",JSON.stringify(t))},i.prototype.saveUnlocks=function(t){this.game.storage.setItem("unlocks",JSON.stringify(t))},i.prototype.saveMapTheme=function(t){this.game.storage.setItem("map_theme",JSON.stringify(t))},i.prototype.getActiveMissions=function(){return null===this.game.storage.getItem("activeMissions")&&this.game.storage.setItem("activeMissions",JSON.stringify([])),JSON.parse(this.game.storage.getItem("activeMissions"))},i.prototype.getMissions=function(){return null===this.game.storage.getItem("missions")&&this.createMissionData(),JSON.parse(this.game.storage.getItem("missions"))},i.prototype.getLanguage=function(){return JSON.parse(this.game.storage.getItem("language"))},i.prototype.getMusic=function(){return null===JSON.parse(this.game.storage.getItem("music"))&&this.game.storage.setItem("music",JSON.stringify(!0)),JSON.parse(this.game.storage.getItem("music"))},i.prototype.getAudio=function(){return JSON.parse(this.game.storage.getItem("audio"))},i.prototype.getPlayerPoints=function(){return Number(this.game.storage.getItem("player_points"))},i.prototype.getLivesPlayer1=function(){return Number(this.game.storage.getItem("lives_player_1"))},i.prototype.getLivesPlayer2=function(){return Number(this.game.storage.getItem("lives_player_2"))},i.prototype.getCurrentLevel=function(){return Number(this.game.storage.getItem("current_level"))},i.prototype.getCharactersChosen=function(){return JSON.parse(this.game.storage.getItem("characters_chosen"))},i.prototype.getOutfitPlayer1=function(){return JSON.parse(this.game.storage.getItem("outfit_player_1"))},i.prototype.getOutfitPlayer2=function(){return JSON.parse(this.game.storage.getItem("outfit_player_2"))},i.prototype.getOutfitPlayer3=function(){return JSON.parse(this.game.storage.getItem("outfit_player_3"))},i.prototype.getOutfitPlayer4=function(){return JSON.parse(this.game.storage.getItem("outfit_player_4"))},i.prototype.getEquippedOutfits=function(){return JSON.parse(this.game.storage.getItem("equipped_outfits"))},i.prototype.getUnlocks=function(){return JSON.parse(this.game.storage.getItem("unlocks"))},i.prototype.getMapTheme=function(){return JSON.parse(this.game.storage.getItem("map_theme"))},t.DataManager=i}(Game=Game||{}),function(t){function i(t,i){this.game=t,this.language=i,this.jsonKey="localization",this.localizationData=this.game.cache.getJSON(this.jsonKey)[this.language],this.charInitArg="[",this.charEndArg="]",this.specialSymbolArray=[],this.specialSymbolArray.push("<"),this.specialSymbolArray.push(">"),this.specialSymbolArray.push("&"),this.specialSymbolArray.push('"'),this.specialSymbolArray.push("'")}i.prototype.localizeText=function(t,i,e,s){return void 0===s&&(s=!1),t=Ph2.UISystem.findObject(t,i),i=e,s||(i=this.localizationData[e]),t.clearColors(),t.text=i,t=this.checkColorStyle(t)},i.prototype.localizeAnimText=function(t,i,e,s){return void 0===s&&(s=!1),t=Ph2.AnimationSystem.findObject(t,i),i=e,s||(i=this.localizationData[e]),t.clearColors(),t.text=i,t},i.prototype.getStringForKey=function(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];for(var s=this.localizationData[t],a=s.indexOf(this.charInitArg)+1,n=s.indexOf(this.charEndArg),o=0,r=s.substring(a,n);""!==r&&o<i.length;)s=s.split(this.charInitArg+r+this.charEndArg).join(i[o]),o++,a=s.indexOf(this.charInitArg)+1,n=s.indexOf(this.charEndArg),r=s.substring(a,n);return s},i.prototype.addSpriteTo=function(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];for(var s=this.localizationData[t],a=s.indexOf(this.charInitArg)+1,n=s.indexOf(this.charEndArg),o=0,r=s.substring(a,n);""!==r&&o<i.length;)s=s.split(this.charInitArg+r+this.charEndArg).join(i[o]),o++,a=s.indexOf(this.charInitArg)+1,n=s.indexOf(this.charEndArg),r=s.substring(a,n);return s},i.prototype.fitFontSizeUI=function(t,i,e,s,a,n){void 0===s&&(s=-1),void 0===a&&(a=-1),void 0===n&&(n=Constants.MIN_FONT_SIZE_DEFAULT),t=Ph2.UISystem.findObject(t,i),this.fitFontSizeText(t,e,s,a,n)},i.prototype.fitFontSizeText=function(t,i,e,s,a){var n,o,r,h;for(void 0===e&&(e=-1),void 0===a&&(a=Constants.MIN_FONT_SIZE_DEFAULT),0<(s=void 0===s?-1:s)&&(t.fontSize=s),o=t.width,r=t.height,h=t.fontSize;i<o||e<r&&-1!==e;){if((n=parseInt(h.toString().replace("px",""),10)-1)<a){h=n=a,t.fontSize=h;break}h=n,t.fontSize=h,o=t.width,r=t.height}},i.prototype.getLanguage=function(){return this.language},i.prototype.checkColorStyle=function(t){for(var i,e,s,a,n,o,r,h=t.text,c=h.length,l=0;l<c;l++)(i=h.indexOf("<s",0))<0?l=c:(r=h.indexOf("|")+1,o=h.indexOf(">"),r=parseFloat(h.substring(r,o)),s=h.slice(i+3,i+10),e=h.indexOf("s>",1),a=h.substring(i,e+2),n=h.substring(o+1,e-2),l=e+1,h=h.replace(a,n),t.text=t.text.replace(a,n),t.strokeThickness=r,t.addStrokeColor(s,i),c=h.length);for(l=0;l<c;l++)(i=h.indexOf("<c",0))<0?l=c:(s=h.slice(i+3,i+10),e=h.indexOf("c>",1),a=h.substring(i,e+2),n=h.substring(i+11,e-2),l=e+1,h=h.replace(a,n),t.text=t.text.replace(a,n),t.addColor(s,i),c=h.length);return t},t.LocalizationManager=i}(Game=Game||{}),function(a){function t(t){this.game=t,this.missions=[],this.missionsActive=[],this.missionsComplete=[],this.missionsAvailable=[],this.createMissions(),this.loadMissions(),this.obtainMissions(),this.game.ph2NotificationManager.addObserver("_CHECK_MISSION",this.checkMission,this),this.game.ph2NotificationManager.addObserver("_CHECK_POINT_MISSION",this.checkPointMission,this),this.game.ph2NotificationManager.addObserver("_CHECK_AVOID_MISSION",this.checkAvoidMission,this),this.game.ph2NotificationManager.addObserver("_CHANGE_MISSION",this.changeMission,this)}t.prototype.createMissions=function(){for(var t,i=this.game.cache.getJSON("missions").missions,e=0;e<i.length;e++)t=i[e],t=new a.Mission(this.game,t.id,t.requirement,t.reward,t.timer,t.levels,t.avoid,t.name),this.missions.push(t)},t.prototype.loadMissions=function(){for(var t,i,e=a.Instances.DataManager.getMissions(),s=0;s<e.length;s++)i=e[s],(t=this.missions[s]).progress=i.progress,t.complete=i.complete,t.progressArray=i.progressArray,t.active=i.active},t.prototype.obtainMissions=function(){this.checkMissionsActive(),this.checkMissionAvailable(),this.checkMissionsComplete(),this.saveMissions()},t.prototype.saveMissions=function(){for(var t,i=[],e=[],s=0;s<this.missions.length;s++)t={id:(t=this.missions[s]).id,progress:t.progress,progressArray:t.progressArray,complete:t.complete,active:t.active},i.push(t);for(s=0;s<this.missionsActive.length;s++)e.push(this.missionsActive[s].id);a.Instances.DataManager.saveMissions(i),0<=this.missionsActive.length&&a.Instances.DataManager.saveActiveMissions(e)},t.prototype.checkMissionsActive=function(){for(var t=a.Instances.DataManager.getActiveMissions(),i=0;i<t.length;i++)this.missionsActive.push(this.missions[t[i]]);if(this.missionsActive.length<3)for(;this.missionsActive.length<3;)this.startNewMission();t.push(this.missionsActive[0].id),t.push(this.missionsActive[1].id),t.push(this.missionsActive[2].id),a.Instances.DataManager.saveActiveMissions(t)},t.prototype.checkMissionAvailable=function(){for(var t,i=0;i<this.missions.length;i++)(t=this.missions[i]).complete||this.missionsAvailable.push(t)},t.prototype.checkMissionsComplete=function(){for(var t,i=0;i<this.missions.length;i++)(t=this.missions[i]).complete&&this.missionsComplete.push(t)},t.prototype.startNewMission=function(){for(var t,i=0,e=0;e<this.missions.length;e++)this.missions[e].complete&&i++;this.missions.length-i<=3&&this.resetMissions(),t=this.game.rnd.integerInRange(0,this.missions.length-1),(t=this.missions[t]).active||t.complete?this.startNewMission():(t.active=!0,this.missionsActive.push(t))},t.prototype.resetMissions=function(){for(var t,i=0;i<this.missions.length;i++)(t=this.missions[i]).complete&&t.restartMission()},t.prototype.changeMission=function(t){var i=this.missionsActive[t],e=this.game.rnd.integerInRange(0,this.missions.length-1),e=this.missions[e];e.active||e.complete||e.id===i.id?this.changeMission(t):(i.restartMission(),e.active=!0,this.missionsActive[t]=e,this.saveMissions())},t.prototype.completeMission=function(t){var i=this.missionsActive[t],e=this.game.rnd.integerInRange(0,this.missions.length-1),e=this.missions[e];e.active||e.complete||e.id===i.id?this.completeMission(t):(e.active=!0,this.missionsActive[t]=e,this.saveMissions())},t.prototype.checkMission=function(t,i){var e,s,a;for(void 0===i&&(i=0),a=!1,e=0;e<this.missionsActive.length;e++)(s=this.missionsActive[e]).id===t&&(a=!0,e=this.missionsActive.length);a&&s.avoid?s.avoidMissionFailed():a&&!s.complete&&s.checkMissionProgress(i),this.saveMissions()},t.prototype.checkPointMission=function(t,i){for(var e,s=!1,a=0;a<this.missionsActive.length;a++)(e=this.missionsActive[a]).id===t&&(s=!0,a=this.missionsActive.length);s&&!e.complete&&(e.progress+=i,e.checkMissionProgress(0)),this.saveMissions()},t.prototype.checkAvoidMission=function(t){for(var i,e=!1,s=0;s<this.missionsActive.length;s++)(i=this.missionsActive[s]).id===t&&(e=!0,s=this.missionsActive.length);e&&i.avoid&&i.checkAvoidMissionProgress(),this.saveMissions()},t.prototype.getActiveMissions=function(){return this.missionsActive},a.MissionManager=t}(Game=Game||{}),function(o){t=Phaser.State,__extends(e,t),e.prototype.init=function(){var i=this;this.loadPlugins(),this.game.input.maxPointers=1,this.game.canvas.oncontextmenu=function(t){t.preventDefault()},AzerionIntegration.SDK.addListeners(this.game),this.game.device.desktop?(this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.pageAlignHorizontally=!0,this.game.scale.pageAlignVertically=!0,this.game.scale.windowConstraints.right="layout",this.game.scale.windowConstraints.bottom="visual",this.game.ph2UIManager.setCurrentPlatform("desktop")):(this.game.ph2UIManager.setCurrentPlatform("mobile"),this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.fullScreenScaleMode=Phaser.ScaleManager.USER_SCALE,this.setScaling(),window.addEventListener("resize",function(t){return e.mobileResizeCallback(i.game.scale)}),this.game.scale.onSizeChange.add(function(){i.game.width>i.game.height?"landscape"!==Constants.CURRENT_ORIENTATION&&(Constants.CURRENT_ORIENTATION="landscape"):"portrait"!==Constants.CURRENT_ORIENTATION&&(Constants.CURRENT_ORIENTATION="portrait"),i.game.ph2UIManager.events.onGameResize(Constants.CALCULATED_WIDTH,Constants.CALCULATED_HEIGHT),i.game.state.getCurrentState().resize()},this),e.mobileResizeCallback(this.game.scale)),this.game.ph2UIManager.events.onGameResize(Constants.CALCULATED_WIDTH,Constants.CALCULATED_HEIGHT)},e.prototype.loadPlugins=function(){this.game.storage.setNamespace("bombit-7-v1.0.0")},e.mobileResizeCallback=function(t){var i=window.innerWidth,e=window.innerHeight,s=Constants.GAME_WIDTH*o.SETTINGS.SCALE,a=Constants.GAME_HEIGHT*o.SETTINGS.SCALE,n=1;e<i?(n/=e/a,o.SETTINGS.CURRENT_ORIENTATION=o.SCREEN_ORIENTATION.LANDSCAPE):(n/=e/s,o.SETTINGS.CURRENT_ORIENTATION=o.SCREEN_ORIENTATION.PORTRAIT),Constants.CALCULATED_WIDTH=Math.ceil(i*n),Constants.CALCULATED_HEIGHT=Math.ceil(e*n),t.setGameSize(Constants.CALCULATED_WIDTH,Constants.CALCULATED_HEIGHT),t.setUserScale(1/n,1/n)},e.prototype.setScaling=function(){var t=window.innerWidth*this.game.device.pixelRatio;t<window.innerHeight&&(t=window.innerHeight*this.game.device.pixelRatio),o.SETTINGS.SCALE=t<650?.5:1050<t?1:.75},e.prototype.handleCorrect=function(){},e.prototype.handleIncorrect=function(){},e.prototype.create=function(){function t(){i.recursiveUpdateText(i.stage)}var i=this;WebFont.load({custom:{families:["roboto_condensedbold"],urls:["assets/fonts/roboto/roboto_condense-webfont.css"]},active:t,inactive:t}),this.game.state.start("preloaderState")},e.prototype.recursiveUpdateText=function(t){var i=this;t instanceof Phaser.Text&&(t.dirty=!0),t.children&&0<t.children.length&&t.children.forEach(function(t){i.recursiveUpdateText(t)})},e.prototype.preload=function(){this.game.ph2Loader.debug(!0),this.game.load.cacheBuster="undefined"==typeof version?null:version,this.game.load.json("resources","assets/json/resources.json"),this.game.load.json("balance","assets/json/balance.json"),this.game.load.json("localization","assets/json/localization.json"),this.game.load.json("missions","assets/json/missions.json"),this.game.load.atlas("arcade","assets/atlases/joystick/arcade-joystick.png","assets/atlases/joystick/arcade-joystick.json"),this.game.load.atlas("dpad","assets/atlases/joystick/dpad.png","assets/atlases/joystick/dpad.json"),this.game.load.atlas("generic","assets/atlases/joystick/generic-joystick.png","assets/atlases/joystick/generic-joystick.json"),this.game.load.atlas("reward","assets/atlases/reward/atlas-reward-icon.png","assets/atlases/reward/atlas-reward-icon.json"),this.game.load.crossOrigin="anonymous",h5branding.Utils.getBrandingDomain()!==h5branding.BrandingDomain.Neutral&&this.game.load.image("branding_logo",h5branding.Branding.brandingLogoUrl)};var t,i=e;function e(){return t.call(this)||this}o.BootState=i}(Game=Game||{}),function(s){e=Phaser.State,__extends(i,e),i.prototype.init=function(t,i,e){this.gameMode=t,this.difficulty=i,this.playerMode=e,this.selectingPlayer1=!0,this.selectingPlayer2=!1,this.playerCursorIndex1=0,this.playerCursorIndex2=1,this.headPlayer1=0,this.facePlayer1=0,this.bodyPlayer1=0,this.headPlayer2=0,this.facePlayer2=0,this.bodyPlayer2=0,e===s.PLAYER_MODE.SINGLE_PLAYER?this.charactersChosen=[0]:this.charactersChosen=[0,1]},i.prototype.create=function(){this.dataManager=s.Instances.DataManager,this.group=new Phaser.Group(this.game),this.add.existing(this.group),this.gotoGameplay()},i.prototype.selectCharacter=function(){this.selectingPlayer1?this.charactersChosen[0]=void 0:this.selectingPlayer2&&(this.charactersChosen[1]=void 0)},i.prototype.selectHead=function(){this.selectingPlayer1?this.headPlayer1=void 0:this.selectingPlayer2&&(this.headPlayer2=void 0)},i.prototype.selectFace=function(){this.selectingPlayer1?this.facePlayer1=void 0:this.selectingPlayer2&&(this.facePlayer2=void 0)},i.prototype.selectBody=function(){this.selectingPlayer1?this.bodyPlayer1=void 0:this.selectingPlayer2&&(this.bodyPlayer2=void 0)},i.prototype.switchSelection=function(){this.selectingPlayer1=!this.selectingPlayer1,this.selectingPlayer2=!this.selectingPlayer2},i.prototype.gotoGameplay=function(){var t={face:this.facePlayer1,head:this.headPlayer1,body:this.bodyPlayer1},i={face:this.facePlayer2,head:this.headPlayer2,body:this.bodyPlayer2};s.Instances.DataManager.saveOutfitPlayer1(t),s.Instances.DataManager.saveOutfitPlayer2(i),this.game.state.start("gameplayState",!0,!1,this.gameMode,this.difficulty,this.playerMode,this.charactersChosen)};var e,t=i;function i(t){var i=e.call(this)||this;return i.game=t,i}s.CharacterSelectState=t}(Game=Game||{}),function(A){t=Phaser.State,__extends(e,t),e.prototype.init=function(t,i,e,s,a,n,o,r){this.gameMode=t,this.difficulty=i,this.playerMode=e,this.mapTheme=s,this.characters=a,this.totalEnemies=n,this.totalLevels=o,this.gameTimer=0,this.gameStatus=A.GAME_STATUS.PLAYING,this.endGame=null,this.isDesktop=this.game.device.desktop,this.gameScale=A.SETTINGS.SCALE,this.textFeedbackEnabled=[],this.textFeedbackEnabled=[!1,!1,!1,!1,!1],this.textFeedbackTimer=0,this.textFeedbackColor="#c30411",this.scoreManager=void 0!==r?r:null,this.currentOrientation=A.SETTINGS.CURRENT_ORIENTATION,this.levelNumber=A.Instances.DataManager.getCurrentLevel(),this.directionMission1="left",this.directionMission2="left",this.directionMission3="left",this.movingText1=!1,this.movingText2=!1,this.movingText3=!1,this.currentMissionLimitLeft=0,this.currentMissionLimitRight=0,this.missionLimitLeft1=0,this.missionLimitLeft2=0,this.missionLimitLeft3=0,this.missionLimitRight1=0,this.missionLimitRight2=0,this.missionLimitRight3=0},e.prototype.create=function(){var t,i,e=A.SETTINGS.SCALE*A.SETTINGS.CELL_WIDTH*.75,s=A.SETTINGS.SCALE*A.SETTINGS.CELL_HEIGHT;this.currentLevel=A.Instances.DataManager.getCurrentLevel(),this.bgLandscape=this.game.add.sprite(.5*this.game.width,.5*this.game.height,"gameplay_land"),this.bgLandscape.anchor.set(.5),this.bgPortrait=this.game.add.sprite(.5*this.game.width,.5*this.game.height,"gameplay"),this.bgPortrait.anchor.set(.5),this.group=new Phaser.Group(this.game),this.add.existing(this.group),this.uiGameplay=this.game.add.ph2UI("gameplay","atlas_ui_gameplay"),this.uiPause=this.game.add.ph2UI("pause","atlas_missions"),this.overlayPause=new A.Overlay(this.game,.7,"bg_black"),this.overlayGameOver=new A.Overlay(this.game,.7,"bg_black"),this.buttonPause=Ph2.UISystem.findObject("container/pause_button",this.uiGameplay),this.avatarsContainer=Ph2.UISystem.findObject("container",this.uiGameplay),this.gameContainer=Ph2.UISystem.findObject("edge",this.uiGameplay),t=this.gameContainer.width,i=this.gameContainer.height,this.buttonResume=Ph2.UISystem.findObject("pause_button",this.uiPause),this.buttonMainMenu=Ph2.UISystem.findObject("main_menu_button",this.uiPause),this.buttonAudio=Ph2.UISystem.findObject("sound_container/audio_button",this.uiPause),this.buttonMusic=Ph2.UISystem.findObject("sound_container/music_button",this.uiPause),this.characterContainer=Ph2.UISystem.findObject("character",this.uiPause),this.avatar1=Ph2.UISystem.findObject("container/avatar1_container",this.uiGameplay),this.avatar2=Ph2.UISystem.findObject("container/avatar2_container",this.uiGameplay),this.avatar3=Ph2.UISystem.findObject("container/avatar3_container",this.uiGameplay),this.avatar4=Ph2.UISystem.findObject("container/avatar4_container",this.uiGameplay),this.textLevel=Ph2.UISystem.findObject("container/level_container/level",this.uiGameplay),this.textTime=Ph2.UISystem.findObject("container/time_container/time",this.uiGameplay),this.edgeLeft=Ph2.UISystem.findObject("edge/edge_left",this.uiGameplay),this.edgeRight=Ph2.UISystem.findObject("edge/edge_right",this.uiGameplay),this.edgeTop=Ph2.UISystem.findObject("edge/edge_top",this.uiGameplay),this.edgeBot=Ph2.UISystem.findObject("edge/edge_bottom",this.uiGameplay),this.buttonMission1=Ph2.UISystem.findObject("bg/mission1/close",this.uiPause),this.buttonMission2=Ph2.UISystem.findObject("bg/mission2/close",this.uiPause),this.buttonMission3=Ph2.UISystem.findObject("bg/mission3/close",this.uiPause),this.textMission1=Ph2.UISystem.findObject("bg/mission1/description",this.uiPause),this.textMission2=Ph2.UISystem.findObject("bg/mission2/description",this.uiPause),this.textMission3=Ph2.UISystem.findObject("bg/mission3/description",this.uiPause),this.overlayGameOver.kill(),this.overlayPause.kill(),this.uiPause.visible=!1,this.grid=new A.Grid(this.game,this.difficulty,this.gameMode,this.playerMode,this.mapTheme,this.characters,this.totalEnemies),this.grid.x=this.edgeLeft.x+e,this.grid.y=this.edgeTop.bottom+s,this.grid.startingX=this.grid.x,this.grid.startingY=this.grid.y,this.animationContainer=this.game.add.ph2AnimationObject(this.gameContainer.x,this.gameContainer.y,"container","atlas_ui_gameplay"),this.animationContainer.visible=!1,this.gameContainer.add(this.grid),this.containerWidthOffset=this.gameContainer.width-t,this.containerHeightOffset=this.gameContainer.height-i,this.edgeBot.bringToTop(),this.edgeTop.bringToTop(),this.edgeLeft.bringToTop(),this.edgeRight.bringToTop(),this.group.add(this.uiGameplay),this.group.add(this.overlayPause),this.group.add(this.uiPause),this.group.add(this.overlayGameOver),this.group.add(this.animationContainer),this.saveContainerValues(),this.initMusic(),this.createMask(),this.createPlayerAvatars(),this.createScoreManager(),this.createMissionAnimation(),this.addTouchListeners(),this.localizeUI(),this.updateUIs(),this.loadMissions(),this.createMissionsMask(),this.resize(),this.game.ph2NotificationManager.addObserver("_UPDATE_UIS",this.updateUIs,this),this.game.ph2NotificationManager.addObserver("_SHOW_MISSION_COMPLETE",this.showMissionCompleted,this),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_IN_120_SECONDS_IN_FROZEN),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_ARCADE_IN_120_SECONDS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_BATTLE_ROYALE_120_SECONDS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_STAR_COLLECTOR_120_SECONDS),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_IN_PACMAN_IN_120_SECONDS),this.createCheats(),this.cheatWin()},e.prototype.cheatWin=function(){Constants.useCheats&&(this.endGame=A.GAME_END.WIN,this.gameOver())},e.prototype.createMissionAnimation=function(){var t=this.gameContainer.x,i=this.gameContainer.y+.5*this.gameContainer.height;this.animationMissionComplete=this.game.add.ph2AnimationObject(t,i,"mission_completed","atlas_ui_gameplay"),this.animationMissionComplete.visible=!1,this.group.add(this.animationMissionComplete)},e.prototype.createMissionsMask=function(){var t=300*A.SETTINGS.SCALE,i=45*A.SETTINGS.SCALE,e=Ph2.UISystem.findObject("bg/mission1",this.uiPause),s=Ph2.UISystem.findObject("bg/mission2",this.uiPause),a=Ph2.UISystem.findObject("bg/mission3",this.uiPause),n=Ph2.UISystem.findObject("bg/mission1/mission",this.uiPause),o=Ph2.UISystem.findObject("bg/mission2/mission",this.uiPause),r=Ph2.UISystem.findObject("bg/mission3/mission",this.uiPause);this.missionMask1=this.game.add.graphics(this.textMission1.x,this.textMission1.y-.5*i),this.missionMask2=this.game.add.graphics(this.textMission2.x,this.textMission2.y-.5*i),this.missionMask3=this.game.add.graphics(this.textMission3.x,this.textMission3.y-.5*i),this.missionMask1.beginFill(65331),this.missionMask1.drawRect(0,0,t-n.width,i),this.missionMask1.endFill(),this.missionMask2.beginFill(65331),this.missionMask2.drawRect(0,0,t-o.width,i),this.missionMask2.endFill(),this.missionMask3.beginFill(65331),this.missionMask3.drawRect(0,0,t-r.width,i),this.missionMask3.endFill(),e.addChild(this.missionMask1),s.addChild(this.missionMask2),a.addChild(this.missionMask3),this.textMission1.mask=this.missionMask1,this.textMission2.mask=this.missionMask2,this.textMission3.mask=this.missionMask3,this.getMissionLimits()},e.prototype.getMissionLimits=function(){var t,i=10*A.SETTINGS.SCALE,e=300*A.SETTINGS.SCALE,s=Ph2.UISystem.findObject("bg/mission1/mission",this.uiPause),a=Ph2.UISystem.findObject("bg/mission2/mission",this.uiPause),n=Ph2.UISystem.findObject("bg/mission3/mission",this.uiPause);this.textMission1.width>=e-s.width&&(t=this.textMission1.width-(e-s.width),this.missionLimitLeft1=this.textMission1.left-(t+i),this.missionLimitRight1=this.textMission1.x+i),this.textMission2.width>=e-a.width&&(t=this.textMission2.width-(e-a.width),this.missionLimitLeft2=this.textMission2.left-(t+i),this.missionLimitRight2=this.textMission2.x+i),this.textMission3.width>=e-n.width&&(t=this.textMission3.width-(e-n.width),this.missionLimitLeft3=this.textMission3.left-(t+i),this.missionLimitRight3=this.textMission3.x+i)},e.prototype.saveContainerValues=function(){"landscape"===Constants.CURRENT_ORIENTATION?this.containerInitialPortraitY=0:"portrait"===Constants.CURRENT_ORIENTATION&&(this.containerInitialPortraitY=this.gameContainer.y)},e.prototype.initMusic=function(){var t=A.Music.GAMEPLAY.length-1,t=this.game.rnd.integerInRange(0,t);this.currentMusic=A.Music.GAMEPLAY[t],A.Instances.DataManager.getMusic()?this.game.ph2AudioManager.switchMusic(A.Music.GAMEPLAY[t]):this.buttonMusic.setFrames("mm_music_off.png","mm_music_off.png","mm_music.png","mm_music_off.png"),A.Instances.DataManager.getAudio()?this.buttonAudio.setFrames("mm_audio.png","mm_audio.png","mm_audio_off.png","mm_audio.png"):this.buttonAudio.setFrames("mm_audio_off.png","mm_audio_off.png","mm_audio.png","mm_audio_off.png")},e.prototype.createMask=function(){var t,i,e,s=1;"landscape"===Constants.CURRENT_ORIENTATION?s=(this.game.height-2*this.edgeLeft.height)/this.gameContainer.height:"portrait"===Constants.CURRENT_ORIENTATION&&(s=(this.game.width-2*this.edgeLeft.width)/this.gameContainer.width),s=Math.abs(s),t=this.gameContainer.x+this.edgeLeft.left*s,i=this.gameContainer.y+this.edgeTop.top*s,e=(Math.abs(this.edgeLeft.left)+Math.abs(this.edgeRight.right))*s,s=(Math.abs(this.edgeTop.top)+Math.abs(this.edgeBot.bottom))*s,this.gridMask=this.game.add.graphics(t,i-10),this.gridMask.beginFill(16777215),this.gridMask.drawRect(0,0,e,s),this.gridMask.endFill(),this.grid.mask=this.gridMask},e.prototype.createPauseHeroes=function(){this.pauseHero1=this.game.add.spine(150*A.SETTINGS.SCALE,-150*A.SETTINGS.SCALE,"dress_hero1"),this.pauseHero2=this.game.add.spine(150*A.SETTINGS.SCALE,-150*A.SETTINGS.SCALE,"dress_hero2"),this.pauseHero1.createCombinedSkin("outfit","normal0","body1","decor1"),this.pauseHero1.setSkinByName("outfit"),this.pauseHero1.setAnimationByName(0,"face1_front",!0),this.pauseHero1.setAnimationByName(1,"mm",!0),this.pauseHero1.setToSetupPose(),this.pauseHero1.scale.setTo(A.SETTINGS.SCALE),this.pauseHero2.createCombinedSkin("outfit","normal0","body3","head3"),this.pauseHero2.setSkinByName("outfit"),this.pauseHero2.setAnimationByName(0,"anim_face",!0),this.pauseHero2.setAnimationByName(1,"mm",!0),this.pauseHero2.setToSetupPose(),this.pauseHero2.scale.setTo(A.SETTINGS.SCALE),this.characterContainer.add(this.pauseHero1),this.characterContainer.add(this.pauseHero2)},e.prototype.createPlayerAvatars=function(){for(var t,i,e=[],s=0;s<this.characters.length;s++){switch(this.characters[s]){case 0:t="avatar_container1.png";break;case 1:t="avatar_container2.png";break;case 2:t="avatar_container3.png";break;case 3:t="avatar_container4.png";break;case 4:t="avatar_container5.png";break;case 5:t="avatar_container6.png";break;case 6:t="avatar_container7.png";break;case 7:t="avatar_container8.png";break;default:t="avatar_container1.png"}e.push(t)}switch(this.avatar1.frameName=e[0],this.avatar2.frameName=e[1],this.avatar3.frameName=e[2],this.avatar4.frameName=e[3],this.textLivesPlayer1=Ph2.UISystem.findObject("container/avatar1_container/avatar1_life",this.uiGameplay),this.textBombsPlayer1=Ph2.UISystem.findObject("container/avatar1_container/avatar1_bomb",this.uiGameplay),this.textPowerPlayer1=Ph2.UISystem.findObject("container/avatar1_container/avatar1_power_blast",this.uiGameplay),this.textSpeedPlayer1=Ph2.UISystem.findObject("container/avatar1_container/avatar1_speed",this.uiGameplay),this.textScorePlayer1=Ph2.UISystem.findObject("container/avatar1_container/avatar1_score",this.uiGameplay),this.iconModePlayer1=Ph2.UISystem.findObject("container/avatar1_container/avatar1_icon_mode",this.uiGameplay),this.textLivesPlayer2=Ph2.UISystem.findObject("container/avatar2_container/avatar2_life",this.uiGameplay),this.textBombsPlayer2=Ph2.UISystem.findObject("container/avatar2_container/avatar2_bomb",this.uiGameplay),this.textPowerPlayer2=Ph2.UISystem.findObject("container/avatar2_container/avatar2_power_blast",this.uiGameplay),this.textSpeedPlayer2=Ph2.UISystem.findObject("container/avatar2_container/avatar2_speed",this.uiGameplay),this.textScorePlayer2=Ph2.UISystem.findObject("container/avatar2_container/avatar2_score",this.uiGameplay),this.iconModePlayer2=Ph2.UISystem.findObject("container/avatar2_container/avatar2_icon_mode",this.uiGameplay),this.textLivesPlayer3=Ph2.UISystem.findObject("container/avatar3_container/avatar3_life",this.uiGameplay),this.textBombsPlayer3=Ph2.UISystem.findObject("container/avatar3_container/avatar3_bomb",this.uiGameplay),this.textPowerPlayer3=Ph2.UISystem.findObject("container/avatar3_container/avatar3_power_blast",this.uiGameplay),this.textSpeedPlayer3=Ph2.UISystem.findObject("container/avatar3_container/avatar3_speed",this.uiGameplay),this.textScorePlayer3=Ph2.UISystem.findObject("container/avatar3_container/avatar3_score",this.uiGameplay),this.iconModePlayer3=Ph2.UISystem.findObject("container/avatar3_container/avatar3_icon_mode",this.uiGameplay),this.textLivesPlayer4=Ph2.UISystem.findObject("container/avatar4_container/avatar4_life",this.uiGameplay),this.textBombsPlayer4=Ph2.UISystem.findObject("container/avatar4_container/avatar4_bomb",this.uiGameplay),this.textPowerPlayer4=Ph2.UISystem.findObject("container/avatar4_container/avatar4_power_blast",this.uiGameplay),this.textSpeedPlayer4=Ph2.UISystem.findObject("container/avatar4_container/avatar4_speed",this.uiGameplay),this.textScorePlayer4=Ph2.UISystem.findObject("container/avatar4_container/avatar4_score",this.uiGameplay),this.iconModePlayer4=Ph2.UISystem.findObject("container/avatar4_container/avatar4_icon_mode",this.uiGameplay),this.gameMode){case A.GAME_MODE.ARCADE:i="icon1.png";break;case A.GAME_MODE.BATTLE_ROYALE:i="icon2.png";break;case A.GAME_MODE.NEW_PACMAN:i="icon5.png";break;case A.GAME_MODE.ICE_MAN:i="icon2.png";break;case A.GAME_MODE.STAR_COLLECTOR:i="icon6.png";break;default:i="icon1.png"}this.grid.players.length<=2&&(this.avatar3.visible=!1,this.avatar3.visibility.enable(!1),this.avatar4.visible=!1,this.avatar4.visibility.enable(!1)),this.grid.players.length<=3&&(this.avatar4.visible=!1,this.avatar4.visibility.enable(!1)),this.iconModePlayer1.frameName=i,this.iconModePlayer2.frameName=i,this.iconModePlayer3.frameName=i,this.iconModePlayer4.frameName=i,this.gameMode===A.GAME_MODE.NEW_PACMAN&&(this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER&&(this.iconModePlayer2.frameName="icon4.png"),this.iconModePlayer3.frameName="icon4.png",this.iconModePlayer4.frameName="icon4.png")},e.prototype.createScoreManager=function(){null===this.scoreManager&&(this.scoreManager=new A.ScoreManager(this.game,this.grid.players,this.difficulty,this.gameMode))},e.prototype.addTouchListeners=function(){this.buttonAudio.onInputDown.add(this.switchAudio,this),this.buttonMusic.onInputDown.add(this.switchMusic,this),this.buttonPause.onInputDown.add(this.pausePressed,this),this.buttonResume.onInputDown.add(this.pausePressed,this),this.buttonMainMenu.onInputDown.add(this.gotoMainMenu,this),this.buttonResume.onInputOut.add(this.buttonInputOut,this),this.buttonMainMenu.onInputOut.add(this.buttonInputOut,this),this.buttonResume.onInputOver.add(this.buttonInputOver,this),this.buttonMainMenu.onInputOver.add(this.buttonInputOver,this),this.buttonMission1.onInputUp.add(this.changeMission,this),this.buttonMission2.onInputUp.add(this.changeMission,this),this.buttonMission3.onInputUp.add(this.changeMission,this),this.textMission1.inputEnabled=!0,this.textMission2.inputEnabled=!0,this.textMission3.inputEnabled=!0},e.prototype.localizeUI=function(){this.textLevel.setText(this.currentLevel.toString()+" / "+this.totalLevels.toString()),this.textTime.setText("180"),A.Instances.LocalizationManager.localizeText("container/level_container/level_text",this.uiGameplay,"level"),A.Instances.LocalizationManager.localizeText("container/time_container/time_text",this.uiGameplay,"time"),A.Instances.LocalizationManager.localizeText("container/pause_button/pause_text",this.uiGameplay,"gp_pause"),A.Instances.LocalizationManager.localizeText("pause_button/text",this.uiPause,"gp_resume"),A.Instances.LocalizationManager.localizeText("main_menu_button/text",this.uiPause,"main_menu")},e.prototype.loadMissions=function(){var t=A.Instances.MissionManager.missionsActive[0],i=A.Instances.MissionManager.missionsActive[1],e=A.Instances.MissionManager.missionsActive[2],s=t.progress+"/"+t.requirement,a=i.progress+"/"+i.requirement,n=e.progress+"/"+e.requirement;A.Instances.LocalizationManager.localizeText("bg/mission1/description",this.uiPause,t.name),A.Instances.LocalizationManager.localizeText("bg/mission1/mission",this.uiPause,s,!0),A.Instances.LocalizationManager.localizeText("bg/mission1/score",this.uiPause,t.reward.toString(),!0),A.Instances.LocalizationManager.localizeText("bg/mission2/description",this.uiPause,i.name),A.Instances.LocalizationManager.localizeText("bg/mission2/mission",this.uiPause,a,!0),A.Instances.LocalizationManager.localizeText("bg/mission2/score",this.uiPause,i.reward.toString(),!0),A.Instances.LocalizationManager.localizeText("bg/mission3/description",this.uiPause,e.name),A.Instances.LocalizationManager.localizeText("bg/mission3/mission",this.uiPause,n,!0),A.Instances.LocalizationManager.localizeText("bg/mission3/score",this.uiPause,e.reward.toString(),!0),Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiPause).visible=t.complete,Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiPause).visible=i.complete,Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiPause).visible=e.complete,Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiPause).visibility.enable(!1),Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiPause).visibility.enable(!1),Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiPause).visibility.enable(!1)},e.prototype.pausePressed=function(){var t=this;this.gameStatus===A.GAME_STATUS.PLAYING?this.pauseGame():this.gameStatus===A.GAME_STATUS.PAUSED&&AzerionIntegration.SDK.showInterstitialAd("resume",function(){t.unpauseGame()})},e.prototype.pauseGame=function(){this.loadMissions(),this.game.ph2AudioManager.playEffect("menuPress",!1),this.gameStatus=A.GAME_STATUS.PAUSED,this.grid.gameStatus=A.GAME_STATUS.PAUSED,this.uiPause.visible=!0,this.overlayPause.revive(),this.grid.pauseGrid()},e.prototype.unpauseGame=function(){this.stopMovingMissionText(this.textMission1),this.stopMovingMissionText(this.textMission2),this.stopMovingMissionText(this.textMission3),this.game.ph2AudioManager.playEffect("menuPress",!1),this.gameStatus=A.GAME_STATUS.PLAYING,this.grid.gameStatus=A.GAME_STATUS.PLAYING,this.uiPause.visible=!1,this.overlayPause.kill(),this.grid.resumeGrid()},e.prototype.checkMissionText=function(t){var i,e=Ph2.UISystem.findObject("bg/mission1/mission",this.uiPause),s=Ph2.UISystem.findObject("bg/mission2/mission",this.uiPause),a=Ph2.UISystem.findObject("bg/mission3/mission",this.uiPause);switch(t.parent.name){case"mission1":i=300*A.SETTINGS.SCALE-e.width;break;case"mission2":i=300*A.SETTINGS.SCALE-s.width;break;case"mission3":i=300*A.SETTINGS.SCALE-a.width}if(t.width>i)switch(t.width,t.parent.name){case"mission1":this.movingText1=!0;break;case"mission2":this.movingText2=!0;break;case"mission3":this.movingText3=!0}else switch(t.parent.name){case"mission1":this.movingText1=!1;break;case"mission2":this.movingText2=!1;break;case"mission3":this.movingText3=!1}},e.prototype.stopMovingMissionText=function(t){switch(t.parent.name){case"mission1":this.movingText1=!1;break;case"mission2":this.movingText2=!1;break;case"mission3":this.movingText3=!1;break;default:this.movingText1=!1,this.movingText2=!1,this.movingText3=!1}},e.prototype.changeMission=function(t){var i,e,s=this,t=t.parent.name;switch(t){case"mission1":i=0,e=this.buttonMission1;break;case"mission2":i=1,e=this.buttonMission2;break;case"mission3":i=2,e=this.buttonMission3;break;default:return}e.inputEnabled=!1,t=Ph2.UISystem.findObject("bg/"+t,this.uiPause),A.Instances.MissionManager.changeMission(i),this.game.add.tween(t).to({alpha:0},500,"Linear",!0).onComplete.add(function(){s.onMissionFadeComplete(i)},this)},e.prototype.onMissionFadeComplete=function(t){var i,e,s=Ph2.UISystem.findObject("bg/mission1/mission",this.uiPause),a=Ph2.UISystem.findObject("bg/mission2/mission",this.uiPause),n=Ph2.UISystem.findObject("bg/mission3/mission",this.uiPause),o=10*A.SETTINGS.SCALE,r=300*A.SETTINGS.SCALE,h="mission"+(t+1),t=A.Instances.MissionManager.missionsActive[t],c=t.progress+"/"+t.requirement,l=Ph2.UISystem.findObject("bg/"+h,this.uiPause);switch(Ph2.UISystem.findObject("bg/"+h+"/description",this.uiPause).x=-192.5*A.SETTINGS.SCALE,A.Instances.LocalizationManager.localizeText("bg/"+h+"/description",this.uiPause,t.name),A.Instances.LocalizationManager.localizeText("bg/"+h+"/mission",this.uiPause,c,!0),A.Instances.LocalizationManager.localizeText("bg/"+h+"/score",this.uiPause,t.reward.toString(),!0),h){case"mission1":i=this.buttonMission1,this.textMission1.width>=r-s.width&&(e=this.textMission1.width-(r-s.width),this.textMission1.x=-192.5*A.SETTINGS.SCALE,this.missionLimitLeft1=this.textMission1.left-(e+o),this.missionLimitRight1=this.textMission1.x+o,this.missionMask1.width=r-s.width);break;case"mission2":i=this.buttonMission2,this.textMission2.width>=r-a.width&&(e=this.textMission2.width-(r-a.width),this.textMission2.x=-192.5*A.SETTINGS.SCALE,this.missionLimitLeft2=this.textMission2.left-(e+o),this.missionLimitRight2=this.textMission2.x+o,this.missionMask2.width=r-a.width);break;case"mission3":i=this.buttonMission3,this.textMission3.width>=r-n.width&&(e=this.textMission3.width-(r-n.width),this.textMission3.x=-192.5*A.SETTINGS.SCALE,this.missionLimitLeft3=this.textMission3.left-(e+o),this.missionLimitRight3=this.textMission3.x+o,this.missionMask3.width=r-n.width);break;default:return}this.game.add.tween(l).to({alpha:1},500,"Linear",!0).onComplete.add(function(){i.inputEnabled=!0,i.input.useHandCursor=!0},this)},e.prototype.showMissionCompleted=function(t){var i;this.animationMissionComplete.visible=!0,this.animationMissionComplete.ph2Animations.play("mission_completed_in",1,!1),t=A.Instances.LocalizationManager.getStringForKey(t.name),null!==(i=Ph2.AnimationSystem.findObject("base/description",this.animationMissionComplete))&&i.setText(t)},e.prototype.switchAudio=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),A.Instances.DataManager.getAudio()?(this.game.ph2AudioManager.switchSfxState(),A.Instances.DataManager.saveAudio(!1),this.buttonAudio.setFrames("mm_audio_off.png","mm_audio_off.png","mm_audio.png","mm_audio_off.png")):(this.game.ph2AudioManager.switchSfxState(),A.Instances.DataManager.saveAudio(!0),this.buttonAudio.setFrames("mm_audio.png","mm_audio.png","mm_audio_off.png","mm_audio.png"))},e.prototype.switchMusic=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),A.Instances.DataManager.getMusic()?(this.game.ph2AudioManager.switchMusicState(),this.game.ph2AudioManager.stopMusic(),A.Instances.DataManager.saveMusic(!1),this.buttonMusic.setFrames("mm_music_off.png","mm_music_off.png","mm_music.png","mm_music_off.png")):(this.game.ph2AudioManager.switchMusicState(),this.game.ph2AudioManager.playMusic(this.currentMusic),A.Instances.DataManager.saveMusic(!0),this.buttonMusic.setFrames("mm_music.png","mm_music.png","mm_music_off.png","mm_music.png"))},e.prototype.checkGameOver=function(){if(this.gameStatus!==A.GAME_STATUS.GAME_OVER)switch(this.checkTime(),this.gameMode){case A.GAME_MODE.ARCADE:this.checkPlayersArcade();break;case A.GAME_MODE.BATTLE_ROYALE:this.checkPlayersBattleRoyale();break;case A.GAME_MODE.STAR_COLLECTOR:this.checkPlayersStarCollector();break;case A.GAME_MODE.ICE_MAN:this.checkPlayersIceman();break;case A.GAME_MODE.NEW_PACMAN:this.checkPlayersPacman()}},e.prototype.checkTime=function(){var t;this.gameStatus===A.GAME_STATUS.PLAYING&&(this.gameTimer+=this.game.time.elapsedMS,t=A.SETTINGS.MATCH_TIME-this.gameTimer,t=Math.floor(t/1e3),this.gameTimer>=A.SETTINGS.MATCH_TIME?(this.textTime.setText("0"),this.gameOver()):this.textTime.setText(t.toString()),this.gameTimer>=A.SETTINGS.MATCH_TIME-1e4)&&(this.textFeedbackEnabled[4]=!0)},e.prototype.checkPlayersArcade=function(){var t,i,e;if(this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER)if(this.grid.players[0].deathComplete)this.endGame=A.GAME_END.LOSE,this.gameOver();else{for(i=!0,e=this.grid.players,t=1;t<e.length;t++)e[t].deathComplete||(i=!1);i&&(this.endGame=A.GAME_END.WIN,this.gameOver())}else if(this.playerMode===A.PLAYER_MODE.MULTI_PLAYER)if(this.grid.players[0].deathComplete&&this.grid.players[1].deathComplete)this.endGame=A.GAME_END.LOSE,this.gameOver();else{for(i=!0,e=this.grid.players,t=2;t<e.length;t++)e[t].deathComplete||(i=!1);i&&(this.endGame=A.GAME_END.WIN,this.gameOver())}},e.prototype.checkPlayersBattleRoyale=function(){for(var t=this.grid.players.length,i=0;i<t;i++)10<=this.grid.players[i].totalKills&&(this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.endGame=0===i?A.GAME_END.WIN:A.GAME_END.LOSE:this.endGame=0===i||1===i?A.GAME_END.WIN:A.GAME_END.LOSE,this.gameOver())},e.prototype.checkPlayersIceman=function(){for(var t=this.grid.players.length,i=0;i<t;i++)10<=this.grid.players[i].totalFreeze&&(this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.endGame=0===i?A.GAME_END.WIN:A.GAME_END.LOSE:this.endGame=0===i||1===i?A.GAME_END.WIN:A.GAME_END.LOSE,this.gameOver())},e.prototype.checkPlayersStarCollector=function(){for(var t=this.grid.players.length,i=0;i<t;i++)5<=this.grid.players[i].totalStars&&(this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.endGame=0===i?A.GAME_END.WIN:A.GAME_END.LOSE:this.endGame=0===i||1===i?A.GAME_END.WIN:A.GAME_END.LOSE,this.gameOver())},e.prototype.checkPlayersPacman=function(){this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.grid.players[0].deathComplete?(this.endGame=A.GAME_END.LOSE,this.gameOver()):100<=this.grid.players[0].totalCoins&&(this.endGame=A.GAME_END.WIN,this.gameOver()):this.grid.players[0].deathComplete&&this.grid.players[1].deathComplete?(this.endGame=A.GAME_END.LOSE,this.gameOver()):(100<=this.grid.players[0].totalCoins||100<=this.grid.players[1].totalCoins)&&(this.endGame=A.GAME_END.WIN,this.gameOver())},e.prototype.gameOver=function(){var t,i,e,s,a,n,o,r,h,c,l,m=this,d=!1,p=!1;if(this.gameMode===A.GAME_MODE.ICE_MAN)for(t=0;t<this.grid.players.length;t++)for(i=0;i<this.grid.players[t].totalFreeze;i++)this.game.ph2NotificationManager.postNotification("_ADD_SCORE_KILLS",this.grid.players[t].playerID);if(this.gameTimer<A.SETTINGS.MATCH_TIME)this.endGame===A.GAME_END.WIN&&(this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.scoreManager.addLeftOverTime(this.gameTimer,this.grid.players[0].playerID):(this.scoreManager.addLeftOverTime(this.gameTimer,this.grid.players[0].playerID),this.scoreManager.addLeftOverTime(this.gameTimer,this.grid.players[1].playerID)));else switch(p=!0,this.gameMode){case A.GAME_MODE.ARCADE:this.checkArcadeScores();break;case A.GAME_MODE.BATTLE_ROYALE:this.checkBattleRoyaleScores();break;case A.GAME_MODE.NEW_PACMAN:this.checkNewPacmanScore();break;case A.GAME_MODE.ICE_MAN:this.checkIceManScore();break;case A.GAME_MODE.STAR_COLLECTOR:this.checkStarCollectorScore()}for(this.gameTimer=0,this.gameStatus=A.GAME_STATUS.GAME_OVER,this.game.ph2AnimationManager.stopAll(),t=0;t<this.grid.players.length;t++)this.grid.players[t].gameStatus=A.GAME_STATUS.GAME_OVER;if(this.endGame===A.GAME_END.LOSE&&this.gameMode!==A.GAME_MODE.ARCADE&&(this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.grid.players[0].lives--:(this.grid.players[0].lives--,this.grid.players[1].lives--)),this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?(d=this.grid.players[0].lives<=0,A.Instances.DataManager.saveLivesPlayer1(this.grid.players[0].lives)):((d=this.grid.players[0].lives<=0&&this.grid.players[1].lives<=0)||(this.grid.players[0].lives<=0?this.grid.players[0].lives=1:this.grid.players[1].lives<=0&&(this.grid.players[1].lives=1)),A.Instances.DataManager.saveLivesPlayer1(this.grid.players[0].lives),A.Instances.DataManager.saveLivesPlayer2(this.grid.players[1].lives)),p)switch(A.Instances.DataManager.getLanguage()){case"en-US":e="pause_time.png";break;case"es-ES":e="pause_time_esp.png";break;case"nl-NL":e="pause_time_dutch.png";break;default:e="pause_time.png"}else if(this.endGame===A.GAME_END.WIN)switch(A.Instances.DataManager.getLanguage()){case"en-US":e="pause_win.png";break;case"es-ES":e="pause_win_esp.png";break;case"nl-NL":e="pause_win_dutch.png";break;default:e="pause_win.png"}else switch(A.Instances.DataManager.getLanguage()){case"en-US":e="pause_lose.png";break;case"es-ES":e="pause_lose_esp.png";break;case"nl-NL":e="pause_lose_dutch.png";break;default:e="pause_lose.png"}this.endGame!==A.GAME_END.WIN||d||(this.currentLevel>=this.totalLevels&&(d=!0),this.currentLevel++,A.Instances.DataManager.saveCurrentLevel(this.currentLevel)),Ph2.AnimationSystem.findObject("image",this.animationContainer).frameName=e,s=this.gameMode,a=this.difficulty,n=this.playerMode,o=this.grid.mapThemeSelected,r=this.characters,h=this.totalEnemies,l=this.endGame,c=this.totalLevels,this.overlayGameOver.revive(),this.animationContainer.visible=!0,this.animationContainer.ph2Animations.play("game_over_play"),this.grid.gameOver(),this.endGame===A.GAME_END.WIN?this.game.ph2AudioManager.switchMusic(A.Music.LEVEL_COMPLETED):this.game.ph2AudioManager.switchMusic(A.Music.LEVEL_FAILED),this.checkClearMissions(),this.game.time.events.add(2e3,function(){m.game.state.start("gameOverState",!0,!1,s,a,n,o,r,h,c,m.scoreManager,l,d)},this)},e.prototype.checkClearMissions=function(){var t;if(this.endGame===A.GAME_END.WIN)this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.WIN_CONTINUOUSLY_IN_3_LEVELS),this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.grid.players[0].weaponActive&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_ANY_WEAPON):(this.grid.players[0].weaponActive||this.grid.players[1].weaponActive)&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_ANY_WEAPON),this.gameMode===A.GAME_MODE.ARCADE?this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_ARCADE_IN_120_SECONDS):this.gameMode===A.GAME_MODE.BATTLE_ROYALE?this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_BATTLE_ROYALE_120_SECONDS):this.gameMode===A.GAME_MODE.NEW_PACMAN?(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.WIN_CONTINUOUSLY_IN_3_LEVELS_IN_PACMAN),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_IN_PACMAN_IN_120_SECONDS)):this.gameMode===A.GAME_MODE.ICE_MAN?(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.WIN_CONTINUOUSLY_3_LEVELS_IN_FROZEN),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_IN_120_SECONDS_IN_FROZEN)):this.gameMode===A.GAME_MODE.STAR_COLLECTOR&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",A.MISSION.CLEAR_LEVEL_STAR_COLLECTOR_120_SECONDS);else for(t=0;t<A.Instances.MissionManager.missionsActive.length;t++)switch(A.Instances.MissionManager.missionsActive[t],A.Instances.MissionManager.missionsActive[t].id){case A.MISSION.WIN_CONTINUOUSLY_3_LEVELS_IN_FROZEN:this.gameMode===A.GAME_MODE.ICE_MAN&&(A.Instances.MissionManager.missionsActive[t].progress=0);break;case A.MISSION.WIN_CONTINUOUSLY_IN_3_LEVELS_IN_PACMAN:this.gameMode===A.GAME_MODE.NEW_PACMAN&&(A.Instances.MissionManager.missionsActive[t].progress=0);break;case A.MISSION.WIN_CONTINUOUSLY_IN_3_LEVELS:A.Instances.MissionManager.missionsActive[t].progress=0}},e.prototype.checkArcadeScores=function(){var t=this.scoreManager.getMaxScore();this.difficulty===A.DIFFICULTY.EASY?this.endGame=A.GAME_END.WIN:this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.endGame=t===this.grid.players[0].playerID?A.GAME_END.WIN:A.GAME_END.LOSE:this.playerMode===A.PLAYER_MODE.MULTI_PLAYER&&(this.endGame=t===this.grid.players[0].playerID||t===this.grid.players[1].playerID?A.GAME_END.WIN:A.GAME_END.LOSE)},e.prototype.checkBattleRoyaleScores=function(){var t,i,e=0;if(this.difficulty===A.DIFFICULTY.EASY)this.endGame=A.GAME_END.WIN;else{for(t=0;t<this.grid.players.length;t++)this.grid.players[t].totalKills>=e&&(e=this.grid.players[t].totalKills,i=t);this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.endGame=0===i?A.GAME_END.WIN:A.GAME_END.LOSE:this.endGame=0===i||1===i?A.GAME_END.WIN:A.GAME_END.LOSE}},e.prototype.checkNewPacmanScore=function(){this.difficulty===A.DIFFICULTY.EASY?this.endGame=A.GAME_END.WIN:this.endGame=A.GAME_END.LOSE},e.prototype.checkIceManScore=function(){this.difficulty===A.DIFFICULTY.EASY&&(this.endGame=A.GAME_END.WIN)},e.prototype.checkStarCollectorScore=function(){var t,i,e=0;if(this.difficulty===A.DIFFICULTY.EASY)this.endGame=A.GAME_END.WIN;else{for(t=0;t<this.grid.players.length;t++)this.grid.players[t].totalCoins>=e&&(e=this.grid.players[0].totalCoins,i=t);this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.endGame=0===i?A.GAME_END.WIN:A.GAME_END.LOSE:this.endGame=0===i||1===i?A.GAME_END.WIN:A.GAME_END.LOSE}},e.prototype.updateUIs=function(){var t=this.grid.players,i=t[0].lives<=0?0:t[0].lives;this.textLivesPlayer1.setText(i.toString()),this.textBombsPlayer1.setText(t[0].bombs.toString()),this.textPowerPlayer1.setText(t[0].power.toString()),this.textSpeedPlayer1.setText(t[0].speedPickedUp.toString()),i=t[1].lives<=0?0:t[1].lives,this.textLivesPlayer2.setText(i.toString()),this.textBombsPlayer2.setText(t[1].bombs.toString()),this.textPowerPlayer2.setText(t[1].power.toString()),this.textSpeedPlayer2.setText(t[1].speedPickedUp.toString()),3<=t.length&&(i=t[2].lives<=0?0:t[2].lives,this.textLivesPlayer3.setText(i.toString()),this.textBombsPlayer3.setText(t[2].bombs.toString()),this.textPowerPlayer3.setText(t[2].power.toString()),this.textSpeedPlayer3.setText(t[2].speedPickedUp.toString())),4<=t.length&&(i=t[3].lives<=0?0:t[3].lives,this.textLivesPlayer4.setText(i.toString()),this.textBombsPlayer4.setText(t[3].bombs.toString()),this.textPowerPlayer4.setText(t[3].power.toString()),this.textSpeedPlayer4.setText(t[3].speedPickedUp.toString())),this.updateGameModeUIs(),this.updateAvatarFeedback()},e.prototype.updateGameModeUIs=function(){var t=this.grid.players;switch(this.gameMode){case A.GAME_MODE.ARCADE:this.textScorePlayer1.setText("--"),this.textScorePlayer2.setText("--"),this.textScorePlayer3.setText("--"),this.textScorePlayer4.setText("--");break;case A.GAME_MODE.BATTLE_ROYALE:this.textScorePlayer1.setText(t[0].totalKills+"/10"),this.textScorePlayer2.setText(t[1].totalKills+"/10"),this.textFeedbackEnabled[0]=8<=t[0].totalKills,this.textFeedbackEnabled[1]=8<=t[1].totalKills,3<=t.length&&(this.textScorePlayer3.setText(t[2].totalKills+"/10"),this.textFeedbackEnabled[2]=8<=t[2].totalKills),4<=t.length&&(this.textScorePlayer4.setText(t[3].totalKills+"/10"),this.textFeedbackEnabled[3]=8<=t[3].totalKills);break;case A.GAME_MODE.NEW_PACMAN:this.textScorePlayer1.setText(t[0].totalCoins+"/100"),this.textFeedbackEnabled[0]=80<=t[0].totalCoins,this.playerMode===A.PLAYER_MODE.SINGLE_PLAYER?this.textScorePlayer2.setText(""):(this.textScorePlayer2.setText(t[1].totalCoins+"/100"),this.textFeedbackEnabled[1]=80<=t[1].totalCoins),3<=t.length&&this.textScorePlayer3.setText(""),4<=t.length&&this.textScorePlayer4.setText("");break;case A.GAME_MODE.ICE_MAN:this.textScorePlayer1.setText((t[0].totalFreeze+"/10").toString()),this.textScorePlayer2.setText((t[1].totalFreeze+"/10").toString()),this.textFeedbackEnabled[0]=8<=t[0].totalFreeze,this.textFeedbackEnabled[1]=8<=t[1].totalFreeze,3<=t.length&&(this.textScorePlayer3.setText((t[2].totalFreeze+"/10").toString()),this.textFeedbackEnabled[2]=8<=t[2].totalFreeze),4<=t.length&&(this.textScorePlayer4.setText((t[3].totalFreeze+"/10").toString()),this.textFeedbackEnabled[3]=8<=t[3].totalFreeze);break;case A.GAME_MODE.STAR_COLLECTOR:this.textScorePlayer1.setText(t[0].totalStars+"/5"),this.textScorePlayer2.setText(t[1].totalStars+"/5"),this.textFeedbackEnabled[0]=4<=t[0].totalStars,this.textFeedbackEnabled[1]=4<=t[1].totalStars,3<=t.length&&(this.textScorePlayer3.setText(t[2].totalStars+"/5"),this.textFeedbackEnabled[2]=4<=t[2].totalStars),4<=t.length&&(this.textScorePlayer4.setText(t[3].totalStars+"/5"),this.textFeedbackEnabled[3]=4<=t[3].totalStars)}},e.prototype.updateAvatarFeedback=function(){var t,i,e,s;if(this.gameMode!==A.GAME_MODE.ICE_MAN&&this.gameMode!==A.GAME_MODE.STAR_COLLECTOR&&this.gameMode!==A.GAME_MODE.BATTLE_ROYALE)for(t=0;t<this.grid.players.length;t++)if(s=!0,this.grid.players[t].dead&&(s=(this.gameMode!==A.GAME_MODE.NEW_PACMAN||!this.grid.players[t].isAI)&&s)){switch(this.characters[t]){case 0:i="avatar_disable_container1.png";break;case 1:i="avatar_disable_container2.png";break;case 2:i="avatar_disable_container3.png";break;case 3:i="avatar_disable_container4.png";break;case 4:i="avatar_disable_container5.png";break;case 5:i="avatar_disable_container6.png";break;case 6:i="avatar_disable_container7.png";break;case 7:i="avatar_disable_container8.png";break;default:i="avatar_disable_container1.png"}switch(t){case 0:e=this.avatar1;break;case 1:e=this.avatar2;break;case 2:e=this.avatar3;break;case 3:e=this.avatar4;break;default:e=this.avatar1}e.frameName=i}},e.prototype.updateTextFeedback=function(){var t;for(this.textFeedbackTimer+=this.game.time.elapsedMS,125<=this.textFeedbackTimer&&(this.textFeedbackTimer=0,this.textFeedbackColor="#ffffff"===this.textFeedbackColor?"#c30411":"#ffffff"),t=0;t<this.textFeedbackEnabled.length;t++)if(this.textFeedbackEnabled[t])switch(t){case 0:this.textScorePlayer1.addColor(this.textFeedbackColor,0);break;case 1:this.textScorePlayer2.addColor(this.textFeedbackColor,0);break;case 2:this.textScorePlayer3.addColor(this.textFeedbackColor,0);break;case 3:this.textScorePlayer4.addColor(this.textFeedbackColor,0);break;case 4:this.textTime.addColor(this.textFeedbackColor,0)}},e.prototype.update=function(){this.gameStatus===A.GAME_STATUS.PAUSED||this.gameStatus===A.GAME_STATUS.GAME_OVER?this.updateMissionText():(this.checkGameOver(),this.updateTextFeedback())},e.prototype.updateMissionText=function(){var t,i,e,s,a,n,o,r,h,c;this.checkMissionText(this.textMission1),this.checkMissionText(this.textMission2),this.checkMissionText(this.textMission3),(this.movingText1||this.movingText2||this.movingText3)&&(r=Ph2.UISystem.findObject("bg/mission1/mission",this.uiPause),h=Ph2.UISystem.findObject("bg/mission2/mission",this.uiPause),c=Ph2.UISystem.findObject("bg/mission3/mission",this.uiPause),o=.5*A.SETTINGS.SCALE,this.movingText1&&(s=this.directionMission1,t=300*A.SETTINGS.SCALE-r.width),this.movingText2&&(a=this.directionMission2,i=300*A.SETTINGS.SCALE-h.width),this.movingText3&&(n=this.directionMission3,e=300*A.SETTINGS.SCALE-c.width),this.textMission1.width>t&&("left"===s?(this.textMission1.x-=o,this.textMission1.x<=this.missionLimitLeft1&&(s="right")):"right"===s&&(this.textMission1.x+=o,this.textMission1.x>=this.missionLimitRight1)&&(s="left"),this.directionMission1=s),this.textMission2.width>i&&("left"===a?(this.textMission2.x-=o,this.textMission2.x<=this.missionLimitLeft2&&(a="right")):"right"===a&&(this.textMission2.x+=o,this.textMission2.x>=this.missionLimitRight2)&&(a="left"),this.directionMission2=a),this.textMission3.width>e)&&("left"===n?(this.textMission3.x-=o,this.textMission3.x<=this.missionLimitLeft3&&(n="right")):"right"===n&&(this.textMission3.x+=o,this.textMission3.x>=this.missionLimitRight3)&&(n="left"),this.directionMission3=n)},e.prototype.resize=function(){var t,i,e;this.bgLandscape.x=.5*this.game.width,this.bgLandscape.y=.5*this.game.height,this.bgPortrait.x=.5*this.game.width,this.bgPortrait.y=.5*this.game.height,this.bgLandscape.scale.set(1,1),this.bgPortrait.scale.set(1,1),"landscape"===Constants.CURRENT_ORIENTATION?(this.avatarsContainer.frameName="gp_container1.png",this.bgLandscape.visible=!0,this.bgPortrait.visible=!1):"portrait"===Constants.CURRENT_ORIENTATION&&(0===this.containerInitialPortraitY&&(this.containerInitialPortraitY=100*this.gameContainer.y/97.5),this.gameContainer.y=this.containerInitialPortraitY,this.avatarsContainer.frameName="gp_container2.png",this.bgLandscape.visible=!1,this.bgPortrait.visible=!0),i="landscape"===orientation?Constants.CALCULATED_WIDTH-this.bgLandscape.width:Constants.CALCULATED_WIDTH-this.bgPortrait.width,(e="landscape"===orientation?Constants.CALCULATED_HEIGHT-this.bgLandscape.height:Constants.CALCULATED_HEIGHT-this.bgPortrait.height)<i?0<i&&(t="landscape"===orientation?Constants.CALCULATED_WIDTH/this.bgLandscape.width:Constants.CALCULATED_WIDTH/this.bgPortrait.width,this.bgLandscape.scale.set(t,t),this.bgPortrait.scale.set(t,t)):0<e&&(t="landscape"===orientation?Constants.CALCULATED_HEIGHT/this.bgLandscape.height:Constants.CALCULATED_HEIGHT/this.bgPortrait.height,this.bgLandscape.scale.set(t,t),this.bgPortrait.scale.set(t,t)),this.isDesktop||(this.grid.players[0].inputController.stick.alignBottomLeft(0),this.resizeGameContainer()),this.uiPause.onGameSizeChanged(),this.animationContainer.x=this.gameContainer.x,this.animationContainer.y=this.gameContainer.y},e.prototype.resizeGameContainer=function(){var t,i,e;this.avatarsContainer.scale.set(1,1),this.gameContainer.scale.set(1,1),"landscape"===Constants.CURRENT_ORIENTATION?(t=this.game.height/(this.gameContainer.height-this.containerHeightOffset),i=.45*this.avatarsContainer.width*t,this.gameContainer.y=359*A.SETTINGS.SCALE,this.avatarsContainer.y=this.gameContainer.y+2*A.SETTINGS.SCALE,this.avatarsContainer.x=this.gameContainer.x-Math.abs(this.edgeLeft.left)-i):"portrait"===Constants.CURRENT_ORIENTATION&&(t=this.game.width/(this.gameContainer.width-this.containerWidthOffset)),i=Math.abs(t),this.gameContainer.scale.set(i,i),this.overlayGameOver.width=this.game.width,this.overlayGameOver.height=this.game.height,this.overlayPause.width=this.game.width,this.overlayPause.height=this.game.height,"portrait"===Constants.CURRENT_ORIENTATION&&(t<1?(e=1-t+1,this.avatarsContainer.y=(this.gameContainer.y-Math.abs(this.edgeTop.y*e+this.edgeTop.height*e)-.5*this.avatarsContainer.height)*e):(e=t,this.avatarsContainer.y=(this.gameContainer.y-Math.abs(this.edgeTop.y*t-this.edgeTop.height*e)-.5*this.avatarsContainer.height)*e)),this.repositionMask(i)},e.prototype.repositionMask=function(t){var i,e,s=this;this.gridMask.x=this.gameContainer.x+this.edgeLeft.left*t,this.gridMask.y=this.gameContainer.y+this.edgeTop.top*t,i=(Math.abs(this.edgeLeft.left)+Math.abs(this.edgeRight.right))*t,e=(Math.abs(this.edgeTop.top)+Math.abs(this.edgeBot.bottom))*t,this.game.time.events.add(5,function(){if(s.gridMask.width<i)for(;s.gridMask.width<i;)s.gridMask.width+=1;else for(;s.gridMask.width>i;)--s.gridMask.width;if(s.gridMask.height<e)for(;s.gridMask.height<e;)s.gridMask.height+=1;else for(;s.gridMask.height>e;)--s.gridMask.height},this)},e.prototype.gotoMainMenu=function(){var t=this;AzerionIntegration.SDK.showInterstitialAd("exit_to_menu_from_game",function(){t.game.ph2AudioManager.playEffect("menuPress",!1),t.game.state.start("mainMenuState",!0,!1)})},e.prototype.buttonInputOver=function(t){t.changeFrame("button_press.png"),this.game.ph2AudioManager.playEffect("menuTouch",!1)},e.prototype.buttonInputOut=function(t){t.changeFrame("button.png")},e.prototype.shutdown=function(){for(var t=this.game.stage.children.length-1;0<=t;t--)"arcade"===this.game.stage.children[t].key&&(this.game.stage.children[t]=null,this.game.stage.children.splice(t,1));this.grid.shutdownGrid(),this.grid=null},e.prototype.createCheats=function(){var t,i,e,s,a,n,o,r,h,c,l,m,d,p,g,_,u,S,E,T,I,b=this;Constants.useCheats&&(i=this.game.input.keyboard.addKey(Phaser.Keyboard.X),e=this.game.input.keyboard.addKey(Phaser.Keyboard.ONE),s=this.game.input.keyboard.addKey(Phaser.Keyboard.TWO),a=this.game.input.keyboard.addKey(Phaser.Keyboard.THREE),n=this.game.input.keyboard.addKey(Phaser.Keyboard.FOUR),o=this.game.input.keyboard.addKey(Phaser.Keyboard.FIVE),r=this.game.input.keyboard.addKey(Phaser.Keyboard.SIX),h=this.game.input.keyboard.addKey(Phaser.Keyboard.SEVEN),c=this.game.input.keyboard.addKey(Phaser.Keyboard.EIGHT),l=this.game.input.keyboard.addKey(Phaser.Keyboard.NINE),m=this.game.input.keyboard.addKey(Phaser.Keyboard.ZERO),d=this.game.input.keyboard.addKey(Phaser.Keyboard.R),p=this.game.input.keyboard.addKey(Phaser.Keyboard.T),g=this.game.input.keyboard.addKey(Phaser.Keyboard.Y),_=this.game.input.keyboard.addKey(Phaser.Keyboard.U),u=this.game.input.keyboard.addKey(Phaser.Keyboard.I),S=this.game.input.keyboard.addKey(Phaser.Keyboard.O),E=this.game.input.keyboard.addKey(Phaser.Keyboard.P),T=this.game.input.keyboard.addKey(Phaser.Keyboard.K),I=this.game.input.keyboard.addKey(Phaser.Keyboard.L),this.game.input.keyboard.addKey(Phaser.Keyboard.M),i.onDown.add(function(){switch(b.gameMode){case A.GAME_MODE.ARCADE:for(t=1;t<b.grid.players.length;t++)b.grid.players[t].deathComplete=!0;break;case A.GAME_MODE.BATTLE_ROYALE:b.grid.players[0].totalKills=10;break;case A.GAME_MODE.NEW_PACMAN:b.grid.players[0].totalCoins=100;break;case A.GAME_MODE.ICE_MAN:b.grid.players[0].totalFreeze=10;break;case A.GAME_MODE.STAR_COLLECTOR:b.grid.players[0].totalStars=5}},this),e.onDown.add(function(){b.grid.players[0].cheatWeapon(A.ITEM_TYPE.DOLL_BOMB)},this),s.onDown.add(function(){b.grid.players[0].cheatWeapon(A.ITEM_TYPE.FLAMETHROWER)},this),a.onDown.add(function(){b.grid.players[0].cheatWeapon(A.ITEM_TYPE.LASER_GUN)},this),n.onDown.add(function(){b.grid.players[0].cheatWeapon(A.ITEM_TYPE.HAMMER)},this),o.onDown.add(function(){b.grid.players[0].cheatWeapon(A.ITEM_TYPE.LIGHTING_GUN)},this),r.onDown.add(function(){b.grid.players[0].cheatWeapon(A.ITEM_TYPE.MIGHTY_HAMMER)},this),h.onDown.add(function(){b.grid.players[0].cheatMount(A.ITEM_TYPE.SKATEBOARD)},this),c.onDown.add(function(){b.grid.players[0].cheatMount(A.ITEM_TYPE.STAG)},this),l.onDown.add(function(){b.grid.players[0].cheatMount(A.ITEM_TYPE.SHOPPING_CART)},this),m.onDown.add(function(){b.grid.players[0].cheatMount(A.ITEM_TYPE.HORSE)},this),d.onDown.add(function(){b.grid.players[0].cheatItem(A.ITEM_TYPE.BOMB)},this),p.onDown.add(function(){b.grid.players[0].cheatItem(A.ITEM_TYPE.POWER)},this),g.onDown.add(function(){b.grid.players[0].cheatItem(A.ITEM_TYPE.SPEED)},this),_.onDown.add(function(){b.grid.players[0].cheatItem(A.ITEM_TYPE.KICK_BOMBS)},this),u.onDown.add(function(){b.grid.players[0].cheatItem(A.ITEM_TYPE.SHIELD)},this),S.onDown.add(function(){b.grid.players[0].cheatItem(A.ITEM_TYPE.HEART)},this),E.onDown.add(function(){b.grid.players[0].cheatItem(A.ITEM_TYPE.INVINCIBILITY)},this),T.onDown.add(function(){b.grid.cheatDestroy()},this),I.onDown.add(function(){b.gameTimer=175e3},this))};var t,i=e;function e(){return t.call(this)||this}A.GameplayState=i}(Game=Game||{}),function(p){t=Phaser.State,__extends(e,t),e.prototype.init=function(t,i,e,s,a,n,o,r,h,c){this.gameMode=t,this.difficulty=i,this.playerMode=e,this.isGameOver=c,this.mapTheme=s,this.enemies=n,this.gameEnd=h,this.levels=o,this.charactersChosen=a,this.scoreManager=r,this.selectingPlayer1=!0,this.selectingPlayer2=!1,this.visiblePopup=-1,this.popupTimer=-1,this.outfitPlayer1=p.Instances.DataManager.getOutfitPlayer1(),this.outfitPlayer2=p.Instances.DataManager.getOutfitPlayer2(),this.equippedOutfits=p.Instances.DataManager.getEquippedOutfits(),this.facePlayer1=this.outfitPlayer1.face,this.headPlayer1=this.outfitPlayer1.head,this.bodyPlayer1=this.outfitPlayer1.body,this.facePlayer2=this.outfitPlayer2.face,this.headPlayer2=this.outfitPlayer2.head,this.bodyPlayer2=this.outfitPlayer2.body,this.headsPlayer1=[],this.headsPlayer2=[],this.faces=[],this.bodies=[],this.outfitIndex1=0,this.outfitIndex2=0,this.currentLevel=p.Instances.DataManager.getCurrentLevel()-1,this.currentCharacterOn=0,this.isDesktop=this.game.device.desktop,this.showingGameOver=!1,this.directionMission1="left",this.directionMission2="left",this.directionMission3="left",this.movingText1=!1,this.movingText2=!1,this.movingText3=!1,this.currentMissionLimitLeft=0,this.currentMissionLimitRight=0,this.missionLimitLeft1=0,this.missionLimitLeft2=0,this.missionLimitLeft3=0,this.missionLimitRight1=0,this.missionLimitRight2=0,this.missionLimitRight3=0,this.starsMission1=[],this.starsMission2=[],this.starsMission3=[],this.obtainCharactersNames()},e.prototype.create=function(){var t,i=.5*this.game.width,e=.5*this.game.height,s=(p.Instances.DataManager=p.Instances.DataManager,this.unlocks=p.Instances.DataManager.getUnlocks(),this.bgLandscape=this.game.add.sprite(.5*this.game.width,.5*this.game.height,"mm_land"),this.bgLandscape.anchor.set(.5),this.bgPortrait=this.game.add.sprite(.5*this.game.width,this.game.height,"mm"),this.bgPortrait.anchor.set(.5,1),this.bgPortrait.visible=!1,this.bgGameOver=this.game.add.sprite(.5*this.game.width,.5*this.game.height,"gameover_land"),this.bgGameOver.anchor.set(.5),this.bgGameOver.visible=!1,this.bgGameOverPortrait=this.game.add.sprite(.5*this.game.width,this.game.height,"gameover"),this.bgGameOverPortrait.anchor.set(.5,1),this.bgGameOverPortrait.visible=!1,this.group=new Phaser.Group(this.game),this.add.existing(this.group),this.uiLevelComplete=this.game.add.ph2UI("level_completed","atlas_loading"),this.uiDressUp=this.game.add.ph2UI("dress_up_gameover","atlas_ui_dress_up"),this.uiGameComplete=this.game.add.ph2UI("ui_game_completed","atlas_game_completed"),this.uiGameOver=this.game.add.ph2UI("ui_gameover","atlas_loading"),this.uiMissions=this.game.add.ph2UI("pause","atlas_missions"),this.uiBonus=this.game.add.ph2UI("ad_bonus","atlas_loading"),this.comic=new p.Comic(this.game),this.overlayMissions=new p.Overlay(this.game,.7,"bg_black"),this.overlayMissions.kill(),this.overlayDressUp=new p.Overlay(this.game,.7,"bg_black"),this.overlayBonus=new p.Overlay(this.game,.8,"bg_black"),this.container=Ph2.UISystem.findObject("container",this.uiLevelComplete),this.buttonDressUp=Ph2.UISystem.findObject("container/dress_up_button",this.uiLevelComplete),this.buttonNext=Ph2.UISystem.findObject("container/more_games_button",this.uiLevelComplete),this.buttonMoreGames=Ph2.UISystem.findObject("container/next_button",this.uiLevelComplete),this.buttonMoreGames2=Ph2.UISystem.findObject("container/more_games_button",this.uiGameOver),this.buttonMoreGames3=Ph2.UISystem.findObject("container/more_games_button",this.uiGameComplete),this.buttonBonus=Ph2.UISystem.findObject("container/bonus_button",this.uiLevelComplete),this.buttonWatchAd=Ph2.UISystem.findObject("container/watch_ad_button",this.uiBonus),this.buttonExitBonus=Ph2.UISystem.findObject("container/exit_bonus_button",this.uiBonus),this.buttonWatchAd.visible=!1,this.buttonExitBonus.visible=!1,this.buttonBonus.input.enabled=!0,this.buttonBonus.alpha=1,new Phaser.Sprite(this.game,0,0,"reward","icon_1.png")),s=(s.anchor.set(.5),s.visible=!0,s.scale.set(.25),s.position.set(52,0),this.buttonWatchAd.addChild(s),new Phaser.Sprite(this.game,0,0,"atlas_loading","lvlc_item8.png"));s.anchor.set(.5),s.visible=!0,s.position.set(52,0),this.buttonBonus.addChild(s),this.buttonTryAgain=Ph2.UISystem.findObject("container/play_again_button",this.uiGameOver),this.buttonBack=Ph2.UISystem.findObject("container/back_button",this.uiGameComplete),this.buttonBack2=Ph2.UISystem.findObject("container/back_button",this.uiDressUp),this.buttonMission1=Ph2.UISystem.findObject("bg/mission1/close",this.uiMissions),this.buttonMission2=Ph2.UISystem.findObject("bg/mission2/close",this.uiMissions),this.buttonMission3=Ph2.UISystem.findObject("bg/mission3/close",this.uiMissions),this.characterContainer=Ph2.UISystem.findObject("container/character",this.uiDressUp),this.containerItem1=Ph2.UISystem.findObject("container/container_items/item1",this.uiDressUp),this.containerItem2=Ph2.UISystem.findObject("container/container_items/item2",this.uiDressUp),this.containerItem3=Ph2.UISystem.findObject("container/container_items/item3",this.uiDressUp),this.containerItem4=Ph2.UISystem.findObject("container/container_items/item4",this.uiDressUp),this.containerItem5=Ph2.UISystem.findObject("container/container_items/item5",this.uiDressUp),this.containerItem6=Ph2.UISystem.findObject("container/container_items/item6",this.uiDressUp),this.containerItem7=Ph2.UISystem.findObject("container/container_items/item7",this.uiDressUp),this.containerItem8=Ph2.UISystem.findObject("container/container_items/item8",this.uiDressUp),this.containerItem9=Ph2.UISystem.findObject("container/container_items/item9",this.uiDressUp),this.iconPlayerNumber=Ph2.UISystem.findObject("container/p1_image",this.uiDressUp),s=Ph2.UISystem.findObject("container",this.uiDressUp),this.animationButtonChange=this.game.add.ph2AnimationObject(-125*p.SETTINGS.SCALE,-140*p.SETTINGS.SCALE,"change_button","atlas_ui_dress_up"),this.animationButtonChange.ph2Animations.play("change_button_stand",1,!0),this.buttonChangeCharacter=Ph2.AnimationSystem.findObject("base",this.animationButtonChange),s.addChild(this.animationButtonChange),this.animationButtonChange.visible=this.playerMode===p.PLAYER_MODE.MULTI_PLAYER,this.containerInfo=Ph2.UISystem.findObject("container/info_container",this.uiLevelComplete),this.containerPlayer1=Ph2.UISystem.findObject("container/player1_container",this.uiLevelComplete),this.containerPlayer2=Ph2.UISystem.findObject("container/player2_container",this.uiLevelComplete),this.containerBar=Ph2.UISystem.findObject("container/bar",this.uiLevelComplete),this.containerPlayer1BonusScore=Ph2.UISystem.findObject("container/player1_container",this.uiBonus),this.containerPlayer2BonusScore=Ph2.UISystem.findObject("container/player2_container",this.uiBonus),this.iconPlayerOne=Ph2.UISystem.findObject("container/player1_container/p1_image",this.uiLevelComplete),this.iconPlayerTwo=Ph2.UISystem.findObject("container/player2_container/p2_image",this.uiLevelComplete),this.textKillsScoreP1=Ph2.UISystem.findObject("container/player1_container/enemies_destroyed_p1",this.uiLevelComplete),this.textTimeScoreP1=Ph2.UISystem.findObject("container/player1_container/time_bonus_p1",this.uiLevelComplete),this.textDifficultyScoreP1=Ph2.UISystem.findObject("container/player1_container/easy_bonus_p1",this.uiLevelComplete),this.textModeScoreP1=Ph2.UISystem.findObject("container/player1_container/occupy_zones_p1",this.uiLevelComplete),this.textLevelScoreP1=Ph2.UISystem.findObject("container/player1_container/level_score_p1",this.uiLevelComplete),this.textTotalScoreP1=Ph2.UISystem.findObject("container/bar/total_score_p1",this.uiLevelComplete),this.bonusScoreP1=Ph2.UISystem.findObject("container/player1_container/bonus_score_p1",this.uiBonus),this.bonusScoreP2=Ph2.UISystem.findObject("container/player2_container/bonus_score_p2",this.uiBonus),this.noAdAvailableText=Ph2.UISystem.findObject("container/no_ad_available_text",this.uiBonus),this.noAdAvailableText.visible=!1,this.textKillsScoreP2=Ph2.UISystem.findObject("container/player2_container/enemies_destroyed_p2",this.uiLevelComplete),this.textTimeScoreP2=Ph2.UISystem.findObject("container/player2_container/time_bonus_p2",this.uiLevelComplete),this.textDifficultyScoreP2=Ph2.UISystem.findObject("container/player2_container/easy_bonus_p2",this.uiLevelComplete),this.textModeScoreP2=Ph2.UISystem.findObject("container/player2_container/occupy_zones_p2",this.uiLevelComplete),this.textLevelScoreP2=Ph2.UISystem.findObject("container/player2_container/level_score_p2",this.uiLevelComplete),this.textTotalScoreP2=Ph2.UISystem.findObject("container/bar/total_score_p2",this.uiLevelComplete),Ph2.UISystem.findObject("container/container_win_hero1",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_win_hero2",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_win_hero3",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_win_hero4",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_win_hero5",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_win_hero6",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_win_hero7",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_win_hero8",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_win_hero1",this.uiGameComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/container_win_hero2",this.uiGameComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/container_win_hero3",this.uiGameComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/container_win_hero4",this.uiGameComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/container_win_hero5",this.uiGameComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/container_win_hero6",this.uiGameComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/container_win_hero7",this.uiGameComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/container_win_hero8",this.uiGameComplete).visibility.enable(!1),this.textMission1=Ph2.UISystem.findObject("bg/mission1/description",this.uiMissions),this.textMission2=Ph2.UISystem.findObject("bg/mission2/description",this.uiMissions),this.textMission3=Ph2.UISystem.findObject("bg/mission3/description",this.uiMissions),this.spinePlayer1=this.game.add.spine(0,0,this.spineNamePlayer1),this.spinePlayer2=this.game.add.spine(0,0,this.spineNamePlayer2),this.spinePlayer1.scale.setTo(p.SETTINGS.SCALE),this.spinePlayer2.scale.setTo(p.SETTINGS.SCALE),s=this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER?150*p.SETTINGS.SCALE:200*p.SETTINGS.SCALE,t=this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER?50*p.SETTINGS.SCALE:60*p.SETTINGS.SCALE,this.spineGameOverHero1=this.game.add.spine(s,t,this.spineNamePlayer1),this.spineGameOverHero2=this.game.add.spine(250*p.SETTINGS.SCALE,25*p.SETTINGS.SCALE,this.spineNamePlayer2),this.spineGameOverHero2.visible=this.playerMode===p.PLAYER_MODE.MULTI_PLAYER,this.spineGameOverHero1.scale.setTo(p.SETTINGS.SCALE),this.spineGameOverHero2.scale.setTo(p.SETTINGS.SCALE),this.container.addChild(this.spineGameOverHero2),this.container.addChild(this.spineGameOverHero1),this.animationGameOver=this.game.add.ph2AnimationObject(i,e,"gameover","atlas_gameover"),this.animationHeroGameOver=Ph2.AnimationSystem.findObject("skin",this.animationGameOver),this.animationGameOver.visible=!1,s=Ph2.UISystem.findObject("container/trophy",this.uiLevelComplete),t=Ph2.UISystem.findObject("bomb",this.uiLevelComplete),i=this.container.y-Math.abs(s.y),e=this.container.x-Math.abs(s.x),this.trophy=this.game.add.ph2AnimationObject(e,i,"trophy","atlas_anim"),this.trophy.ph2Animations.play("trophy_stand",1,!0),this.bomb=this.game.add.ph2AnimationObject(0,0,"bomb_ui","atlas_anim"),this.bomb.ph2Animations.play("bomb_decor",1,!0),t.addChild(this.bomb),this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER?(this.containerPlayer2.visible=!1,this.containerPlayer2.visibility.enable(!1),this.textTotalScoreP2.visible=!1,this.textTotalScoreP2.visibility.enable(!1),Ph2.UISystem.findObject("container/bar/p2_image",this.uiLevelComplete).visible=!1,Ph2.UISystem.findObject("container/bar/p2_image",this.uiLevelComplete).visibility.enable(!1),this.containerPlayer2BonusScore.visible=!1,this.containerPlayer1BonusScore.position.set(-50,-5)):(this.containerPlayer2.visible=!0,this.containerPlayer2.visibility.enable(!0),this.textTotalScoreP2.visible=!0,this.textTotalScoreP2.visibility.enable(!0),this.containerPlayer2BonusScore.visible=!0,this.containerPlayer1BonusScore.position.set(-210,-5)),this.textStarPoints=Ph2.AnimationSystem.findObject("score",this.trophy),this.textModeScoreP1.visible=!1,this.textModeScoreP1.visibility.enable(!1),this.uiMissions.visible=!1,this.uiDressUp.visible=!1,this.uiBonus.visible=!1,this.uiGameOver.visible=!1,this.uiGameComplete.visible=!1,this.spinePlayer2.visible=!1,this.overlayDressUp.kill(),this.overlayBonus.kill(),this.group.add(this.uiLevelComplete),this.group.add(this.overlayBonus),this.group.add(this.overlayDressUp),this.group.add(this.uiDressUp),this.group.add(this.animationGameOver),this.group.add(this.uiGameOver),this.group.add(this.uiGameComplete),this.group.add(this.overlayMissions),this.group.add(this.trophy),this.group.add(this.uiMissions),this.group.add(this.comic),this.characterContainer.addChild(this.spinePlayer1),this.characterContainer.addChild(this.spinePlayer2),this.checkGameModeInfo(),this.createUnlockableItems(),this.addTouchListeners(),this.localizeUI(),this.obtainSkins(),this.checkCharacterItems(this.currentCharacterOn),this.setSkinPlayer1(),this.setSkinPlayer2(),this.showScores(),this.checkTimerMissions(),this.loadMissions(),this.createMissionsMask(),this.createMissionCompleteStars(),this.isGameOver?this.checkMissionsGameOver():this.checkMissionsLevelComplete(),this.checkMissionsCompleted(),this.resize(),this.buttonMoreGames.visible=!1},e.prototype.createMissionsMask=function(){var t=300*p.SETTINGS.SCALE,i=45*p.SETTINGS.SCALE,e=Ph2.UISystem.findObject("bg/mission1",this.uiMissions),s=Ph2.UISystem.findObject("bg/mission2",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission3",this.uiMissions),n=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),o=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),r=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions);this.missionMask1=this.game.add.graphics(this.textMission1.x,this.textMission1.y-.5*i),this.missionMask2=this.game.add.graphics(this.textMission2.x,this.textMission2.y-.5*i),this.missionMask3=this.game.add.graphics(this.textMission3.x,this.textMission3.y-.5*i),this.missionMask1.beginFill(65331),this.missionMask1.drawRect(0,0,t-n.width,i),this.missionMask1.endFill(),this.missionMask2.beginFill(65331),this.missionMask2.drawRect(0,0,t-o.width,i),this.missionMask2.endFill(),this.missionMask3.beginFill(65331),this.missionMask3.drawRect(0,0,t-r.width,i),this.missionMask3.endFill(),e.addChild(this.missionMask1),s.addChild(this.missionMask2),a.addChild(this.missionMask3),this.textMission1.mask=this.missionMask1,this.textMission2.mask=this.missionMask2,this.textMission3.mask=this.missionMask3,this.getMissionLimits()},e.prototype.getMissionLimits=function(){var t,i=10*p.SETTINGS.SCALE,e=300*p.SETTINGS.SCALE,s=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),n=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions);this.textMission1.width>=e-s.width&&(t=this.textMission1.width-(e-s.width),this.missionLimitLeft1=this.textMission1.left-(t+i),this.missionLimitRight1=this.textMission1.x+i),this.textMission2.width>=e-a.width&&(t=this.textMission2.width-(e-a.width),this.missionLimitLeft2=this.textMission2.left-(t+i),this.missionLimitRight2=this.textMission2.x+i),this.textMission3.width>=e-n.width&&(t=this.textMission3.width-(e-n.width),this.missionLimitLeft3=this.textMission3.left-(t+i),this.missionLimitRight3=this.textMission3.x+i)},e.prototype.checkTimerMissions=function(){for(var t=0;t<p.Instances.MissionManager.missionsActive.length;t++)p.Instances.MissionManager.missionsActive[t].hasTimer&&p.Instances.MissionManager.missionsActive[t].progress<p.Instances.MissionManager.missionsActive[t].requirement&&p.Instances.MissionManager.missionsActive[t].restartMission()},e.prototype.loadMissions=function(){var t,i,e,s,a,n;Ph2.UISystem.findObject("pause_button",this.uiMissions).visible=!1,Ph2.UISystem.findObject("bg/description",this.uiMissions).visible=!1,Ph2.UISystem.findObject("sound_container",this.uiMissions).visible=!1,Ph2.UISystem.findObject("main_menu_button",this.uiMissions).visible=!1,Ph2.UISystem.findObject("pause_button",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("bg/description",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("sound_container",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("main_menu_button",this.uiMissions).visibility.enable(!1),t=p.Instances.MissionManager.missionsActive[0],i=p.Instances.MissionManager.missionsActive[1],e=p.Instances.MissionManager.missionsActive[2],s=t.progress+"/"+t.requirement,a=i.progress+"/"+i.requirement,n=e.progress+"/"+e.requirement,p.Instances.LocalizationManager.localizeText("bg/mission1/description",this.uiMissions,t.name),p.Instances.LocalizationManager.localizeText("bg/mission1/mission",this.uiMissions,s,!0),p.Instances.LocalizationManager.localizeText("bg/mission1/score",this.uiMissions,t.reward.toString(),!0),p.Instances.LocalizationManager.localizeText("bg/mission2/description",this.uiMissions,i.name),p.Instances.LocalizationManager.localizeText("bg/mission2/mission",this.uiMissions,a,!0),p.Instances.LocalizationManager.localizeText("bg/mission2/score",this.uiMissions,i.reward.toString(),!0),p.Instances.LocalizationManager.localizeText("bg/mission3/description",this.uiMissions,e.name),p.Instances.LocalizationManager.localizeText("bg/mission3/mission",this.uiMissions,n,!0),p.Instances.LocalizationManager.localizeText("bg/mission3/score",this.uiMissions,e.reward.toString(),!0),Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiMissions).visible=t.complete,Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiMissions).visible=i.complete,Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiMissions).visible=e.complete,Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiMissions).visibility.enable(!1)},e.prototype.showMissions=function(t){var i;if(void 0===t&&(t=!1),this.uiMissions.visible)this.closeMissions();else if(this.overlayMissions.revive(),this.uiMissions.visible=!0,t)for(i=0;i<p.Instances.MissionManager.missionsActive.length;i++)p.Instances.MissionManager.missionsActive[i].complete&&this.doStarsAnimation(i)},e.prototype.createMissionCompleteStars=function(){for(var t,i,e,s=Ph2.UISystem.findObject("bg/mission1",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission2",this.uiMissions),n=Ph2.UISystem.findObject("bg/mission3",this.uiMissions),o=this.game.rnd.integerInRange(25,30),r=0;r<o;r++)i=this.game.rnd.integerInRange(this.container.x-150*p.SETTINGS.SCALE,this.container.x+150*p.SETTINGS.SCALE),e=this.container.y-Math.abs(s.y),(t=new Phaser.Sprite(this.game,i,e,"atlas_anim","stars_trophy.png")).anchor.set(.5),t.visible=!1,this.starsMission1.push(t),this.group.add(t);for(o=this.game.rnd.integerInRange(25,30),r=0;r<o;r++)i=this.game.rnd.integerInRange(this.container.x-150*p.SETTINGS.SCALE,this.container.x+150*p.SETTINGS.SCALE),e=this.container.y-Math.abs(a.y),(t=new Phaser.Sprite(this.game,i,e,"atlas_anim","stars_trophy.png")).anchor.set(.5),t.visible=!1,this.starsMission2.push(t),this.group.add(t);for(o=this.game.rnd.integerInRange(25,30),r=0;r<o;r++)i=this.game.rnd.integerInRange(this.container.x-150*p.SETTINGS.SCALE,this.container.x+150*p.SETTINGS.SCALE),e=this.container.y+Math.abs(n.y),(t=new Phaser.Sprite(this.game,i,e,"atlas_anim","stars_trophy.png")).anchor.set(.5),t.visible=!1,this.starsMission3.push(t),this.group.add(t)},e.prototype.doStarsAnimation=function(t){var i,e,s,a;for(0===t?(s=this.starsMission1,a="mission1"):1===t?(s=this.starsMission2,a="mission2"):2===t&&(s=this.starsMission3,a="mission3"),i=0;i<s.length;i++)e=s[i],this.makeStarFall(e,i,a)},e.prototype.makeStarFall=function(t,i,e){var s,a,n,o=this;t.visible=!0,n=Ph2.UISystem.findObject("bg",this.uiMissions),a=5*i,n=this.container.y+.5*n.height,s=this.game.rnd.integerInRange(t.x-200*p.SETTINGS.SCALE,t.x+200*p.SETTINGS.SCALE),this.game.add.tween(t).to({x:s},1e3,"Linear",!0,a),this.game.add.tween(t).to({y:n},1e3,Phaser.Easing.Bounce.Out,!0,a).onComplete.add(function(){o.moveStarToTrophy(t,i,e)},this)},e.prototype.moveStarToTrophy=function(t,i,e){var s=50*i,a=this.trophy.x+-34.9*p.SETTINGS.SCALE,n=this.trophy.y+-2.9*p.SETTINGS.SCALE;this.game.add.tween(t).to({alpha:0},650,Phaser.Easing.Exponential.In,!0,s),this.game.add.tween(t).to({x:a,y:n},500,"Linear",!0,s),0===i&&this.removeCompleteMissions(e)},e.prototype.removeCompleteMissions=function(t){var i,e,s=this;switch(t){case"mission1":i=0,e=this.buttonMission1;break;case"mission2":i=1,e=this.buttonMission2;break;case"mission3":i=2,e=this.buttonMission3;break;default:return}e.inputEnabled=!1,t=Ph2.UISystem.findObject("bg/"+t,this.uiMissions),p.Instances.MissionManager.completeMission(i),this.game.add.tween(t).to({alpha:0},500,"Linear",!0).onComplete.add(function(){s.onMissionFadeComplete(i)},this),t=p.Instances.DataManager.getPlayerPoints()+p.Instances.MissionManager.missionsActive[i].reward,p.Instances.DataManager.savePlayersPoints(t),this.textStarPoints.setText(p.Instances.DataManager.getPlayerPoints().toString())},e.prototype.closeMissions=function(){this.stopMovingMissionText(this.textMission1),this.stopMovingMissionText(this.textMission2),this.stopMovingMissionText(this.textMission3),this.overlayMissions.kill(),this.uiMissions.visible=!1},e.prototype.checkMissionText=function(t){var i,e=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),s=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions);switch(t.parent.name){case"mission1":i=300*p.SETTINGS.SCALE-e.width;break;case"mission2":i=300*p.SETTINGS.SCALE-s.width;break;case"mission3":i=300*p.SETTINGS.SCALE-a.width}if(t.width>i)switch(t.width,t.parent.name){case"mission1":this.movingText1=!0;break;case"mission2":this.movingText2=!0;break;case"mission3":this.movingText3=!0}else switch(t.parent.name){case"mission1":this.movingText1=!1;break;case"mission2":this.movingText2=!1;break;case"mission3":this.movingText3=!1}},e.prototype.stopMovingMissionText=function(t){switch(t.parent.name){case"mission1":this.movingText1=!1;break;case"mission2":this.movingText2=!1;break;case"mission3":this.movingText3=!1;break;default:this.movingText1=!1,this.movingText2=!1,this.movingText3=!1}},e.prototype.changeMission=function(t){var i,e,s=this,t=t.parent.name;switch(t){case"mission1":i=0,e=this.buttonMission1;break;case"mission2":i=1,e=this.buttonMission2;break;case"mission3":i=2,e=this.buttonMission3;break;default:return}e.inputEnabled=!1,t=Ph2.UISystem.findObject("bg/"+t,this.uiMissions),p.Instances.MissionManager.changeMission(i),this.game.add.tween(t).to({alpha:0},500,"Linear",!0).onComplete.add(function(){s.onMissionFadeComplete(i)},this)},e.prototype.onMissionFadeComplete=function(t){var i,e,s=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),n=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions),o=10*p.SETTINGS.SCALE,r=300*p.SETTINGS.SCALE,h="mission"+(t+1),t=p.Instances.MissionManager.missionsActive[t],c=t.progress+"/"+t.requirement,l=Ph2.UISystem.findObject("bg/"+h,this.uiMissions),m=Ph2.UISystem.findObject("bg/"+h+"/empty/check",this.uiMissions),d=Ph2.UISystem.findObject("bg/"+h+"/description",this.uiMissions);switch(m.visible=!1,m.visibility.enable(!1),d.x=-192.5*p.SETTINGS.SCALE,p.Instances.LocalizationManager.localizeText("bg/"+h+"/description",this.uiMissions,t.name),p.Instances.LocalizationManager.localizeText("bg/"+h+"/mission",this.uiMissions,c,!0),p.Instances.LocalizationManager.localizeText("bg/"+h+"/score",this.uiMissions,t.reward.toString(),!0),h){case"mission1":i=this.buttonMission1,this.textMission1.width>=r-s.width&&(e=this.textMission1.width-(r-s.width),this.textMission1.x=-192.5*p.SETTINGS.SCALE,this.missionLimitLeft1=this.textMission1.left-(e+o),this.missionLimitRight1=this.textMission1.x+o,this.missionMask1.width=r-s.width);break;case"mission2":i=this.buttonMission2,this.textMission2.width>=r-a.width&&(e=this.textMission2.width-(r-a.width),this.textMission2.x=-192.5*p.SETTINGS.SCALE,this.missionLimitLeft2=this.textMission2.left-(e+o),this.missionLimitRight2=this.textMission2.x+o,this.missionMask2.width=r-a.width);break;case"mission3":i=this.buttonMission3,this.textMission3.width>=r-n.width&&(e=this.textMission3.width-(r-n.width),this.textMission3.x=-192.5*p.SETTINGS.SCALE,this.missionLimitLeft3=this.textMission3.left-(e+o),this.missionLimitRight3=this.textMission3.x+o,this.missionMask3.width=r-n.width);break;default:return}this.game.add.tween(l).to({alpha:1},500,"Linear",!0).onComplete.add(function(){i.inputEnabled=!0,i.input.useHandCursor=!0},this)},e.prototype.checkMissionsGameOver=function(){this.gameMode===p.GAME_MODE.ARCADE?this.gameEnd===p.GAME_END.WIN&&(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_ARCADE),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_ARCADE_5_TIMES),p.Instances.DataManager.getMapTheme()===p.MAP_THEME.FOREST&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_ARCADE_5_TIMES_IN_FOREST),this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER?3<=p.Instances.DataManager.getLivesPlayer1()&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_ARCADE_WITH_3_LIVES_LEFT):(3<=p.Instances.DataManager.getLivesPlayer1()||3<=p.Instances.DataManager.getLivesPlayer2())&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_ARCADE_WITH_3_LIVES_LEFT)):this.gameMode===p.GAME_MODE.BATTLE_ROYALE?(10===this.levels&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_BATTLE_ROYALE_10_LEVELS),p.Instances.DataManager.getMapTheme()&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_BATTLE_ROYALE_IN_RANCH)):this.gameMode===p.GAME_MODE.NEW_PACMAN?(this.difficulty===p.DIFFICULTY.NORMAL&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_PACMAN_IN_NORMAL),this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER?4===this.charactersChosen[0]&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_PACMAN_PURPLE_ROBOT):4!==this.charactersChosen[0]&&4!==this.charactersChosen[1]||this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_PACMAN_PURPLE_ROBOT)):this.gameMode===p.GAME_MODE.STAR_COLLECTOR?(this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER?5===this.charactersChosen[0]&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_STAR_COLLECTOR_BLACK_ROBOT):5!==this.charactersChosen[0]&&5!==this.charactersChosen[1]||this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_STAR_COLLECTOR_BLACK_ROBOT),p.Instances.DataManager.getMapTheme()===p.MAP_THEME.FOREST&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_STAR_COLLECTOR_IN_FOREST)):this.gameMode===p.GAME_MODE.ICE_MAN&&(p.Instances.DataManager.getMapTheme()===p.MAP_THEME.RACE_TRACK&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_FROZEN_MODE_IN_RACE_ARENA),20===this.levels)&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.CLEAR_FROZEN_WITH_20_LEVELS)},e.prototype.checkMissionsLevelComplete=function(){var t=p.Instances.DataManager.getMapTheme();this.gameMode===p.GAME_MODE.ARCADE?this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.FIGHT_IN_ALL_ARENAS_IN_ARCADE_MODE,t):this.gameMode===p.GAME_MODE.BATTLE_ROYALE?(this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.FIGHT_IN_ALL_ARENAS_IN_BATTLE_ROYALE_MODE,t),t===p.MAP_THEME.RANCH&&this.game.ph2NotificationManager.postNotification("_CHECK_AVOID_MISSION",p.MISSION.AVOID_HORSES_BATTLE_ROYALE_1_LEVEL)):this.gameMode===p.GAME_MODE.STAR_COLLECTOR?this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.FIGHT_IN_ALL_ARENAS_IN_STAR_BATTLE_MODE,t):this.gameMode===p.GAME_MODE.NEW_PACMAN?this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.FIGHT_IN_ALL_ARENAS_IN_PACMAN_MODE,t):this.gameMode===p.GAME_MODE.ICE_MAN&&this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.FIGHT_IN_ALL_ARENAS_IN_FREEZE_MODE,t),t===p.MAP_THEME.TOY_STORE?(this.game.ph2NotificationManager.postNotification("_CHECK_AVOID_MISSION",p.MISSION.AVOID_CLAWS_TOYSHOP_ARENA),this.game.ph2NotificationManager.postNotification("_CHECK_AVOID_MISSION",p.MISSION.AVOID_CLAWS_3_CONTINUOUS_LEVELS)):t===p.MAP_THEME.RACE_TRACK?(this.game.ph2NotificationManager.postNotification("_CHECK_AVOID_MISSION",p.MISSION.AVOID_CARS_RACE_ARENA),this.game.ph2NotificationManager.postNotification("_CHECK_AVOID_MISSION",p.MISSION.AVOID_CARS_3_LEVELS),this.game.ph2NotificationManager.postNotification("_CHECK_AVOID_MISSION",p.MISSION.AVOID_CARS_5_LEVELS)):t===p.MAP_THEME.RANCH&&this.game.ph2NotificationManager.postNotification("_CHECK_AVOID_MISSION",p.MISSION.AVOID_HORSES_ARENA_1_LEVEL),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.PLAY_ALL_MODES,this.gameMode)},e.prototype.checkMissionsCompleted=function(t){var i,e,s,a=this;for(void 0===t&&(t=!1),s=!1,e=p.Instances.MissionManager.getActiveMissions(),i=0;i<e.length;i++)e[i].complete&&(s=!0);if(Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiMissions).visible=e[0].complete,Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiMissions).visible=e[1].complete,Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiMissions).visible=e[2].complete,Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiMissions).visibility.enable(!1),t)for(i=0;i<p.Instances.MissionManager.missionsActive.length;i++)p.Instances.MissionManager.missionsActive[i].complete&&this.doStarsAnimation(i);else s&&this.game.time.events.add(500,function(){a.showMissions(!0)},this)},e.prototype.checkGameModeInfo=function(){var t,i,e=Ph2.UISystem.findObject("container/info_container/item_image1",this.uiLevelComplete),s=Ph2.UISystem.findObject("container/info_container/item_image2",this.uiLevelComplete),a=Ph2.UISystem.findObject("container/info_container/item_image3",this.uiLevelComplete),n=Ph2.UISystem.findObject("container/info_container/item_image4",this.uiLevelComplete),o=Ph2.UISystem.findObject("container/info_container/item_image5",this.uiLevelComplete);switch(this.difficulty){case p.DIFFICULTY.EASY:i="score_easy";break;case p.DIFFICULTY.NORMAL:i="score_normal";break;case p.DIFFICULTY.HARD:i="score_hard";break;default:i="score_easy"}this.gameMode===p.GAME_MODE.NEW_PACMAN||this.gameMode===p.GAME_MODE.STAR_COLLECTOR?(e.frameName=this.gameMode===p.GAME_MODE.NEW_PACMAN?"lvlc_item7.png":"lvlc_item8.png",s.frameName="lvlc_item3.png",a.frameName="lvlc_item4.png",n.frameName="lvlc_item5.png",o.frameName="lvlc_item6.png",t=this.gameMode===p.GAME_MODE.NEW_PACMAN?"score_coins":"score_stars",p.Instances.LocalizationManager.localizeText("container/info_container/enemies_destroyed_text",this.uiLevelComplete,t),p.Instances.LocalizationManager.localizeText("container/info_container/time_bonus_text",this.uiLevelComplete,"score_enemies"),p.Instances.LocalizationManager.localizeText("container/info_container/easy_bonus_text",this.uiLevelComplete,"score_time"),p.Instances.LocalizationManager.localizeText("container/info_container/level_score_text",this.uiLevelComplete,i),p.Instances.LocalizationManager.localizeText("container/info_container/occupy_zones_text",this.uiLevelComplete,"score_level")):(t=this.gameMode===p.GAME_MODE.ICE_MAN?"score_ice":"score_enemies",e.frameName="lvlc_item3.png",s.frameName="lvlc_item4.png",a.frameName="lvlc_item5.png",n.frameName="lvlc_item6.png",p.Instances.LocalizationManager.localizeText("container/info_container/enemies_destroyed_text",this.uiLevelComplete,t),p.Instances.LocalizationManager.localizeText("container/info_container/time_bonus_text",this.uiLevelComplete,"score_time"),p.Instances.LocalizationManager.localizeText("container/info_container/easy_bonus_text",this.uiLevelComplete,i),p.Instances.LocalizationManager.localizeText("container/info_container/level_score_text",this.uiLevelComplete,"score_level"),Ph2.UISystem.findObject("container/info_container/item_image5",this.uiLevelComplete).visible=!1,Ph2.UISystem.findObject("container/info_container/occupy_zones_text",this.uiLevelComplete).visible=!1,Ph2.UISystem.findObject("container/player1_container/occupy_zones_p1",this.uiLevelComplete).visible=!1,Ph2.UISystem.findObject("container/player2_container/occupy_zones_p2",this.uiLevelComplete).visible=!1,Ph2.UISystem.findObject("container/info_container/item_image5",this.uiLevelComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/info_container/occupy_zones_text",this.uiLevelComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/player1_container/occupy_zones_p1",this.uiLevelComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/player2_container/occupy_zones_p2",this.uiLevelComplete).visibility.enable(!1))},e.prototype.obtainSkins=function(){p.Instances.DataManager=p.Instances.DataManager,this.headsPlayer1=e.obtainHeads(this.spineNamePlayer1),this.headsPlayer2=e.obtainHeads(this.spineNamePlayer2),this.faces=["face1","face2","face3","face4"],this.bodies=["body1","body2","body3","body4"]},e.prototype.setSkin=function(){var t,i,e,s,a,n,o,r,h;switch(this.selectingPlayer1?(this.outfitIndex1++,n=this.spineNamePlayer1,s=this.spinePlayer1,a=this.spineGameOverHero1,e=this.outfitPlayer1,t=this.headsPlayer1[e.head],o=this.outfitIndex1):this.selectingPlayer2&&(this.outfitIndex2++,n=this.spineNamePlayer2,s=this.spinePlayer2,a=this.spineGameOverHero2,e=this.outfitPlayer2,t=this.headsPlayer2[e.head],o=this.outfitIndex2),i=this.faces[e.face],e=this.bodies[e.body],h=!0,"dress_hero1"!==n&&"dress_hero3"!==n&&"dress_hero6"!==n||"head1"===t?(s.createCombinedSkin("outfit"+o,"normal0",t,i,e),a.createCombinedSkin("outfit"+o,"normal0",t,i,e)):(s.createCombinedSkin("outfit"+o,"normal0","head1",t,i,e),a.createCombinedSkin("outfit"+o,"normal0","head1",t,i,e)),s.setSkinByName("outfit"+o),a.setSkinByName("outfit"+o),s.setAnimationByName(0,"special",!1),s.setAnimationByName(1,"stand",!1),n){case"dress_hero1":if("face1"===i)r="face1_front";else{if("face3"!==i){h=!1;break}r="face2_front"}break;case"dress_hero2":"face1"===i?r="face1_front":h=!1;break;case"dress_hero3":"face1"===i||"face2"===i||"face3"===i?r="face_front":h=!1;break;case"dress_hero4":"face1"===i?r="face1_front":"face3"===i?r="face2_front":h=!1;break;case"dress_hero5":"face1"===i?r="face1_front":h=!1;break;case"dress_hero6":"face1"===i||"face4"===i?r="face1_front":h=!1;break;case"dress_hero7":case"dress_hero8":"face1"===i?r="face1_front":h=!1;break;default:h=!(r="face1_front")}h&&(s.setAnimationByName(1,r,!0),a.setAnimationByName(1,r,!0)),s.setToSetupPose(),a.setToSetupPose()},e.prototype.setSkinPlayer1=function(){var t,i,e,s,a,n,o,r,h;if(this.outfitIndex1++,s=this.spineNamePlayer1,a=this.outfitIndex1,n=this.gameEnd===p.GAME_END.WIN?"special":"sad",r=this.gameEnd===p.GAME_END.LOSE,t=this.headsPlayer1[this.outfitPlayer1.head],i=this.gameEnd===p.GAME_END.WIN?this.faces[this.outfitPlayer1.face]:"face5",e=this.bodies[this.outfitPlayer1.body],h=!0,"dress_hero1"!==s&&"dress_hero3"!==s&&"dress_hero6"!==s||"head1"===t?(this.spinePlayer1.createCombinedSkin("outfit"+a,"normal0",t,this.faces[this.outfitPlayer1.face],e),this.spineGameOverHero1.createCombinedSkin("outfit"+a,"normal0",t,i,e)):(this.spinePlayer1.createCombinedSkin("outfit"+a,"normal0","head1",t,this.faces[this.outfitPlayer1.face],e),this.spineGameOverHero1.createCombinedSkin("outfit"+a,"normal0","head1",t,i,e)),this.spinePlayer1.setSkinByName("outfit"+a),this.spineGameOverHero1.setSkinByName("outfit"+a),this.spinePlayer1.setAnimationByName(0,"stand",!0),this.spinePlayer1.setToSetupPose(),this.spineGameOverHero1.setAnimationByName(0,n,r).onComplete=function(){r||(this.spineGameOverHero1.setAnimationByName(0,"stand",!0),this.spineGameOverHero1.setToSetupPose())}.bind(this),this.gameEnd===p.GAME_END.LOSE)"dress_hero3"!==s&&this.spineGameOverHero1.setAnimationByName(1,"face1_front",!0);else{switch(s){case"dress_hero1":if("face1"===i)o="face1_front";else{if("face3"!==i){h=!1;break}o="face2_front"}break;case"dress_hero2":"face1"===i?o="face1_front":h=!1;break;case"dress_hero3":"face1"===i||"face2"===i||"face3"===i?o="face_front":h=!1;break;case"dress_hero4":"face1"===i?o="face1_front":"face3"===i?o="face2_front":h=!1;break;case"dress_hero5":"face1"===i?o="face1_front":h=!1;break;case"dress_hero6":"face1"===i||"face4"===i?o="face1_front":h=!1;break;case"dress_hero7":case"dress_hero8":"face1"===i?o="face1_front":h=!1;break;default:h=!(o="face1_front")}h&&(this.spinePlayer1.setAnimationByName(1,o,!0),this.spineGameOverHero1.setAnimationByName(1,o,!0))}this.spinePlayer1.setToSetupPose(),this.spineGameOverHero1.setToSetupPose()},e.prototype.setSkinPlayer2=function(){var t,i,e,s,a,n,o,r,h;if(this.outfitIndex2++,s=this.spineNamePlayer2,a=this.outfitIndex2,n=this.gameEnd===p.GAME_END.WIN?"special":"sad",o=this.gameEnd===p.GAME_END.LOSE,t=this.headsPlayer2[this.outfitPlayer2.head],i=this.gameEnd===p.GAME_END.WIN?this.faces[this.outfitPlayer2.face]:"face5",e=this.bodies[this.outfitPlayer2.body],"dress_hero1"!==s&&"dress_hero3"!==s&&"dress_hero6"!==s||"head1"===t?(this.spinePlayer2.createCombinedSkin("outfit"+a,"normal0",t,this.faces[this.outfitPlayer2.face],e),this.spineGameOverHero2.createCombinedSkin("outfit"+a,"normal0",t,i,e)):(this.spinePlayer2.createCombinedSkin("outfit"+a,"normal0","head1",t,this.faces[this.outfitPlayer2.face],e),this.spineGameOverHero2.createCombinedSkin("outfit"+a,"normal0","head1",t,i,e)),this.spinePlayer2.setSkinByName("outfit"+a),this.spineGameOverHero2.setSkinByName("outfit"+a),this.spinePlayer2.setAnimationByName(0,"stand",!0),this.spinePlayer2.setToSetupPose(),this.spineGameOverHero2.setAnimationByName(0,n,o).onComplete=function(){o||(this.spineGameOverHero2.setAnimationByName(0,"stand",!0),this.spineGameOverHero2.setToSetupPose())}.bind(this),this.gameEnd===p.GAME_END.LOSE)this.spineGameOverHero2.setAnimationByName(1,"face1_front",!0);else{switch(s){case"dress_hero1":if("face1"===i)r="face1_front";else{if("face3"!==i){h=!1;break}r="face2_front"}break;case"dress_hero2":"face1"===i?r="face1_front":h=!1;break;case"dress_hero3":"face1"===i||"face2"===i||"face3"===i?r="face_front":h=!1;break;case"dress_hero4":"face1"===i?r="face1_front":"face3"===i?r="face2_front":h=!1;break;case"dress_hero5":"face1"===i?r="face1_front":h=!1;break;case"dress_hero6":"face1"===i||"face4"===i?r="face1_front":h=!1;break;case"dress_hero7":case"dress_hero8":"face1"===i?r="face1_front":h=!1;break;default:h=!(r="face1_front")}h&&(this.spinePlayer2.setAnimationByName(1,r,!0),this.spineGameOverHero2.setAnimationByName(1,r,!0))}this.spinePlayer2.setToSetupPose(),this.spineGameOverHero2.setToSetupPose()},e.prototype.createUnlockableItems=function(){var t;switch(this.item9=this.game.add.ph2AnimationObject(0,0,"item9","atlas_ui_dress_up"),this.item8=this.game.add.ph2AnimationObject(0,0,"item8","atlas_ui_dress_up"),this.item7=this.game.add.ph2AnimationObject(0,0,"item7","atlas_ui_dress_up"),this.item6=this.game.add.ph2AnimationObject(0,0,"item6","atlas_ui_dress_up"),this.item5=this.game.add.ph2AnimationObject(0,0,"item5","atlas_ui_dress_up"),this.item4=this.game.add.ph2AnimationObject(0,0,"item4","atlas_ui_dress_up"),this.item3=this.game.add.ph2AnimationObject(0,0,"item3","atlas_ui_dress_up"),this.item2=this.game.add.ph2AnimationObject(0,0,"item2","atlas_ui_dress_up"),this.item1=this.game.add.ph2AnimationObject(0,0,"item1","atlas_ui_dress_up"),this.items=[],this.items.push(this.item1,this.item2,this.item3,this.item4,this.item5,this.item6,this.item7,this.item8,this.item9),this.containerItem9.add(this.item9),this.containerItem8.add(this.item8),this.containerItem7.add(this.item7),this.containerItem6.add(this.item6),this.containerItem5.add(this.item5),this.containerItem4.add(this.item4),this.containerItem3.add(this.item3),this.containerItem2.add(this.item2),this.containerItem1.add(this.item1),this.itemPrice1=Ph2.AnimationSystem.findObject("price",this.item1),this.itemPrice2=Ph2.AnimationSystem.findObject("price",this.item2),this.itemPrice3=Ph2.AnimationSystem.findObject("price",this.item3),this.itemPrice4=Ph2.AnimationSystem.findObject("price",this.item4),this.itemPrice5=Ph2.AnimationSystem.findObject("price",this.item5),this.itemPrice6=Ph2.AnimationSystem.findObject("price",this.item6),this.itemPrice7=Ph2.AnimationSystem.findObject("price",this.item7),this.itemPrice8=Ph2.AnimationSystem.findObject("price",this.item8),this.itemPrice9=Ph2.AnimationSystem.findObject("price",this.item9),this.charactersChosen[0]){case 0:t="item1";break;case 1:t="item2";break;case 2:t="item3";break;case 3:t="item4";break;case 4:t="item5";break;case 5:t="item6";break;case 6:t="item7";break;case 7:t="item8";break;case 8:t="item9"}this.itemImages=[],this.itemImage1=Ph2.AnimationSystem.findObject("image",this.item1),this.itemImage2=Ph2.AnimationSystem.findObject("image",this.item2),this.itemImage3=Ph2.AnimationSystem.findObject("image",this.item3),this.itemImage4=Ph2.AnimationSystem.findObject("image",this.item4),this.itemImage5=Ph2.AnimationSystem.findObject("image",this.item5),this.itemImage6=Ph2.AnimationSystem.findObject("image",this.item6),this.itemImage7=Ph2.AnimationSystem.findObject("image",this.item7),this.itemImage8=Ph2.AnimationSystem.findObject("image",this.item8),this.itemImage9=Ph2.AnimationSystem.findObject("image",this.item9),this.itemImages.push(this.itemImage1,this.itemImage2,this.itemImage3,this.itemImage4,this.itemImage5,this.itemImage6,this.itemImage7,this.itemImage8,this.itemImage9),this.itemPopups=[],this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item1",this.item1)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item2",this.item2)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item3",this.item3)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item4",this.item4)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item5",this.item5)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item6",this.item6)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item7",this.item7)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item8",this.item8)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item9",this.item9));for(var i=0;i<this.itemPopups.length;i++)this.itemPopups[i].visible=!1;this.itemImage1.frameName=t+"_1.png",this.itemImage2.frameName=t+"_2.png",this.itemImage3.frameName=t+"_3.png",this.itemImage4.frameName=t+"_4.png",this.itemImage5.frameName=t+"_5.png",this.itemImage6.frameName=t+"_6.png",this.itemImage7.frameName=t+"_7.png",this.itemImage8.frameName=t+"_8.png",this.itemImage9.frameName=t+"_9.png",this.itemFrames=[],this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item1)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item2)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item3)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item4)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item5)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item6)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item7)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item8)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item9)),this.itemPrice1.setText(p.SETTINGS.ITEM_COSTS[0].toString()),this.itemPrice2.setText(p.SETTINGS.ITEM_COSTS[1].toString()),this.itemPrice3.setText(p.SETTINGS.ITEM_COSTS[2].toString()),this.itemPrice4.setText(p.SETTINGS.ITEM_COSTS[3].toString()),this.itemPrice5.setText(p.SETTINGS.ITEM_COSTS[4].toString()),this.itemPrice6.setText(p.SETTINGS.ITEM_COSTS[5].toString()),this.itemPrice7.setText(p.SETTINGS.ITEM_COSTS[6].toString()),this.itemPrice8.setText(p.SETTINGS.ITEM_COSTS[7].toString()),this.itemPrice9.setText(p.SETTINGS.ITEM_COSTS[8].toString()),this.currentCharacterOn=this.charactersChosen[0]},e.prototype.localizeUI=function(){var t,i;this.textStarPoints.setText(p.Instances.DataManager.getPlayerPoints().toString()),t=p.Instances.LocalizationManager.getStringForKey("go_level"),i=this.gameEnd===p.GAME_END.WIN?p.Instances.LocalizationManager.getStringForKey("go_complete"):p.Instances.LocalizationManager.getStringForKey("go_failed"),t=t+" "+(this.gameEnd===p.GAME_END.WIN?p.Instances.DataManager.getCurrentLevel()-1:p.Instances.DataManager.getCurrentLevel())+"/"+this.levels+" "+i,p.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiLevelComplete,t,!0),p.Instances.LocalizationManager.localizeText("container/next_button/next_text",this.uiLevelComplete,"mm_more_games"),p.Instances.LocalizationManager.localizeText("container/more_games_button/more_games_text",this.uiLevelComplete,"next"),p.Instances.LocalizationManager.localizeText("container/dress_up_button/dress_up_text",this.uiLevelComplete,"dress_up"),p.Instances.LocalizationManager.localizeText("container/bonus_button/bonus_text",this.uiLevelComplete,"level_complete_bonus"),p.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiBonus,"bonus_title"),p.Instances.LocalizationManager.localizeText("container/info_container/video_bonus_text",this.uiBonus,"bonus_second_title"),p.Instances.LocalizationManager.localizeText("container/bar/total_score_text",this.uiLevelComplete,"score_total"),p.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiDressUp,"dress_up"),p.Instances.LocalizationManager.localizeText("container/back_button/back_text",this.uiDressUp,"back"),p.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiGameOver,"go_game_over"),p.Instances.LocalizationManager.localizeText("container/more_games_button/text",this.uiGameOver,"mm_more_games"),p.Instances.LocalizationManager.localizeText("container/play_again_button/text",this.uiGameOver,"back"),p.Instances.LocalizationManager.localizeText("container/container_score/total_score_text",this.uiGameOver,"score_total"),p.Instances.LocalizationManager.localizeText("container/title",this.uiGameComplete,"go_game_complete"),p.Instances.LocalizationManager.localizeText("container/more_games_button/more_games_text",this.uiGameComplete,"mm_more_games"),p.Instances.LocalizationManager.localizeText("container/back_button/back_text",this.uiGameComplete,"back"),p.Instances.LocalizationManager.localizeText("container/container_score/total_score_text",this.uiGameComplete,"score_total"),p.Instances.LocalizationManager.fitFontSizeUI("container/container_title/title",this.uiLevelComplete,320*p.SETTINGS.SCALE,-1,42*p.SETTINGS.SCALE),p.Instances.LocalizationManager.fitFontSizeUI("container/info_container/enemies_destroyed_text",this.uiLevelComplete,190*p.SETTINGS.SCALE,-1,18*p.SETTINGS.SCALE),p.Instances.LocalizationManager.fitFontSizeUI("container/info_container/time_bonus_text",this.uiLevelComplete,190*p.SETTINGS.SCALE,-1,18*p.SETTINGS.SCALE),p.Instances.LocalizationManager.fitFontSizeUI("container/info_container/easy_bonus_text",this.uiLevelComplete,190*p.SETTINGS.SCALE,-1,18*p.SETTINGS.SCALE),p.Instances.LocalizationManager.fitFontSizeUI("container/info_container/level_score_text",this.uiLevelComplete,190*p.SETTINGS.SCALE,-1,18*p.SETTINGS.SCALE),p.Instances.LocalizationManager.fitFontSizeUI("container/info_container/occupy_zones_text",this.uiLevelComplete,190*p.SETTINGS.SCALE,-1,18*p.SETTINGS.SCALE),p.Instances.LocalizationManager.fitFontSizeUI("container/container_title/title",this.uiGameOver,300*p.SETTINGS.SCALE,-1,40*p.SETTINGS.SCALE),p.Instances.LocalizationManager.fitFontSizeUI("container/title",this.uiGameComplete,300*p.SETTINGS.SCALE,-1,40*p.SETTINGS.SCALE),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item1/label",this.item1,"not_enough_stars_popup"),216),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item2/label",this.item2,"not_enough_stars_popup"),216),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item3/label",this.item3,"not_enough_stars_popup"),216),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item4/label",this.item4,"not_enough_stars_popup"),216),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item5/label",this.item5,"not_enough_stars_popup"),216),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item6/label",this.item6,"not_enough_stars_popup"),216),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item7/label",this.item7,"not_enough_stars_popup"),216),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item8/label",this.item8,"not_enough_stars_popup"),216),p.MainMenuState.setWordWrap(p.Instances.LocalizationManager.localizeAnimText("bubble_item9/label",this.item9,"not_enough_stars_popup"),216)},e.prototype.addTouchListeners=function(){var i=this;this.buttonNext.onInputUp.add(this.nextStep,this),this.buttonDressUp.onInputDown.add(this.openDressUp,this),this.buttonBack2.onInputDown.add(function(){AzerionIntegration.SDK.showInterstitialAd("close_dressup",function(){i.closeDressUp()})},this),this.buttonWatchAd.onInputDown.add(function(){AzerionIntegration.SDK.showRewardedAd("claim_reward",function(){i.closeBonus();var t=p.Instances.DataManager.getPlayerPoints()+500;p.Instances.DataManager.savePlayersPoints(t),i.textStarPoints.setText(p.Instances.DataManager.getPlayerPoints().toString())},function(){i.buttonWatchAd.input.enabled=!1,i.buttonWatchAd.alpha=.7,i.noAdAvailableText.visible=!0})},this),this.buttonMoreGames.onInputDown.add(this.gotoMoreGames,this),this.buttonMoreGames2.onInputDown.add(this.gotoMoreGames,this),this.buttonMoreGames3.onInputDown.add(this.gotoMoreGames,this),this.buttonTryAgain.onInputUp.add(this.gotoMainMenu,this),this.buttonBack.onInputUp.add(this.gotoMainMenu,this),this.buttonBonus.onInputDown.add(this.openBonus,this),this.buttonExitBonus.onInputDown.add(this.closeBonus,this),this.buttonExitBonus.onInputOut.add(e.buttonInputOut,this),this.buttonWatchAd.onInputOut.add(e.buttonInputOut,this),this.buttonBonus.onInputOut.add(e.buttonInputOut,this),this.buttonMoreGames.onInputOut.add(e.buttonInputOut,this),this.buttonDressUp.onInputOut.add(e.buttonInputOut,this),this.buttonBack2.onInputOut.add(e.buttonInputOut,this),this.buttonNext.onInputOut.add(e.buttonInputOut,this),this.buttonMoreGames2.onInputOut.add(e.buttonInputOut,this),this.buttonMoreGames3.onInputOut.add(e.buttonInputOut,this),this.buttonTryAgain.onInputOut.add(e.buttonInputOut,this),this.buttonBack.onInputOut.add(e.buttonInputOut,this),this.buttonExitBonus.onInputOver.add(this.buttonInputOver,this),this.buttonWatchAd.onInputOver.add(this.buttonInputOver,this),this.buttonBonus.onInputOver.add(this.buttonInputOver,this),this.buttonMoreGames.onInputOver.add(this.buttonInputOver,this),this.buttonDressUp.onInputOver.add(this.buttonInputOver,this),this.buttonBack2.onInputOver.add(this.buttonInputOver,this),this.buttonNext.onInputOver.add(this.buttonInputOver,this),this.buttonMoreGames2.onInputOver.add(this.buttonInputOver,this),this.buttonMoreGames3.onInputOver.add(this.buttonInputOver,this),this.buttonTryAgain.onInputOver.add(this.buttonInputOver,this),this.buttonBack.onInputOver.add(this.buttonInputOver,this),this.createItemButtonListener(this.itemImage1,this.selectFace),this.createItemButtonListener(this.itemImage2,this.selectFace),this.createItemButtonListener(this.itemImage3,this.selectFace),this.createItemButtonListener(this.itemImage4,this.selectHead),this.createItemButtonListener(this.itemImage5,this.selectHead),this.createItemButtonListener(this.itemImage6,this.selectHead),this.createItemButtonListener(this.itemImage7,this.selectBody),this.createItemButtonListener(this.itemImage8,this.selectBody),this.createItemButtonListener(this.itemImage9,this.selectBody),this.createButtonListener(this.buttonChangeCharacter,this.switchSelection),this.itemImage1.input.useHandCursor=!0,this.itemImage2.input.useHandCursor=!0,this.itemImage3.input.useHandCursor=!0,this.itemImage4.input.useHandCursor=!0,this.itemImage5.input.useHandCursor=!0,this.itemImage6.input.useHandCursor=!0,this.itemImage7.input.useHandCursor=!0,this.itemImage8.input.useHandCursor=!0,this.itemImage9.input.useHandCursor=!0,this.buttonChangeCharacter.events.onInputOver.add(function(){i.buttonChangeCharacter.frameName="change_hov_button.png",i.animationButtonChange.ph2Animations.play("change_button_pause",1,!0)},this),this.buttonChangeCharacter.events.onInputOut.add(function(){i.buttonChangeCharacter.frameName="change_button.png",i.animationButtonChange.ph2Animations.play("change_button_stand",1,!0)},this),this.trophy.inputEnabled=!0,this.trophy.input.useHandCursor=!0,this.trophy.events.onInputUp.add(this.showMissions,this),this.overlayMissions.inputEnabled=!0,this.overlayMissions.events.onInputUp.add(this.closeMissions,this),this.buttonMission1.onInputUp.add(this.changeMission,this),this.buttonMission2.onInputUp.add(this.changeMission,this),this.buttonMission3.onInputUp.add(this.changeMission,this),this.textMission1.inputEnabled=!0,this.textMission2.inputEnabled=!0,this.textMission3.inputEnabled=!0,this.textMission1.events.onInputOver.add(this.checkMissionText,this),this.textMission2.events.onInputOver.add(this.checkMissionText,this),this.textMission3.events.onInputOver.add(this.checkMissionText,this),this.textMission1.events.onInputOut.add(this.stopMovingMissionText,this),this.textMission2.events.onInputOut.add(this.stopMovingMissionText,this),this.textMission3.events.onInputOut.add(this.stopMovingMissionText,this),Ph2.UISystem.findObject("bg",this.uiMissions).inputEnabled=!0},e.prototype.showScores=function(){var t,i,e,s,a;if(this.gameEnd===p.GAME_END.WIN){switch(this.difficulty){case p.DIFFICULTY.EASY:t=1e3;break;case p.DIFFICULTY.NORMAL:t=2e3;break;case p.DIFFICULTY.HARD:t=3e3;break;default:t=1e3}if(this.scoreManager.totalScores[0]+=t,this.gameMode===p.GAME_MODE.NEW_PACMAN||this.gameMode===p.GAME_MODE.STAR_COLLECTOR)switch(this.textModeScoreP1.visible=!0,this.gameMode){case p.GAME_MODE.NEW_PACMAN:this.textKillsScoreP1.setText(this.scoreManager.coinScores[0].toString()),this.textTimeScoreP1.setText(this.scoreManager.killScores[0].toString()),this.textDifficultyScoreP1.setText(this.scoreManager.timeScores[0].toString()),this.textLevelScoreP1.setText(t.toString()),this.textModeScoreP1.setText(this.scoreManager.totalScores[0].toString());break;case p.GAME_MODE.STAR_COLLECTOR:this.textKillsScoreP1.setText(this.scoreManager.starScores[0].toString()),this.textTimeScoreP1.setText(this.scoreManager.killScores[0].toString()),this.textDifficultyScoreP1.setText(this.scoreManager.timeScores[0].toString()),this.textLevelScoreP1.setText(t.toString()),this.textModeScoreP1.setText(this.scoreManager.totalScores[0].toString())}else this.textModeScoreP1.visible=!1,this.textModeScoreP1.visibility.enable(!1),this.textKillsScoreP1.setText(this.scoreManager.killScores[0].toString()),this.textTimeScoreP1.setText(this.scoreManager.timeScores[0].toString()),this.textDifficultyScoreP1.setText(t.toString()),this.textLevelScoreP1.setText(this.scoreManager.totalScores[0].toString());if(this.scoreManager.finalScores[0]+=this.scoreManager.totalScores[0],this.textTotalScoreP1.setText(this.scoreManager.finalScores[0].toString()),this.playerMode===p.PLAYER_MODE.MULTI_PLAYER)if(this.gameMode===p.GAME_MODE.NEW_PACMAN||this.gameMode===p.GAME_MODE.STAR_COLLECTOR){switch(this.textModeScoreP2.visible=!0,this.gameMode){case p.GAME_MODE.NEW_PACMAN:this.textKillsScoreP2.setText(this.scoreManager.coinScores[1].toString()),this.textTimeScoreP2.setText(this.scoreManager.killScores[1].toString()),this.textDifficultyScoreP2.setText(this.scoreManager.timeScores[1].toString()),this.textLevelScoreP2.setText(t.toString()),this.textModeScoreP2.setText(this.scoreManager.totalScores[1].toString());break;case p.GAME_MODE.STAR_COLLECTOR:this.textKillsScoreP2.setText(this.scoreManager.starScores[1].toString()),this.textTimeScoreP2.setText(this.scoreManager.killScores[1].toString()),this.textDifficultyScoreP2.setText(this.scoreManager.timeScores[1].toString()),this.textLevelScoreP2.setText(t.toString()),this.textModeScoreP2.setText(this.scoreManager.totalScores[1].toString())}this.scoreManager.finalScores[1]+=this.scoreManager.totalScores[1],this.textTotalScoreP2.setText(this.scoreManager.finalScores[1].toString())}else this.textModeScoreP2.visible=!1,this.textModeScoreP2.visibility.enable(!1),this.textKillsScoreP2.setText(this.scoreManager.killScores[1].toString()),this.textTimeScoreP2.setText(this.scoreManager.timeScores[1].toString()),this.textDifficultyScoreP2.setText(t.toString()),this.textLevelScoreP2.setText(this.scoreManager.totalScores[1].toString()),this.scoreManager.finalScores[0]+=this.scoreManager.totalScores[0],this.textTotalScoreP2.setText(this.scoreManager.finalScores[0].toString())}else this.gameMode===p.GAME_MODE.NEW_PACMAN||this.gameMode===p.GAME_MODE.STAR_COLLECTOR?(this.textModeScoreP1.visible=!0,this.textModeScoreP2.visible=!0):(this.textModeScoreP1.visible=!1,this.textModeScoreP1.visibility.enable(!1),this.textModeScoreP2.visible=!1,this.textModeScoreP2.visibility.enable(!1)),this.textKillsScoreP1.setText("0"),this.textTimeScoreP1.setText("0"),this.textDifficultyScoreP1.setText("0"),this.textModeScoreP1.setText("0"),this.textLevelScoreP1.setText("0"),this.textTotalScoreP1.setText(this.scoreManager.finalScores[0].toString()),this.textKillsScoreP2.setText("0"),this.textTimeScoreP2.setText("0"),this.textDifficultyScoreP2.setText("0"),this.textModeScoreP2.setText("0"),this.textLevelScoreP2.setText("0"),this.textTotalScoreP2.setText(this.scoreManager.finalScores[1].toString());i=Ph2.UISystem.findObject("container/container_score/total_score_p1",this.uiGameComplete),e=Ph2.UISystem.findObject("container/container_score/total_score_p2",this.uiGameComplete),s=Ph2.UISystem.findObject("container/container_score/total_score_p1",this.uiGameOver),a=Ph2.UISystem.findObject("container/container_score/total_score_p2",this.uiGameOver),i.setText(this.scoreManager.finalScores[0].toString()),e.setText(this.scoreManager.finalScores[1].toString()),s.setText(this.scoreManager.finalScores[0].toString()),a.setText(this.scoreManager.finalScores[1].toString()),this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER?(this.game.ph2NotificationManager.postNotification("_CHECK_POINT_MISSION",p.MISSION.GET_5000_POINTS,this.scoreManager.finalScores[0]),this.game.ph2NotificationManager.postNotification("_CHECK_POINT_MISSION",p.MISSION.GET_30000_POINTS,this.scoreManager.finalScores[0])):(this.game.ph2NotificationManager.postNotification("_CHECK_POINT_MISSION",p.MISSION.GET_5000_POINTS,this.scoreManager.finalScores[0]+this.scoreManager.finalScores[1]),this.game.ph2NotificationManager.postNotification("_CHECK_POINT_MISSION",p.MISSION.GET_30000_POINTS,this.scoreManager.finalScores[0]+this.scoreManager.finalScores[1]))},e.prototype.nextStep=function(){var t=this;AzerionIntegration.SDK.showInterstitialAd("next_level",function(){t.isGameOver?t.gameEnd===p.GAME_END.WIN?t.showComic():t.showGameOver():t.gotoGameplay()})},e.prototype.openBonus=function(){this.overlayBonus.revive(),this.uiBonus.visible=!0,this.buttonBonus.visible=!1,this.buttonWatchAd.alpha=1,this.noAdAvailableText.visible=!1,this.buttonWatchAd.visible=!0,this.buttonExitBonus.visible=!0,this.buttonWatchAd.input.enabled=!0,this.trophy.visible=!1,this.rewardAmountP1=parseInt(this.textTotalScoreP1.text,10),this.bonusScoreP1.setText("+500"),this.rewardAmountP2=parseInt(this.textTotalScoreP2.text,10),this.bonusScoreP2.setText("+500")},e.prototype.openDressUp=function(){var t,i,e,s,a,n;switch(this.overlayDressUp.revive(),this.uiDressUp.visible=!0,i=this.selectingPlayer1?(s=this.spineNamePlayer1,e=this.spinePlayer1,this.equippedOutfits[this.charactersChosen[0]]):(s=this.spineNamePlayer2,e=this.spinePlayer2,this.equippedOutfits[this.charactersChosen[1]]),t=this.faces[i.face],e.setAnimationByName(0,"special",!(n=!0)).onComplete=function(){(this.selectingPlayer1?(this.spinePlayer1.setAnimationByName(0,"stand",!0),this.spinePlayer1):(this.spinePlayer2.setAnimationByName(0,"stand",!0),this.spinePlayer2)).setToSetupPose()}.bind(this),e.setAnimationByName(1,"stand",!1),e.setToSetupPose(),s){case"dress_hero1":"face3"===t?n=!1:a="face2"===t?"face2_front":"face1_front";break;case"dress_hero2":"face4"===t?n=!1:a="face2"===t?"face2_front":"face1_front";break;case"dress_hero3":a="face_front";break;case"dress_hero4":a="face1_front";break;case"dress_hero5":"face3"===t||"face4"===t?n=!1:a="face1_front";break;case"dress_hero6":"face4"===t?n=!1:a="face3"===t?"face3_front":"face1_front";break;case"dress_hero7":"face3"===t?n=!1:a="face2"===t?"face2_front":"face4"===t?"face4_front":"face1_front";break;case"dress_hero8":"face3"===t||"face4"===t?n=!1:a="face1_front";break;default:a="face1_front"}n&&this.spineGameOverHero1.setAnimationByName(1,a,!0)},e.prototype.closeBonus=function(){this.overlayBonus.kill(),this.uiBonus.visible=!1,this.buttonBonus.visible=!0,this.buttonBonus.input.enabled=!1,this.buttonBonus.alpha=.7,this.buttonWatchAd.visible=!1,this.buttonExitBonus.visible=!1,this.trophy.visible=!0},e.prototype.closeDressUp=function(){var t,i,e,s,a,n,o;switch(this.overlayDressUp.kill(),this.uiDressUp.visible=!1,this.outfitIndex1++,s=this.spineNamePlayer1,a=this.outfitIndex1,t=this.headsPlayer1[this.outfitPlayer1.head],i=this.faces[this.outfitPlayer1.face],e=this.bodies[this.outfitPlayer1.body],o=!0,"dress_hero1"!==s&&"dress_hero3"!==s&&"dress_hero6"!==s||"head1"===t?this.spineGameOverHero1.createCombinedSkin("outfit"+a,"normal0",t,i,e):this.spineGameOverHero1.createCombinedSkin("outfit"+a,"normal0","head1",t,i,e),this.spineGameOverHero1.setSkinByName("outfit"+a),this.spineGameOverHero1.setAnimationByName(0,"special",!1).onComplete=function(){this.spineGameOverHero1.setAnimationByName(0,"stand",!0),this.spineGameOverHero1.setToSetupPose()}.bind(this),this.spineGameOverHero1.setAnimationByName(1,"stand",!1),s){case"dress_hero1":if("face1"===i)n="face1_front";else{if("face3"!==i){o=!1;break}n="face2_front"}break;case"dress_hero2":"face1"===i?n="face1_front":o=!1;break;case"dress_hero3":"face1"===i||"face2"===i||"face3"===i?n="face_front":o=!1;break;case"dress_hero4":"face1"===i?n="face1_front":"face3"===i?n="face2_front":o=!1;break;case"dress_hero5":"face1"===i?n="face1_front":o=!1;break;case"dress_hero6":"face1"===i||"face4"===i?n="face1_front":o=!1;break;case"dress_hero7":case"dress_hero8":"face1"===i?n="face1_front":o=!1;break;default:o=!(n="face1_front")}switch(o&&this.spineGameOverHero1.setAnimationByName(1,n,!0),this.spineGameOverHero1.setToSetupPose(),this.outfitIndex2++,s=this.spineNamePlayer2,a=this.outfitIndex2,t=this.headsPlayer2[this.outfitPlayer2.head],i=this.faces[this.outfitPlayer2.face],e=this.bodies[this.outfitPlayer2.body],o=!0,"dress_hero1"!==s&&"dress_hero3"!==s&&"dress_hero6"!==s||"head1"===t?this.spineGameOverHero2.createCombinedSkin("outfit"+a,"normal0",t,i,e):this.spineGameOverHero2.createCombinedSkin("outfit"+a,"normal0","head1",t,i,e),this.spineGameOverHero2.setSkinByName("outfit"+a),this.spineGameOverHero2.setAnimationByName(0,"special",!1).onComplete=function(){this.spineGameOverHero2.setAnimationByName(0,"stand",!0),this.spineGameOverHero2.setToSetupPose()}.bind(this),this.spineGameOverHero2.setAnimationByName(1,"stand",!1),s){case"dress_hero1":if("face1"===i)n="face1_front";else{if("face3"!==i){o=!1;break}n="face2_front"}break;case"dress_hero2":"face1"===i?n="face1_front":o=!1;break;case"dress_hero3":"face1"===i||"face2"===i||"face3"===i?n="face_front":o=!1;break;case"dress_hero4":"face1"===i?n="face1_front":"face3"===i?n="face2_front":o=!1;break;case"dress_hero5":"face1"===i?n="face1_front":o=!1;break;case"dress_hero6":"face1"===i||"face4"===i?n="face1_front":o=!1;break;case"dress_hero7":case"dress_hero8":"face1"===i?n="face1_front":o=!1;break;default:o=!(n="face1_front")}o&&this.spineGameOverHero2.setAnimationByName(1,n,!0),this.spineGameOverHero2.setToSetupPose()},e.prototype.switchSelection=function(){this.selectingPlayer1=!this.selectingPlayer1,this.selectingPlayer2=!this.selectingPlayer2,this.selectingPlayer1&&(this.currentCharacterOn=this.charactersChosen[0],this.spinePlayer1.visible=!0,this.spinePlayer2.visible=!1,this.iconPlayerNumber.frameName="p1_1.png"),this.selectingPlayer2&&(this.currentCharacterOn=this.charactersChosen[1],this.spinePlayer1.visible=!1,this.spinePlayer2.visible=!0,this.iconPlayerNumber.frameName="p2_1.png"),this.selectCharacter(this.currentCharacterOn),this.game.ph2AudioManager.playEffect("menuPress",!1)},e.prototype.selectCharacter=function(t){var i;switch(t){case 0:i="item1";break;case 1:i="item2";break;case 2:i="item3";break;case 3:i="item4";break;case 4:i="item5";break;case 5:i="item6";break;case 6:i="item7";break;case 7:i="item8"}this.itemImage1.alpha=1,this.itemImage2.alpha=1,this.itemImage3.alpha=1,this.itemImage4.alpha=1,this.itemImage5.alpha=1,this.itemImage6.alpha=1,this.itemImage7.alpha=1,this.itemImage8.alpha=1,this.itemImage9.alpha=1,this.itemImage1.frameName=i+"_1.png",this.itemImage2.frameName=i+"_2.png",this.itemImage3.frameName=i+"_3.png",this.itemImage4.frameName=i+"_4.png",this.itemImage5.frameName=i+"_5.png",this.itemImage6.frameName=i+"_6.png",this.itemImage7.frameName=i+"_7.png",this.itemImage8.frameName=i+"_8.png",this.itemImage9.frameName=i+"_9.png";for(var e=0;e<this.itemFrames.length;e++)this.itemFrames[e].frameName="item_bottom.png";this.obtainSkins(),this.checkCharacterItems(t)},e.prototype.selectFace=function(t){var i,e,s,a,n,o=p.Instances.DataManager.getPlayerPoints(),r=this.unlocks[this.currentCharacterOn],h=!1;switch(t.parent.name){case"item1":e=1,a=r.items[s=0],i=p.SETTINGS.ITEM_COSTS[0],n=this.item1;break;case"item2":e=2,a=r.items[s=1],i=p.SETTINGS.ITEM_COSTS[1],n=this.item2;break;case"item3":e=3,a=r.items[s=2],i=p.SETTINGS.ITEM_COSTS[2],n=this.item3}a?h=!0:i<=o&&(o-=i,this.unlocks[this.currentCharacterOn].items[s]=h=!0,this.unlockItem(n),p.Instances.DataManager.savePlayersPoints(o),p.Instances.DataManager.saveUnlocks(this.unlocks),this.textStarPoints.setText(p.Instances.DataManager.getPlayerPoints().toString()),this.selectingPlayer1?this.checkCharacterItems(this.charactersChosen[0]):this.selectingPlayer2&&this.checkCharacterItems(this.charactersChosen[1])),h?(this.selectingPlayer1?(e===this.facePlayer1?(1===e&&2===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face4_anim",n).visible=!0),2===e&&0===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face1_anim",n).visible=!0),2===e&&3===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face2_anim",n).visible=!0),3===e&&5===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face3_anim",n).visible=!0),e=0,t.alpha=1,this.itemFrames[s].frameName="item_bottom_hover.png"):(0<=this.facePlayer1-1&&(2===this.currentCharacterOn&&null!==Ph2.AnimationSystem.findObject("face4_anim",this.items[this.facePlayer1-1])&&(Ph2.AnimationSystem.findObject("face4_anim",this.items[this.facePlayer1-1]).visible=!0),0===this.currentCharacterOn&&null!==Ph2.AnimationSystem.findObject("face1_anim",this.items[this.facePlayer1-1])&&(Ph2.AnimationSystem.findObject("face1_anim",this.items[this.facePlayer1-1]).visible=!0),3===this.currentCharacterOn&&2===this.facePlayer1&&null!==Ph2.AnimationSystem.findObject("face2_anim",this.items[this.facePlayer1-1])&&(Ph2.AnimationSystem.findObject("face2_anim",this.items[this.facePlayer1-1]).visible=!0),5===this.currentCharacterOn)&&3===this.facePlayer1&&null!==Ph2.AnimationSystem.findObject("face3_anim",this.items[this.facePlayer1-1])&&(Ph2.AnimationSystem.findObject("face3_anim",this.items[this.facePlayer1-1]).visible=!0),1===e&&2===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face4_anim",n).visible=!1),2===e&&0===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face1_anim",n).visible=!1),2===e&&3===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face2_anim",n).visible=!1),3===e&&5===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face3_anim",n).visible=!1),t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.facePlayer1&&(this.itemFrames[this.facePlayer1-1].frameName="item_bottom.png",this.itemImages[this.facePlayer1-1].alpha=1)),this.facePlayer1=e,this.outfitPlayer1.face=e):this.selectingPlayer2&&(e===this.facePlayer2?(1===e&&2===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face4_anim",n).visible=!0),2===e&&0===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face1_anim",n).visible=!0),2===e&&3===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face2_anim",n).visible=!0),3===e&&6===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face3_anim",n).visible=!0),e=0,t.alpha=1):(0<=this.facePlayer2-1&&(2===this.currentCharacterOn&&null!==Ph2.AnimationSystem.findObject("face4_anim",this.items[this.facePlayer2-1])&&(Ph2.AnimationSystem.findObject("face4_anim",this.items[this.facePlayer2-1]).visible=!0),0===this.currentCharacterOn&&null!==Ph2.AnimationSystem.findObject("face1_anim",this.items[this.facePlayer2-1])&&(Ph2.AnimationSystem.findObject("face1_anim",this.items[this.facePlayer2-1]).visible=!0),3===this.currentCharacterOn&&2===this.facePlayer2&&null!==Ph2.AnimationSystem.findObject("face2_anim",this.items[this.facePlayer2-1])&&(Ph2.AnimationSystem.findObject("face2_anim",this.items[this.facePlayer2-1]).visible=!0),5===this.currentCharacterOn)&&3===this.facePlayer2&&null!==Ph2.AnimationSystem.findObject("face3_anim",this.items[this.facePlayer2-1])&&(Ph2.AnimationSystem.findObject("face3_anim",this.items[this.facePlayer2-1]).visible=!0),1===e&&2!==this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face4_anim",n).visible=!1),2===e&&0!==this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face1_anim",n).visible=!1),2===e&&3!==this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face2_anim",n).visible=!1),3===e&&5!==this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face3_anim",n).visible=!1),t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.facePlayer2&&(this.itemFrames[this.facePlayer2-1].frameName="item_bottom.png",this.itemImages[this.facePlayer2-1].alpha=1)),this.facePlayer2=e,this.outfitPlayer2.face=e),this.equippedOutfits[this.currentCharacterOn].face=e,p.Instances.DataManager.saveEquippedOutfits(this.equippedOutfits),this.setSkin(),this.game.ph2AudioManager.playEffect("menuPress",!1)):(-1<this.visiblePopup&&this.visiblePopup!==s&&(this.itemPopups[this.visiblePopup].visible=!1),this.visiblePopup=s,this.itemPopups[s].visible=!0,this.popupTimer=1200)},e.prototype.selectHead=function(t){var i,e,s,a,n,o=p.Instances.DataManager.getPlayerPoints(),r=this.unlocks[this.currentCharacterOn],h=!1;switch(t.parent.name){case"item4":e=1,a=r.items[s=3],i=p.SETTINGS.ITEM_COSTS[3],n=this.item4;break;case"item5":e=2,a=r.items[s=4],i=p.SETTINGS.ITEM_COSTS[4],n=this.item5;break;case"item6":e=3,a=r.items[s=5],i=p.SETTINGS.ITEM_COSTS[5],n=this.item6}if(a?h=!0:i<=o&&(o-=i,this.unlocks[this.currentCharacterOn].items[s]=h=!0,this.unlockItem(n),p.Instances.DataManager.savePlayersPoints(o),p.Instances.DataManager.saveUnlocks(this.unlocks),this.textStarPoints.setText(p.Instances.DataManager.getPlayerPoints().toString()),this.selectingPlayer1?this.checkCharacterItems(this.charactersChosen[0]):this.selectingPlayer2&&this.checkCharacterItems(this.charactersChosen[1])),h){switch(t.parent.name){case"item4":e=1;break;case"item5":e=2;break;case"item6":e=3}this.selectingPlayer1?(e===this.headPlayer1?(e=0,t.alpha=1,this.itemFrames[s].frameName="item_bottom_hover.png"):(t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.headPlayer1&&(this.itemFrames[this.headPlayer1+2].frameName="item_bottom.png",this.itemImages[this.headPlayer1+2].alpha=1)),this.headPlayer1=e,this.outfitPlayer1.head=e):this.selectingPlayer2&&(e===this.headPlayer2?(e=0,t.alpha=1):(t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.headPlayer2&&(this.itemFrames[this.headPlayer2+2].frameName="item_bottom.png",this.itemImages[this.headPlayer2+2].alpha=1)),this.headPlayer2=e,this.outfitPlayer2.head=e),this.equippedOutfits[this.currentCharacterOn].face=e,p.Instances.DataManager.saveEquippedOutfits(this.equippedOutfits),this.game.ph2AudioManager.playEffect("menuPress",!1),this.setSkin()}else-1<this.visiblePopup&&this.visiblePopup!==s&&(this.itemPopups[this.visiblePopup].visible=!1),this.visiblePopup=s,this.itemPopups[s].visible=!0,this.popupTimer=1200},e.prototype.selectBody=function(t){var i,e,s,a,n,o=p.Instances.DataManager.getPlayerPoints(),r=this.unlocks[this.currentCharacterOn],h=!1;switch(t.parent.name){case"item7":e=1,a=r.items[s=6],i=p.SETTINGS.ITEM_COSTS[6],n=this.item7;break;case"item8":e=2,a=r.items[s=7],i=p.SETTINGS.ITEM_COSTS[7],n=this.item8;break;case"item9":e=3,a=r.items[s=8],i=p.SETTINGS.ITEM_COSTS[8],n=this.item9}if(a?h=!0:i<=o&&(o-=i,this.unlocks[this.currentCharacterOn].items[s]=h=!0,this.unlockItem(n),p.Instances.DataManager.savePlayersPoints(o),p.Instances.DataManager.saveUnlocks(this.unlocks),this.textStarPoints.setText(p.Instances.DataManager.getPlayerPoints().toString()),this.selectingPlayer1?this.checkCharacterItems(this.charactersChosen[0]):this.selectingPlayer2&&this.checkCharacterItems(this.charactersChosen[1])),h){switch(t.parent.name){case"item7":e=1;break;case"item8":e=2;break;case"item9":e=3}this.selectingPlayer1?(e===this.bodyPlayer1?(e=0,t.alpha=1):(t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.bodyPlayer1&&(this.itemFrames[this.bodyPlayer1+5].frameName="item_bottom.png",this.itemImages[this.bodyPlayer1+5].alpha=1)),this.bodyPlayer1=e,this.outfitPlayer1.body=e):this.selectingPlayer2&&(e===this.bodyPlayer2?(e=0,t.alpha=1):(t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.bodyPlayer2&&(this.itemFrames[this.bodyPlayer2+5].frameName="item_bottom.png",this.itemImages[this.bodyPlayer2+5].alpha=1)),this.bodyPlayer2=e,this.outfitPlayer2.body=e),this.equippedOutfits[this.currentCharacterOn].face=e,p.Instances.DataManager.saveEquippedOutfits(this.equippedOutfits),this.game.ph2AudioManager.playEffect("menuPress",!1),this.setSkin()}else-1<this.visiblePopup&&this.visiblePopup!==s&&(this.itemPopups[this.visiblePopup].visible=!1),this.visiblePopup=s,this.itemPopups[s].visible=!0,this.popupTimer=1200},e.prototype.showComic=function(){var t=this;this.audioCheering=this.game.ph2AudioManager.playEffect("uiCherry",!1),this.game.ph2AudioManager.switchMusic(p.Music.MAIN_MENU),this.comic.showGameCompleteComic2(this.charactersChosen[0]).onComplete.add(function(){t.comic.hideComics(),t.showGameOver()},this)},e.prototype.showGameOver=function(){var t;this.game.ph2AudioManager.playEffect("menuPress",!1),this.trophy.visible=!1,this.currentLevel>=this.levels?(this.uiGameComplete.visible=!0,this.uiGameOver.visible=!1,Ph2.UISystem.findObject("container/container_win_hero"+(this.charactersChosen[0]+1),this.uiGameComplete).visible=!0,this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER&&(Ph2.UISystem.findObject("container/container_score/p2_image",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_score/p2_image",this.uiGameComplete).visibility.enable(!1),Ph2.UISystem.findObject("container/container_score/total_score_p2",this.uiGameComplete).visible=!1,Ph2.UISystem.findObject("container/container_score/total_score_p2",this.uiGameComplete).visibility.enable(!1))):(t="hero"+(this.charactersChosen[0]+1)+"_go",this.animationGameOver.visible=!0,this.animationGameOver.ph2Animations.play("gameover_stand",1,!0),this.animationHeroGameOver.ph2Animations.play(t,1,!0),this.game.ph2AudioManager.switchMusic(p.Music.GAME_OVER),this.bgPortrait.visible=!1,this.bgLandscape.visible=!1,this.showingGameOver=!0,this.bgGameOver.visible=!0,this.isDesktop||(this.bgGameOver.visible="landscape"===Constants.CURRENT_ORIENTATION,this.bgGameOverPortrait.visible="portrait"===Constants.CURRENT_ORIENTATION),this.uiGameComplete.visible=!1,this.uiGameOver.visible=!0,this.playerMode===p.PLAYER_MODE.SINGLE_PLAYER&&(Ph2.UISystem.findObject("container/container_score/p2_image",this.uiGameOver).visible=!1,Ph2.UISystem.findObject("container/container_score/p2_image",this.uiGameOver).visibility.enable(!1),Ph2.UISystem.findObject("container/container_score/total_score_p2",this.uiGameOver).visible=!1,Ph2.UISystem.findObject("container/container_score/total_score_p2",this.uiGameOver).visibility.enable(!1))),this.uiLevelComplete.visible=!1,this.uiDressUp.visible=!1,this.uiBonus.visible=!1},e.prototype.gotoMoreGames=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),window.open(Constants.MORE_GAMES,"_blank")},e.prototype.gotoGameplay=function(){this.scoreManager.cleanScores(),p.Instances.DataManager.saveOutfitPlayer1(this.outfitPlayer1),p.Instances.DataManager.saveOutfitPlayer2(this.outfitPlayer2),this.gameEnd===p.GAME_END.WIN&&(this.mapTheme=p.Instances.DataManager.getMapTheme()),this.game.ph2AudioManager.playEffect("menuPress",!1),this.game.state.start("gameplayState",!0,!1,this.gameMode,this.difficulty,this.playerMode,this.mapTheme,this.charactersChosen,this.enemies,this.levels,this.scoreManager)},e.prototype.gotoMainMenu=function(){var t=this;AzerionIntegration.SDK.showInterstitialAd("exit_to_menu_on_level_lose",function(){t.game.ph2AudioManager.playEffect("menuPress",!1),t.game.state.start("mainMenuState",!0,!1)})},e.prototype.createButtonListener=function(t,i){t.inputEnabled=!0,t.input.useHandCursor=!0,t.events.onInputDown.add(i,this)},e.prototype.createItemButtonListener=function(t,i){t.inputEnabled=!0,t.events.onInputDown.add(i,this),t.events.onInputOver.add(this.itemOver,this),t.events.onInputOut.add(this.itemOut,this)},e.prototype.buttonInputOver=function(t){this.game.ph2AudioManager.playEffect("menuTouch",!1)},e.buttonInputOut=function(t){},e.prototype.obtainCharactersNames=function(){switch(p.Instances.DataManager.getCharactersChosen()[0]){case 0:this.spineNamePlayer1="dress_hero1";break;case 1:this.spineNamePlayer1="dress_hero2";break;case 2:this.spineNamePlayer1="dress_hero3";break;case 3:this.spineNamePlayer1="dress_hero4";break;case 4:this.spineNamePlayer1="dress_hero5";break;case 5:this.spineNamePlayer1="dress_hero6";break;case 6:this.spineNamePlayer1="dress_hero7";break;case 7:this.spineNamePlayer1="dress_hero8"}switch(p.Instances.DataManager.getCharactersChosen()[1]){case 0:this.spineNamePlayer2="dress_hero1";break;case 1:this.spineNamePlayer2="dress_hero2";break;case 2:this.spineNamePlayer2="dress_hero3";break;case 3:this.spineNamePlayer2="dress_hero4";break;case 4:this.spineNamePlayer2="dress_hero5";break;case 5:this.spineNamePlayer2="dress_hero6";break;case 6:this.spineNamePlayer2="dress_hero7";break;case 7:this.spineNamePlayer2="dress_hero8"}},e.obtainHeads=function(t){return"dress_hero1"===t||"dress_hero3"===t||"dress_hero6"===t?["head1","decor2","decor3","decor4"]:["head1","head2","head3","head4"]},e.prototype.itemAlreadyUnlocked=function(t){var i,e,s=parseInt(t.name.charAt(4),10)-1,a=Ph2.AnimationSystem.findObject("star_empty",t),n=Ph2.AnimationSystem.findObject("price",t),o=Ph2.AnimationSystem.findObject("black",t),r=this.selectingPlayer1?this.charactersChosen[0]:this.charactersChosen[1],h=(this.selectingPlayer1?this.outfitPlayer1:this.outfitPlayer2).face,c=Ph2.AnimationSystem.findObject("face1_anim",this.item2),l=Ph2.AnimationSystem.findObject("face2_anim",this.item2);"item2"===t.name&&(0===r?(c.visible=2!==h,l.visible=!1):3===r?(c.visible=!1,l.visible=2!==h):(c.visible=!1,l.visible=!1)),a.visible=!1,n.visible=!1,o.visible=!1,r="item1"===t.name||"item2"===t.name||"item3"===t.name?(i=this.facePlayer1,this.facePlayer2):"item4"===t.name||"item5"===t.name||"item6"===t.name?(i=this.headPlayer1+3,this.headPlayer2+3):(i=this.bodyPlayer1+6,this.bodyPlayer2+6),this.selectingPlayer1?e=i===1+s:this.selectingPlayer2&&(e=r===1+s),e?(this.itemImages[s].alpha=0,this.itemFrames[s].frameName="item_bottom2.png"):(this.itemImages[s].alpha=1,this.itemFrames[s].frameName="item_bottom.png")},e.prototype.itemLocked=function(t){var i,e,s=parseInt(t.name.charAt(4),10)-1,a=p.Instances.DataManager.getPlayerPoints(),n=p.SETTINGS.ITEM_COSTS[s],o=Ph2.AnimationSystem.findObject("star_empty",t),r=Ph2.AnimationSystem.findObject("price",t),h=Ph2.AnimationSystem.findObject("black",t);o.visible=!0,r.visible=!0,h.visible=!0,o.frameName=n<=a?"dress_up_star_full.png":"dress_up_star_empty.png",r=this.selectingPlayer1?this.charactersChosen[0]:this.charactersChosen[1],h=(this.selectingPlayer1?this.outfitPlayer1:this.outfitPlayer2).face,o=Ph2.AnimationSystem.findObject("face1_anim",this.item2),n=Ph2.AnimationSystem.findObject("face2_anim",this.item2),"item2"===t.name&&(0===r?(o.visible=2!==h,n.visible=!1):3===r?(o.visible=!1,n.visible=2!==h):(o.visible=!1,n.visible=!1)),a="item1"===t.name||"item2"===t.name||"item3"===t.name?(i=this.facePlayer1,this.facePlayer2):"item4"===t.name||"item5"===t.name||"item6"===t.name?(i=this.headPlayer1+3,this.headPlayer2+3):(i=this.bodyPlayer1+6,this.bodyPlayer2+6),this.selectingPlayer1?e=i===1+s:this.selectingPlayer2&&(e=a===1+s),e?(this.itemImages[s].alpha=0,this.itemFrames[s].frameName="item_bottom2.png"):(this.itemImages[s].alpha=1,this.itemFrames[s].frameName="item_bottom.png")},e.prototype.unlockItem=function(t){var i,e=Ph2.AnimationSystem.findObject("star_empty",t),s=Ph2.AnimationSystem.findObject("price",t);e.visible=!1,s.visible=!1,(i=Ph2.AnimationSystem.findObject("black",t)).ph2Animations.play("unlock_play",1,!1).onComplete.add(function(){i.visible=!1},this),this.game.ph2AudioManager.playEffect("sound_dressUnlock",!1),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.UNLOCK_1_OUTFIT),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",p.MISSION.UNLOCK_OUTFIT_FOR_EVERY_ROBOT,this.currentCharacterOn)},e.prototype.checkCharacterItems=function(t){var i,e;for(this.facePlayer1=this.equippedOutfits[this.charactersChosen[0]].face,this.facePlayer2=this.equippedOutfits[this.charactersChosen[1]].face,this.bodyPlayer1=this.equippedOutfits[this.charactersChosen[0]].body,this.bodyPlayer2=this.equippedOutfits[this.charactersChosen[1]].body,this.headPlayer1=this.equippedOutfits[this.charactersChosen[0]].head,this.headPlayer2=this.equippedOutfits[this.charactersChosen[1]].head,i=this.unlocks[t].items,e=0;e<i.length;e++)if(i[e])switch(e){case 0:this.itemAlreadyUnlocked(this.item1);break;case 1:this.itemAlreadyUnlocked(this.item2);break;case 2:this.itemAlreadyUnlocked(this.item3);break;case 3:this.itemAlreadyUnlocked(this.item4);break;case 4:this.itemAlreadyUnlocked(this.item5);break;case 5:this.itemAlreadyUnlocked(this.item6);break;case 6:this.itemAlreadyUnlocked(this.item7);break;case 7:this.itemAlreadyUnlocked(this.item8);break;case 8:this.itemAlreadyUnlocked(this.item9)}else switch(e){case 0:this.itemLocked(this.item1);break;case 1:this.itemLocked(this.item2);break;case 2:this.itemLocked(this.item3);break;case 3:this.itemLocked(this.item4);break;case 4:this.itemLocked(this.item5);break;case 5:this.itemLocked(this.item6);break;case 6:this.itemLocked(this.item7);break;case 7:this.itemLocked(this.item8);break;case 8:this.itemLocked(this.item9)}},e.prototype.itemOver=function(t){var i,e,s,a=parseInt(t.parent.name.charAt(4),10)-1;if(this.unlocks[this.currentCharacterOn].items[a]){switch(t.parent.name){case"item1":case"item2":case"item3":e=this.facePlayer1,s=this.facePlayer2;break;case"item4":case"item5":case"item6":e=this.headPlayer1+3,s=this.headPlayer2+3;break;case"item7":case"item8":case"item9":e=this.bodyPlayer1+6,s=this.bodyPlayer2+6}this.selectingPlayer1?i=e===1+a:this.selectingPlayer2&&(i=s===1+a),this.itemFrames[a].frameName=i?"item_bottom3.png":"item_bottom_hover.png"}},e.prototype.itemOut=function(t){var i,e,s,a=parseInt(t.parent.name.charAt(4),10)-1,n=this.unlocks[this.currentCharacterOn].items[a];if(this.itemPopups[a].visible&&(this.itemPopups[a].visible=!1,this.popupTimer=-1,this.visiblePopup=-1),n){switch(t.parent.name){case"item1":case"item2":case"item3":e=this.facePlayer1,s=this.facePlayer2;break;case"item4":case"item5":case"item6":e=this.headPlayer1+3,s=this.headPlayer2+3;break;case"item7":case"item8":case"item9":e=this.bodyPlayer1+6,s=this.bodyPlayer2+6}this.selectingPlayer1?i=e===1+a:this.selectingPlayer2&&(i=s===1+a),this.itemFrames[a].frameName=i?"item_bottom2.png":"item_bottom.png"}},e.prototype.update=function(){this.updateMissionText(),-1<this.popupTimer&&(this.popupTimer-=this.game.time.elapsedMS,this.popupTimer<=0)&&(this.popupTimer=-1,this.itemPopups[this.visiblePopup].visible)&&(this.itemPopups[this.visiblePopup].visible=!1,this.visiblePopup=-1)},e.prototype.updateMissionText=function(){var t,i,e,s,a,n,o,r,h,c;this.checkMissionText(this.textMission1),this.checkMissionText(this.textMission2),this.checkMissionText(this.textMission3),(this.movingText1||this.movingText2||this.movingText3)&&(r=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),h=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),c=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions),o=.5*p.SETTINGS.SCALE,this.movingText1&&(s=this.directionMission1,t=300*p.SETTINGS.SCALE-r.width),this.movingText2&&(a=this.directionMission2,i=300*p.SETTINGS.SCALE-h.width),this.movingText3&&(n=this.directionMission3,e=300*p.SETTINGS.SCALE-c.width),this.textMission1.width>t&&("left"===s?(this.textMission1.x-=o,this.textMission1.x<=this.missionLimitLeft1&&(s="right")):"right"===s&&(this.textMission1.x+=o,this.textMission1.x>=this.missionLimitRight1)&&(s="left"),this.directionMission1=s),this.textMission2.width>i&&("left"===a?(this.textMission2.x-=o,this.textMission2.x<=this.missionLimitLeft2&&(a="right")):"right"===a&&(this.textMission2.x+=o,this.textMission2.x>=this.missionLimitRight2)&&(a="left"),this.directionMission2=a),this.textMission3.width>e)&&("left"===n?(this.textMission3.x-=o,this.textMission3.x<=this.missionLimitLeft3&&(n="right")):"right"===n&&(this.textMission3.x+=o,this.textMission3.x>=this.missionLimitRight3)&&(n="left"),this.directionMission3=n)},e.prototype.resize=function(){var t,i,e,s,a,n;this.isDesktop||(s=Constants.CURRENT_ORIENTATION,a=this.game.width,n=this.game.height,this.overlayBonus.width=a,this.overlayBonus.height=n,this.overlayBonus.width=a,this.overlayBonus.height=n,this.overlayDressUp.width=a,this.overlayDressUp.height=n,this.overlayMissions.width=a,this.overlayDressUp.height=n,this.bgLandscape.x=.5*a,this.bgLandscape.y=.5*n,this.bgPortrait.x=.5*a,this.bgPortrait.y=n,this.bgGameOver.x=.5*a,this.bgGameOver.y=.5*n,this.bgGameOverPortrait.x=.5*a,this.bgGameOverPortrait.y=n,this.bgGameOverPortrait.scale.set(1,1),this.bgGameOverPortrait.scale.set(1,1),this.bgLandscape.scale.set(1,1),this.bgPortrait.scale.set(1,1),this.animationGameOver.x=.5*a,this.animationGameOver.y=.5*n,a=Ph2.UISystem.findObject("container/trophy",this.uiLevelComplete),n=this.container.y-Math.abs(a.y),a=this.container.x-Math.abs(a.x),this.trophy.position.set(a,n),"landscape"===Constants.CURRENT_ORIENTATION?(this.showingGameOver?(this.bgGameOver.visible=!0,this.bgGameOverPortrait.visible=!1,this.bgLandscape.visible=!1,this.bgPortrait.visible=!1):(this.bgLandscape.visible=!0,this.bgPortrait.visible=!1,this.bgGameOver.visible=!1,this.bgGameOverPortrait.visible=!1),this.iconPlayerOne.visible=!0,this.iconPlayerTwo.visible=this.playerMode===p.PLAYER_MODE.MULTI_PLAYER,this.container.frameName="big_container1.png",i=175*p.SETTINGS.SCALE,e=40*p.SETTINGS.SCALE,this.spineGameOverHero1.position.set(i,e)):"portrait"===Constants.CURRENT_ORIENTATION&&(this.showingGameOver?(this.bgLandscape.visible=!1,this.bgPortrait.visible=!1,this.bgGameOver.visible=!1,this.bgGameOverPortrait.visible=!0):(this.bgLandscape.visible=!1,this.bgPortrait.visible=!0,this.bgGameOver.visible=!1,this.bgGameOverPortrait.visible=!1),this.iconPlayerOne.visible=!1,this.iconPlayerTwo.visible=!1,this.container.frameName="big_container2.png",i=175*p.SETTINGS.SCALE,e=40*p.SETTINGS.SCALE,this.spineGameOverHero1.position.set(i,e)),a="landscape"===s?Constants.CALCULATED_WIDTH-this.bgLandscape.width:Constants.CALCULATED_WIDTH-this.bgPortrait.width,(n="landscape"===s?Constants.CALCULATED_HEIGHT-this.bgLandscape.height:Constants.CALCULATED_HEIGHT-this.bgPortrait.height)<a?0<a&&(t="landscape"===s?Constants.CALCULATED_WIDTH/this.bgLandscape.width:Constants.CALCULATED_WIDTH/this.bgPortrait.width,this.bgLandscape.scale.set(t,t),this.bgPortrait.scale.set(t,t)):0<n&&(t="landscape"===s?Constants.CALCULATED_HEIGHT/this.bgLandscape.height:Constants.CALCULATED_HEIGHT/this.bgPortrait.height,this.bgLandscape.scale.set(t,t),this.bgPortrait.scale.set(t,t)),this.overlayDressUp.scale.set(t,t),this.resizeGameOverBorders(),this.comic.resizeComic())},e.prototype.resizeGameOverBorders=function(){var t=Ph2.UISystem.findObject("container/black_l",this.uiGameOver),i=Ph2.UISystem.findObject("container/black_r",this.uiGameOver),e=Ph2.UISystem.findObject("container/black_top",this.uiGameOver),s=Ph2.UISystem.findObject("container/black_bottom",this.uiGameOver),a=this.game.width,n=this.game.height;t.resize(.5*a,n),i.resize(.5*a,n),e.resize(a,.5*n),s.resize(a,.5*n)},e.prototype.createCheats=function(){var t=this,i=this.game.input.keyboard.addKey(Phaser.Keyboard.ONE),e=this.game.input.keyboard.addKey(Phaser.Keyboard.TWO),s=this.game.input.keyboard.addKey(Phaser.Keyboard.THREE);i.onDown.add(function(){p.Instances.MissionManager.missionsActive[0].completeMissionWithCheats(),t.checkMissionsCompleted(!0)},this),e.onDown.add(function(){p.Instances.MissionManager.missionsActive[1].completeMissionWithCheats(),t.checkMissionsCompleted(!0)},this),s.onDown.add(function(){p.Instances.MissionManager.missionsActive[2].completeMissionWithCheats(),t.checkMissionsCompleted(!0)},this)};var t,i=e;function e(){return t.call(this)||this}p.GameOverState=i}(Game=Game||{}),function(m){t=Phaser.State,__extends(e,t),e.prototype.init=function(t){this.firstLogin=!1,this.gameScale=m.SETTINGS.SCALE,this.gameMode=m.GAME_MODE.ARCADE,this.playerMode=m.PLAYER_MODE.SINGLE_PLAYER,this.enemiesSelected=3,this.levelsSelected=5,this.mapTheme=m.MAP_THEME.RANDOM,this.difficulty=m.DIFFICULTY.EASY,this.selectingPlayer1=!0,this.selectingPlayer2=!1,this.visiblePopup=-1,this.popupTimer=-1,this.playerCursorIndex1=0,this.playerCursorIndex2=1,this.charactersChosen=[0,1,2,3],this.currentCharacterOn=0,this.headsPlayer1=[],this.headsPlayer2=[],this.faces=[],this.bodies=[],this.outfitIndex1=0,this.outfitIndex2=0,this.unlocks=[],this.isDesktop=this.game.device.desktop,this.forceMobile=!1,this.changeFrameTimer=0,this.currentFrameButtons="small_button_select.png",this.directionMission1="left",this.directionMission2="left",this.directionMission3="left",this.movingText1=!1,this.movingText2=!1,this.movingText3=!1,this.currentMissionLimitLeft=0,this.currentMissionLimitRight=0,this.missionLimitLeft1=0,this.missionLimitLeft2=0,this.missionLimitLeft3=0,this.missionLimitRight1=0,this.missionLimitRight2=0,this.missionLimitRight3=0},e.prototype.create=function(){this.game.input.maxPointers=1,m.Instances.DataManager.saveLivesPlayer1(m.SETTINGS.INITIAL_LIVES),m.Instances.DataManager.saveLivesPlayer2(m.SETTINGS.INITIAL_LIVES),this.totalPoints=m.Instances.DataManager.getPlayerPoints(),this.unlocks=m.Instances.DataManager.getUnlocks(),this.equippedOutfits=m.Instances.DataManager.getEquippedOutfits(),this.headPlayer1=this.equippedOutfits[0].head,this.facePlayer1=this.equippedOutfits[0].face,this.bodyPlayer1=this.equippedOutfits[0].body,this.headPlayer2=this.equippedOutfits[1].head,this.facePlayer2=this.equippedOutfits[1].face,this.bodyPlayer2=this.equippedOutfits[1].body,this.bgLandscape=this.game.add.sprite(.5*this.game.width,.5*this.game.height,"mm_land"),this.bgLandscape.anchor.set(.5),this.bgPortrait=this.game.add.sprite(.5*this.game.width,this.game.height,"mm"),this.bgPortrait.anchor.set(.5,1),this.bgPortrait.visible=!1,this.group=new Phaser.Group(this.game),this.add.existing(this.group),this.uiMainMenu=this.game.add.ph2UI("main_menu","atlas_main_menu"),this.uiPowerups=this.game.add.ph2UI("powerups","atlas_missions"),this.uiSettings=this.game.add.ph2UI("settings","atlas_missions"),this.uiModeSelect=this.game.add.ph2UI("select_mode","atlas_select_mode"),this.uiGameSettings=this.game.add.ph2UI("game_settings","atlas_loading"),this.uiCharacterSelect=this.game.add.ph2UI("dress_up_character","atlas_ui_dress_up"),this.uiLoading=this.game.add.ph2UI("loading_ingame","atlas_loading"),this.uiMissions=this.game.add.ph2UI("pause","atlas_missions"),this.comic=new m.Comic(this.game),this.overlayMissions=new m.Overlay(this.game,.7,"bg_black"),this.overlayMissions.kill(),this.logoAnimation1=this.game.add.ph2AnimationObject(0,0,"logo1","atlas_main_menu"),this.logoAnimation2=this.game.add.ph2AnimationObject(0,0,"logo2","atlas_main_menu"),this.logoAnimation1.ph2Animations.play("logo1_stand",1,!0),this.logoAnimation2.ph2Animations.play("logo2_stand",1,!0),this.logo=Ph2.UISystem.findObject("logo",this.uiMainMenu),this.logo.addChild(this.logoAnimation1),this.logo.addChild(this.logoAnimation2),this.logo.frameName=!this.isDesktop||this.forceMobile?"mm_logo2.png":"mm_logo1.png",this.logoAnimation1.visible=this.isDesktop,this.logoAnimation2.visible=!this.isDesktop,this.introAnim=this.game.add.ph2AnimationObject(.5*this.game.width,.5*this.game.height,"intro","atlas_intro"),this.introAnim.visible=!1,this.trophy=this.game.add.ph2AnimationObject(0,0,"trophy","atlas_anim"),this.trophy.visible=!1,this.bomb=this.game.add.ph2AnimationObject(0,0,"bomb_ui","atlas_anim"),this.bomb.visible=!1,a=Ph2.UISystem.findObject("buttons_pivot",this.uiMainMenu),t=Ph2.UISystem.findObject("container",this.uiCharacterSelect),this.containerDressUp=Ph2.UISystem.findObject("container",this.uiCharacterSelect),this.containerSettings=Ph2.UISystem.findObject("container",this.uiGameSettings),this.containerSelectMode=Ph2.UISystem.findObject("container",this.uiModeSelect),this.containerLoading=Ph2.UISystem.findObject("container",this.uiLoading),this.containerControls=Ph2.UISystem.findObject("container",this.uiSettings),this.containerPowerUps=Ph2.UISystem.findObject("container",this.uiPowerups),i=Ph2.UISystem.findObject("mm_hero2",this.uiMainMenu),e=Ph2.UISystem.findObject("mm_bottom",this.uiMainMenu),this.bgSettings=Ph2.UISystem.findObject("container/bg",this.uiSettings),this.bgPowerUps=Ph2.UISystem.findObject("container/bg",this.uiPowerups),this.bgGameSettings=Ph2.UISystem.findObject("container/bg",this.uiGameSettings),this.bgDressUp=Ph2.UISystem.findObject("container/bg",this.uiCharacterSelect),this.bgLoading=Ph2.UISystem.findObject("container/bg",this.uiLoading),this.edgeSettings=Ph2.UISystem.findObject("container/edge",this.uiSettings),this.edgePowerUps=Ph2.UISystem.findObject("container/edge",this.uiPowerups),this.edgeGameSettings=Ph2.UISystem.findObject("container/edge",this.uiGameSettings),this.edgeDressUp=Ph2.UISystem.findObject("container/edge",this.uiCharacterSelect),this.edgeLoading=Ph2.UISystem.findObject("container/edge",this.uiLoading),this.buttonMission1=Ph2.UISystem.findObject("bg/mission1/close",this.uiMissions),this.buttonMission2=Ph2.UISystem.findObject("bg/mission2/close",this.uiMissions),this.buttonMission3=Ph2.UISystem.findObject("bg/mission3/close",this.uiMissions),this.logoAGAME=Ph2.UISystem.findObject("logo_agame",this.uiMainMenu),this.flagSelected=Ph2.UISystem.findObject("container_select/flag_select",this.uiMainMenu),this.flagContainer=Ph2.UISystem.findObject("container_flag",this.uiMainMenu),this.flagOption1=Ph2.UISystem.findObject("container_flag/flag1",this.uiMainMenu),this.flagOption2=Ph2.UISystem.findObject("container_flag/flag2",this.uiMainMenu),this.buttonMusic=Ph2.UISystem.findObject("sound_container/music",this.uiMainMenu),this.buttonAudio=Ph2.UISystem.findObject("sound_container/audio",this.uiMainMenu),this.buttonStartGame=Ph2.UISystem.findObject("buttons_container/start_button",this.uiMainMenu),this.buttonHowToPlay=Ph2.UISystem.findObject("buttons_container/how_to_play_button",this.uiMainMenu),this.buttonMoreGames=Ph2.UISystem.findObject("buttons_container/more_games_button",this.uiMainMenu),this.buttonControls=Ph2.UISystem.findObject("container/controls_button",this.uiPowerups),this.buttonPowerups=Ph2.UISystem.findObject("container/power_ups_button",this.uiSettings),this.buttonBackToMainMenu1=Ph2.UISystem.findObject("container/back_button",this.uiSettings),this.buttonBackToMainMenu2=Ph2.UISystem.findObject("container/back_button",this.uiPowerups),this.buttonBackToMainMenu3=Ph2.UISystem.findObject("container/back_button",this.uiModeSelect),this.buttonNextToGameSettings=Ph2.UISystem.findObject("container/next_button",this.uiModeSelect),this.buttonCharacterSelect=Ph2.UISystem.findObject("container/ok_button",this.uiGameSettings),this.buttonBackToMode=Ph2.UISystem.findObject("container/back_button",this.uiGameSettings),this.buttonGotoGameplay=Ph2.UISystem.findObject("container/start_button",this.uiCharacterSelect),this.buttonBackToSettings=Ph2.UISystem.findObject("container/back_button",this.uiCharacterSelect),AzerionIntegration.SDK.hideSponsorLogo()&&(this.logoAGAME.visible=!1),this.imageModeSelected=Ph2.UISystem.findObject("container/mode_image",this.uiModeSelect),this.blackContainerGameMode=Ph2.UISystem.findObject("container/black_container",this.uiModeSelect),s=Ph2.UISystem.findObject("container",this.uiModeSelect),this.textGameMode=Ph2.UISystem.findObject("container/description",this.uiModeSelect),this.button1Player=Ph2.UISystem.findObject("container/1player_button",this.uiGameSettings),this.button2Player=Ph2.UISystem.findObject("container/2player_button",this.uiGameSettings),this.button0Enemies=Ph2.UISystem.findObject("container/0enemies_button",this.uiGameSettings),this.button1Enemies=Ph2.UISystem.findObject("container/1enemies_button",this.uiGameSettings),this.button2Enemies=Ph2.UISystem.findObject("container/2enemies_button",this.uiGameSettings),this.button3Enemies=Ph2.UISystem.findObject("container/3enemies_button",this.uiGameSettings),this.button20Levels=Ph2.UISystem.findObject("container/20levels_button",this.uiGameSettings),this.button15Levels=Ph2.UISystem.findObject("container/15levels_button",this.uiGameSettings),this.button10Levels=Ph2.UISystem.findObject("container/10levels_button",this.uiGameSettings),this.button5Levels=Ph2.UISystem.findObject("container/5levels_button",this.uiGameSettings),this.buttonAquarium=Ph2.UISystem.findObject("container/aquarium_button",this.uiGameSettings),this.buttonBathroom=Ph2.UISystem.findObject("container/bathroom_button",this.uiGameSettings),this.buttonBaseballField=Ph2.UISystem.findObject("container/baseball_field_button",this.uiGameSettings),this.buttonCastle=Ph2.UISystem.findObject("container/castle_button",this.uiGameSettings),this.buttonDollhouse=Ph2.UISystem.findObject("container/dollhouse_button",this.uiGameSettings),this.buttonFarm=Ph2.UISystem.findObject("container/farm_button",this.uiGameSettings),this.buttonGarden=Ph2.UISystem.findObject("container/garden_button",this.uiGameSettings),this.buttonPolarRegion=Ph2.UISystem.findObject("container/polar_region_button",this.uiGameSettings),this.buttonPicnic=Ph2.UISystem.findObject("container/picnic_button",this.uiGameSettings),this.buttonRandom=Ph2.UISystem.findObject("container/random_button",this.uiGameSettings),this.buttonEasy=Ph2.UISystem.findObject("container/easy_button",this.uiGameSettings),this.buttonNormal=Ph2.UISystem.findObject("container/normal_button",this.uiGameSettings),this.buttonHard=Ph2.UISystem.findObject("container/hard_button",this.uiGameSettings),this.spineContainer=Ph2.UISystem.findObject("container/character_container/character",this.uiCharacterSelect),this.iconPlayerNumber=Ph2.UISystem.findObject("container/character_container/p1_image",this.uiCharacterSelect),this.characterButtons=[],this.buttonCharacter1=Ph2.UISystem.findObject("container/character1_button",this.uiCharacterSelect),this.buttonCharacter2=Ph2.UISystem.findObject("container/character2_button",this.uiCharacterSelect),this.buttonCharacter3=Ph2.UISystem.findObject("container/character3_button",this.uiCharacterSelect),this.buttonCharacter4=Ph2.UISystem.findObject("container/character4_button",this.uiCharacterSelect),this.buttonCharacter5=Ph2.UISystem.findObject("container/character5_button",this.uiCharacterSelect),this.buttonCharacter6=Ph2.UISystem.findObject("container/character6_button",this.uiCharacterSelect),this.buttonCharacter7=Ph2.UISystem.findObject("container/character7_button",this.uiCharacterSelect),this.buttonCharacter8=Ph2.UISystem.findObject("container/character8_button",this.uiCharacterSelect),this.characterButtons.push(this.buttonCharacter1,this.buttonCharacter2,this.buttonCharacter3,this.buttonCharacter4,this.buttonCharacter5,this.buttonCharacter6,this.buttonCharacter7,this.buttonCharacter8),this.currentButtonCharacterP1=this.buttonCharacter1,this.currentButtonCharacterP2=this.buttonCharacter2,this.buttonCharacter1.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),this.buttonCharacter2.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),this.buttonCharacter3.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),this.buttonCharacter4.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),this.buttonCharacter5.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),this.buttonCharacter6.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),this.buttonCharacter7.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),this.buttonCharacter8.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),this.iconPlayerNumber.visible=!(!this.isDesktop||this.forceMobile),this.iconPlayerNumber.visibility.enable(!(!this.isDesktop||this.forceMobile)),this.itemContainer1=Ph2.UISystem.findObject("container/itmes_container/item1",this.uiCharacterSelect),this.itemContainer2=Ph2.UISystem.findObject("container/itmes_container/item2",this.uiCharacterSelect),this.itemContainer3=Ph2.UISystem.findObject("container/itmes_container/item3",this.uiCharacterSelect),this.itemContainer4=Ph2.UISystem.findObject("container/itmes_container/item4",this.uiCharacterSelect),this.itemContainer5=Ph2.UISystem.findObject("container/itmes_container/item5",this.uiCharacterSelect),this.itemContainer6=Ph2.UISystem.findObject("container/itmes_container/item6",this.uiCharacterSelect),this.itemContainer7=Ph2.UISystem.findObject("container/itmes_container/item7",this.uiCharacterSelect),this.itemContainer8=Ph2.UISystem.findObject("container/itmes_container/item8",this.uiCharacterSelect),this.itemContainer9=Ph2.UISystem.findObject("container/itmes_container/item9",this.uiCharacterSelect),this.textStarPoints=Ph2.AnimationSystem.findObject("score",this.trophy),this.buttonsBombIts=this.game.add.ph2AnimationObject(0,0,"buttons_bombit","atlas_main_menu"),this.buttonsBombIts.ph2Animations.play("buttons_bombit_stand",1,!0),this.buttonBombIt2=Ph2.AnimationSystem.findObject("bombit2",this.buttonsBombIts),this.buttonBombIt3=Ph2.AnimationSystem.findObject("bombit3",this.buttonsBombIts),this.buttonBombIt4=Ph2.AnimationSystem.findObject("bombit4",this.buttonsBombIts),this.buttonBombIt5=Ph2.AnimationSystem.findObject("bombit5",this.buttonsBombIts),this.buttonBombIt6=Ph2.AnimationSystem.findObject("bombit6",this.buttonsBombIts),a.addChild(this.buttonsBombIts),this.animationButtonChange=this.game.add.ph2AnimationObject(0,-50*m.SETTINGS.SCALE,"change_button","atlas_ui_dress_up"),this.animationButtonChange.ph2Animations.play("change_button_stand",1,!0),this.buttonChangeCharacter=Ph2.AnimationSystem.findObject("base",this.animationButtonChange),this.animationButtonChange.visible=this.playerMode===m.PLAYER_MODE.MULTI_PLAYER,t.addChild(this.animationButtonChange),this.textMission1=Ph2.UISystem.findObject("bg/mission1/description",this.uiMissions),this.textMission2=Ph2.UISystem.findObject("bg/mission2/description",this.uiMissions),this.textMission3=Ph2.UISystem.findObject("bg/mission3/description",this.uiMissions);var t,i,e,s,a=this.game.add.ph2AnimationObject(0,0,"arrows","atlas_select_mode");switch(this.arrowRight=Ph2.AnimationSystem.findObject("arrow_right",a),this.arrowRight.ph2Animations.play("arrow_stand",1,!0),this.arrowLeft=Ph2.AnimationSystem.findObject("arrow_left",a),this.arrowLeft.ph2Animations.play("arrow_stand",1,!0),this.arrowLeft.scale.x=-1,s.addChild(this.arrowLeft),s.addChild(this.arrowRight),this.spineDressHero1=this.game.add.spine(0,0,"dress_hero1"),this.spineDressHero1.createCombinedSkin("outfit","normal0","head1","face1","body1"),this.spineDressHero1.setSkinByName("outfit"),this.spineContainer.addChild(this.spineDressHero1),this.spinePlayerName1="dress_hero1",this.spineDressHero1.scale.setTo(m.SETTINGS.SCALE),this.spineDressHero2=this.game.add.spine(0,0,"dress_hero2"),this.spineDressHero2.createCombinedSkin("outfit","normal0","head1","face1","body1"),this.spineDressHero2.setSkinByName("outfit"),this.spineDressHero2.visible=!1,this.spineContainer.addChild(this.spineDressHero2),this.spinePlayerName2="dress_hero2",this.spineDressHero2.scale.setTo(m.SETTINGS.SCALE),this.spineMainMenuHero1=this.game.add.spine(0,0,"mm_hero2"),this.spineMainMenuHero1.setSkinByName("normal_mockup5"),this.spineMainMenuHero1.scale.setTo(m.SETTINGS.SCALE),this.spineMainMenuHero2=this.game.add.spine(0,0,"mm_bottom"),this.spineMainMenuHero2.scale.setTo(m.SETTINGS.SCALE),this.button1Player.changeFrame("small_button_select.png"),this.button3Enemies.changeFrame("small_button_select.png"),this.button5Levels.changeFrame("small_button_select.png"),this.buttonRandom.changeFrame("small_button_select.png"),this.buttonEasy.changeFrame("small_button_select.png"),this.uiMissions.visible=!1,this.uiPowerups.visible=!1,this.uiSettings.visible=!1,this.uiModeSelect.visible=!1,this.uiGameSettings.visible=!1,this.uiCharacterSelect.visible=!1,this.uiLoading.visible=!1,this.flagContainer.visible=!1,this.flagContainer.visibility.enable(!1),this.currentButtonPlayers=this.button1Player,this.currentButtonEnemies=this.button3Enemies,this.currentButtonLevels=this.button5Levels,this.currentButtonArena=this.buttonRandom,this.currentButtonDifficulty=this.buttonEasy,e.addChild(this.spineMainMenuHero2),i.addChild(this.spineMainMenuHero1),this.group.add(this.uiMainMenu),this.group.add(this.uiSettings),this.group.add(this.uiPowerups),this.group.add(this.uiModeSelect),this.group.add(this.uiGameSettings),this.group.add(this.uiCharacterSelect),this.group.add(this.overlayMissions),this.group.add(this.uiMissions),this.group.add(this.introAnim),this.group.add(this.comic),m.Instances.DataManager.getAudio()?this.game.ph2AudioManager.getSfxEnabled()||this.game.ph2AudioManager.switchSfxState():(this.buttonAudio.setFrames("mm_audio_off.png","mm_audio_off.png","mm_audio.png","mm_audio_off.png"),this.game.ph2AudioManager.getSfxEnabled()&&this.game.ph2AudioManager.switchSfxState()),m.Instances.DataManager.getMusic()?this.game.ph2AudioManager.switchMusic(m.Music.MAIN_MENU):(this.buttonMusic.setFrames("mm_music_off.png","mm_music_off.png","mm_music.png","mm_music_off.png"),this.game.ph2AudioManager.getMusicEnabled()&&this.game.ph2AudioManager.switchMusicState()),m.Instances.DataManager.getLanguage()){case"en-US":this.flagSelected.frameName="eng.png",this.flagOption1.frameName="esp.png",this.flagOption2.frameName="hol.png";break;case"es-ES":this.flagSelected.frameName="esp.png",this.flagOption1.frameName="eng.png",this.flagOption2.frameName="hol.png";break;case"nl-NL":this.flagSelected.frameName="hol.png",this.flagOption1.frameName="eng.png",this.flagOption2.frameName="esp.png";break;default:this.flagSelected.frameName="eng.png",this.flagOption1.frameName="esp.png",this.flagOption2.frameName="hol.png"}this.createSelectCharacterFaces(),this.createUnlockableItems(),this.obtainSkins(),this.checkCharacterItems(0),this.addTouchListeners(),this.localizeUI(),this.setMenuSkin(),this.checkTimerMissions(),this.loadMissions(),this.createMissionsMask(),this.resize(),this.buttonMoreGames.visible=!1,this.buttonBombIt2.visible=!1,this.buttonBombIt3.visible=!1,this.buttonBombIt4.visible=!1,this.buttonBombIt5.visible=!1,this.buttonBombIt6.visible=!1},e.prototype.createMissionsMask=function(){var t=300*m.SETTINGS.SCALE,i=45*m.SETTINGS.SCALE,e=Ph2.UISystem.findObject("bg/mission1",this.uiMissions),s=Ph2.UISystem.findObject("bg/mission2",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission3",this.uiMissions),n=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),o=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),r=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions);this.missionMask1=this.game.add.graphics(this.textMission1.x,this.textMission1.y-.5*i),this.missionMask2=this.game.add.graphics(this.textMission2.x,this.textMission2.y-.5*i),this.missionMask3=this.game.add.graphics(this.textMission3.x,this.textMission3.y-.5*i),this.missionMask1.beginFill(65331),this.missionMask1.drawRect(0,0,t-n.width,i),this.missionMask1.endFill(),this.missionMask2.beginFill(65331),this.missionMask2.drawRect(0,0,t-o.width,i),this.missionMask2.endFill(),this.missionMask3.beginFill(65331),this.missionMask3.drawRect(0,0,t-r.width,i),this.missionMask3.endFill(),e.addChild(this.missionMask1),s.addChild(this.missionMask2),a.addChild(this.missionMask3),this.textMission1.mask=this.missionMask1,this.textMission2.mask=this.missionMask2,this.textMission3.mask=this.missionMask3,this.getMissionLimits()},e.prototype.getMissionLimits=function(){var t,i=10*m.SETTINGS.SCALE,e=300*m.SETTINGS.SCALE,s=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),n=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions);this.textMission1.width>=e-s.width&&(t=this.textMission1.width-(e-s.width),this.missionLimitLeft1=this.textMission1.left-(t+i),this.missionLimitRight1=this.textMission1.x+i),this.textMission2.width>=e-a.width&&(t=this.textMission2.width-(e-a.width),this.missionLimitLeft2=this.textMission2.left-(t+i),this.missionLimitRight2=this.textMission2.x+i),this.textMission3.width>=e-n.width&&(t=this.textMission3.width-(e-n.width),this.missionLimitLeft3=this.textMission3.left-(t+i),this.missionLimitRight3=this.textMission3.x+i)},e.prototype.checkTimerMissions=function(){for(var t=0;t<m.Instances.MissionManager.missionsActive.length;t++)m.Instances.MissionManager.missionsActive[t].hasTimer&&m.Instances.MissionManager.missionsActive[t].progress<=m.Instances.MissionManager.missionsActive[t].requirement&&m.Instances.MissionManager.missionsActive[t].restartMission()},e.prototype.createSelectCharacterFaces=function(){var t,i;for(this.characterFaces=[],t=1;t<9;t++)(i=this.game.add.ph2AnimationObject(0,0,"character"+t,"atlas_ui_dress_up")).ph2Animations.play("character"+t+"_stand",1,!0),Ph2.UISystem.findObject("container/character"+t,this.uiCharacterSelect).addChildAt(i,0),Ph2.UISystem.findObject("container/character"+t+"/player",this.uiCharacterSelect).visible=!1,Ph2.UISystem.findObject("container/character"+t+"/player",this.uiCharacterSelect).visibility.enable(!1),this.characterFaces.push(i)},e.prototype.createUnlockableItems=function(){this.item9=this.game.add.ph2AnimationObject(0,0,"item9","atlas_ui_dress_up"),this.item8=this.game.add.ph2AnimationObject(0,0,"item8","atlas_ui_dress_up"),this.item7=this.game.add.ph2AnimationObject(0,0,"item7","atlas_ui_dress_up"),this.item6=this.game.add.ph2AnimationObject(0,0,"item6","atlas_ui_dress_up"),this.item5=this.game.add.ph2AnimationObject(0,0,"item5","atlas_ui_dress_up"),this.item4=this.game.add.ph2AnimationObject(0,0,"item4","atlas_ui_dress_up"),this.item3=this.game.add.ph2AnimationObject(0,0,"item3","atlas_ui_dress_up"),this.item2=this.game.add.ph2AnimationObject(0,0,"item2","atlas_ui_dress_up"),this.item1=this.game.add.ph2AnimationObject(0,0,"item1","atlas_ui_dress_up"),this.items=[],this.items.push(this.item1,this.item2,this.item3,this.item4,this.item5,this.item6,this.item7,this.item8,this.item9),this.itemContainer9.add(this.item9),this.itemContainer8.add(this.item8),this.itemContainer7.add(this.item7),this.itemContainer6.add(this.item6),this.itemContainer5.add(this.item5),this.itemContainer4.add(this.item4),this.itemContainer3.add(this.item3),this.itemContainer2.add(this.item2),this.itemContainer1.add(this.item1),this.itemPrice1=Ph2.AnimationSystem.findObject("price",this.item1),this.itemPrice2=Ph2.AnimationSystem.findObject("price",this.item2),this.itemPrice3=Ph2.AnimationSystem.findObject("price",this.item3),this.itemPrice4=Ph2.AnimationSystem.findObject("price",this.item4),this.itemPrice5=Ph2.AnimationSystem.findObject("price",this.item5),this.itemPrice6=Ph2.AnimationSystem.findObject("price",this.item6),this.itemPrice7=Ph2.AnimationSystem.findObject("price",this.item7),this.itemPrice8=Ph2.AnimationSystem.findObject("price",this.item8),this.itemPrice9=Ph2.AnimationSystem.findObject("price",this.item9),this.itemImages=[],this.itemImage1=Ph2.AnimationSystem.findObject("image",this.item1),this.itemImage2=Ph2.AnimationSystem.findObject("image",this.item2),this.itemImage3=Ph2.AnimationSystem.findObject("image",this.item3),this.itemImage4=Ph2.AnimationSystem.findObject("image",this.item4),this.itemImage5=Ph2.AnimationSystem.findObject("image",this.item5),this.itemImage6=Ph2.AnimationSystem.findObject("image",this.item6),this.itemImage7=Ph2.AnimationSystem.findObject("image",this.item7),this.itemImage8=Ph2.AnimationSystem.findObject("image",this.item8),this.itemImage9=Ph2.AnimationSystem.findObject("image",this.item9),this.itemImages.push(this.itemImage1,this.itemImage2,this.itemImage3,this.itemImage4,this.itemImage5,this.itemImage6,this.itemImage7,this.itemImage8,this.itemImage9),this.itemPopups=[],this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item1",this.item1)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item2",this.item2)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item3",this.item3)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item4",this.item4)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item5",this.item5)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item6",this.item6)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item7",this.item7)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item8",this.item8)),this.itemPopups.push(Ph2.AnimationSystem.findObject("bubble_item9",this.item9));for(var t=0;t<this.itemPopups.length;t++)this.itemPopups[t].visible=!1;this.itemFrames=[],this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item1)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item2)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item3)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item4)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item5)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item6)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item7)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item8)),this.itemFrames.push(Ph2.AnimationSystem.findObject("bottom",this.item9)),this.itemPrice1.setText(m.SETTINGS.ITEM_COSTS[0].toString()),this.itemPrice2.setText(m.SETTINGS.ITEM_COSTS[1].toString()),this.itemPrice3.setText(m.SETTINGS.ITEM_COSTS[2].toString()),this.itemPrice4.setText(m.SETTINGS.ITEM_COSTS[3].toString()),this.itemPrice5.setText(m.SETTINGS.ITEM_COSTS[4].toString()),this.itemPrice6.setText(m.SETTINGS.ITEM_COSTS[5].toString()),this.itemPrice7.setText(m.SETTINGS.ITEM_COSTS[6].toString()),this.itemPrice8.setText(m.SETTINGS.ITEM_COSTS[7].toString()),this.itemPrice9.setText(m.SETTINGS.ITEM_COSTS[8].toString())},e.prototype.addTouchListeners=function(){var t=this;this.buttonMusic.onInputDown.add(this.switchMusic,this),this.buttonAudio.onInputDown.add(this.switchAudio,this),this.buttonStartGame.events.onInputDown.add(this.showIntroComic1,this),this.buttonHowToPlay.events.onInputDown.add(this.showSettings,this),this.buttonMoreGames.events.onInputDown.add(this.gotoMoreGames,this),this.buttonControls.events.onInputDown.add(this.showSettings,this),this.buttonPowerups.events.onInputDown.add(this.showPowerups,this),this.buttonBackToMainMenu1.events.onInputDown.add(this.showMainMenu,this),this.buttonBackToMainMenu2.events.onInputDown.add(this.showMainMenu,this),this.buttonBackToMainMenu3.events.onInputDown.add(this.showMainMenu,this),this.buttonNextToGameSettings.events.onInputDown.add(this.showGameSettings,this),this.buttonCharacterSelect.events.onInputDown.add(this.showCharacterSelect,this),this.buttonBackToMode.events.onInputDown.add(this.showModeSelect,this),this.buttonGotoGameplay.events.onInputDown.add(this.gotoGameplay,this),this.buttonBackToSettings.events.onInputDown.add(this.showGameSettings,this),this.buttonStartGame.events.onInputOver.add(this.buttonInputOver,this),this.buttonHowToPlay.events.onInputOver.add(this.buttonInputOver,this),this.buttonMoreGames.events.onInputOver.add(this.buttonInputOver,this),this.buttonControls.events.onInputOver.add(this.buttonInputOver,this),this.buttonPowerups.events.onInputOver.add(this.buttonInputOver,this),this.buttonBackToMainMenu1.events.onInputOver.add(this.buttonInputOver,this),this.buttonBackToMainMenu2.events.onInputOver.add(this.buttonInputOver,this),this.buttonBackToMainMenu3.events.onInputOver.add(this.buttonInputOver,this),this.buttonNextToGameSettings.events.onInputOver.add(this.buttonInputOver,this),this.buttonCharacterSelect.events.onInputOver.add(this.buttonInputOver,this),this.buttonBackToMode.events.onInputOver.add(this.buttonInputOver,this),this.buttonGotoGameplay.events.onInputOver.add(this.buttonInputOver,this),this.buttonBackToSettings.events.onInputOver.add(this.buttonInputOver,this),this.buttonStartGame.events.onInputOut.add(e.buttonInputOut,this),this.buttonHowToPlay.events.onInputOut.add(e.buttonInputOut,this),this.buttonMoreGames.events.onInputOut.add(e.buttonInputOut,this),this.buttonControls.events.onInputOut.add(e.buttonInputOut,this),this.buttonPowerups.events.onInputOut.add(e.buttonInputOut,this),this.buttonBackToMainMenu1.events.onInputOut.add(e.buttonInputOut,this),this.buttonBackToMainMenu2.events.onInputOut.add(e.buttonInputOut,this),this.buttonBackToMainMenu3.events.onInputOut.add(e.buttonInputOut,this),this.buttonNextToGameSettings.events.onInputOut.add(e.buttonInputOut,this),this.buttonCharacterSelect.events.onInputOut.add(e.buttonInputOut,this),this.buttonBackToMode.events.onInputOut.add(e.buttonInputOut,this),this.buttonGotoGameplay.events.onInputOut.add(e.buttonInputOut,this),this.buttonBackToSettings.events.onInputOut.add(e.buttonInputOut,this),this.createButtonListener(this.arrowLeft,this.selectModeLeft),this.createButtonListener(this.arrowRight,this.selectModeRight),this.createButtonListener(this.button1Player,this.selectPlayerMode),this.createButtonListener(this.button2Player,this.selectPlayerMode),this.createButtonListener(this.button0Enemies,this.selectEnemies),this.createButtonListener(this.button1Enemies,this.selectEnemies),this.createButtonListener(this.button2Enemies,this.selectEnemies),this.createButtonListener(this.button3Enemies,this.selectEnemies),this.createButtonListener(this.button20Levels,this.selectLevels),this.createButtonListener(this.button15Levels,this.selectLevels),this.createButtonListener(this.button10Levels,this.selectLevels),this.createButtonListener(this.button5Levels,this.selectLevels),this.createButtonListener(this.buttonBathroom,this.selectTheme),this.createButtonListener(this.buttonPicnic,this.selectTheme),this.createButtonListener(this.buttonBaseballField,this.selectTheme),this.createButtonListener(this.buttonCastle,this.selectTheme),this.createButtonListener(this.buttonPolarRegion,this.selectTheme),this.createButtonListener(this.buttonFarm,this.selectTheme),this.createButtonListener(this.buttonGarden,this.selectTheme),this.createButtonListener(this.buttonAquarium,this.selectTheme),this.createButtonListener(this.buttonDollhouse,this.selectTheme),this.createButtonListener(this.buttonRandom,this.selectTheme),this.createButtonListener(this.buttonEasy,this.selectDifficulty),this.createButtonListener(this.buttonNormal,this.selectDifficulty),this.createButtonListener(this.buttonHard,this.selectDifficulty),this.button1Player.events.onInputOver.add(this.settingsInputOver,this),this.button2Player.events.onInputOver.add(this.settingsInputOver,this),this.button0Enemies.events.onInputOver.add(this.settingsInputOver,this),this.button1Enemies.events.onInputOver.add(this.settingsInputOver,this),this.button2Enemies.events.onInputOver.add(this.settingsInputOver,this),this.button3Enemies.events.onInputOver.add(this.settingsInputOver,this),this.button20Levels.events.onInputOver.add(this.settingsInputOver,this),this.button15Levels.events.onInputOver.add(this.settingsInputOver,this),this.button10Levels.events.onInputOver.add(this.settingsInputOver,this),this.button5Levels.events.onInputOver.add(this.settingsInputOver,this),this.buttonBathroom.events.onInputOver.add(this.settingsInputOver,this),this.buttonPicnic.events.onInputOver.add(this.settingsInputOver,this),this.buttonBaseballField.events.onInputOver.add(this.settingsInputOver,this),this.buttonCastle.events.onInputOver.add(this.settingsInputOver,this),this.buttonPolarRegion.events.onInputOver.add(this.settingsInputOver,this),this.buttonFarm.events.onInputOver.add(this.settingsInputOver,this),this.buttonGarden.events.onInputOver.add(this.settingsInputOver,this),this.buttonAquarium.events.onInputOver.add(this.settingsInputOver,this),this.buttonDollhouse.events.onInputOver.add(this.settingsInputOver,this),this.buttonRandom.events.onInputOver.add(this.settingsInputOver,this),this.buttonEasy.events.onInputOver.add(this.settingsInputOver,this),this.buttonNormal.events.onInputOver.add(this.settingsInputOver,this),this.buttonHard.events.onInputOver.add(this.settingsInputOver,this),this.button1Player.events.onInputOut.add(this.settingsInputOut,this),this.button2Player.events.onInputOut.add(this.settingsInputOut,this),this.button0Enemies.events.onInputOut.add(this.settingsInputOut,this),this.button1Enemies.events.onInputOut.add(this.settingsInputOut,this),this.button2Enemies.events.onInputOut.add(this.settingsInputOut,this),this.button3Enemies.events.onInputOut.add(this.settingsInputOut,this),this.button20Levels.events.onInputOut.add(this.settingsInputOut,this),this.button15Levels.events.onInputOut.add(this.settingsInputOut,this),this.button10Levels.events.onInputOut.add(this.settingsInputOut,this),this.button5Levels.events.onInputOut.add(this.settingsInputOut,this),this.buttonBathroom.events.onInputOut.add(this.settingsInputOut,this),this.buttonPicnic.events.onInputOut.add(this.settingsInputOut,this),this.buttonBaseballField.events.onInputOut.add(this.settingsInputOut,this),this.buttonCastle.events.onInputOut.add(this.settingsInputOut,this),this.buttonPolarRegion.events.onInputOut.add(this.settingsInputOut,this),this.buttonFarm.events.onInputOut.add(this.settingsInputOut,this),this.buttonGarden.events.onInputOut.add(this.settingsInputOut,this),this.buttonAquarium.events.onInputOut.add(this.settingsInputOut,this),this.buttonDollhouse.events.onInputOut.add(this.settingsInputOut,this),this.buttonRandom.events.onInputOut.add(this.settingsInputOut,this),this.buttonEasy.events.onInputOut.add(this.settingsInputOut,this),this.buttonNormal.events.onInputOut.add(this.settingsInputOut,this),this.buttonHard.events.onInputOut.add(this.settingsInputOut,this),this.createButtonListener2(this.buttonCharacter1,this.selectCharacter),this.createButtonListener2(this.buttonCharacter2,this.selectCharacter),this.createButtonListener2(this.buttonCharacter3,this.selectCharacter),this.createButtonListener2(this.buttonCharacter4,this.selectCharacter),this.createButtonListener2(this.buttonCharacter5,this.selectCharacter),this.createButtonListener2(this.buttonCharacter6,this.selectCharacter),this.createButtonListener2(this.buttonCharacter7,this.selectCharacter),this.createButtonListener2(this.buttonCharacter8,this.selectCharacter),this.buttonCharacter1.onInputOver.add(this.characterOver,this),this.buttonCharacter2.onInputOver.add(this.characterOver,this),this.buttonCharacter3.onInputOver.add(this.characterOver,this),this.buttonCharacter4.onInputOver.add(this.characterOver,this),this.buttonCharacter5.onInputOver.add(this.characterOver,this),this.buttonCharacter6.onInputOver.add(this.characterOver,this),this.buttonCharacter7.onInputOver.add(this.characterOver,this),this.buttonCharacter8.onInputOver.add(this.characterOver,this),this.buttonCharacter1.onInputOut.add(this.characterOut,this),this.buttonCharacter2.onInputOut.add(this.characterOut,this),this.buttonCharacter3.onInputOut.add(this.characterOut,this),this.buttonCharacter4.onInputOut.add(this.characterOut,this),this.buttonCharacter5.onInputOut.add(this.characterOut,this),this.buttonCharacter6.onInputOut.add(this.characterOut,this),this.buttonCharacter7.onInputOut.add(this.characterOut,this),this.buttonCharacter8.onInputOut.add(this.characterOut,this),this.createItemButtonListener(this.itemImage1,this.selectFace),this.createItemButtonListener(this.itemImage2,this.selectFace),this.createItemButtonListener(this.itemImage3,this.selectFace),this.createItemButtonListener(this.itemImage4,this.selectHead),this.createItemButtonListener(this.itemImage5,this.selectHead),this.createItemButtonListener(this.itemImage6,this.selectHead),this.createItemButtonListener(this.itemImage7,this.selectBody),this.createItemButtonListener(this.itemImage8,this.selectBody),this.createItemButtonListener(this.itemImage9,this.selectBody),this.createButtonListener(this.buttonChangeCharacter,this.switchSelection),this.createButtonListener(this.flagSelected,this.openLanguage),this.createButtonListener(this.flagOption1,this.changeLanguage),this.createButtonListener(this.flagOption2,this.changeLanguage),this.createButtonListener(this.buttonBombIt2,this.gotoBombIt),this.createButtonListener(this.buttonBombIt3,this.gotoBombIt),this.createButtonListener(this.buttonBombIt4,this.gotoBombIt),this.createButtonListener(this.buttonBombIt5,this.gotoBombIt),this.createButtonListener(this.buttonBombIt6,this.gotoBombIt),this.buttonBombIt2.events.onInputOver.add(this.bombItOver,this),this.buttonBombIt3.events.onInputOver.add(this.bombItOver,this),this.buttonBombIt4.events.onInputOver.add(this.bombItOver,this),this.buttonBombIt5.events.onInputOver.add(this.bombItOver,this),this.buttonBombIt6.events.onInputOver.add(this.bombItOver,this),this.buttonBombIt2.events.onInputOut.add(this.bombItOut,this),this.buttonBombIt3.events.onInputOut.add(this.bombItOut,this),this.buttonBombIt4.events.onInputOut.add(this.bombItOut,this),this.buttonBombIt5.events.onInputOut.add(this.bombItOut,this),this.buttonBombIt6.events.onInputOut.add(this.bombItOut,this),this.arrowLeft.input.useHandCursor=!0,this.arrowRight.input.useHandCursor=!0,this.itemImage1.input.useHandCursor=!0,this.itemImage2.input.useHandCursor=!0,this.itemImage3.input.useHandCursor=!0,this.itemImage4.input.useHandCursor=!0,this.itemImage5.input.useHandCursor=!0,this.itemImage6.input.useHandCursor=!0,this.itemImage7.input.useHandCursor=!0,this.itemImage8.input.useHandCursor=!0,this.itemImage9.input.useHandCursor=!0,this.buttonBombIt2.input.useHandCursor=!0,this.buttonBombIt3.input.useHandCursor=!0,this.buttonBombIt4.input.useHandCursor=!0,this.buttonBombIt5.input.useHandCursor=!0,this.buttonBombIt6.input.useHandCursor=!0,this.buttonCharacter1.input.useHandCursor=!0,this.buttonCharacter2.input.useHandCursor=!0,this.buttonCharacter3.input.useHandCursor=!0,this.buttonCharacter4.input.useHandCursor=!0,this.buttonCharacter5.input.useHandCursor=!0,this.buttonCharacter6.input.useHandCursor=!0,this.buttonCharacter7.input.useHandCursor=!0,this.buttonCharacter8.input.useHandCursor=!0,this.buttonChangeCharacter.events.onInputOver.add(function(){t.buttonChangeCharacter.frameName="change_hov_button.png",t.animationButtonChange.ph2Animations.play("change_button_pause",1,!0)},this),this.buttonChangeCharacter.events.onInputOut.add(function(){t.buttonChangeCharacter.frameName="change_button.png",t.animationButtonChange.ph2Animations.play("change_button_stand",1,!0)},this),this.trophy.inputEnabled=!0,this.trophy.input.useHandCursor=!0,this.trophy.events.onInputUp.add(this.showMissions,this),this.overlayMissions.inputEnabled=!0,this.overlayMissions.events.onInputUp.add(this.closeMissions,this),this.buttonMission1.onInputUp.add(this.changeMission,this),this.buttonMission2.onInputUp.add(this.changeMission,this),this.buttonMission3.onInputUp.add(this.changeMission,this),this.textMission1.inputEnabled=!0,this.textMission2.inputEnabled=!0,this.textMission3.inputEnabled=!0,Ph2.UISystem.findObject("bg",this.uiMissions).inputEnabled=!0,this.game.input.onUp.add(this.fixCharacterButtonFrames,this)},e.prototype.localizeUI=function(){this.textStarPoints.setText(this.totalPoints.toString()),m.Instances.LocalizationManager.localizeText("buttons_container/start_button/start_text",this.uiMainMenu,"mm_start"),m.Instances.LocalizationManager.localizeText("buttons_container/how_to_play_button/how_to_play_text",this.uiMainMenu,"mm_how_to_play"),m.Instances.LocalizationManager.localizeText("buttons_container/more_games_button/more_games_text",this.uiMainMenu,"mm_more_games"),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item1/label",this.item1,"not_enough_stars_popup"),216),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item2/label",this.item2,"not_enough_stars_popup"),216),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item3/label",this.item3,"not_enough_stars_popup"),216),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item4/label",this.item4,"not_enough_stars_popup"),216),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item5/label",this.item5,"not_enough_stars_popup"),216),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item6/label",this.item6,"not_enough_stars_popup"),216),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item7/label",this.item7,"not_enough_stars_popup"),216),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item8/label",this.item8,"not_enough_stars_popup"),216),e.setWordWrap(m.Instances.LocalizationManager.localizeAnimText("bubble_item9/label",this.item9,"not_enough_stars_popup"),216),m.Instances.LocalizationManager.localizeText("container/container_powerup/power_ups_text",this.uiPowerups,"tutorial_power_ups"),m.Instances.LocalizationManager.localizeText("container/container_powerup/bomb_icon/text",this.uiPowerups,"tutorial_bomb_text"),m.Instances.LocalizationManager.localizeText("container/container_powerup/power_blast_icon/text",this.uiPowerups,"tutorial_power_text"),m.Instances.LocalizationManager.localizeText("container/container_powerup/speed_icon/text",this.uiPowerups,"tutorial_speed_text"),m.Instances.LocalizationManager.localizeText("container/container_powerup/life_icon/text",this.uiPowerups,"tutorial_life_text"),m.Instances.LocalizationManager.localizeText("container/container_powerup/shield_icon/text",this.uiPowerups,"tutorial_shield_text"),m.Instances.LocalizationManager.localizeText("container/container_powerup/bomb_launcher_icon/text",this.uiPowerups,"tutorial_bomb_launcher_text"),m.Instances.LocalizationManager.localizeText("container/container_powerup/invincibility_icon/text",this.uiPowerups,"tutorial_invincibility_text"),m.Instances.LocalizationManager.localizeText("container/container_weapoms/weapons_text",this.uiPowerups,"tutorial_weapons"),m.Instances.LocalizationManager.localizeText("container/container_weapoms/flamethrower_icon/text",this.uiPowerups,"tutorial_flamethrower_text"),m.Instances.LocalizationManager.localizeText("container/container_weapoms/lightning_icon/text",this.uiPowerups,"tutorial_lighting_gun_text"),m.Instances.LocalizationManager.localizeText("container/container_weapoms/hammer_icon/text",this.uiPowerups,"tutorial_hammer_text"),m.Instances.LocalizationManager.localizeText("container/container_weapoms/electric_gun_icon/text",this.uiPowerups,"tutorial_electric_gun_text"),m.Instances.LocalizationManager.localizeText("container/container_weapoms/thor_hammer_icon/text",this.uiPowerups,"tutorial_thor_hammer_text"),m.Instances.LocalizationManager.localizeText("container/container_weapoms/ice_gun_icon/text",this.uiPowerups,"tutorial_ice_gun_text"),m.Instances.LocalizationManager.localizeText("container/container_weapoms/doll_bomb_icon/text",this.uiPowerups,"tutorial_doll_bomb_text"),m.Instances.LocalizationManager.localizeText("container/container_vehicles/vehicles_text",this.uiPowerups,"tutorial_vehicles"),m.Instances.LocalizationManager.localizeText("container/container_vehicles/stag_icon/text",this.uiPowerups,"tutorial_stag_text"),m.Instances.LocalizationManager.localizeText("container/container_vehicles/cart_icon/text",this.uiPowerups,"tutorial_cart_text"),m.Instances.LocalizationManager.localizeText("container/container_vehicles/horse_icon/text",this.uiPowerups,"tutorial_horse_text"),m.Instances.LocalizationManager.localizeText("container/container_vehicles/skateboard_icon/text",this.uiPowerups,"tutorial_skateboard_text"),m.Instances.LocalizationManager.localizeText("container/back_button/back_text",this.uiPowerups,"back"),m.Instances.LocalizationManager.localizeText("container/controls_button/control_text",this.uiPowerups,"tutorial_controls"),m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiSettings,"tutorial_controls"),m.Instances.LocalizationManager.localizeText("container/controls_mobile/move_text",this.uiSettings,"tutorial_move"),m.Instances.LocalizationManager.localizeText("container/controls_mobile/bomb_text",this.uiSettings,"tutorial_bomb"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/move_text",this.uiSettings,"tutorial_move"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/bomb_text",this.uiSettings,"tutorial_bomb"),m.Instances.LocalizationManager.localizeText("container/back_button/text",this.uiSettings,"back"),m.Instances.LocalizationManager.localizeText("container/power_ups_button/text",this.uiSettings,"tutorial_power_ups"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/1player_bomb_text",this.uiSettings,"spacebar"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/1players_up_text",this.uiSettings,"arrow_up"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/1players_down_text",this.uiSettings,"arrow_down"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/1players_left_text",this.uiSettings,"arrow_left"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/1players_right_text",this.uiSettings,"arrow_right"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p1_bomb_text",this.uiSettings,"spacebar"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p1_up_text",this.uiSettings,"w",!0),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p1_down_text",this.uiSettings,"s",!0),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p1_left_text",this.uiSettings,"a",!0),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p1_right_text",this.uiSettings,"d",!0),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p2_bomb_text",this.uiSettings,"enter"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p2_up_text",this.uiSettings,"arrow_up"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p2_down_text",this.uiSettings,"arrow_down"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p2_left_text",this.uiSettings,"arrow_left"),m.Instances.LocalizationManager.localizeText("container/controls_desktop/keys/2players_p2_right_text",this.uiSettings,"arrow_right"),m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiModeSelect,"gm_select_mode"),m.Instances.LocalizationManager.localizeText("container/back_button/back_text",this.uiModeSelect,"back"),m.Instances.LocalizationManager.localizeText("container/next_button/next_text",this.uiModeSelect,"next"),m.Instances.LocalizationManager.localizeText("container/description",this.uiModeSelect,"gm_arcade"),m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiGameSettings,"settings"),m.Instances.LocalizationManager.localizeText("container/players_text",this.uiGameSettings,"settings_players"),m.Instances.LocalizationManager.localizeText("container/enemies_text",this.uiGameSettings,"settings_enemies"),m.Instances.LocalizationManager.localizeText("container/levels_text",this.uiGameSettings,"settings_levels"),m.Instances.LocalizationManager.localizeText("container/arena_text",this.uiGameSettings,"settings_arena"),m.Instances.LocalizationManager.localizeText("container/difficulty_text",this.uiGameSettings,"settings_difficulty"),m.Instances.LocalizationManager.localizeText("container/back_button/text",this.uiGameSettings,"back"),m.Instances.LocalizationManager.localizeText("container/ok_button/text",this.uiGameSettings,"ok"),m.Instances.LocalizationManager.localizeText("container/bathroom_button/text",this.uiGameSettings,"arena_boutique"),m.Instances.LocalizationManager.localizeText("container/castle_button/text",this.uiGameSettings,"arena_forest"),m.Instances.LocalizationManager.localizeText("container/garden_button/text",this.uiGameSettings,"arena_toy_store"),m.Instances.LocalizationManager.localizeText("container/aquarium_button/text",this.uiGameSettings,"arena_christmas"),m.Instances.LocalizationManager.localizeText("container/polar_region_button/text",this.uiGameSettings,"arena_race_track"),m.Instances.LocalizationManager.localizeText("container/picnic_button/text",this.uiGameSettings,"arena_bakery"),m.Instances.LocalizationManager.localizeText("container/dollhouse_button/text",this.uiGameSettings,"arena_beach"),m.Instances.LocalizationManager.localizeText("container/farm_button/text",this.uiGameSettings,"arena_ranch"),m.Instances.LocalizationManager.localizeText("container/baseball_field_button/text",this.uiGameSettings,"arena_classroom"),m.Instances.LocalizationManager.localizeText("container/random_button/text",this.uiGameSettings,"arena_random"),m.Instances.LocalizationManager.localizeText("container/easy_button/text",this.uiGameSettings,"settings_easy"),m.Instances.LocalizationManager.localizeText("container/normal_button/text",this.uiGameSettings,"settings_normal"),m.Instances.LocalizationManager.localizeText("container/hard_button/text",this.uiGameSettings,"settings_hard"),m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiCharacterSelect,"dress_up_character"),m.Instances.LocalizationManager.localizeText("container/start_button/text",this.uiCharacterSelect,"start"),m.Instances.LocalizationManager.localizeText("container/back_button/text",this.uiCharacterSelect,"back"),m.Instances.LocalizationManager.fitFontSizeUI("container/container_powerup/bomb_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_powerup/power_blast_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_powerup/speed_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_powerup/life_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_powerup/shield_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_powerup/bomb_launcher_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_powerup/invincibility_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_weapoms/weapons_text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_weapoms/flamethrower_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_weapoms/lightning_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_weapoms/hammer_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_weapoms/electric_gun_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_weapoms/thor_hammer_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_weapoms/ice_gun_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_weapoms/doll_bomb_icon/text",this.uiPowerups,170*m.SETTINGS.SCALE,-1,22*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/container_title/title",this.uiCharacterSelect,350*m.SETTINGS.SCALE,-1,42*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/controls_mobile/move_text",this.uiSettings,100*m.SETTINGS.SCALE,-1,27*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/controls_mobile/bomb_text",this.uiSettings,100*m.SETTINGS.SCALE,-1,27*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/controls_desktop/move_text",this.uiSettings,100*m.SETTINGS.SCALE,-1,27*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/controls_desktop/bomb_text",this.uiSettings,100*m.SETTINGS.SCALE,-1,27*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/bathroom_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/castle_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/garden_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/aquarium_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/polar_region_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/picnic_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/dollhouse_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/farm_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/baseball_field_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/random_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/easy_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/normal_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),m.Instances.LocalizationManager.fitFontSizeUI("container/hard_button/text",this.uiGameSettings,150*m.SETTINGS.SCALE,-1,24*m.SETTINGS.SCALE),this.textGameMode=Ph2.UISystem.findObject("container/description",this.uiModeSelect),this.blackContainerGameMode.width=this.textGameMode.width+75*m.SETTINGS.SCALE},e.prototype.openLanguage=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),this.flagContainer.visible=!this.flagContainer.visible},e.prototype.closeLanguage=function(){this.flagContainer.visible=!1},e.prototype.changeLanguage=function(t){var i,e=this.flagSelected.frameName,s=t.frameName;switch(t.frameName){case"eng.png":i="en-US";break;case"esp.png":i="es-ES";break;case"hol.png":i="nl-NL";break;default:i="en-US"}this.flagSelected.frameName=s,t.frameName=e,this.game.ph2AudioManager.playEffect("menuPress",!1),m.Instances.LocalizationManager=new m.LocalizationManager(this.game,i),m.Instances.DataManager.saveLanguage(i),this.localizeUI(),this.loadMissions(),this.closeLanguage()},e.prototype.switchAudio=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),m.Instances.DataManager.getAudio()?(this.game.ph2AudioManager.switchSfxState(),m.Instances.DataManager.saveAudio(!1),this.buttonAudio.setFrames("mm_audio_off.png","mm_audio_off.png","mm_audio.png","mm_audio_off.png")):(this.game.ph2AudioManager.switchSfxState(),m.Instances.DataManager.saveAudio(!0),this.buttonAudio.setFrames("mm_audio.png","mm_audio.png","mm_audio_off.png","mm_audio.png"))},e.prototype.switchMusic=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),m.Instances.DataManager.getMusic()?(this.game.ph2AudioManager.switchMusicState(),this.game.ph2AudioManager.stopMusic(),m.Instances.DataManager.saveMusic(!1),this.buttonMusic.setFrames("mm_music_off.png","mm_music_off.png","mm_music.png","mm_music_off.png")):(this.game.ph2AudioManager.switchMusicState(),this.game.ph2AudioManager.playMusic(m.Music.MAIN_MENU),m.Instances.DataManager.saveMusic(!0),this.buttonMusic.setFrames("mm_music.png","mm_music.png","mm_music_off.png","mm_music.png"))},e.prototype.showMainMenu=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),this.uiPowerups.visible=!1,this.uiSettings.visible=!1,this.uiModeSelect.visible=!1,this.uiMainMenu.visible=!0,this.setMenuSkin()},e.prototype.setMenuSkin=function(){var t=["body1","body2","body3","body4"],i=["hero1_body1","hero1_body2","hero1_body3","hero1_body4"],e=["hero7_body1","hero7_body2","hero7_body3","hero7_body4"],s=["hero1_decor1","hero1_decor2","hero1_decor3","hero1_decor4"],a=["hero7_head1","hero7_head2","hero7_head3","hero7_head4"],n=this.game.rnd.pick(["head1","head2","head3","head4"]),t=this.game.rnd.pick(t),s=this.game.rnd.pick(s),a=this.game.rnd.pick(a),i=this.game.rnd.pick(i),e=this.game.rnd.pick(e);this.spineMainMenuHero1.createCombinedSkin("outfit1"+n+t,"normal",n,t),this.spineMainMenuHero2.createCombinedSkin("outfit2"+s+a,"default",s,i,a,e),this.spineMainMenuHero1.setToSetupPose(),this.spineMainMenuHero1.setSkinByName("outfit1"+n+t),this.spineMainMenuHero1.setAnimationByName(0,"anim_face",!0),this.spineMainMenuHero1.setAnimationByName(1,"mm",!0),this.spineMainMenuHero2.setToSetupPose(),this.spineMainMenuHero2.setSkinByName("outfit2"+s+a),this.spineMainMenuHero2.setAnimationByName(1,"mm",!0),this.spineMainMenuHero1.visible=!0,this.spineMainMenuHero2.visible=!0},e.prototype.loadMissions=function(){var t,i,e,s,a,n;Ph2.UISystem.findObject("pause_button",this.uiMissions).visible=!1,Ph2.UISystem.findObject("bg/description",this.uiMissions).visible=!1,Ph2.UISystem.findObject("sound_container",this.uiMissions).visible=!1,Ph2.UISystem.findObject("main_menu_button",this.uiMissions).visible=!1,Ph2.UISystem.findObject("pause_button",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("bg/description",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("sound_container",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("main_menu_button",this.uiMissions).visibility.enable(!1),t=m.Instances.MissionManager.missionsActive[0],i=m.Instances.MissionManager.missionsActive[1],e=m.Instances.MissionManager.missionsActive[2],s=t.progress+"/"+t.requirement,a=i.progress+"/"+i.requirement,n=e.progress+"/"+e.requirement,m.Instances.LocalizationManager.localizeText("bg/mission1/description",this.uiMissions,t.name),m.Instances.LocalizationManager.localizeText("bg/mission1/mission",this.uiMissions,s,!0),m.Instances.LocalizationManager.localizeText("bg/mission1/score",this.uiMissions,t.reward.toString(),!0),m.Instances.LocalizationManager.localizeText("bg/mission2/description",this.uiMissions,i.name),m.Instances.LocalizationManager.localizeText("bg/mission2/mission",this.uiMissions,a,!0),m.Instances.LocalizationManager.localizeText("bg/mission2/score",this.uiMissions,i.reward.toString(),!0),m.Instances.LocalizationManager.localizeText("bg/mission3/description",this.uiMissions,e.name),m.Instances.LocalizationManager.localizeText("bg/mission3/mission",this.uiMissions,n,!0),m.Instances.LocalizationManager.localizeText("bg/mission3/score",this.uiMissions,e.reward.toString(),!0),Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiMissions).visible=t.complete,Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiMissions).visible=i.complete,Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiMissions).visible=e.complete,Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiMissions).visibility.enable(!1),Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiMissions).visibility.enable(!1)},e.prototype.showMissions=function(){this.overlayMissions.revive(),this.uiMissions.visible=!0},e.prototype.closeMissions=function(){this.stopMovingMissionText(this.textMission1),this.stopMovingMissionText(this.textMission2),this.stopMovingMissionText(this.textMission3),this.overlayMissions.kill(),this.uiMissions.visible=!1},e.prototype.checkMissionText=function(t){var i,e=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),s=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions);switch(t.parent.name){case"mission1":i=300*m.SETTINGS.SCALE-e.width;break;case"mission2":i=300*m.SETTINGS.SCALE-s.width;break;case"mission3":i=300*m.SETTINGS.SCALE-a.width}if(t.width>i)switch(t.width,t.parent.name){case"mission1":this.movingText1=!0;break;case"mission2":this.movingText2=!0;break;case"mission3":this.movingText3=!0}else switch(t.parent.name){case"mission1":this.movingText1=!1;break;case"mission2":this.movingText2=!1;break;case"mission3":this.movingText3=!1}},e.prototype.stopMovingMissionText=function(t){switch(t.parent.name){case"mission1":this.movingText1=!1;break;case"mission2":this.movingText2=!1;break;case"mission3":this.movingText3=!1;break;default:this.movingText1=!1,this.movingText2=!1,this.movingText3=!1}},e.prototype.changeMission=function(t){var i,e,s=this,t=t.parent.name;switch(t){case"mission1":i=0,e=this.buttonMission1;break;case"mission2":i=1,e=this.buttonMission2;break;case"mission3":i=2,e=this.buttonMission3;break;default:return}e.inputEnabled=!1,t=Ph2.UISystem.findObject("bg/"+t,this.uiMissions),m.Instances.MissionManager.changeMission(i),this.game.add.tween(t).to({alpha:0},500,"Linear",!0).onComplete.add(function(){s.onMissionFadeComplete(i)},this)},e.prototype.onMissionFadeComplete=function(t){var i,e,s=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),a=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),n=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions),o=10*m.SETTINGS.SCALE,r=300*m.SETTINGS.SCALE,h="mission"+(t+1),t=m.Instances.MissionManager.missionsActive[t],c=t.progress+"/"+t.requirement,l=Ph2.UISystem.findObject("bg/"+h,this.uiMissions);switch(Ph2.UISystem.findObject("bg/"+h+"/description",this.uiMissions).x=-192.5*m.SETTINGS.SCALE,m.Instances.LocalizationManager.localizeText("bg/"+h+"/description",this.uiMissions,t.name),m.Instances.LocalizationManager.localizeText("bg/"+h+"/mission",this.uiMissions,c,!0),m.Instances.LocalizationManager.localizeText("bg/"+h+"/score",this.uiMissions,t.reward.toString(),!0),h){case"mission1":i=this.buttonMission1,this.textMission1.width>=r-s.width&&(e=this.textMission1.width-(r-s.width),this.textMission1.x=-192.5*m.SETTINGS.SCALE,this.missionLimitLeft1=this.textMission1.left-(e+o),this.missionLimitRight1=this.textMission1.x+o,this.missionMask1.width=r-s.width),Ph2.UISystem.findObject("bg/mission1/empty/check",this.uiMissions).visible=!1;break;case"mission2":i=this.buttonMission2,this.textMission2.width>=r-a.width&&(e=this.textMission2.width-(r-a.width),this.textMission2.x=-192.5*m.SETTINGS.SCALE,this.missionLimitLeft2=this.textMission2.left-(e+o),this.missionLimitRight2=this.textMission2.x+o,this.missionMask2.width=r-a.width),Ph2.UISystem.findObject("bg/mission2/empty/check",this.uiMissions).visible=!1;break;case"mission3":i=this.buttonMission3,this.textMission3.width>=r-n.width&&(e=this.textMission3.width-(r-n.width),this.textMission3.x=-192.5*m.SETTINGS.SCALE,this.missionLimitLeft3=this.textMission3.left-(e+o),this.missionLimitRight3=this.textMission3.x+o,this.missionMask3.width=r-n.width),Ph2.UISystem.findObject("bg/mission3/empty/check",this.uiMissions).visible=!1;break;default:return}this.game.add.tween(l).to({alpha:1},500,"Linear",!0).onComplete.add(function(){i.inputEnabled=!0,i.input.useHandCursor=!0},this)},e.prototype.showSettings=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),Ph2.UISystem.findObject("bomb",this.uiSettings).addChild(this.bomb),this.bomb.ph2Animations.play("bomb_decor",1,!0),this.bomb.visible=!0,this.spineMainMenuHero1.visible=!1,this.spineMainMenuHero2.visible=!1,this.uiMainMenu.visible=!1,this.uiPowerups.visible=!1,this.uiSettings.visible=!0},e.prototype.showPowerups=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),Ph2.UISystem.findObject("bomb",this.uiPowerups).addChild(this.bomb),this.bomb.ph2Animations.play("bomb_decor",1,!0),this.bomb.visible=!0,this.spineMainMenuHero1.visible=!1,this.spineMainMenuHero2.visible=!1,this.uiMainMenu.visible=!1,this.uiSettings.visible=!1,this.uiPowerups.visible=!0},e.prototype.showIntroComic1=function(){var t=this;this.game.ph2AudioManager.switchMusic(m.Music.COMIC_INTRO),this.game.ph2AudioManager.playEffect("menuPress",!1),this.comic.showIntroComic1().onComplete.add(function(){t.comic.hideComics(),t.showModeSelect()},this)},e.prototype.showModeSelect=function(){this.game.ph2AudioManager.switchMusic(m.Music.MAIN_MENU),this.game.ph2AudioManager.stopEffect(this.audioComic1),this.spineMainMenuHero1.visible=!1,this.spineMainMenuHero2.visible=!1,this.uiSettings.visible=!1,this.uiPowerups.visible=!1,this.uiMainMenu.visible=!1,this.uiGameSettings.visible=!1,this.uiModeSelect.visible=!0,this.closeLanguage(),this.resetSettingsButtons(),this.enableButton0Enemies(!1),Ph2.UISystem.findObject("container/trophy",this.uiModeSelect).addChild(this.trophy),Ph2.UISystem.findObject("bomb",this.uiModeSelect).addChild(this.bomb),this.bomb.ph2Animations.play("bomb_decor",1,!0),this.bomb.visible=!0,this.trophy.ph2Animations.play("trophy_stand",1,!0),this.trophy.visible=!0,this.currentButtonPlayers=this.button1Player,this.currentButtonEnemies=this.button3Enemies,this.currentButtonLevels=this.button5Levels,this.currentButtonArena=this.buttonRandom,this.currentButtonDifficulty=this.buttonEasy,this.playerMode=m.PLAYER_MODE.SINGLE_PLAYER,this.enemiesSelected=3,this.levelsSelected=5,this.mapTheme=m.MAP_THEME.RANDOM,this.difficulty=m.DIFFICULTY.EASY},e.prototype.resetSettingsButtons=function(){this.button1Player.changeFrame("small_button_select.png"),this.button2Player.changeFrame("small_button_normal.png"),this.button0Enemies.changeFrame("small_button_normal.png"),this.button1Enemies.changeFrame("small_button_normal.png"),this.button2Enemies.changeFrame("small_button_normal.png"),this.button3Enemies.changeFrame("small_button_select.png"),this.button20Levels.changeFrame("small_button_normal.png"),this.button15Levels.changeFrame("small_button_normal.png"),this.button10Levels.changeFrame("small_button_normal.png"),this.button5Levels.changeFrame("small_button_select.png"),this.buttonAquarium.changeFrame("small_button_normal.png"),this.buttonBathroom.changeFrame("small_button_normal.png"),this.buttonBaseballField.changeFrame("small_button_normal.png"),this.buttonCastle.changeFrame("small_button_normal.png"),this.buttonDollhouse.changeFrame("small_button_normal.png"),this.buttonFarm.changeFrame("small_button_normal.png"),this.buttonGarden.changeFrame("small_button_normal.png"),this.buttonPolarRegion.changeFrame("small_button_normal.png"),this.buttonPicnic.changeFrame("small_button_normal.png"),this.buttonRandom.changeFrame("small_button_select.png"),this.buttonEasy.changeFrame("small_button_select.png"),this.buttonNormal.changeFrame("small_button_normal.png"),this.buttonHard.changeFrame("small_button_normal.png")},e.prototype.showGameSettings=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),this.uiModeSelect.visible=!1,this.uiCharacterSelect.visible=!1,this.uiGameSettings.visible=!0,Ph2.UISystem.findObject("container/trophy",this.uiGameSettings).addChild(this.trophy),Ph2.UISystem.findObject("bomb",this.uiGameSettings).addChild(this.bomb),this.bomb.ph2Animations.play("bomb_decor",1,!0),this.bomb.visible=!0,this.trophy.ph2Animations.play("trophy_stand",1,!0),this.trophy.visible=!0},e.prototype.showCharacterSelect=function(){var t;this.game.ph2AudioManager.playEffect("menuPress",!1),this.uiGameSettings.visible=!1,this.uiCharacterSelect.visible=!0,this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER?(this.currentButtonCharacterP1.setFrames("face_hover.png","face_hover.png","face_hover.png","face_hover.png"),this.currentButtonCharacterP2.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),(t=Ph2.UISystem.findObject("container/character"+(this.charactersChosen[0]+1)+"/player",this.uiCharacterSelect)).visible=!0,t.visibility.enable(!0),t.frameName="face_p1.png",(t=Ph2.UISystem.findObject("container/character"+(this.charactersChosen[1]+1)+"/player",this.uiCharacterSelect)).visible=!1,t.visibility.enable(!1)):(this.currentButtonCharacterP1.setFrames("face_hover.png","face_hover.png","face_hover.png","face_hover.png"),this.currentButtonCharacterP2.setFrames("face_hover.png","face_hover.png","face_hover.png","face_hover.png"),(t=Ph2.UISystem.findObject("container/character"+(this.charactersChosen[0]+1)+"/player",this.uiCharacterSelect)).visible=!0,t.visibility.enable(!0),t.frameName="face_p1.png",(t=Ph2.UISystem.findObject("container/character"+(this.charactersChosen[1]+1)+"/player",this.uiCharacterSelect)).visible=!0,t.visibility.enable(!0)),t.frameName="face_p2.png",Ph2.UISystem.findObject("container/trophy",this.uiCharacterSelect).addChild(this.trophy),Ph2.UISystem.findObject("bomb",this.uiCharacterSelect).addChild(this.bomb),this.bomb.ph2Animations.play("bomb_decor",1,!0),this.bomb.visible=!0,this.trophy.ph2Animations.play("trophy_stand",1,!0),this.trophy.visible=!0,this.selectCharacter(this.currentButtonCharacterP1)},e.prototype.selectModeLeft=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),this.gameMode--,this.gameMode<0?(this.gameMode=5,this.selectModeLeft()):(this.changeModeImage(),this.changeModeDescription())},e.prototype.selectModeRight=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),this.gameMode++,4<this.gameMode?(this.gameMode=-1,this.selectModeRight()):(this.changeModeImage(),this.changeModeDescription())},e.prototype.enableButton0Enemies=function(t){t?(this.button0Enemies.inputEnabled=!0,this.button0Enemies.changeFrame("small_button_normal.png")):(this.button0Enemies.inputEnabled=!1,this.button0Enemies.changeFrame("small_button_lock.png"))},e.prototype.changeModeImage=function(){var t;switch(this.gameMode){case m.GAME_MODE.ARCADE:t="sm_image_1.png";break;case m.GAME_MODE.BATTLE_ROYALE:t="sm_image_2.png";break;case m.GAME_MODE.NEW_PACMAN:t="sm_image_3.png";break;case m.GAME_MODE.STAR_COLLECTOR:t="sm_image_5.png";break;case m.GAME_MODE.ICE_MAN:t="sm_image_4.png"}this.imageModeSelected.frameName=t},e.prototype.changeModeDescription=function(){var t;switch(this.gameMode){case m.GAME_MODE.ARCADE:t="gm_arcade";break;case m.GAME_MODE.BATTLE_ROYALE:t="gm_battle_royale";break;case m.GAME_MODE.NEW_PACMAN:t="gm_new_pacman";break;case m.GAME_MODE.STAR_COLLECTOR:t="gm_star_collector";break;case m.GAME_MODE.ICE_MAN:t="gm_ice_man"}m.Instances.LocalizationManager.localizeText("container/description",this.uiModeSelect,t),this.textGameMode=Ph2.UISystem.findObject("container/description",this.uiModeSelect),this.blackContainerGameMode.width=this.textGameMode.width+75*m.SETTINGS.SCALE},e.prototype.update=function(){this.updateButtonsSelected(),this.uiMissions.visible&&this.updateMissionText(),-1<this.popupTimer&&(this.popupTimer-=this.game.time.elapsedMS,this.popupTimer<=0)&&(this.popupTimer=-1,this.itemPopups[this.visiblePopup].visible)&&(this.itemPopups[this.visiblePopup].visible=!1,this.visiblePopup=-1)},e.prototype.updateMissionText=function(){var t,i,e,s,a,n,o,r,h,c;this.checkMissionText(this.textMission1),this.checkMissionText(this.textMission2),this.checkMissionText(this.textMission3),(this.movingText1||this.movingText2||this.movingText3)&&(r=Ph2.UISystem.findObject("bg/mission1/mission",this.uiMissions),h=Ph2.UISystem.findObject("bg/mission2/mission",this.uiMissions),c=Ph2.UISystem.findObject("bg/mission3/mission",this.uiMissions),o=.5*m.SETTINGS.SCALE,this.movingText1&&(s=this.directionMission1,t=300*m.SETTINGS.SCALE-r.width),this.movingText2&&(a=this.directionMission2,i=300*m.SETTINGS.SCALE-h.width),this.movingText3&&(n=this.directionMission3,e=300*m.SETTINGS.SCALE-c.width),this.textMission1.width>t&&("left"===s?(this.textMission1.x-=o,this.textMission1.x<=this.missionLimitLeft1&&(s="right")):"right"===s&&(this.textMission1.x+=o,this.textMission1.x>=this.missionLimitRight1)&&(s="left"),this.directionMission1=s),this.textMission2.width>i&&("left"===a?(this.textMission2.x-=o,this.textMission2.x<=this.missionLimitLeft2&&(a="right")):"right"===a&&(this.textMission2.x+=o,this.textMission2.x>=this.missionLimitRight2)&&(a="left"),this.directionMission2=a),this.textMission3.width>e)&&("left"===n?(this.textMission3.x-=o,this.textMission3.x<=this.missionLimitLeft3&&(n="right")):"right"===n&&(this.textMission3.x+=o,this.textMission3.x>=this.missionLimitRight3)&&(n="left"),this.directionMission3=n)},e.prototype.updateButtonsSelected=function(){this.uiGameSettings.visible&&(this.changeFrameTimer+=this.game.time.elapsedMS,100<=this.changeFrameTimer)&&(this.changeFrameTimer=0,"small_button_select.png"===this.currentFrameButtons?this.currentFrameButtons="small_button_select2.png":this.currentFrameButtons="small_button_select.png",this.currentButtonPlayers.changeFrame(this.currentFrameButtons),this.currentButtonEnemies.changeFrame(this.currentFrameButtons),this.currentButtonLevels.changeFrame(this.currentFrameButtons),this.currentButtonArena.changeFrame(this.currentFrameButtons),this.currentButtonDifficulty.changeFrame(this.currentFrameButtons))},e.prototype.checkPlayerNumberAndMode=function(){this.gameMode===m.GAME_MODE.BATTLE_ROYALE?this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER?(this.button3Enemies.inputEnabled=!0,this.button3Enemies.changeFrame("small_button_normal.png"),this.button0Enemies.inputEnabled=!1,this.button0Enemies.changeFrame("small_button_lock.png")):this.playerMode===m.PLAYER_MODE.MULTI_PLAYER&&(this.button3Enemies.inputEnabled=!1,this.button3Enemies.changeFrame("small_button_lock.png"),this.button0Enemies.inputEnabled=!0,this.button0Enemies.changeFrame("small_button_normal.png")):(this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER?(this.button3Enemies.inputEnabled=!0,this.button3Enemies.changeFrame("small_button_normal.png")):this.playerMode===m.PLAYER_MODE.MULTI_PLAYER&&(this.button3Enemies.inputEnabled=!1,this.button3Enemies.changeFrame("small_button_lock.png")),this.button0Enemies.inputEnabled=!1,this.button0Enemies.changeFrame("small_button_lock.png"))},e.prototype.selectPlayerMode=function(t){switch(this.game.ph2AudioManager.playEffect("menuPress",!1),this.button1Player.changeFrame("small_button_normal.png"),this.button2Player.changeFrame("small_button_normal.png"),t.name){case"1player_button":this.playerMode=m.PLAYER_MODE.SINGLE_PLAYER,this.animationButtonChange.visible=!1;break;case"2player_button":this.playerMode=m.PLAYER_MODE.MULTI_PLAYER,this.animationButtonChange.visible=!0}this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER&&(this.currentButtonEnemies===this.button0Enemies&&(this.currentButtonEnemies=this.button1Enemies,this.enemiesSelected=1),this.gameMode===m.GAME_MODE.BATTLE_ROYALE&&this.enableButton0Enemies(!1),this.selectingPlayer1=!0,this.selectingPlayer2=!1,this.currentCharacterOn=this.charactersChosen[0],this.spineDressHero1.visible=!0,this.spineDressHero2.visible=!1),this.playerMode===m.PLAYER_MODE.MULTI_PLAYER&&(this.currentButtonEnemies===this.button3Enemies&&(this.currentButtonEnemies=this.button2Enemies,this.enemiesSelected=2,this.button2Enemies.changeFrame("small_button_select.png")),this.gameMode===m.GAME_MODE.BATTLE_ROYALE)&&this.enableButton0Enemies(!0),this.checkPlayerNumberAndMode(),t.changeFrame("small_button_select.png"),this.currentButtonPlayers=t},e.prototype.selectEnemies=function(t){switch(this.game.ph2AudioManager.playEffect("menuPress",!1),this.button3Enemies.changeFrame("small_button_normal.png"),this.button2Enemies.changeFrame("small_button_normal.png"),this.button1Enemies.changeFrame("small_button_normal.png"),this.button0Enemies.changeFrame("small_button_normal.png"),t.name){case"0enemies_button":this.enemiesSelected=0;break;case"1enemies_button":this.enemiesSelected=1;break;case"2enemies_button":this.enemiesSelected=2;break;case"3enemies_button":this.enemiesSelected=3}this.checkPlayerNumberAndMode(),t.changeFrame("small_button_select.png"),this.currentButtonEnemies=t},e.prototype.selectLevels=function(t){switch(this.game.ph2AudioManager.playEffect("menuPress",!1),this.button20Levels.changeFrame("small_button_normal.png"),this.button15Levels.changeFrame("small_button_normal.png"),this.button10Levels.changeFrame("small_button_normal.png"),this.button5Levels.changeFrame("small_button_normal.png"),t.name){case"20levels_button":this.levelsSelected=20;break;case"15levels_button":this.levelsSelected=15;break;case"10levels_button":this.levelsSelected=10;break;case"5levels_button":this.levelsSelected=5}t.changeFrame("small_button_select.png"),this.currentButtonLevels=t},e.prototype.selectTheme=function(t){switch(this.game.ph2AudioManager.playEffect("menuPress",!1),this.buttonAquarium.changeFrame("small_button_normal.png"),this.buttonBathroom.changeFrame("small_button_normal.png"),this.buttonBaseballField.changeFrame("small_button_normal.png"),this.buttonCastle.changeFrame("small_button_normal.png"),this.buttonDollhouse.changeFrame("small_button_normal.png"),this.buttonFarm.changeFrame("small_button_normal.png"),this.buttonGarden.changeFrame("small_button_normal.png"),this.buttonPolarRegion.changeFrame("small_button_normal.png"),this.buttonPicnic.changeFrame("small_button_normal.png"),this.buttonRandom.changeFrame("small_button_normal.png"),t.name){case"aquarium_button":this.mapTheme=m.MAP_THEME.CHRISTMAS;break;case"bathroom_button":this.mapTheme=m.MAP_THEME.BOUTIQUE;break;case"baseball_field_button":this.mapTheme=m.MAP_THEME.CLASSROOM;break;case"castle_button":this.mapTheme=m.MAP_THEME.FOREST;break;case"dollhouse_button":this.mapTheme=m.MAP_THEME.BEACH;break;case"farm_button":this.mapTheme=m.MAP_THEME.RANCH;break;case"garden_button":this.mapTheme=m.MAP_THEME.TOY_STORE;break;case"polar_region_button":this.mapTheme=m.MAP_THEME.RACE_TRACK;break;case"picnic_button":this.mapTheme=m.MAP_THEME.BAKERY;break;case"random_button":this.mapTheme=m.MAP_THEME.RANDOM}t.changeFrame("small_button_select.png"),this.currentButtonArena=t},e.prototype.selectDifficulty=function(t){switch(this.game.ph2AudioManager.playEffect("menuPress",!1),this.buttonEasy.changeFrame("small_button_normal.png"),this.buttonNormal.changeFrame("small_button_normal.png"),this.buttonHard.changeFrame("small_button_normal.png"),t.name){case"easy_button":this.difficulty=m.DIFFICULTY.EASY;break;case"normal_button":this.difficulty=m.DIFFICULTY.NORMAL;break;case"hard_button":this.difficulty=m.DIFFICULTY.HARD}t.changeFrame("small_button_select.png"),this.currentButtonDifficulty=t},e.prototype.selectCharacter=function(t,i,e){var s,a,n,o,r;if(!1!==e){switch(t.name){case"character1_button":s=0,a="item1",n="dress_hero1";break;case"character2_button":s=1,a="item2",n="dress_hero2";break;case"character3_button":s=2,a="item3",n="dress_hero3";break;case"character4_button":s=3,a="item4",n="dress_hero4";break;case"character5_button":s=4,a="item5",n="dress_hero5";break;case"character6_button":s=5,a="item6",n="dress_hero6";break;case"character7_button":s=6,a="item7",n="dress_hero7";break;case"character8_button":s=7,a="item8",n="dress_hero8"}if(!(this.currentCharacterOn===s&&1<arguments.length||this.playerMode===m.PLAYER_MODE.MULTI_PLAYER&&(this.selectingPlayer1?c=this.charactersChosen[1]:this.selectingPlayer2&&(c=this.charactersChosen[0]),c===s))){Ph2.UISystem.findObject("container/character"+(this.currentCharacterOn+1)+"/player",this.uiCharacterSelect).visible=!1,Ph2.UISystem.findObject("container/character"+(this.currentCharacterOn+1)+"/player",this.uiCharacterSelect).visibility.enable(!1),this.currentCharacterOn=s,this.itemImage1.alpha=1,this.itemImage2.alpha=1,this.itemImage3.alpha=1,this.itemImage4.alpha=1,this.itemImage5.alpha=1,this.itemImage6.alpha=1,this.itemImage7.alpha=1,this.itemImage8.alpha=1,this.itemImage9.alpha=1,this.itemImage1.frameName=a+"_1.png",this.itemImage2.frameName=a+"_2.png",this.itemImage3.frameName=a+"_3.png",this.itemImage4.frameName=a+"_4.png",this.itemImage5.frameName=a+"_5.png",this.itemImage6.frameName=a+"_6.png",this.itemImage7.frameName=a+"_7.png",this.itemImage8.frameName=a+"_8.png",this.itemImage9.frameName=a+"_9.png";for(var h=0;h<this.itemFrames.length;h++)this.itemFrames[h].frameName="item_bottom.png";if(this.selectingPlayer1){if(this.charactersChosen[0]=s,this.spinePlayerName1=n,o=this.spineDressHero1,this.currentButtonCharacterP2===t){for(var c,l=void 0;(l=this.game.rnd.pick(this.characterButtons))===t;);c=this.characterButtons.indexOf(l),this.currentButtonCharacterP2=l,this.charactersChosen[1]=c}this.currentButtonCharacterP1.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),(this.currentButtonCharacterP1=t).setFrames("face_hover.png","face_hover.png","face_hover.png","face_hover.png"),(r=Ph2.UISystem.findObject("container/character"+(s+1)+"/player",this.uiCharacterSelect)).visible=!0,r.visibility.enable(!0),r.frameName="face_p1.png"}else this.selectingPlayer2&&(this.charactersChosen[1]=s,this.spinePlayerName2=n,o=this.spineDressHero2,this.currentButtonCharacterP2.setFrames("face_hover.png","face_normal.png","face_hover.png","face_normal.png"),(this.currentButtonCharacterP2=t).setFrames("face_hover.png","face_hover.png","face_hover.png","face_hover.png"),(r=Ph2.UISystem.findObject("container/character"+(s+1)+"/player",this.uiCharacterSelect)).visible=!0,r.visibility.enable(!0),r.frameName="face_p2.png");this.obtainSkins(),this.checkCharacterItems(s),o.destroy(),(o=this.game.add.spine(0,0,n)).scale.setTo(m.SETTINGS.SCALE),this.selectingPlayer1?this.spineDressHero1=o:this.spineDressHero2=o,this.setSkin(),this.spineContainer.addChild(o),this.game.ph2AudioManager.playEffect("menuPress",!1),this.resetCharactersButtons()}}},e.prototype.resetCharactersButtons=function(){var t,i;if(this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER)for(t=0;t<this.characterButtons.length;t++)i=this.characterButtons[t],this.charactersChosen[0]!==t&&(i.frameName="face_normal.png");else for(t=0;t<this.characterButtons.length;t++)i=this.characterButtons[t],this.charactersChosen[0]!==t&&this.charactersChosen[1]!==t&&(i.frameName="face_normal.png")},e.prototype.itemAlreadyUnlocked=function(t){var i,e,s,a,n,o;switch(Ph2.AnimationSystem.findObject("black",t).visible=!1,Ph2.AnimationSystem.findObject("star_empty",t).visible=!1,Ph2.AnimationSystem.findObject("price",t).visible=!1,i=parseInt(t.name.charAt(4),10)-1,t.name){case"item1":case"item2":case"item3":e=this.facePlayer1,s=this.facePlayer2;break;case"item4":case"item5":case"item6":e=this.headPlayer1+3,s=this.headPlayer2+3;break;case"item7":case"item8":case"item9":e=this.bodyPlayer1+6,s=this.bodyPlayer2+6}switch(this.selectingPlayer1?a=e===1+i:this.selectingPlayer2&&(a=s===1+i),a?(this.itemImages[i].alpha=0,this.itemFrames[i].frameName="item_bottom2.png"):(this.itemImages[i].alpha=1,this.itemFrames[i].frameName="item_bottom.png"),i){case 0:n=Ph2.AnimationSystem.findObject("face4_anim",t),2!==this.currentCharacterOn||this.selectingPlayer1&&this.facePlayer1===1+i||this.selectingPlayer2&&this.facePlayer2===1+i?n.visible=!1:n.visible=!0;break;case 1:n=Ph2.AnimationSystem.findObject("face1_anim",t),o=Ph2.AnimationSystem.findObject("face2_anim",t),0===this.currentCharacterOn?(this.selectingPlayer1&&this.facePlayer1===1+i||this.selectingPlayer2&&this.facePlayer2===1+i?n.visible=!1:n.visible=!0,o.visible=!1):3!==this.currentCharacterOn||this.selectingPlayer1&&this.facePlayer1===1+i||this.selectingPlayer2&&this.facePlayer2===1+i?(n.visible=!1,o.visible=!1):(n.visible=!1,o.visible=!0);break;case 2:o=Ph2.AnimationSystem.findObject("face3_anim",t),5!==this.currentCharacterOn||this.selectingPlayer1&&this.facePlayer1===1+i||this.selectingPlayer2&&this.facePlayer2===1+i?o.visible=!1:(o.visible=!0,o.ph2Animations.play("face3_pause",1,!0))}},e.prototype.itemLocked=function(t){var i,e,s,a=parseInt(t.name.charAt(4),10)-1,n=m.Instances.DataManager.getPlayerPoints(),o=m.SETTINGS.ITEM_COSTS[a];switch(Ph2.AnimationSystem.findObject("black",t).visible=!0,Ph2.AnimationSystem.findObject("price",t).visible=!0,(i=Ph2.AnimationSystem.findObject("star_empty",t)).visible=!0,i.frameName=o<=n?"dress_up_star_full.png":"dress_up_star_empty.png",a){case 0:e=Ph2.AnimationSystem.findObject("face4_anim",t),2===this.currentCharacterOn?(e.visible=!0,e.ph2Animations.play("face4_stand",1,!0)):e.visible=!1;break;case 1:e=Ph2.AnimationSystem.findObject("face1_anim",t),s=Ph2.AnimationSystem.findObject("face2_anim",t),0===this.currentCharacterOn?(e.visible=!0,s.visible=!1,e.ph2Animations.play("face1_stand",1,!0)):3===this.currentCharacterOn?(e.visible=!1,s.visible=!0,s.ph2Animations.play("face2_stand",1,!0)):(e.visible=!1,s.visible=!1);break;case 2:s=Ph2.AnimationSystem.findObject("face3_anim",t),5===this.currentCharacterOn?(s.visible=!0,s.ph2Animations.play("face3_stand",1,!0)):s.visible=!1}},e.prototype.unlockItem=function(t){var i;Ph2.AnimationSystem.findObject("star_empty",t).visible=!1,Ph2.AnimationSystem.findObject("price",t).visible=!1,null!=(i=Ph2.AnimationSystem.findObject("black",t))&&(i.visible=!0,i.ph2Animations.play("unlock_play",1,!1).onComplete.add(function(){i.visible=!1},this),this.game.ph2AudioManager.playEffect("sound_dressUnlock",!1),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",m.MISSION.UNLOCK_1_OUTFIT),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",m.MISSION.UNLOCK_OUTFIT_FOR_EVERY_ROBOT,this.currentCharacterOn))},e.prototype.checkCharacterItems=function(t){var i,e;for(this.facePlayer1=this.equippedOutfits[this.charactersChosen[0]].face,this.bodyPlayer1=this.equippedOutfits[this.charactersChosen[0]].body,this.headPlayer1=this.equippedOutfits[this.charactersChosen[0]].head,this.facePlayer2=this.equippedOutfits[this.charactersChosen[1]].face,this.bodyPlayer2=this.equippedOutfits[this.charactersChosen[1]].body,this.headPlayer2=this.equippedOutfits[this.charactersChosen[1]].head,i=this.unlocks[t].items,e=0;e<i.length;e++)if(i[e])switch(e){case 0:this.itemAlreadyUnlocked(this.item1);break;case 1:this.itemAlreadyUnlocked(this.item2);break;case 2:this.itemAlreadyUnlocked(this.item3);break;case 3:this.itemAlreadyUnlocked(this.item4);break;case 4:this.itemAlreadyUnlocked(this.item5);break;case 5:this.itemAlreadyUnlocked(this.item6);break;case 6:this.itemAlreadyUnlocked(this.item7);break;case 7:this.itemAlreadyUnlocked(this.item8);break;case 8:this.itemAlreadyUnlocked(this.item9)}else switch(e){case 0:this.itemLocked(this.item1);break;case 1:this.itemLocked(this.item2);break;case 2:this.itemLocked(this.item3);break;case 3:this.itemLocked(this.item4);break;case 4:this.itemLocked(this.item5);break;case 5:this.itemLocked(this.item6);break;case 6:this.itemLocked(this.item7);break;case 7:this.itemLocked(this.item8);break;case 8:this.itemLocked(this.item9)}},e.prototype.itemOver=function(t){var i,e,s,a=parseInt(t.parent.name.charAt(4),10)-1;if(this.unlocks[this.currentCharacterOn].items[a]){switch(t.parent.name){case"item1":case"item2":case"item3":e=this.facePlayer1,s=this.facePlayer2;break;case"item4":case"item5":case"item6":e=this.headPlayer1+3,s=this.headPlayer2+3;break;case"item7":case"item8":case"item9":e=this.bodyPlayer1+6,s=this.bodyPlayer2+6}this.selectingPlayer1?i=e===1+a:this.selectingPlayer2&&(i=s===1+a),this.itemFrames[a].frameName=i?"item_bottom3.png":"item_bottom_hover.png"}},e.prototype.itemOut=function(t){var i,e,s,a=parseInt(t.parent.name.charAt(4),10)-1,n=this.unlocks[this.currentCharacterOn].items[a];if(this.itemPopups[a].visible&&(this.itemPopups[a].visible=!1,this.popupTimer=-1,this.visiblePopup=-1),n){switch(t.parent.name){case"item1":case"item2":case"item3":e=this.facePlayer1,s=this.facePlayer2;break;case"item4":case"item5":case"item6":e=this.headPlayer1+3,s=this.headPlayer2+3;break;case"item7":case"item8":case"item9":e=this.bodyPlayer1+6,s=this.bodyPlayer2+6}this.selectingPlayer1?i=e===1+a:this.selectingPlayer2&&(i=s===1+a),this.itemFrames[a].frameName=i?"item_bottom2.png":"item_bottom.png"}},e.prototype.selectFace=function(t){var i,e,s,a,n,o=m.Instances.DataManager.getPlayerPoints(),r=this.unlocks[this.currentCharacterOn],h=!1;switch(t.parent.name){case"item1":e=1,a=r.items[s=0],i=m.SETTINGS.ITEM_COSTS[0],n=this.item1;break;case"item2":e=2,a=r.items[s=1],i=m.SETTINGS.ITEM_COSTS[1],n=this.item2;break;case"item3":e=3,a=r.items[s=2],i=m.SETTINGS.ITEM_COSTS[2],n=this.item3}a?h=!0:i<=o&&(o-=i,this.unlocks[this.currentCharacterOn].items[s]=h=!0,this.textStarPoints.setText(o.toString()),this.selectingPlayer1?this.checkCharacterItems(this.charactersChosen[0]):this.selectingPlayer2&&this.checkCharacterItems(this.charactersChosen[1]),this.unlockItem(n),m.Instances.DataManager.savePlayersPoints(o),m.Instances.DataManager.saveUnlocks(this.unlocks)),h?(this.selectingPlayer1?(e===this.facePlayer1?(1===e&&2===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face4_anim",n).visible=!0),2===e&&0===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face1_anim",n).visible=!0),2===e&&3===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face2_anim",n).visible=!0),3===e&&5===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face3_anim",n).visible=!0),e=0,t.alpha=1,this.itemFrames[s].frameName="item_bottom_hover.png"):(0<=this.facePlayer1-1&&(2===this.currentCharacterOn&&null!==Ph2.AnimationSystem.findObject("face4_anim",this.items[this.facePlayer1-1])&&(Ph2.AnimationSystem.findObject("face4_anim",this.items[this.facePlayer1-1]).visible=!0),0===this.currentCharacterOn&&null!==Ph2.AnimationSystem.findObject("face1_anim",this.items[this.facePlayer1-1])&&(Ph2.AnimationSystem.findObject("face1_anim",this.items[this.facePlayer1-1]).visible=!0),3===this.currentCharacterOn&&2===this.facePlayer1&&null!==Ph2.AnimationSystem.findObject("face2_anim",this.items[this.facePlayer1-1])&&(Ph2.AnimationSystem.findObject("face2_anim",this.items[this.facePlayer1-1]).visible=!0),5===this.currentCharacterOn)&&3===this.facePlayer1&&null!==Ph2.AnimationSystem.findObject("face3_anim",this.items[this.facePlayer1-1])&&(Ph2.AnimationSystem.findObject("face3_anim",this.items[this.facePlayer1-1]).visible=!0),1===e&&2===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face4_anim",n).visible=!1),2===e&&0===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face1_anim",n).visible=!1),2===e&&3===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face2_anim",n).visible=!1),3===e&&5===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face3_anim",n).visible=!1),t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.facePlayer1&&(this.itemFrames[this.facePlayer1-1].frameName="item_bottom.png",this.itemImages[this.facePlayer1-1].alpha=1)),this.facePlayer1=e):this.selectingPlayer2&&(e===this.facePlayer2?(1===e&&2===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face4_anim",n).visible=!0),2===e&&0===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face1_anim",n).visible=!0),2===e&&3===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face2_anim",n).visible=!0),3===e&&6===this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face3_anim",n).visible=!0),e=0,t.alpha=1):(0<=this.facePlayer2-1&&(2===this.currentCharacterOn&&null!==Ph2.AnimationSystem.findObject("face4_anim",this.items[this.facePlayer2-1])&&(Ph2.AnimationSystem.findObject("face4_anim",this.items[this.facePlayer2-1]).visible=!0),0===this.currentCharacterOn&&null!==Ph2.AnimationSystem.findObject("face1_anim",this.items[this.facePlayer2-1])&&(Ph2.AnimationSystem.findObject("face1_anim",this.items[this.facePlayer2-1]).visible=!0),3===this.currentCharacterOn&&2===this.facePlayer2&&null!==Ph2.AnimationSystem.findObject("face2_anim",this.items[this.facePlayer2-1])&&(Ph2.AnimationSystem.findObject("face2_anim",this.items[this.facePlayer2-1]).visible=!0),5===this.currentCharacterOn)&&3===this.facePlayer2&&null!==Ph2.AnimationSystem.findObject("face3_anim",this.items[this.facePlayer2-1])&&(Ph2.AnimationSystem.findObject("face3_anim",this.items[this.facePlayer2-1]).visible=!0),1===e&&2!==this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face4_anim",n).visible=!1),2===e&&0!==this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face1_anim",n).visible=!1),2===e&&3!==this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face2_anim",n).visible=!1),3===e&&5!==this.currentCharacterOn&&(Ph2.AnimationSystem.findObject("face3_anim",n).visible=!1),t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.facePlayer2&&(this.itemFrames[this.facePlayer2-1].frameName="item_bottom.png",this.itemImages[this.facePlayer2-1].alpha=1)),this.facePlayer2=e),this.equippedOutfits[this.currentCharacterOn].face=e,m.Instances.DataManager.saveEquippedOutfits(this.equippedOutfits),this.setSkin(),this.game.ph2AudioManager.playEffect("menuPress",!1)):(-1<this.visiblePopup&&this.visiblePopup!==s&&(this.itemPopups[this.visiblePopup].visible=!1),this.visiblePopup=s,this.itemPopups[s].visible=!0,this.popupTimer=1200)},e.prototype.selectHead=function(t){var i,e,s,a,n,o=m.Instances.DataManager.getPlayerPoints(),r=this.unlocks[this.currentCharacterOn],h=!1;switch(t.parent.name){case"item4":e=1,a=r.items[s=3],i=m.SETTINGS.ITEM_COSTS[3],n=this.item4;break;case"item5":e=2,a=r.items[s=4],i=m.SETTINGS.ITEM_COSTS[4],n=this.item5;break;case"item6":e=3,a=r.items[s=5],i=m.SETTINGS.ITEM_COSTS[5],n=this.item6}a?h=!0:i<=o&&(o-=i,this.unlocks[this.currentCharacterOn].items[s]=h=!0,this.textStarPoints.setText(o.toString()),this.selectingPlayer1?this.checkCharacterItems(this.charactersChosen[0]):this.selectingPlayer2&&this.checkCharacterItems(this.charactersChosen[1]),this.unlockItem(n),m.Instances.DataManager.savePlayersPoints(o),m.Instances.DataManager.saveUnlocks(this.unlocks)),h?(this.selectingPlayer1?(e===this.headPlayer1?(e=0,t.alpha=1,this.itemFrames[s].frameName="item_bottom_hover.png"):(t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.headPlayer1&&(this.itemFrames[this.headPlayer1+2].frameName="item_bottom.png",this.itemImages[this.headPlayer1+2].alpha=1)),this.headPlayer1=e):this.selectingPlayer2&&(e===this.headPlayer2?(e=0,t.alpha=1):(t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.headPlayer2&&(this.itemFrames[this.headPlayer2+2].frameName="item_bottom.png",this.itemImages[this.headPlayer2+2].alpha=1)),this.headPlayer2=e),this.equippedOutfits[this.currentCharacterOn].head=e,m.Instances.DataManager.saveEquippedOutfits(this.equippedOutfits),this.setSkin(),this.game.ph2AudioManager.playEffect("menuPress",!1)):(-1<this.visiblePopup&&this.visiblePopup!==s&&(this.itemPopups[this.visiblePopup].visible=!1),this.visiblePopup=s,this.itemPopups[s].visible=!0,this.popupTimer=1200)},e.prototype.selectBody=function(t){var i,e,s,a,n,o=m.Instances.DataManager.getPlayerPoints(),r=this.unlocks[this.currentCharacterOn],h=!1;switch(t.parent.name){case"item7":e=1,a=r.items[s=6],i=m.SETTINGS.ITEM_COSTS[6],n=this.item7;break;case"item8":e=2,a=r.items[s=7],i=m.SETTINGS.ITEM_COSTS[7],n=this.item8;break;case"item9":e=3,a=r.items[s=8],i=m.SETTINGS.ITEM_COSTS[8],n=this.item9}a?h=!0:i<=o&&(o-=i,this.unlocks[this.currentCharacterOn].items[s]=h=!0,this.textStarPoints.setText(o.toString()),this.selectingPlayer1?this.checkCharacterItems(this.charactersChosen[0]):this.selectingPlayer2&&this.checkCharacterItems(this.charactersChosen[1]),this.unlockItem(n),m.Instances.DataManager.savePlayersPoints(o),m.Instances.DataManager.saveUnlocks(this.unlocks)),h?(this.selectingPlayer1?(e===this.bodyPlayer1?(e=0,t.alpha=1):(t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.bodyPlayer1&&(this.itemFrames[this.bodyPlayer1+5].frameName="item_bottom.png",this.itemImages[this.bodyPlayer1+5].alpha=1)),this.bodyPlayer1=e):this.selectingPlayer2&&(e===this.bodyPlayer2?(e=0,t.alpha=1):(t.alpha=0,this.itemFrames[s].frameName="item_bottom2.png",0<this.bodyPlayer2&&(this.itemFrames[this.bodyPlayer2+5].frameName="item_bottom.png",this.itemImages[this.bodyPlayer2+5].alpha=1)),this.bodyPlayer2=e),this.equippedOutfits[this.currentCharacterOn].body=e,m.Instances.DataManager.saveEquippedOutfits(this.equippedOutfits),this.setSkin(),this.game.ph2AudioManager.playEffect("menuPress",!1)):(-1<this.visiblePopup&&this.visiblePopup!==s&&(this.itemPopups[this.visiblePopup].visible=!1),this.visiblePopup=s,this.itemPopups[s].visible=!0,this.popupTimer=1200)},e.prototype.switchSelection=function(){var t;switch(this.game.ph2AudioManager.playEffect("menuPress",!1),this.selectingPlayer1=!this.selectingPlayer1,this.selectingPlayer2=!this.selectingPlayer2,this.selectingPlayer1&&(this.currentCharacterOn=this.charactersChosen[0],this.spineDressHero1.visible=!0,this.spineDressHero2.visible=!1,(t=Ph2.UISystem.findObject("container/character"+(this.charactersChosen[0]+1)+"/player",this.uiCharacterSelect)).visible=!0,t.visibility.enable(!0),t.frameName="face_p1.png",t=Ph2.UISystem.findObject("container/character"+(this.charactersChosen[1]+1)+"/player",this.uiCharacterSelect),this.playerMode===m.PLAYER_MODE.MULTI_PLAYER)&&(t.visible=!0,t.visibility.enable(!0),t.frameName="face_p2.png"),this.selectingPlayer2&&(this.currentCharacterOn=this.charactersChosen[1],this.spineDressHero1.visible=!1,this.spineDressHero2.visible=!0,(t=Ph2.UISystem.findObject("container/character"+(this.charactersChosen[0]+1)+"/player",this.uiCharacterSelect)).visible=!0,t.visibility.enable(!0),t.frameName="face_p1.png",(t=Ph2.UISystem.findObject("container/character"+(this.charactersChosen[1]+1)+"/player",this.uiCharacterSelect)).visible=!1,t.visibility.enable(!1),t.frameName="face_p2.png"),this.currentCharacterOn){case 0:this.selectCharacter(this.buttonCharacter1);break;case 1:this.selectCharacter(this.buttonCharacter2);break;case 2:this.selectCharacter(this.buttonCharacter3);break;case 3:this.selectCharacter(this.buttonCharacter4);break;case 4:this.selectCharacter(this.buttonCharacter5);break;case 5:this.selectCharacter(this.buttonCharacter6);break;case 6:this.selectCharacter(this.buttonCharacter7);break;case 7:this.selectCharacter(this.buttonCharacter8);break;default:this.selectCharacter(this.buttonCharacter1)}},e.prototype.obtainSkins=function(){m.Instances.DataManager=m.Instances.DataManager,this.headsPlayer1=e.obtainHeads(this.spinePlayerName1),this.headsPlayer2=e.obtainHeads(this.spinePlayerName2),this.faces=["face1","face2","face3","face4"],this.bodies=["body1","body2","body3","body4"]},e.prototype.setSkin=function(){var t,i,e,s,a,n,o=this.selectingPlayer1?(this.outfitIndex1++,s=this.spinePlayerName1,e=this.spineDressHero1,i=this.equippedOutfits[this.charactersChosen[0]],t=this.headsPlayer1[i.head],a=this.outfitIndex1,this.headsPlayer1):(this.outfitIndex2++,s=this.spinePlayerName2,e=this.spineDressHero2,i=this.equippedOutfits[this.charactersChosen[1]],t=this.headsPlayer2[i.head],a=this.outfitIndex2,this.headsPlayer2),r=this.faces[i.face],h=this.bodies[i.body],c=!0;switch("dress_hero1"!==s&&"dress_hero3"!==s&&"dress_hero6"!==s||"head1"===(t=i.head<4?o[i.head+1]:t)?e.createCombinedSkin("outfit"+a,"normal0",t,r,h):e.createCombinedSkin("outfit"+a,"normal0","head1",t,r,h),e.setSkinByName("outfit"+a),e.setAnimationByName(0,"special",!1).onComplete=function(){e.setAnimationByName(0,"stand",!1)},e.setAnimationByName(1,"stand",!1),e.setToSetupPose(),s){case"dress_hero1":if("face1"===r)n="face1_front";else{if("face3"!==r){c=!1;break}n="face2_front"}break;case"dress_hero2":"face1"===r?n="face1_front":c=!1;break;case"dress_hero3":"face1"===r||"face2"===r||"face3"===r?n="face_front":c=!1;break;case"dress_hero4":"face1"===r?n="face1_front":"face3"===r?n="face2_front":c=!1;break;case"dress_hero5":"face1"===r?n="face1_front":c=!1;break;case"dress_hero6":"face1"===r||"face4"===r?n="face1_front":c=!1;break;case"dress_hero7":case"dress_hero8":"face1"===r?n="face1_front":c=!1;break;default:c=!(n="face1_front")}c&&e.setAnimationByName(1,n,!0)},e.prototype.gotoGameplay=function(){var t,i,e,s,a,n={face:this.facePlayer1,head:this.headPlayer1,body:this.bodyPlayer1},o=this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER?{face:this.game.rnd.integerInRange(0,3),head:this.game.rnd.integerInRange(0,3),body:this.game.rnd.integerInRange(0,3)}:{face:this.facePlayer2,head:this.headPlayer2,body:this.bodyPlayer2},r={face:this.game.rnd.integerInRange(0,3),head:this.game.rnd.integerInRange(0,3),body:this.game.rnd.integerInRange(0,3)},h={face:this.game.rnd.integerInRange(0,3),head:this.game.rnd.integerInRange(0,3),body:this.game.rnd.integerInRange(0,3)};if(m.Instances.DataManager.saveOutfitPlayer1(n),m.Instances.DataManager.saveOutfitPlayer2(o),m.Instances.DataManager.saveOutfitPlayer3(r),m.Instances.DataManager.saveOutfitPlayer4(h),(s=[]).push(this.charactersChosen[0]),this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER)for(t=1;1===t;)(i=this.game.rnd.integerInRange(0,7))!==this.charactersChosen[0]&&(this.charactersChosen[1]=i,t++,s.push(i));else t=2,s.push(this.charactersChosen[1]);for(;t<this.enemiesSelected+1;){for(e=!1,i=this.game.rnd.integerInRange(0,7),a=0;a<s.length;a++)i===s[a]&&(e=!0);e||(this.charactersChosen[s.length]=i,s.push(i),t++)}this.game.ph2AnimationManager.stopAll(),this.stopAnimations(),m.Instances.DataManager.saveCharactersChosen(this.charactersChosen),m.Instances.DataManager.saveOutfitPlayer1(this.equippedOutfits[this.charactersChosen[0]]),m.Instances.DataManager.saveOutfitPlayer2(this.equippedOutfits[this.charactersChosen[1]]),m.Instances.DataManager.saveCurrentLevel(1),m.Instances.DataManager.saveMapTheme(this.mapTheme),this.showIntroComic2()},e.prototype.showIntroComic2=function(){var t=this;this.game.ph2AudioManager.switchMusic(m.Music.COMIC_GO_GAMEPLAY),this.comic.showIntroComic2().onComplete.add(function(){t.comic.hideComics(),t.showLoadingScreen()},this)},e.prototype.showLoadingScreen=function(){var t,i=this,e=Ph2.UISystem.findObject("container/mode_image",this.uiLoading),s=Ph2.UISystem.findObject("container/bomb_container/bomb1/bomb",this.uiLoading),a=Ph2.UISystem.findObject("container/bomb_container/bomb2/bomb",this.uiLoading),n=Ph2.UISystem.findObject("container/bomb_container/bomb3/bomb",this.uiLoading),o=Ph2.UISystem.findObject("container/bomb_container/bomb4/bomb",this.uiLoading),r=Ph2.UISystem.findObject("container/bomb_container/bomb5/bomb",this.uiLoading),h=Ph2.UISystem.findObject("container/bomb_container/bomb6/bomb",this.uiLoading);switch(s.alpha=0,a.alpha=0,n.alpha=0,o.alpha=0,r.alpha=0,h.alpha=0,t=m.SETTINGS.LOADING_SCREEN/6,this.game.ph2AudioManager.stopEffect(this.audioComic2),this.game.add.tween(s).to({alpha:1},t,"Linear",!0).onComplete.add(function(){i.game.ph2AudioManager.playEffect("loadingBomb",!1)},this),this.game.add.tween(a).to({alpha:1},t,"Linear",!0,t).onComplete.add(function(){i.game.ph2AudioManager.playEffect("loadingBomb",!1)},this),this.game.add.tween(n).to({alpha:1},t,"Linear",!0,2*t).onComplete.add(function(){i.game.ph2AudioManager.playEffect("loadingBomb",!1)},this),this.game.add.tween(o).to({alpha:1},t,"Linear",!0,3*t).onComplete.add(function(){i.game.ph2AudioManager.playEffect("loadingBomb",!1)},this),this.game.add.tween(r).to({alpha:1},t,"Linear",!0,4*t).onComplete.add(function(){i.game.ph2AudioManager.playEffect("loadingBomb",!1)},this),this.game.add.tween(h).to({alpha:1},t,"Linear",!0,5*t).onComplete.add(function(){i.game.ph2AudioManager.playEffect("loadingBomb",!1)},this),this.gameMode){case m.GAME_MODE.ARCADE:e.frameName="loading_image1.png",m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiLoading,"title_arcade"),m.Instances.LocalizationManager.localizeText("container/description",this.uiLoading,"advice_arcade");break;case m.GAME_MODE.BATTLE_ROYALE:e.frameName="loading_image2.png",m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiLoading,"title_battle_royale"),m.Instances.LocalizationManager.localizeText("container/description",this.uiLoading,"advice_battle_royale");break;case m.GAME_MODE.NEW_PACMAN:e.frameName="loading_image3.png",m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiLoading,"title_new_pacman"),m.Instances.LocalizationManager.localizeText("container/description",this.uiLoading,"advice_new_pacman");break;case m.GAME_MODE.ICE_MAN:e.frameName="loading_image4.png",m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiLoading,"title_ice_man"),m.Instances.LocalizationManager.localizeText("container/description",this.uiLoading,"advice_ice_man");break;case m.GAME_MODE.STAR_COLLECTOR:e.frameName="loading_image5.png",m.Instances.LocalizationManager.localizeText("container/container_title/title",this.uiLoading,"title_star_collector"),m.Instances.LocalizationManager.localizeText("container/description",this.uiLoading,"advice_star_collector");break;default:e.frameName="loading_image1.png",m.Instances.LocalizationManager.localizeText("container_title/title",this.uiLoading,"title_arcade"),m.Instances.LocalizationManager.localizeText("container/description",this.uiLoading,"advice_arcade")}m.Instances.LocalizationManager.fitFontSizeUI("container/description",this.uiLoading,500*m.SETTINGS.SCALE,-1,29*m.SETTINGS.SCALE),this.uiCharacterSelect.visible=!1,this.uiLoading.visible=!0,this.game.time.events.add(m.SETTINGS.LOADING_SCREEN,function(){i.game.state.start("gameplayState",!0,!1,i.gameMode,i.difficulty,i.playerMode,i.mapTheme,i.charactersChosen,i.enemiesSelected,i.levelsSelected)},this)},e.prototype.stopAnimations=function(){this.trophy.ph2Animations.stop(),this.bomb.ph2Animations.stop(),this.logoAnimation1.ph2Animations.stop(),this.logoAnimation2.ph2Animations.stop(),this.logoAnimation1.destroy(),this.logoAnimation2.destroy();for(var t=0;t<this.characterFaces.length;t++)this.characterFaces[t].ph2Animations.stop();Ph2.AnimationSystem.findObject("face4_anim",this.item1).ph2Animations.stop(),Ph2.AnimationSystem.findObject("face1_anim",this.item2).ph2Animations.stop(),Ph2.AnimationSystem.findObject("face2_anim",this.item2).ph2Animations.stop(),Ph2.AnimationSystem.findObject("face3_anim",this.item3).ph2Animations.stop()},e.prototype.createButtonListener=function(t,i){t.inputEnabled=!0,t.input.useHandCursor=!0,t.events.onInputDown.add(i,this)},e.prototype.createItemButtonListener=function(t,i){t.inputEnabled=!0,t.events.onInputDown.add(i,this),t.events.onInputOver.add(this.itemOver,this),t.events.onInputOut.add(this.itemOut,this)},e.prototype.createButtonListener2=function(t,i){t.onInputUp.add(i,this)},e.prototype.buttonInputOver=function(t){t.changeFrame("button_press.png"),this.game.ph2AudioManager.playEffect("menuTouch",!1)},e.buttonInputOut=function(t){t.changeFrame("button.png")},e.prototype.settingsInputOver=function(t){var i=!1;switch(t.name){case"1player_button":i=this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER;break;case"2player_button":i=this.playerMode===m.PLAYER_MODE.MULTI_PLAYER;break;case"0enemies_button":i=0===this.enemiesSelected;break;case"1enemies_button":i=1===this.enemiesSelected;break;case"2enemies_button":i=2===this.enemiesSelected;break;case"3enemies_button":i=3===this.enemiesSelected;break;case"20levels_button":i=20===this.levelsSelected;break;case"15levels_button":i=15===this.levelsSelected;break;case"10levels_button":i=10===this.levelsSelected;break;case"5levels_button":i=5===this.levelsSelected;break;case"aquarium_button":i=this.mapTheme===m.MAP_THEME.CHRISTMAS;break;case"bathroom_button":i=this.mapTheme===m.MAP_THEME.BOUTIQUE;break;case"baseball_field_button":i=this.mapTheme===m.MAP_THEME.CLASSROOM;break;case"castle_button":i=this.mapTheme===m.MAP_THEME.FOREST;break;case"dollhouse_button":i=this.mapTheme===m.MAP_THEME.BEACH;break;case"farm_button":i=this.mapTheme===m.MAP_THEME.RANCH;break;case"garden_button":i=this.mapTheme===m.MAP_THEME.TOY_STORE;break;case"polar_region_button":i=this.mapTheme===m.MAP_THEME.RACE_TRACK;break;case"picnic_button":i=this.mapTheme===m.MAP_THEME.BAKERY;break;case"random_button":i=this.mapTheme===m.MAP_THEME.RANDOM;break;case"easy_button":i=this.difficulty===m.DIFFICULTY.EASY;break;case"normal_button":i=this.difficulty===m.DIFFICULTY.NORMAL;break;case"hard_button":i=this.difficulty===m.DIFFICULTY.HARD}i||t.changeFrame("small_button_hover.png")},e.prototype.settingsInputOut=function(t){var i=!1;switch(t.name){case"1player_button":i=this.playerMode===m.PLAYER_MODE.SINGLE_PLAYER;break;case"2player_button":i=this.playerMode===m.PLAYER_MODE.MULTI_PLAYER;break;case"0enemies_button":i=0===this.enemiesSelected;break;case"1enemies_button":i=1===this.enemiesSelected;break;case"2enemies_button":i=2===this.enemiesSelected;break;case"3enemies_button":i=3===this.enemiesSelected;break;case"20levels_button":i=20===this.levelsSelected;break;case"15levels_button":i=15===this.levelsSelected;break;case"10levels_button":i=10===this.levelsSelected;break;case"5levels_button":i=5===this.levelsSelected;break;case"aquarium_button":i=this.mapTheme===m.MAP_THEME.CHRISTMAS;break;case"bathroom_button":i=this.mapTheme===m.MAP_THEME.BOUTIQUE;break;case"baseball_field_button":i=this.mapTheme===m.MAP_THEME.CLASSROOM;break;case"castle_button":i=this.mapTheme===m.MAP_THEME.FOREST;break;case"dollhouse_button":i=this.mapTheme===m.MAP_THEME.BEACH;break;case"farm_button":i=this.mapTheme===m.MAP_THEME.RANCH;break;case"garden_button":i=this.mapTheme===m.MAP_THEME.TOY_STORE;break;case"polar_region_button":i=this.mapTheme===m.MAP_THEME.RACE_TRACK;break;case"picnic_button":i=this.mapTheme===m.MAP_THEME.BAKERY;break;case"random_button":i=this.mapTheme===m.MAP_THEME.RANDOM;break;case"easy_button":i=this.difficulty===m.DIFFICULTY.EASY;break;case"normal_button":i=this.difficulty===m.DIFFICULTY.NORMAL;break;case"hard_button":i=this.difficulty===m.DIFFICULTY.HARD}i||t.changeFrame("small_button_normal.png")},e.obtainHeads=function(t){return"dress_hero1"===t||"dress_hero3"===t||"dress_hero6"===t?["head1","decor1","decor2","decor3","decor4"]:["head1","head2","head3","head4"]},e.prototype.gotoMoreGames=function(){this.game.ph2AudioManager.playEffect("menuPress",!1),window.open(Constants.MORE_GAMES,"_blank")},e.prototype.bombItOver=function(t){switch(t.name){case"bombit2":t.frameName="bombit2_hov.png";break;case"bombit3":t.frameName="bombit3_hov.png";break;case"bombit4":t.frameName="bombit4_hov.png";break;case"bombit5":t.frameName="bombit5_hov.png";break;case"bombit6":t.frameName="bombit6_hov.png"}this.game.ph2AudioManager.playEffect("menuTouch",!1)},e.prototype.bombItOut=function(t){switch(t.name){case"bombit2":t.frameName="bombit2.png";break;case"bombit3":t.frameName="bombit3.png";break;case"bombit4":t.frameName="bombit4.png";break;case"bombit5":t.frameName="bombit5.png";break;case"bombit6":t.frameName="bombit6.png"}},e.prototype.gotoBombIt=function(t){var i;switch(t.name){case"bombit2":i=Constants.BOMB_IT_2;break;case"bombit3":i=Constants.BOMB_IT_3;break;case"bombit4":i=Constants.BOMB_IT_4;break;case"bombit5":i=Constants.BOMB_IT_5;break;case"bombit6":i=Constants.BOMB_IT_6}this.game.ph2AudioManager.playEffect("menuPress",!1),this.game.ph2NotificationManager.postNotification("_CHECK_MISSION",m.MISSION.CLICK_GAME_LINKS_IN_THIS_GAME),this.loadMissions(),window.open(i,"_blank")},e.prototype.characterOver=function(t){if(t!==this.currentButtonCharacterP1&&t!==this.currentButtonCharacterP2)switch(this.game.ph2AudioManager.playEffect("menuTouch",!1),t.name){case"character1_button":case"character2_button":case"character3_button":case"character4_button":case"character5_button":case"character6_button":case"character7_button":t.frameName="face_hover.png"}},e.prototype.characterOut=function(t){if(t!==this.currentButtonCharacterP1&&t!==this.currentButtonCharacterP2)switch(t.name){case"character1_button":case"character2_button":case"character3_button":case"character4_button":case"character5_button":case"character6_button":case"character7_button":t.frameName="face_normal.png"}},e.prototype.fixCharacterButtonFrames=function(){this.isDesktop||this.uiCharacterSelect.visible&&(this.buttonCharacter1!==this.currentButtonCharacterP1&&(this.buttonCharacter1.frameName="face_normal.png"),this.buttonCharacter2!==this.currentButtonCharacterP1&&(this.buttonCharacter2.frameName="face_normal.png"),this.buttonCharacter3!==this.currentButtonCharacterP1&&(this.buttonCharacter3.frameName="face_normal.png"),this.buttonCharacter4!==this.currentButtonCharacterP1&&(this.buttonCharacter4.frameName="face_normal.png"),this.buttonCharacter5!==this.currentButtonCharacterP1&&(this.buttonCharacter5.frameName="face_normal.png"),this.buttonCharacter6!==this.currentButtonCharacterP1&&(this.buttonCharacter6.frameName="face_normal.png"),this.buttonCharacter7!==this.currentButtonCharacterP1&&(this.buttonCharacter7.frameName="face_normal.png"),this.buttonCharacter8!==this.currentButtonCharacterP1&&(this.buttonCharacter8.frameName="face_normal.png"),this.buttonCharacter1!==this.currentButtonCharacterP1)&&(this.buttonCharacter1.frameName="face_normal.png")},e.prototype.shutdown=function(){},e.prototype.resize=function(){var t,i,e,s;this.isDesktop||(this.bgLandscape.x=.5*this.game.width,this.bgLandscape.y=.5*this.game.height,this.bgPortrait.x=.5*this.game.width,this.bgPortrait.y=this.game.height,this.bgLandscape.scale.set(1,1),this.bgPortrait.scale.set(1,1),"landscape"===(s=Constants.CURRENT_ORIENTATION)?(this.bgLandscape.visible=!0,this.bgPortrait.visible=!1,this.containerSelectMode.frameName="big_container4.png",this.containerSettings.frameName="big_container1.png",this.containerDressUp.frameName="big_container1.png",this.containerLoading.frameName="big_container1.png",this.containerPowerUps.frameName="big_container4.png",this.containerControls.frameName="big_container4.png",this.logo.frameName="mm_logo1.png",this.logoAnimation1.visible=!0,this.logoAnimation2.visible=!1,m.Instances.LocalizationManager.fitFontSizeUI("container/container_title/title",this.uiCharacterSelect,520*m.SETTINGS.SCALE,-1,42*m.SETTINGS.SCALE),this.bgPowerUps.resize(743*m.SETTINGS.SCALE,478*m.SETTINGS.SCALE),this.edgePowerUps.resize(776*m.SETTINGS.SCALE,539*m.SETTINGS.SCALE),this.bgSettings.resize(743*m.SETTINGS.SCALE,478*m.SETTINGS.SCALE),this.edgeSettings.resize(776*m.SETTINGS.SCALE,538*m.SETTINGS.SCALE),this.bgDressUp.resize(743*m.SETTINGS.SCALE,478*m.SETTINGS.SCALE),this.edgeDressUp.resize(773*m.SETTINGS.SCALE,544*m.SETTINGS.SCALE),this.bgLoading.resize(743*m.SETTINGS.SCALE,478*m.SETTINGS.SCALE),this.edgeLoading.resize(776*m.SETTINGS.SCALE,553*m.SETTINGS.SCALE),this.bgGameSettings.resize(776*m.SETTINGS.SCALE,478*m.SETTINGS.SCALE),this.edgeGameSettings.resize(776*m.SETTINGS.SCALE,543*m.SETTINGS.SCALE)):"portrait"===s&&(this.bgLandscape.visible=!1,this.bgPortrait.visible=!0,this.containerSelectMode.frameName="big_container2.png",this.containerSettings.frameName="big_container2.png",this.containerDressUp.frameName="big_container2.png",this.containerLoading.frameName="big_container2.png",this.containerPowerUps.frameName="big_container2.png",this.containerControls.frameName="big_container2.png",this.logo.frameName="mm_logo2.png",this.logoAnimation1.visible=!1,this.logoAnimation2.visible=!0,m.Instances.LocalizationManager.fitFontSizeUI("container/container_title/title",this.uiCharacterSelect,330*m.SETTINGS.SCALE,-1,42*m.SETTINGS.SCALE),this.bgPowerUps.resize(688*m.SETTINGS.SCALE,694*m.SETTINGS.SCALE),this.edgePowerUps.resize(718*m.SETTINGS.SCALE,764*m.SETTINGS.SCALE),this.bgSettings.resize(688*m.SETTINGS.SCALE,694*m.SETTINGS.SCALE),this.edgeSettings.resize(719*m.SETTINGS.SCALE,769*m.SETTINGS.SCALE),this.bgDressUp.resize(688*m.SETTINGS.SCALE,694*m.SETTINGS.SCALE),this.edgeDressUp.resize(719*m.SETTINGS.SCALE,763*m.SETTINGS.SCALE),this.bgLoading.resize(678*m.SETTINGS.SCALE,478*m.SETTINGS.SCALE),this.edgeLoading.resize(719*m.SETTINGS.SCALE,553*m.SETTINGS.SCALE),this.bgGameSettings.resize(717*m.SETTINGS.SCALE,763*m.SETTINGS.SCALE),this.edgeGameSettings.resize(717*m.SETTINGS.SCALE,769*m.SETTINGS.SCALE)),i="landscape"===s?Constants.CALCULATED_WIDTH-this.bgLandscape.width:Constants.CALCULATED_WIDTH-this.bgPortrait.width,(t="landscape"===s?Constants.CALCULATED_HEIGHT-this.bgLandscape.height:Constants.CALCULATED_HEIGHT-this.bgPortrait.height)<i?0<i&&(e="landscape"===s?Constants.CALCULATED_WIDTH/this.bgLandscape.width:Constants.CALCULATED_WIDTH/this.bgPortrait.width,this.bgLandscape.scale.set(e,e),this.bgPortrait.scale.set(e,e)):0<t&&(e="landscape"===s?Constants.CALCULATED_HEIGHT/this.bgLandscape.height:Constants.CALCULATED_HEIGHT/this.bgPortrait.height,this.bgLandscape.scale.set(e,e),this.bgPortrait.scale.set(e,e)),this.uiMainMenu.onGameSizeChanged(),this.comic.resizeComic(),this.resizeGroup())},e.prototype.resizeGroup=function(){var t,i=Constants.CALCULATED_WIDTH,e=Constants.CALCULATED_HEIGHT,s=800*m.SETTINGS.SCALE;i<s?(t=e*(s=i/s),this.group.x=.5*(i-i*s),this.group.y=.5*(e-t),this.group.scale.set(s,s),this.comic.resizeOverlay()):(this.group.x=0,this.group.y=0,this.group.scale.set(1,1))},e.setWordWrap=function(t,i){t.wordWrap=!0,t.wordWrapWidth=i},e.prototype.createCheats=function(){var t=this,i=this.game.input.keyboard.addKey(Phaser.Keyboard.NINE),e=this.game.input.keyboard.addKey(Phaser.Keyboard.ZERO),s=this.game.input.keyboard.addKey(Phaser.Keyboard.R);i.onDown.add(function(){t.totalPoints=m.Instances.DataManager.getPlayerPoints()-5e3,m.Instances.DataManager.savePlayersPoints(t.totalPoints),t.textStarPoints.setText(t.totalPoints.toString())},this),e.onDown.add(function(){t.totalPoints=m.Instances.DataManager.getPlayerPoints()+5e3,m.Instances.DataManager.savePlayersPoints(t.totalPoints),t.textStarPoints.setText(t.totalPoints.toString())},this),s.onDown.add(function(){m.Instances.DataManager.createData(),m.Instances.DataManager.saveMusic(!1),t.stopAnimations(),t.game.state.start("mainMenuState",!0,!1)},this)};var t,i=e;function e(){return t.call(this)||this}m.MainMenuState=i}(Game=Game||{}),function(m){e=Phaser.State,__extends(i,e),i.prototype.init=function(t){this.toState=t},i.prototype.preload=function(){var t=this;this.game.ph2Loader.useScalingVariant("x"+m.SETTINGS.SCALE),this.game.ph2Loader.useSpineScalingVariant("@"+m.SETTINGS.SCALE+"x"),this.game.ph2UIManager.setGameScale(m.SETTINGS.SCALE),this.game.ph2AnimationManager.setGameScale(m.SETTINGS.SCALE),this.game.load.onFileComplete.add(function(t){AzerionIntegration.SDK.onLoadProgress(t)}),this.game.load.onLoadComplete.add(function(){AzerionIntegration.SDK.onLoadComplete()}),AzerionIntegration.SDK.removeSplashLoader(function(){t.createListeners(),t.game.state.start("mainMenuState",!0,!1)}),this.loadAudio(),m.Instances.DataManager=new m.DataManager(this.game),m.Instances.DataManager.checkGameData(),m.Instances.DataManager.saveLivesPlayer1(m.SETTINGS.INITIAL_LIVES),m.Instances.DataManager.saveLivesPlayer2(m.SETTINGS.INITIAL_LIVES),m.Instances.LocalizationManager=new m.LocalizationManager(this.game,m.Instances.DataManager.getLanguage()),m.Instances.MissionManager=new m.MissionManager(this.game),this.game.ph2Loader.debug(!0),this.game.ph2Loader.setAssetsResources(this.game.cache.getJSON("resources")),this.game.ph2Loader.load("firstLoad"),this.checkBalanceData()},i.prototype.createListeners=function(){var t=this;Fabrique.PauseHandler.getInstance().onPauseCallback.add(function(){t.game.ph2AudioManager.mute()}),Fabrique.PauseHandler.getInstance().onResumeCallback.add(function(){t.game.ph2AudioManager.unmute()})},i.prototype.loadAudio=function(){var t=new Howl({src:["assets/audios/game_music_1.ogg?v="+version,"assets/audios/game_music_1.mp3?v="+version,"assets/audios/game_music_1.m4a?v="+version],preload:!0,loop:!0}),i=new Howl({src:["assets/audios/game_music_2.ogg?v="+version,"assets/audios/game_music_2.mp3?v="+version,"assets/audios/game_music_2.m4a?v="+version],preload:!0,loop:!0}),e=new Howl({src:["assets/audios/game_music_3.ogg?v="+version,"assets/audios/game_music_3.mp3?v="+version,"assets/audios/game_music_3.m4a?v="+version],preload:!0,loop:!0}),s=new Howl({src:["assets/audios/game_music_4.ogg?v="+version,"assets/audios/game_music_4.mp3?v="+version,"assets/audios/game_music_4.m4a?v="+version],preload:!0,loop:!0}),a=new Howl({src:["assets/audios/menu_music.ogg?v="+version,"assets/audios/menu_music.mp3?v="+version,"assets/audios/menu_music.m4a?v="+version],preload:!0,loop:!0}),n=new Howl({src:["assets/audios/ui_story.ogg?v="+version,"assets/audios/ui_story.mp3?v="+version,"assets/audios/ui_story.m4a?v="+version],preload:!0,loop:!1}),o=new Howl({src:["assets/audios/ui_go.ogg?v="+version,"assets/audios/ui_go.mp3?v="+version,"assets/audios/ui_go.m4a?v="+version],preload:!0,loop:!1}),r=new Howl({src:["assets/audios/level_complete.ogg?v="+version,"assets/audios/level_complete.mp3?v="+version,"assets/audios/level_complete.m4a?v="+version],preload:!0,loop:!1}),h=new Howl({src:["assets/audios/level_failed.ogg?v="+version,"assets/audios/level_failed.mp3?v="+version,"assets/audios/level_failed.m4a?v="+version],preload:!0,loop:!1}),c=new Howl({src:["assets/audios/game_failed.ogg?v="+version,"assets/audios/game_failed.mp3?v="+version,"assets/audios/game_failed.m4a?v="+version],preload:!0,loop:!0}),l=[],t=(l.push(t),l.push(i),l.push(e),l.push(s),new Howl({src:["assets/audios/bombit7_sfx.ogg?v="+version,"assets/audios/bombit7_sfx.mp3?v="+version,"assets/audios/bombit7_sfx.m4a?v="+version],preload:!0,sprite:{InvincibilitySound:[0,1933.061224489796],addBomb:[3e3,261.2244897959184],bomb:[5e3,1410.6122448979593],dead:[8e3,757.5510204081635],eatProp:[1e4,339.5918367346944],gameFailed:[12e3,13740.408163265307],getPlane:[27e3,1306.1224489795932],levelComplete:[3e4,7653.877551020408],levelFailed:[39e3,5433.4693877551035],loadingBomb:[46e3,600.8163265306123],menuPress:[48e3,653.0612244897966],menuTouch:[5e4,208.9795918367372],selectPress:[52e3,783.6734693877575],selectTouch:[54e3,522.448979591836],sound_TerminalHammer:[56e3,3970.612244897957],sound_butter:[61e3,1776.3265306122448],sound_car_run:[64e3,2612.2448979591863],sound_catch_robot:[68e3,626.9387755101974],sound_catch_run:[7e4,940.4081632653032],sound_chimney:[72e3,835.9183673469346],sound_coin:[74e3,548.5714285714351],sound_crabBite:[76e3,809.7959183673424],sound_dressUnlock:[78e3,1201.6326530612246],sound_dropWater:[81e3,1358.3673469387777],sound_frog:[84e3,1149.3877551020405],sound_getItem:[87e3,417.9591836734744],sound_horse_run:[89e3,1985.306122448975],sound_inv:[92e3,940.4081632653032,!0],sound_lightening:[94e3,2272.6530612244887],sound_rocket_exp:[98e3,1880.8163265306064],sound_rocket_start:[101e3,2560.0000000000023],sound_sealion:[105e3,888.1632653061189],sound_sealionAttack:[107e3,522.448979591843],sound_size:[109e3,731.428571428566],sound_snowball:[111e3,835.9183673469346],sound_speed_up:[113e3,1097.142857142856],sound_star:[116e3,1201.6326530612246],sound_stun:[119e3,1149.3877551020405],sound_teacher_angry:[122e3,992.6530612244875],sound_tractor:[124e3,992.6530612244875],sound_tree_hole:[126e3,1462.8571428571463],sound_ui_l:[129e3,6191.020408163268],sound_ui_m:[137e3,4048.979591836741],sound_ui_s:[143e3,1880.8163265306064],sound_wawa_exp:[146e3,1097.1428571428703],sound_wawa_fire:[149e3,1253.8775510203948],uiCherry:[152e3,7471.020408163269,!0],uiGo:[161e3,13792.653061224484],uiStory:[176e3,27115.10204081634],useLaserReady:[205e3,1567.3469387755006],useLaserShoot:[208e3,1436.734693877554],useLauncher:[211e3,1227.7551020408168],useNombril:[214e3,783.6734693877645],useSinker:[216e3,1253.8775510203948],useThrower:[219e3,1071.020408163264]}}));this.game.ph2AudioManager.setAudioEffectsFile(t),m.Music.MAIN_MENU=a,m.Music.GAMEPLAY=l,m.Music.COMIC_INTRO=n,m.Music.COMIC_GO_GAMEPLAY=o,m.Music.LEVEL_COMPLETED=r,m.Music.LEVEL_FAILED=h,m.Music.GAME_OVER=c},i.prototype.checkBalanceData=function(){var t,i=this.game.cache.getJSON("balance");for(t in i)if(i.hasOwnProperty(t)&&"undefined"!==m[t])for(var e in i[t])i[t].hasOwnProperty(e)&&"undefined"!==m[t][e]&&(m[t][e]=i[t][e])};var e,t=i;function i(t){var i=e.call(this)||this;return i.game=t,i}m.PreloaderState=t}(Game=Game||{}),function(t){var i;function e(){}function s(){}function a(){}e.DataManager=null,e.LocalizationManager=null,e.MissionManager=null,t.Instances=e,s.GAMEPLAY=[],s.MAIN_MENU=null,s.LEVEL_COMPLETED=null,s.LEVEL_FAILED=null,s.COMIC_INTRO=null,s.COMIC_GO_GAMEPLAY=null,s.GAME_OVER=null,t.Music=s,a.SCALE=1,a.CURRENT_ORIENTATION=0,a.CELL_WIDTH=10,a.CELL_HEIGHT=10,a.GRID_WIDTH=10,a.GRID_HEIGHT=10,a.LOADING_SCREEN=3e3,a.MATCH_TIME=18e4,a.INITIAL_BLINKING_TIME=0,a.INITIAL_SPEED=3,a.SPEED_INCREASE=0,a.INITIAL_LIVES=3,a.BOMB_TIMER=2500,a.BOMB_SPEED_KICKED=5,a.MAX_BOMB_POWER=5,a.MAX_SPEED=9,a.MAX_BOMBS=9,a.TIME_STUNNED=5e3,a.ON_BLOCK_DESTROY=[],a.POWER_UP_CHANCES=[],a.WEAPON_CHANCES=[],a.MOUNT_CHANCES=[],a.TREASURE_BOXES=[],a.PACMAN_POWER_UPS=[],a.POINTS_EASY=100,a.POINTS_NORMAL=100,a.POINTS_HARD=100,a.POINTS_PER_SECOND=100,a.POINTS_ARCADE_1_KILL=100,a.POINTS_ARCADE_2_KILL=100,a.POINTS_ARCADE_3_KILL=100,a.POINTS_PER_KILL=100,a.POINTS_PER_LIVE=100,a.POINTS_PER_COIN=100,a.POINTS_PER_STAR=100,a.TIMES_TO_SEARCH_PLAYER_EASY=10,a.TIMES_TO_SEARCH_PLAYER_NORMAL=10,a.TIMES_TO_SEARCH_PLAYER_HARD=10,a.CHANCE_TO_SEARCH_PLAYER_EASY=10,a.CHANCE_TO_SEARCH_PLAYER_NORMAL=10,a.CHANCE_TO_SEARCH_PLAYER_HARD=10,a.CHANCE_TO_ATTACK_EASY=30,a.CHANCE_TO_ATTACK_NORMAL=30,a.CHANCE_TO_ATTACK_HARD=30,a.ITEM_COSTS=[],a.CAMERA_SHAKE=.1,a.CAMERA_SHAKE_DURATION=250,a.TRACK_VERTICAL_1=[{x:4,y:5},{x:11,y:5},{x:3,y:8},{x:10,y:8}],a.TRACK_HORIZONTAL_1=[{x:5,y:4},{x:6,y:4},{x:7,y:4},{x:8,y:4},{x:9,y:4},{x:10,y:4},{x:5,y:6},{x:9,y:6},{x:10,y:6},{x:4,y:9},{x:5,y:9},{x:6,y:9},{x:7,y:9},{x:8,y:9},{x:9,y:9},{x:4,y:7},{x:5,y:7},{x:9,y:7}],a.TRACK_UP_LEFT_1=[{x:4,y:4},{x:3,y:7}],a.TRACK_UP_RIGHT_1=[{x:11,y:4},{x:10,y:7}],a.TRACK_DOWN_LEFT_1=[{x:4,y:6},{x:3,y:9}],a.TRACK_DOWN_RIGHT_1=[{x:11,y:6},{x:10,y:9}],a.TRACK_VERTICAL_2=[{x:3,y:6},{x:3,y:7},{x:3,y:8},{x:4,y:7},{x:4,y:3},{x:4,y:4},{x:5,y:4},{x:5,y:5},{x:11,y:4},{x:11,y:5},{x:11,y:6},{x:10,y:5},{x:10,y:8},{x:10,y:9},{x:9,y:7},{x:9,y:8}],a.TRACK_HORIZONTAL_2=[{x:5,y:2},{x:6,y:2},{x:7,y:2},{x:6,y:3},{x:8,y:4},{x:9,y:4},{x:9,y:3},{x:10,y:3},{x:4,y:9},{x:5,y:9},{x:5,y:8},{x:6,y:8},{x:7,y:10},{x:8,y:10},{x:9,y:10},{x:8,y:9}],a.TRACK_UP_LEFT_2=[{x:4,y:2},{x:5,y:3},{x:3,y:5},{x:4,y:6},{x:9,y:6},{x:10,y:7}],a.TRACK_UP_RIGHT_2=[{x:8,y:2},{x:7,y:3},{x:11,y:3},{x:10,y:4},{x:7,y:8},{x:6,y:9}],a.TRACK_DOWN_LEFT_2=[{x:3,y:9},{x:4,y:8},{x:7,y:9},{x:6,y:10},{x:7,y:4},{x:8,y:3}],a.TRACK_DOWN_RIGHT_2=[{x:4,y:5},{x:5,y:6},{x:9,y:9},{x:10,y:10},{x:10,y:6},{x:11,y:7}],t.SETTINGS=a,(i=t.SCREEN_ORIENTATION||(t.SCREEN_ORIENTATION={}))[i.LANDSCAPE=0]="LANDSCAPE",i[i.PORTRAIT=1]="PORTRAIT",(i=t.GAME_END||(t.GAME_END={}))[i.WIN=0]="WIN",i[i.LOSE=1]="LOSE",(i=t.GAME_MODE||(t.GAME_MODE={}))[i.ARCADE=0]="ARCADE",i[i.BATTLE_ROYALE=1]="BATTLE_ROYALE",i[i.NEW_PACMAN=2]="NEW_PACMAN",i[i.STAR_COLLECTOR=3]="STAR_COLLECTOR",i[i.ICE_MAN=4]="ICE_MAN",(i=t.PLAYER_MODE||(t.PLAYER_MODE={}))[i.SINGLE_PLAYER=0]="SINGLE_PLAYER",i[i.MULTI_PLAYER=1]="MULTI_PLAYER",(i=t.DIFFICULTY||(t.DIFFICULTY={}))[i.EASY=0]="EASY",i[i.NORMAL=1]="NORMAL",i[i.HARD=2]="HARD",(i=t.DIRECTION||(t.DIRECTION={}))[i.ALL=0]="ALL",i[i.UP=1]="UP",i[i.UP_LEFT=2]="UP_LEFT",i[i.UP_RIGHT=3]="UP_RIGHT",i[i.LEFT=4]="LEFT",i[i.RIGHT=5]="RIGHT",i[i.DOWN_RIGHT=6]="DOWN_RIGHT",i[i.DOWN_LEFT=7]="DOWN_LEFT",i[i.DOWN=8]="DOWN",(i=t.MAP||(t.MAP={}))[i.FREE=0]="FREE",i[i.WALL=1]="WALL",i[i.TOTEM=2]="TOTEM",i[i.BLOCK=3]="BLOCK",i[i.BOMB=4]="BOMB",i[i.FIRE=5]="FIRE",i[i.ITEM=6]="ITEM",i[i.SPECIAL_TILE=7]="SPECIAL_TILE",i[i.COIN=8]="COIN",i[i.JELLY=9]="JELLY",i[i.STAR=10]="STAR",(i=t.MAP_THEME||(t.MAP_THEME={}))[i.CHRISTMAS=0]="CHRISTMAS",i[i.CLASSROOM=1]="CLASSROOM",i[i.BOUTIQUE=2]="BOUTIQUE",i[i.FOREST=3]="FOREST",i[i.BEACH=4]="BEACH",i[i.RANCH=5]="RANCH",i[i.TOY_STORE=6]="TOY_STORE",i[i.BAKERY=7]="BAKERY",i[i.RACE_TRACK=8]="RACE_TRACK",i[i.RANDOM=9]="RANDOM",(i=t.GRID_DATA||(t.GRID_DATA={}))[i.FREE=0]="FREE",i[i.WALL=1]="WALL",i[i.TOTEM=2]="TOTEM",i[i.PLAYER=3]="PLAYER",i[i.SPECIAL_TILE=4]="SPECIAL_TILE",i[i.RACE_TRACK=5]="RACE_TRACK",i[i.JELLY=6]="JELLY",i[i.FORCE_FREE_CELL=7]="FORCE_FREE_CELL",i[i.LANDING_CELL=8]="LANDING_CELL",(i=t.ITEM_TYPE||(t.ITEM_TYPE={}))[i.BOMB=0]="BOMB",i[i.POWER=1]="POWER",i[i.SPEED=2]="SPEED",i[i.KICK_BOMBS=3]="KICK_BOMBS",i[i.SHIELD=4]="SHIELD",i[i.HEART=5]="HEART",i[i.INVINCIBILITY=6]="INVINCIBILITY",i[i.DOLL_BOMB=7]="DOLL_BOMB",i[i.FLAMETHROWER=8]="FLAMETHROWER",i[i.LIGHTING_GUN=9]="LIGHTING_GUN",i[i.HAMMER=10]="HAMMER",i[i.LASER_GUN=11]="LASER_GUN",i[i.ICE_GUN=12]="ICE_GUN",i[i.MIGHTY_HAMMER=13]="MIGHTY_HAMMER",i[i.HORSE=14]="HORSE",i[i.STAG=15]="STAG",i[i.SHOPPING_CART=16]="SHOPPING_CART",i[i.SKATEBOARD=17]="SKATEBOARD",(i=t.POWER_UP_TYPE||(t.POWER_UP_TYPE={}))[i.POWER_UP=0]="POWER_UP",i[i.WEAPON=1]="WEAPON",i[i.MOUNT=2]="MOUNT",(i=t.GAME_STATUS||(t.GAME_STATUS={}))[i.PLAYING=0]="PLAYING",i[i.PAUSED=1]="PAUSED",i[i.GAME_OVER=2]="GAME_OVER",i[i.TUTORIAL=3]="TUTORIAL",i[i.ROTATE_DEVICE=4]="ROTATE_DEVICE",(i=t.PLAYER_STATE||(t.PLAYER_STATE={}))[i.DEATH=0]="DEATH",i[i.DIZZY_BACK=1]="DIZZY_BACK",i[i.DIZZY_FRONT=2]="DIZZY_FRONT",i[i.DIZZY_SIDE=3]="DIZZY_SIDE",i[i.FACE1_FRONT=4]="FACE1_FRONT",i[i.FACE1_SIDE=5]="FACE1_SIDE",i[i.FACE2_FRONT=6]="FACE2_FRONT",i[i.FACE2_SIDE=7]="FACE2_SIDE",i[i.HORSE_BACK=8]="HORSE_BACK",i[i.HORSE_FRONT=9]="HORSE_FRONT",i[i.HORSE_SIDE=10]="HORSE_SIDE",i[i.HORSE_BACK_STAND=11]="HORSE_BACK_STAND",i[i.HORSE_FRONT_STAND=12]="HORSE_FRONT_STAND",i[i.HORSE_SIDE_STAND=13]="HORSE_SIDE_STAND",i[i.SKATE_FRONT=14]="SKATE_FRONT",i[i.SKATE_SIDE=15]="SKATE_SIDE",i[i.SKATE_BACK=16]="SKATE_BACK",i[i.SKATE_FRONT_STAND=17]="SKATE_FRONT_STAND",i[i.SKATE_SIDE_STAND=18]="SKATE_SIDE_STAND",i[i.SKATE_BACK_STAND=19]="SKATE_BACK_STAND",i[i.SHOPPING_CART_BACK=20]="SHOPPING_CART_BACK",i[i.SHOPPING_CART_SIDE=21]="SHOPPING_CART_SIDE",i[i.SHOPPING_CART_FRONT=22]="SHOPPING_CART_FRONT",i[i.SHOPPING_CART_BACK_STAND=23]="SHOPPING_CART_BACK_STAND",i[i.SHOPPING_CART_SIDE_STAND=24]="SHOPPING_CART_SIDE_STAND",i[i.SHOPPING_CART_FRONT_STAND=25]="SHOPPING_CART_FRONT_STAND",i[i.STAG_BACK=26]="STAG_BACK",i[i.STAG_FRONT=27]="STAG_FRONT",i[i.STAG_SIDE=28]="STAG_SIDE",i[i.STAG_BACK_STAND=29]="STAG_BACK_STAND",i[i.STAG_FRONT_STAND=30]="STAG_FRONT_STAND",i[i.STAG_SIDE_STAND=31]="STAG_SIDE_STAND",i[i.WALK_BACK=32]="WALK_BACK",i[i.WALK_FRONT=33]="WALK_FRONT",i[i.WALK_SIDE=34]="WALK_SIDE",i[i.STAND_FRONT=35]="STAND_FRONT",i[i.STAND_BACK=36]="STAND_BACK",i[i.STAND_SIDE=37]="STAND_SIDE",(i=t.MONSTER_STATE||(t.MONSTER_STATE={}))[i.STAND_FRONT=0]="STAND_FRONT",i[i.STAND_BACK=1]="STAND_BACK",i[i.STAND_LEFT=2]="STAND_LEFT",i[i.STAND_RIGHT=3]="STAND_RIGHT",i[i.FROZEN_FRONT=4]="FROZEN_FRONT",i[i.FROZEN_BACK=5]="FROZEN_BACK",i[i.FROZEN_LEFT=6]="FROZEN_LEFT",i[i.FROZEN_RIGHT=7]="FROZEN_RIGHT",i[i.UNFROZEN_FRONT=8]="UNFROZEN_FRONT",i[i.UNFROZEN_BACK=9]="UNFROZEN_BACK",i[i.UNFROZEN_LEFT=10]="UNFROZEN_LEFT",i[i.UNFROZEN_RIGHT=11]="UNFROZEN_RIGHT",(i=t.HORSE_STATE||(t.HORSE_STATE={}))[i.BACK_JUMP=0]="BACK_JUMP",i[i.FRONT_JUMP=1]="FRONT_JUMP",i[i.LEFT_JUMP=2]="LEFT_JUMP",i[i.RIGHT_JUMP=3]="RIGHT_JUMP",i[i.WALK_BACK=4]="WALK_BACK",i[i.WALK_FRONT=5]="WALK_FRONT",i[i.WALK_LEFT=6]="WALK_LEFT",i[i.WALK_RIGHT=7]="WALK_RIGHT",i[i.STAND_FRONT=8]="STAND_FRONT",i[i.STAND_BACK=9]="STAND_BACK",i[i.STAND_LEFT=10]="STAND_LEFT",i[i.STAND_RIGHT=11]="STAND_RIGHT",(i=t.STAG_STATE||(t.STAG_STATE={}))[i.BACK_ATTACK=0]="BACK_ATTACK",i[i.BACK_WALK=1]="BACK_WALK",i[i.FRONT_ATTACK=2]="FRONT_ATTACK",i[i.FRONT_WALK=3]="FRONT_WALK",i[i.SIDE_ATTACK_LEFT=4]="SIDE_ATTACK_LEFT",i[i.SIDE_ATTACK_RIGHT=5]="SIDE_ATTACK_RIGHT",i[i.SIDE_WALK_LEFT=6]="SIDE_WALK_LEFT",i[i.SIDE_WALK_RIGHT=7]="SIDE_WALK_RIGHT",i[i.STAND_FRONT=8]="STAND_FRONT",i[i.STAND_BACK=9]="STAND_BACK",i[i.STAND_LEFT=10]="STAND_LEFT",i[i.STAND_RIGHT=11]="STAND_RIGHT",(i=t.MOUNT_STATE||(t.MOUNT_STATE={}))[i.BACK=0]="BACK",i[i.SIDE=1]="SIDE",i[i.FRONT=2]="FRONT",i[i.BACK_STAND=3]="BACK_STAND",i[i.FRONT_STAND=4]="FRONT_STAND",i[i.SIDE_STAND=5]="SIDE_STAND",(i=t.MISSION||(t.MISSION={}))[i.PLAY_ALL_MODES=0]="PLAY_ALL_MODES",i[i.UNLOCK_OUTFIT_FOR_EVERY_ROBOT=1]="UNLOCK_OUTFIT_FOR_EVERY_ROBOT",i[i.FREEZE_5_IN_10_SECONDS=2]="FREEZE_5_IN_10_SECONDS",i[i.FREEZE_12_IN_10_SECONDS=3]="FREEZE_12_IN_10_SECONDS",i[i.FREEZE_25_MONSTERS=4]="FREEZE_25_MONSTERS",i[i.FREEZE_50_MONSTERS_IN_FOREST=5]="FREEZE_50_MONSTERS_IN_FOREST",i[i.FREEZE_100_MONSTERS=6]="FREEZE_100_MONSTERS",i[i.AVOID_CLAWS_TOYSHOP_ARENA=7]="AVOID_CLAWS_TOYSHOP_ARENA",i[i.AVOID_CLAWS_3_CONTINUOUS_LEVELS=8]="AVOID_CLAWS_3_CONTINUOUS_LEVELS",i[i.AVOID_CARS_RACE_ARENA=9]="AVOID_CARS_RACE_ARENA",i[i.AVOID_HORSES_ARENA_1_LEVEL=10]="AVOID_HORSES_ARENA_1_LEVEL",i[i.AVOID_HORSES_BATTLE_ROYALE_1_LEVEL=11]="AVOID_HORSES_BATTLE_ROYALE_1_LEVEL",i[i.AVOID_CARS_3_LEVELS=12]="AVOID_CARS_3_LEVELS",i[i.AVOID_CARS_5_LEVELS=13]="AVOID_CARS_5_LEVELS",i[i.CLEAR_LEVEL_STAR_COLLECTOR_120_SECONDS=14]="CLEAR_LEVEL_STAR_COLLECTOR_120_SECONDS",i[i.CLEAR_ARCADE=15]="CLEAR_ARCADE",i[i.CLEAR_PACMAN_PURPLE_ROBOT=16]="CLEAR_PACMAN_PURPLE_ROBOT",i[i.CLEAR_STAR_COLLECTOR_BLACK_ROBOT=17]="CLEAR_STAR_COLLECTOR_BLACK_ROBOT",i[i.CLEAR_LEVEL_BATTLE_ROYALE_120_SECONDS=18]="CLEAR_LEVEL_BATTLE_ROYALE_120_SECONDS",i[i.CLEAR_LEVEL_ANY_WEAPON=19]="CLEAR_LEVEL_ANY_WEAPON",i[i.CLEAR_BATTLE_ROYALE_10_LEVELS=20]="CLEAR_BATTLE_ROYALE_10_LEVELS",i[i.CLEAR_FROZEN_MODE_IN_RACE_ARENA=21]="CLEAR_FROZEN_MODE_IN_RACE_ARENA",i[i.CLEAR_LEVEL_IN_PACMAN_IN_120_SECONDS=22]="CLEAR_LEVEL_IN_PACMAN_IN_120_SECONDS",i[i.CLEAR_PACMAN_IN_NORMAL=23]="CLEAR_PACMAN_IN_NORMAL",i[i.CLEAR_STAR_COLLECTOR_IN_FOREST=24]="CLEAR_STAR_COLLECTOR_IN_FOREST",i[i.CLEAR_LEVEL_ARCADE_IN_120_SECONDS=25]="CLEAR_LEVEL_ARCADE_IN_120_SECONDS",i[i.CLEAR_ARCADE_WITH_3_LIVES_LEFT=26]="CLEAR_ARCADE_WITH_3_LIVES_LEFT",i[i.CLEAR_BATTLE_ROYALE_IN_RANCH=27]="CLEAR_BATTLE_ROYALE_IN_RANCH",i[i.CLEAR_FROZEN_WITH_20_LEVELS=28]="CLEAR_FROZEN_WITH_20_LEVELS",i[i.CLEAR_LEVEL_IN_120_SECONDS_IN_FROZEN=29]="CLEAR_LEVEL_IN_120_SECONDS_IN_FROZEN",i[i.CLEAR_ARCADE_5_TIMES=30]="CLEAR_ARCADE_5_TIMES",i[i.CLEAR_ARCADE_5_TIMES_IN_FOREST=31]="CLEAR_ARCADE_5_TIMES_IN_FOREST",i[i.GET_20_COINS_IN_10_SECONDS=32]="GET_20_COINS_IN_10_SECONDS",i[i.GET_40_COINS_IN_10_SECONDS=33]="GET_40_COINS_IN_10_SECONDS",i[i.GET_5000_POINTS=34]="GET_5000_POINTS",i[i.GET_5_SPEEDUPS_PROPS_IN_1_LEVEL=35]="GET_5_SPEEDUPS_PROPS_IN_1_LEVEL",i[i.GET_5_SPEEDUPS_PROPS_IN_LEVEL_IN_ARCADE=36]="GET_5_SPEEDUPS_PROPS_IN_LEVEL_IN_ARCADE",i[i.GET_30000_POINTS=37]="GET_30000_POINTS",i[i.GET_100_PROPS=38]="GET_100_PROPS",i[i.GET_10_FLAMETHROWERS=39]="GET_10_FLAMETHROWERS",i[i.GET_15_POWER_BLASTS=40]="GET_15_POWER_BLASTS",i[i.GET_200_PROPS=41]="GET_200_PROPS",i[i.GET_20_INVINCIBILITY=42]="GET_20_INVINCIBILITY",i[i.GET_25_SPEEDUPS=43]="GET_25_SPEEDUPS",i[i.DESTROY_20_BLOCKS_1_LEVEL=44]="DESTROY_20_BLOCKS_1_LEVEL",i[i.DESTROY_15_BLOCKS_WHEN_RIDING_WAPITI_1_LEVEL=45]="DESTROY_15_BLOCKS_WHEN_RIDING_WAPITI_1_LEVEL",i[i.DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL=46]="DESTROY_20_BLOCKS_IN_ARCADE_MODE_1_LEVEL",i[i.DESTROY_15_BLOCKS_WHEN_RIDING_WAPITI_IN_ARCADE_MODE_1_LEVEL=47]="DESTROY_15_BLOCKS_WHEN_RIDING_WAPITI_IN_ARCADE_MODE_1_LEVEL",i[i.DESTROY_30_BLOCKS=48]="DESTROY_30_BLOCKS",i[i.DESTROY_120_BLOCKS_IN_ARCADE=49]="DESTROY_120_BLOCKS_IN_ARCADE",i[i.KILL_ENEMY_USING_INVINCIBILITY=50]="KILL_ENEMY_USING_INVINCIBILITY",i[i.KILL_2_ENEMIES_IN_10_SECONDS=51]="KILL_2_ENEMIES_IN_10_SECONDS",i[i.KILL_AN_ENEMY_WITH_1_OR_MORE_STARS=52]="KILL_AN_ENEMY_WITH_1_OR_MORE_STARS",i[i.KILL_AN_ENEMY_WITH_3_OR_MORE_STARS=53]="KILL_AN_ENEMY_WITH_3_OR_MORE_STARS",i[i.KILL_4_ENEMIES_IN_10_SECONDS=54]="KILL_4_ENEMIES_IN_10_SECONDS",i[i.KILL_10_ENEMIES_USING_BOMBS=55]="KILL_10_ENEMIES_USING_BOMBS",i[i.KILL_30_ENEMIES_USING_BOMBS=56]="KILL_30_ENEMIES_USING_BOMBS",i[i.KILL_50_ENEMIES_USING_BOMBS=57]="KILL_50_ENEMIES_USING_BOMBS",i[i.USE_ANGRY_HAMMER_3_TIMES_IN_LEVEL=58]="USE_ANGRY_HAMMER_3_TIMES_IN_LEVEL",i[i.USE_INVINCIBILITY_3_TIMES_IN_LEVEL=59]="USE_INVINCIBILITY_3_TIMES_IN_LEVEL",i[i.USE_4_TYPE_OF_WEAPONS_IN_LEVEL=60]="USE_4_TYPE_OF_WEAPONS_IN_LEVEL",i[i.USE_LIGHTNING_GUN_3_TIMES_IN_1_LEVEL_IN_ARCADE=61]="USE_LIGHTNING_GUN_3_TIMES_IN_1_LEVEL_IN_ARCADE",i[i.USE_INVINCIBILITY_TO_KILL_4_ENEMIES_IN_1_LEVEL=62]="USE_INVINCIBILITY_TO_KILL_4_ENEMIES_IN_1_LEVEL",i[i.USE_4_TYPES_OF_WEAPONS_IN_1_LEVEL_IN_ARCADE=63]="USE_4_TYPES_OF_WEAPONS_IN_1_LEVEL_IN_ARCADE",i[i.USE_DOLL_BOMB_3_TIMES_IN_1_LEVEL=64]="USE_DOLL_BOMB_3_TIMES_IN_1_LEVEL",i[i.USE_DOLL_BOMB_5_TIMES=65]="USE_DOLL_BOMB_5_TIMES",i[i.USE_ALL_THE_WEAPONS=66]="USE_ALL_THE_WEAPONS",i[i.UNLOCK_1_OUTFIT=67]="UNLOCK_1_OUTFIT",i[i.WIN_CONTINUOUSLY_IN_3_LEVELS=68]="WIN_CONTINUOUSLY_IN_3_LEVELS",i[i.WIN_CONTINUOUSLY_3_LEVELS_IN_FROZEN=69]="WIN_CONTINUOUSLY_3_LEVELS_IN_FROZEN",i[i.WIN_CONTINUOUSLY_IN_3_LEVELS_IN_PACMAN=70]="WIN_CONTINUOUSLY_IN_3_LEVELS_IN_PACMAN",i[i.COLLECT_20_STARS=71]="COLLECT_20_STARS",i[i.COLLECT_20_STARS_IN_RACE_ARENA=72]="COLLECT_20_STARS_IN_RACE_ARENA",i[i.COLLECT_600_COINS=73]="COLLECT_600_COINS",i[i.COLLECT_60_STARS_IN_RANCH_ARENA=74]="COLLECT_60_STARS_IN_RANCH_ARENA",i[i.COLLECT_1500_COINS=75]="COLLECT_1500_COINS",i[i.JUMP_BY_HAMMOCK_2_TIMES=76]="JUMP_BY_HAMMOCK_2_TIMES",i[i.JUMP_BY_HAMMOCK_10_TIMES=77]="JUMP_BY_HAMMOCK_10_TIMES",i[i.JUMP_BY_RIDING_A_HORSE_10_TIMES=78]="JUMP_BY_RIDING_A_HORSE_10_TIMES",i[i.JUMP_BY_RIDING_A_HORSE_20_TIMES=79]="JUMP_BY_RIDING_A_HORSE_20_TIMES",i[i.ATTACK_4_ENEMIES=80]="ATTACK_4_ENEMIES",i[i.ATTACK_10_ENEMIES=81]="ATTACK_10_ENEMIES",i[i.ATTACK_34_ENEMIES=82]="ATTACK_34_ENEMIES",i[i.CLICK_GAME_LINKS_IN_THIS_GAME=83]="CLICK_GAME_LINKS_IN_THIS_GAME",i[i.RIDE_2_KINDS_OF_VEHICLES_IN_1_LEVEL=84]="RIDE_2_KINDS_OF_VEHICLES_IN_1_LEVEL",i[i.TRANSFER_BY_TREE_HOLES_10_TIMES_IN_1_LEVEL=85]="TRANSFER_BY_TREE_HOLES_10_TIMES_IN_1_LEVEL",i[i.TRANSFER_BY_TREE_HOLES_20_TIMES_IN_1_LEVEL=86]="TRANSFER_BY_TREE_HOLES_20_TIMES_IN_1_LEVEL",i[i.TRANSFER_BY_TREE_HOLES_6_TIMES=87]="TRANSFER_BY_TREE_HOLES_6_TIMES",i[i.TRANSFER_BY_TREE_HOLES_46_TIMES=88]="TRANSFER_BY_TREE_HOLES_46_TIMES",i[i.FIGHT_IN_ALL_ARENAS_IN_ARCADE_MODE=89]="FIGHT_IN_ALL_ARENAS_IN_ARCADE_MODE",i[i.FIGHT_IN_ALL_ARENAS_IN_BATTLE_ROYALE_MODE=90]="FIGHT_IN_ALL_ARENAS_IN_BATTLE_ROYALE_MODE",i[i.FIGHT_IN_ALL_ARENAS_IN_STAR_BATTLE_MODE=91]="FIGHT_IN_ALL_ARENAS_IN_STAR_BATTLE_MODE",i[i.FIGHT_IN_ALL_ARENAS_IN_PACMAN_MODE=92]="FIGHT_IN_ALL_ARENAS_IN_PACMAN_MODE",i[i.FIGHT_IN_ALL_ARENAS_IN_FREEZE_MODE=93]="FIGHT_IN_ALL_ARENAS_IN_FREEZE_MODE"}(Game=Game||{}),function(t){e=Phaser.Game,__extends(s,e),s.prototype.statePreloader=function(){var i=this;libs.forEach(function(t){i.load.script(t,t)})},s.prototype.stateCreator=function(){this.state.add("bootState",t.BootState,!1),this.state.add("preloaderState",t.PreloaderState,!1),this.state.add("mainMenuState",t.MainMenuState,!1),this.state.add("characterSelectState",t.CharacterSelectState,!1),this.state.add("gameplayState",t.GameplayState,!1),this.state.add("gameOverState",t.GameOverState,!1),this.plugins.add(PhaserSpine.SpinePlugin),this.plugins.add(PhaserCachebuster.CacheBuster),this.plugins.add(PhaserSpine.SpinePlugin),this.plugins.add(PhaserSuperStorage.StoragePlugin),this.plugins.add(Ph2.NotificationPlugin),this.plugins.add(Ph2.AudioPlugin),this.plugins.add(Ph2.AnimationPlugin),this.plugins.add(Ph2.LoaderPlugin),this.plugins.add(Phaser.VirtualJoystick),this.state.start("bootState"),this.state.remove("pre-game")},s.forceCanvas=function(){var t=["Mali-400","Mali-450"],i=document.createElement("canvas"),i=(i.setAttribute("width","1"),i.setAttribute("height","1"),document.body.appendChild(i),document.getElementsByTagName("canvas")),e=i[0].getContext("webgl",{stencil:!0});if(i[0].parentNode.removeChild(i[0]),e){i=e.getExtension("WEBGL_debug_renderer_info");if(null!=i)for(var s=e.getParameter(i.UNMASKED_RENDERER_WEBGL),a=0;a<t.length;a++)if(-1!==s.search(t[a]))return!0}return!1},s.getInstance=function(){return s.instance=null===s.instance?new s:s.instance},s.instance=null;var e,i=s;function s(){var i=this,t=navigator.userAgent,t=/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)||s.forceCanvas()?Phaser.CANVAS:Phaser.AUTO,i=e.call(this,{enableDebug:!1,width:Constants.GAME_WIDTH,height:Constants.GAME_HEIGHT,renderer:t,parent:"content",transparent:!1,antialias:!0,preserveDrawingBuffer:!1,physicsConfig:null,seed:"",state:null,forceSetTimeOut:!1})||this;return Phaser.Device.whenReady(function(){i.stage.disableVisibilityChange=!0;var t=i.device.desktop?"click":"touchstart";document.getElementById("content").addEventListener(t,function(t){i.gameResumed(t)})}),AzerionIntegration.SDK.createSplashLoader(i,function(){i.state.add("pre-game",{create:i.stateCreator.bind(i),preload:i.statePreloader.bind(i)},!0)}),i}t.App=i}(Game=Game||{}),function(r){(t=i=i||{}).PAUSED="Paused",t.RESUMED="Resumed",e.getInstance=function(t){return e.instance=e.instance?e.instance:new e(t)},e.prototype.init=function(t){this.game=t;t=window._azerionIntegration.advType;this.azAdWrapper=new window.h5ads.AdWrapper(t,Constants.GAMEDISTRIBUTION_ID),this.addListeners()},e.prototype.addListeners=function(){var t=this;this.azAdWrapper.on(h5ads.AdEvents.CONTENT_PAUSED,function(){r.PauseHandler.getInstance(t.game).pause(),t.contentStatus=i.PAUSED}),this.azAdWrapper.on(h5ads.AdEvents.CONTENT_RESUMED,function(){t.contentStatus=i.RESUMED,r.PauseHandler.getInstance(t.game).resume()})},e.prototype.showAd=function(t,i,e,s){function a(){r.LoaderHelper.hide(),i&&i.call(n),n.azAdWrapper.removeListener(h5ads.AdEvents.CONTENT_RESUMED,a)}var n=this,o=(void 0===s&&(s=!0),function(){r.LoaderHelper.hide(),e&&e.call(n),n.azAdWrapper.removeListener(h5ads.AdEvents.CONTENT_PAUSED,o)});this.azAdWrapper.on(h5ads.AdEvents.CONTENT_RESUMED,a),this.azAdWrapper.on(h5ads.AdEvents.CONTENT_PAUSED,o),this.azAdWrapper.showAd(h5ads.AdType.interstitial)},e.prototype.showRewardedAd=function(t,i,e){var s=this,a=!1,n=function(){r.LoaderHelper.hide(),a?i&&i.call(s):e&&e.call(s),s.azAdWrapper.removeListener(h5ads.AdEvents.CONTENT_RESUMED,n),s.azAdWrapper.preloadAd(h5ads.AdType.rewarded),s.azAdWrapper.removeAllListeners(h5ads.AdEvents.AD_REWARDED)};this.azAdWrapper.addListener(h5ads.AdEvents.AD_REWARDED,function(){a=!0}),this.azAdWrapper.on(h5ads.AdEvents.CONTENT_RESUMED,n),this.azAdWrapper.showAd(h5ads.AdType.rewarded)},e.prototype.isAdPlaying=function(){return this.contentStatus===i.PAUSED},e.prototype.preloadAd=function(t){this.azAdWrapper.preloadAd(t)};var i,t=e;function e(t){this.contentStatus=i.RESUMED,this.game=t}r.AdHandler=t}(Fabrique=Fabrique||{}),function(t){function i(){}i.onLoadProgress=function(t){h5branding.SplashLoader.getInstance().setLoadProgress(t)},i.onLoadComplete=function(t){h5branding.SplashLoader.getInstance().setLoadProgress(100),t&&t()},i.addListeners=function(t){Fabrique.PauseHandler.getInstance(t).init(),Fabrique.AdHandler.getInstance().init(t)},i.createSplashLoader=function(t,i){var e;null!=(e=window._azerionIntegration)&&e.sa&&(h5branding.Utils.ASSET_LOCATION="assets/"),h5branding.SplashLoader.getInstance({gameId:Constants.GAMEDISTRIBUTION_ID,gameName:Constants.GAME_TITLE,gameTitle:Constants.GAME_TITLE,libs:[],version:version}).create().then(function(){i&&i()}).catch(function(t){})},i.removeSplashLoader=function(t){h5branding.SplashLoader.getInstance().setButtonCallback(function(){h5branding.SplashLoader.getInstance().destroy(),Fabrique.AdHandler.getInstance().preloadAd(h5ads.AdType.rewarded),i.showInterstitialAd("splash_load_complete",function(){t()})})},i.showInterstitialAd=function(t,i){Fabrique.AdHandler.getInstance().showAd(t,function(){i()})},i.showRewardedAd=function(t,i,e){Fabrique.AdHandler.getInstance().showRewardedAd(t,i,e)},i.isOnDevice=function(){return null===h5branding||void 0===h5branding?void 0:h5branding.Utils.isOnDevice()},i.outGoingLinksAllowed=function(){return h5branding.Branding.outGoingLinksAllowed()},i.hideSponsorLogo=function(){return h5branding.Utils.getBrandingDomain()===h5branding.BrandingDomain.Neutral},t.SDK=i}(AzerionIntegration=AzerionIntegration||{}),function(t){function i(){}i.show=function(){var t=document.getElementById("loader");t&&(t.style.display="block")},i.hide=function(){var t=document.getElementById("loader");t&&(t.style.display="none")},t.LoaderHelper=i}(Fabrique=Fabrique||{}),function(t){function i(t){this.game=t,this.focused=!1}i.getInstance=function(t){return i.instance=i.instance?i.instance:new i(t)},i.prototype.init=function(){var t=this;this.game.stage.disableVisibilityChange=!0,this.onPauseCallback=new Phaser.Signal,this.onResumeCallback=new Phaser.Signal,h5branding.Utils.isOnDevice()&&(document.addEventListener("pause",function(){return t.onPause()}),document.addEventListener("resume",function(){return t.onResume()})),this.game.onBlur.add(this.onBlur,this),this.game.onFocus.add(this.onFocus,this),this.game.onPause.add(this.onPause,this),this.game.onResume.add(this.onResume,this)},i.prototype.onBlur=function(){this.focused=!1,this.game.onPause.dispatch()},i.prototype.onFocus=function(){this.focused=!0,t.AdHandler.getInstance().isAdPlaying()||this.game.onResume.dispatch()},i.prototype.onPause=function(){this.game.sound.setMute(),this.onPauseCallback&&this.onPauseCallback.dispatch()},i.prototype.onResume=function(){this.game.sound.unsetMute(),this.onResumeCallback&&this.onResumeCallback.dispatch()},i.prototype.pause=function(){this.game&&this.game.onPause&&this.game.onPause.dispatch()},i.prototype.resume=function(){this.hasFocus&&this.game&&this.game.onResume&&this.game.onResume.dispatch()},Object.defineProperty(i.prototype,"hasFocus",{get:function(){return this.focused},enumerable:!1,configurable:!0}),t.PauseHandler=i}(Fabrique=Fabrique||{}),function(t){s=t.MapCenter,__extends(e,s),e.prototype.createCenter=function(){this.animationCenter=this.game.add.ph2AnimationObject(this.gridCell.centerX,this.gridCell.centerY,"center_polar_region","atlas_center"),this.animationCenter.ph2Animations.play("polar_region_stand",1,!0),this.add(this.animationCenter)};var s,i=e;function e(t,i,e){t=s.call(this,t,i,e)||this;return t.createCenter(),t}t.Survival=i}(Game=Game||{});