(function(){var e={16977:function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),a=i.length,s=a>>2,r=new Uint8Array(a),o=new Uint32Array(r.buffer,0,s),c=0,h=0;c<s;c++)o[c]=i.charCodeAt(h++)|i.charCodeAt(h++)<<8|i.charCodeAt(h++)<<16|i.charCodeAt(h++)<<24;for(var l=3&a;l--;)r[h]=i.charCodeAt(h++);e(new Blob([r],{type:t||"image/png"}))}})},61154:function(e,t,n){"use strict";n.d(t,{J:function(){return g}});var i=n(33938),a=n(58118),s=n.n(a),r=n(35627),o=n.n(r),c=n(30222),h=n.n(c),l=n(71944),u=n(46352),p=n(39482),d=GameCore.Configs.Notification,f=d.GameTitle,m=d.GameImage,g=function(){function e(){}var t=e.prototype;return t.createAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.createAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.joinAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.joinAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postScoreAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.postScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getTournamentsAsync=function(){var e=(0,i.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.getTournamentsAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),v=function(){function e(e){var t=this;this.facebook=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.requestTournamentAsync=function(){var e=(0,i.Z)(h().mark((function e(n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.facebook.getTournamentAsync();case 3:return e.next=5,t.facebook.tournament.shareAsync({score:n});case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),i=GameSDK.player.getName(),e.next=12,t.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.facebook=e}var t=e.prototype;return t.switchAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return e.next=4,GameSDK.context.switchAsync(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.chooseAsync=function(){var e=(0,i.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return e.abrupt("return",GameSDK.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),t.createAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,GameSDK.context.createAsync(""+t);case 5:case 15:return e.abrupt("return",GameSDK.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),t.getPlayerToken=function(){var e=(0,i.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.player.getSignedPlayerInfoAsync();case 2:return t=e.sent,e.abrupt("return",t.getSignature());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getContextPlayers=function(){var e=(0,i.Z)(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.context.getPlayersAsync();case 3:return n=e.sent,i=[],n.forEach((function(e){var n=e.getID();if(n!==t){var a=e.getName();if(a){var s=e.getPhoto();i.push(new u.Z(n,a,s).toObject())}}})),e.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendMessage=function(){var e=(0,i.Z)(h().mark((function e(t){var n,i,a,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,i=t.image,a=t.template,s=t.cta,r=t.text,o={data:n,image:i,action:"CUSTOM",template:a,cta:s,text:r,strategy:"IMMEDIATE",notification:"PUSH"},e.next=4,GameSDK.updateAsync(o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.inviteAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.inviteAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postSessionScoreAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.postSessionScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getRewardedVideoAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getRewardedVideoAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getInterstitialAdAsync=function(){var e=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getInterstitialAdAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getContextID=function(){return GameSDK.context.getID()},t.attemptToAddShortcut=function(){var e=(0,i.Z)(h().mark((function e(){var t,n,i,a,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isCalledCreateShortcut){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,"ANDROID"!==GameSDK.getPlatform()){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,GameSDK.player.getDataAsync(["lastCallCreateShortcut"]);case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0={};case 11:if(n=e.t0,!(i=n.lastCallCreateShortcut)||!(0,p.Gm)(+i)){e.next=15;break}return e.abrupt("return",!1);case 15:if(a=Date.now(),GameSDK.player.setDataAsync({lastCallCreateShortcut:a}),s()(t=GameSDK.getSupportedAPIs()).call(t,"canCreateShortcutAsync")){e.next=20;break}return e.abrupt("return",!1);case 20:return e.next=22,GameSDK.canCreateShortcutAsync();case 22:if(!e.sent){e.next=40;break}return r=l._.SHORTCUT_CREATE,o=l._.SHORTCUT_CREATE_POPUP,this.isCalledCreateShortcut=!0,window.game.analytics.event(o),e.prev=27,e.next=30,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 30:return e.next=32,GameSDK.createShortcutAsync();case 32:return window.game.analytics.event(r,{success:!0}),e.abrupt("return",!0);case 36:return e.prev=36,e.t1=e.catch(27),window.game.analytics.event(r,{success:!1}),e.abrupt("return",!1);case 40:return e.abrupt("return",!1);case 43:return e.prev=43,e.t2=e.catch(2),e.abrupt("return",!1);case 46:case"end":return e.stop()}}),e,this,[[2,43],[27,36]])})));return function(){return e.apply(this,arguments)}}(),t.attemptToSubscribeBot=function(){var e=(0,i.Z)(h().mark((function e(){var t,n,i,a,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isCalledSubscribeBot){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,s()(t=GameSDK.getSupportedAPIs()).call(t,"player.canSubscribeBotAsync")){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,GameSDK.player.canSubscribeBotAsync();case 8:if(!e.sent){e.next=37;break}return e.next=12,GameSDK.player.getDataAsync(["lastCallSubscribeBot"]);case 12:if(e.t0=e.sent,e.t0){e.next=15;break}e.t0={};case 15:if(n=e.t0,!(i=n.lastCallSubscribeBot)||!(0,p.Gm)(+i)){e.next=19;break}return e.abrupt("return",!1);case 19:return a=Date.now(),GameSDK.player.setDataAsync({lastCallSubscribeBot:a}),r=l._.BOT_SUBSCRIBE,o=l._.BOT_SUBSCRIBE_POPUP,this.isCalledSubscribeBot=!0,window.game.analytics.event(o),e.prev=24,e.next=27,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 27:return e.next=29,GameSDK.player.subscribeBotAsync();case 29:return window.game.analytics.event(r,{success:!0}),e.abrupt("return",!0);case 33:return e.prev=33,e.t1=e.catch(24),window.game.analytics.event(r,{success:!1}),e.abrupt("return",!1);case 37:return e.abrupt("return",!1);case 40:return e.prev=40,e.t2=e.catch(2),e.abrupt("return",!1);case 43:case"end":return e.stop()}}),e,this,[[2,40],[24,33]])})));return function(){return e.apply(this,arguments)}}(),t.matchPlayerAsync=function(){var e=(0,i.Z)(h().mark((function e(t,n,i){var a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s()(a=GameSDK.getSupportedAPIs()).call(a,"checkCanPlayerMatchAsync")){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,GameSDK.checkCanPlayerMatchAsync();case 6:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,GameSDK.matchPlayerAsync(t,n,i);case 11:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n,i){return e.apply(this,arguments)}}(),t.setLoadingProgress=function(e){GameSDK.setLoadingProgress(e)},t.getLocale=function(){return GameSDK.getLocale()||"en"},t.injectTournament=function(){var e=(0,i.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameCore.Configs.Tournament.UseMock){e.next=8;break}return e.next=4,n.e(357).then(n.bind(n,19357));case 4:t=e.sent.default,this.facebook.tournament=new t,e.next=9;break;case 8:this.facebook.tournament=new g;case 9:this.facebook.getTournamentAsync=this.getTournamentAsync,this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getTournamentAsync=function(){var e=(0,i.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getTournamentAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.sendNotificationAsync=function(){var e=(0,i.Z)(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.message,i=t.delayTime,e.next=5,FBInstant.graphApi.requestAsync("/me/notifications","POST",{message:o()({title:f,body:n,media_url:m}),schedule_interval:i});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),e}();t.Z=v},10793:function(e,t,n){"use strict";n.d(t,{Z:function(){return Ne}});var i=n(25110),a=n.n(i),s=n(24278),r=n.n(s),o=function(e,t){return void 0===t&&(t=1),a()({length:Math.ceil(e.length/t)},(function(n,i){return r()(e).call(e,i*t,i*t+t)}))},c=n(14418),h=n.n(c),l=n(58118),u=n.n(l),p=function(e,t){return h()(e).call(e,(function(e){return!u()(t).call(t,e)}))},d=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=[e[n],e[t]];e[t]=i[0],e[n]=i[1]}},f=n(11882),m=n.n(f),g=function(e,t,n){return m()(n).call(n,e)===t&&null!==e&&void 0!==e},v=function(e){return h()(e).call(e,g)},y={chunk:o,difference:p,shuffle:d,unique:v},S=n(47475),E=n.n(S),A=n(42568),b=n.n(A),T=b()((function(e,t){if("string"===typeof e){var n=t[e.toLowerCase()];if("string"===typeof n)return n}return"?"})),C=b()((function(e){for(var t=null,n=[],i=/:([A-Z0-9?]+)/gm;null!==(t=i.exec(e));)n.push(t[1]);return n})),P=b()((function(e){for(var t=null,n=[],i=/([0-9]+[A-Z?]{1}|[A-Z?]{1})/gm;null!==(t=i.exec(e));){var a=t[0];if(a.length>=2){var s,o=a.length,c=r()(a).call(a,0,o-1),h=a[o-1],l=E()(s=new Array(+c)).call(s,h);n.push.apply(n,l)}else n.push(a)}return n})),w=function(e,t){var n=e,i=GameCore.Utils.Object.invert(t),a={},s=0,r=0;return C(n).forEach((function(e){s=0,r++,a[r]||(a[r]={}),P(e).forEach((function(e){s++,a[r][s]=T(e,i)}))})),a},I=b()((function(e,t){var n=t[e];return"string"===typeof n?""+n.toUpperCase():"?"})),k=function e(t,n,i){void 0===i&&(i=!1);var a="";if(!GameCore.Utils.Valid.isObject(t))return a;var s="",o=1;for(var c in t)if(GameCore.Utils.Object.hasOwn(t,c)){var h=t[c];if(GameCore.Utils.Valid.isObject(h))a+=":"+e(h,n,!0);else if(GameCore.Utils.Valid.isString(h)){var l=I(h,n);l===s?(o++,a=r()(a).call(a,0,-2)):o=1,a+=""+o+l,s=l}}return a=a.replace(/1([A-Z])/g,"$1")},x=function(e){try{return atob(e)}catch(t){return""}},_={decodeMap:w,encodeMap:k,hashToString:x,stringToHash:function(e){try{return btoa(e)}catch(t){return""}}},O=function(e){try{return JSON.parse(e)}catch(t){return null}},D=n(35627),R=n.n(D),M=function(e){try{return R()(e,null,0)}catch(t){return""}},L=function(e){return O(M(e))},B={clone:L,decode:O,encode:M},N=function(e){var t="object"===typeof e||"function"===typeof e,n=Array.isArray(e);return null!==e&&t&&!n},F=function(e){return void 0===e||null===e},G=function e(t){if(!N(t))return t;for(var n in t){F(t[n])&&delete t[n];var i=t[n];N(i)&&(t[n]=e(i))}return t},Z=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},U=n(28222),H=n.n(U),V=function(e){var t={};return H()(e).forEach((function(n){if(Z(e,n)){var i=e[n];"string"===typeof i&&(t[i]=n)}})),t},W=function(e,t){if(!Array.isArray(e))return{};var n={};return e.forEach((function(e){if(Z(e,t)){var i=e[t];"string"===typeof i&&(n[i]=e)}})),n},Y={clear:G,hasOwn:Z,invert:V,keyBy:W},z=function(e){return e?e[0].toUpperCase()+r()(e).call(e,1):e},K=function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t},j=n(24282),X=n.n(j),q=function(e){var t;return X()(t=H()(e)).call(t,(function(t,n){var i=e[n];return void 0!==i&&t.push(n+"="+i),t}),[]).join("&")},J=function(e){void 0===e&&(e="0x");for(var t=e,n=0;n<6;n++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},Q=function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",i="",a=e;void 0!=t&&(a-=t.length,i+=t);for(var s=0;s<a;s++){var r=Math.floor(67*Math.random());i+=n.charAt(r)}return i},$=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[\u0111\u0110]/g,(function(e){return"\u0111"===e?"d":"D"}))},ee=n(39022),te=n.n(ee),ne=n(57269),ie=n.n(ne),ae=function(e,t){var n,i=e.split(" "),a=(i.length<=1?te()(n=[]).call(n,i):[i[0],i.pop()]).join(" "),s=ie()(a).call(a," ")||0,r=s>=0?s:t;return(a.length>t?a.substring(0,r):a).substring(0,t)},se=n(12196),re=n.n(se),oe={capitalize:z,hashCode:K,params:q,toCamelCase:function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return t.substr(0,1).toLowerCase()+t.substr(1)},toUpperCamelCase:function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)},randomColor:J,random:Q,removeDiacritics:$,getShortName:ae,generateObjectId:function(e){void 0===e&&(e=16);var t=function(t){return Math.floor(t).toString(e)};return t(Date.now()/1e3)+re()(" ").call(" ",e).replace(/./g,(function(){return t(Math.random()*e)}))}},ce=function(e){return"boolean"===typeof e},he=function(){return false},le=function(e){return"function"===typeof e},ue=function(e){return"number"===typeof e},pe=function(e){var t;return m()(t=["string","number","symbol"]).call(t,typeof e)>-1},de=function(e){return"string"===typeof e},fe=n(6226),me=n.n(fe),ge=function(e,t,n){var i=n||{},a=i.timeout,s=void 0===a?1e3:a,r=i.checkInterval,o=void 0===r?100:r;return new(me())((function(n){var i=setInterval((function(){("function"===typeof e?e():e)===("function"===typeof t?t():t)&&(clearInterval(i),n(!0))}),o);s>0&&setTimeout((function(){clearInterval(i),n(!1)}),s)}))},ve=function(e){if(m()(e).call(e,".")<0)return e;for(var t=e.length-1;t>=0;t--){if("."==e[t])return e.substring(0,t);if("0"!=e[t])return e.substring(0,t+1)}return e},ye=function(e,t){var n=t||{},i=n.fractionalDigits,a=void 0===i?0:i,s=n.startAbbreviate,r=void 0===s?1e3:s,o=n.abbreviateStep,c=void 0===o?3:o,h=n.maxLength,l=void 0===h?-1:h,u=n.removeLastZero,p=void 0===u||u,d=n.suffixes,f=void 0===d?["","k","m","b","t","q"]:d,m=-1===l?99999999:l;if(e>=r){var g=Math.floor(e/Math.pow(10,c)),v=Math.floor((g.toString().length-1)/c)+1,y=(e/Math.pow(Math.pow(10,c),v)).toFixed(a),S=m-f[v].length,E=y.substring(0,S);return(p?ve(E):E)+f[v]}var A=e.toFixed(a),b=m-f[0].length,T=A.substring(0,b);return p?ve(T):T+f[0]},Se={Array:y,Hash:_,Json:B,Object:Y,String:oe,Valid:{isBoolean:ce,isDebugger:he,isFunction:le,isNumber:ue,isObject:N,isPropertyKey:pe,isString:de,isValueChangeAsync:ge},Image:{drawCircle:function(e){var t=e.scene,n=e.key,i=e.newKey,a=t.textures.get(n).getSourceImage();if(!a)return!1;var s=Math.min(a.width,a.height);i||t.textures.removeKey(n);var r=t.textures.createCanvas(i||n,s,s),o=r.context;return o.beginPath(),o.arc(s/2,s/2,s/2,0,2*Math.PI,!1),o.clip(),r.draw((a.width-s)/2,(a.height-s)/2,a),!0},drawBorder:function(e){var t=e.scene,n=e.key,i=e.newKey,a=e.radius,s=e.width,r=e.height,o=t.textures.get(n).getSourceImage();if(!o)return!1;s||(s=o.width),r||(r=o.height),i||t.textures.removeKey(n);var c=t.textures.createCanvas(i||n,s,r),h=c.context,l=Math.min(s,r)/100*a/2;return h.beginPath(),h.moveTo(0+l,0),h.lineTo(0+s-l,0),h.quadraticCurveTo(0+s,0,0+s,0+l),h.lineTo(0+s,0+r-l),h.quadraticCurveTo(0+s,0+r,0+s-l,0+r),h.lineTo(0+l,0+r),h.quadraticCurveTo(0,0+r,0,0+r-l),h.lineTo(0,0+l),h.quadraticCurveTo(0,0,0+l,0),h.closePath(),h.clip(),c.draw(0,0,o),!0},getImageScale:function(){return GameCore.Utils.Device.isDesktop()||GameCore.Utils.Device.pixelRatio()>1?2:1}},Number:{toAbbreviatedString:ye,padStart:function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),a=i.length,s=0;s<t-a;s++)i=n+i;return i},padEnd:function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),a=i.length,s=0;s<t-a;s++)i+=n;return i}},Device:{isDesktop:function(){var e=navigator.userAgent;return/Windows|Mac OS/i.test(e)&&!/like Mac OS/.test(e)},isMobile:function(){var e=navigator.userAgent;return/Android|iP[ao]d|iPhone/i.test(e)},isAndroid:function(){return"ANDROID"===FBInstant.getPlatform()},isIOS:function(){return"IOS"===FBInstant.getPlatform()},isMobileWeb:function(){return"MOBILE_WEB"===FBInstant.getPlatform()},pixelRatio:function(){return Math.round(window.devicePixelRatio)||1}}},Ee=n(73126),Ae=n(51527),be={ENV:"production",AppId:"c17f0a0e898947d0af99394c9af8961a",ApiHost:"patch/json/null.json?citigo.site",OtherHost:"patch/json/null.json?citigo.site",Game:{DisableLandscape:!0},LeadersBoard:{LeaderboardId:""},Match:{MaxRescueCount:1,RescueGamePopupTimeout:15,DelayNoThank:2e3,ContinueSingleMatchEnabled:!1},Statistics:{ShowFPSInGame:!1}},Te={ENV:"production",ApiHost:"patch/json/null.json?citigo.site",OtherHost:"patch/json/null.json?citigo.site",LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowConsole:!1,ShowInspector:!1,ShowMonitoring:!1},Statistics:{ShowFPSInGame:!1}},Ce={ENV:"development",AppId:"1241734529564656",ApiHost:"patch/json/null.json?citigo.site",OtherHost:"patch/json/null.json?citigo.site",SyncProfileFromAPI:!0,Notification:{Enable:!1,DisableSendNotification:!0,ApiUrl:"https://notifications.sunstudio.io",GameTitle:"Sun Studio",GameImage:"https://sunstudio.io/images/logo.png"},PlayerMock:{id:"",signature:""},OpponentMock:{id:"",signature:""},MatchMockFailRate:5,Gameplay:{StartLevel:1,StartScore:0,StartDiamonds:0,DefaultDiamondsForNewUser:300,LevelDifficultRate:{FromUnder30:1.07,FromUnder35:1.05,FromUnder45:1.05,FromUnder200:1.1},StartAdAtLevel:2,GiftTime:10800,AwardDiamonds:100,FreeItems:!1,DelayStart:2e3,DelayLevelUp:1800,DelayFinishGame:500,EnableVibrate:!0,VibrateValue:[0,0,119,199,279,359,439],Progress:{BonusScore:5e3,Milestone:3},MaxGemInPiece:2,RatePieceContainGem:10},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{FirstMove:3,TargetScore:1,CurrentScore:1,ColorfulGem:1,ItemPaint:1,ItemHammer:1,ItemShuffle:1}},PlayerDataStore:"playerData",Game:{AutoResize:!0,PortraitRatio:375/667,PortraitWidth:375,PortraitHeight:667,LandscapeRatio:760/450,LandscapeWidth:760,LandscapeHeight:500,ForcePixelRatio:0,AutoDropFps:!1,DisableLandscape:!1,FullSizeOnLandscape:!0},Debugger:{ShowInspector:!1,ShowMonitoring:!1,ShowConsole:!1,Expanded:!0,AutoRefresh:!0,InspectorAutoUpdate:!0,Opacity:.8},Statistics:{Enable:!1,DisplayMode:0,FPS:!0,MS:!0,MB:!0,Opacity:.8,ShowFPSInGame:!0,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1,Opacity:.8,Expanded:!0},ProfilerPlugin:{Enable:!1},Match:{MaxRescueCount:1,RescueGamePopupTimeout:10,DelayNoThank:1e3,ContinueSingleMatchEnabled:!1,SingleMatchStore:"singleMatch",JourneyMatchStore:"journeyMatch",LivesStore:"lives",LocalSingleMatchDefault:{_id:"12345678890",status:"open",playerId:"",score:0,level:1,startedAt:0,updateAt:0,finishAt:0,data:{}},Levels:[100,500,1e3,1500,2e3,3e3,4e3,5e3,6e3,7500,9e3,11500,13e3,15e3,17e3,19e3,21e3,23e3,25e3,1e5],PieceRandoms:{maxPiece:200,measureError:.5}},DailyRewards:{MaxDays:6,MockTime:0,CheckInterrupt:!0},DailyTasks:{Duration:86400},Tournament:{UseMock:!1,ForcePlay:!1,UseLeaderboard:!1,TournamentContextIds:[]},LeadersBoard:{Name:null,UseMock:!1,Prefix:"leaderboards",LeaderboardId:"",Limit:50},LanguageSupport:{en:"en"},EnableEffectSceneTransition:!0,DefaultTheme:"default",ThemeSupport:{default:"default"},Ads:{Enabled:!0,CalculateSafeAreaBottom:!0,EnableRewardVideoResetInterstitial:!1,Mockup:{Enable:!1,ErrorRate:5,GiphyApiKey:""},InterstitialAdOptions:{pID:"",showWhenStartGame:!0,secondsFirstTime:0,secondsBetweenAds:0},RewardAdOptions:{pID:"",secondsFirstTime:0,secondsBetweenAds:0},BannerAdOptions:[{placementId:"desktop-right",position:"right",bannerWidth:120,bannerHeight:600,secondsReload:60,platform:"DESKTOP"},{placementId:"mobile-bottom",position:"bottom",bannerHeight:50,secondsReload:60,platform:"MOBILE"}]},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Analytics:{GoogleAnalytics:{consoleLog:!1},FacebookAnalytics:{prefix:"fba",consoleLog:!1}},MagnetItem:{key:"magnet-item",scoreForOnePercent:4,maxMagnetPerMatch:5},Board:{cols:9,rows:9},Sentry:{errorCodes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},errorMessages:{accepted:[],ignored:["Load image failed"]}},DailyChallenge:{Prefix:"leaderboards",LeaderBoardId:"62a2f28bb2198c615726a999"},Lives:{bonusDurationMins:5,bonusLife:1,livesCapacity:10},Rollbar:{Enable:!1,UseMockup:!1,FilterError:{Codes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},Messages:{accepted:[],ignored:["Load image failed","Request failed to be processed"]}},ListPlayerDevIds:[]},Performance:{Enable:!1,trackingSceneKeys:["DASHBOARD_SCENE","GAME_SCENE"],minQuality:1,maxQuality:2,fpsThreshold:48,checkInterval:2e3,qualityAdjustStep:.1,autoUpgradeQuality:!0,onlyUpdateWhenSwitchScene:!0}};Ce=(0,Ae.TS)((0,Ee.Z)({},Ce),Te);var Pe=Ce=(0,Ae.TS)((0,Ee.Z)({},Ce),be),we=function(e){return function(t){try{var n=window.game,i=t.module;if(n.scene.getScenes(!0)[0].scene.key!==e)return;var a=i.default;n.scene.remove(e),n.scene.add(e,a,!0),n.scene.bringToTop(n.globalScene)}catch(r){var s;null==(s=void 0)||s.invalidate()}}},Ie=n(17061),ke=n.n(Ie),xe=n(29692),_e=n.n(xe),Oe=n(94115),De=n.n(Oe),Re=n(2938),Me=!1,Le=function e(t,n,i){n.forEach((function(n){if(n.name){var a=null;if(a=i?i.getByName(n.name):t.children.getByName(n.name)){if("Container"===n.type){var s=a,r=n.getAll();if(e(t,r,s),!s.hotContainer)return}var o=ke()(n),c=["_events","_sysEvents","input","localTransform","list","displayList"],l=h()(o).call(o,(function(e){if("string"!==typeof e)return!1;if(m()(c).call(c,e)>=0)return!1;if(!a)return!1;var t=_e()(n,e);return!(t instanceof Function)&&(!(t instanceof Phaser.Scene)&&(!(t instanceof Phaser.GameObjects.Group)&&(!(t instanceof Phaser.GameObjects.GameObject)&&t===_e()(a,e))))}));l.length<1||l.forEach((function(e){if(a){var t=_e()(n,e);_e()(a,e),De()(a,e,t)}}))}}}))},Be={Configs:Pe,Utils:Se,LiveUpdate:{Scene:we,SceneObjects:function(e,t){return void 0===t&&(t=Me),function(n){try{var i=window.game,a=n.module,s=i.scene.getScenes(!0)[0];if(s.scene.key!==e)return;Me=t;var r=a.default,o=e+"-draft";i.scene.remove(o);var c=i.scene.add(o,r);s=i.scene.getScene(e),c.events.once(Phaser.Scenes.Events.RENDER,(0,Re.D)((function(){var e=c.children.getAll();Le(s,e),i.scene.remove(o)})),50),i.scene.run(o),i.scene.bringToTop(s),i.scene.bringToTop(i.globalScene)}catch(h){}}}}};window.GameCore=Be;var Ne=Be},1998:function(e,t,n){"use strict";var i=n(33938),a=n(41819),s=n(30222),r=n.n(s),o=n(6359),c=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).instance=void 0,i.placementId=void 0,i.instance=null,i.placementId=n,i}(0,a.Z)(t,e),t.setGame=function(e){self.game=e};var n=t.prototype;return n.loadAsync=function(){var e=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===GameCore.Ads.Status.IDLE){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.status=GameCore.Ads.Status.LOADING,e.next=6,this.createInstanceByType(this.type);case 6:if(this.instance=e.sent,null!==this.instance){e.next=9;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 9:return e.next=11,this.instance.loadAsync();case 11:this.status=GameCore.Ads.Status.FILLED,e.next=19;break;case 14:throw e.prev=14,e.t0=e.catch(2),this.status=GameCore.Ads.Status.IDLE,this.instance=null,e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(){return e.apply(this,arguments)}}(),n.showAsync=function(){var e=(0,i.Z)(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.status===GameCore.Ads.Status.FILLED){e.next=3;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 3:if(this.status=GameCore.Ads.Status.SHOWING,null!==this.instance){e.next=6;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 6:return e.next=8,this.instance.showAsync();case 8:t=this.getSceneName(),this.type===GameCore.Ads.Types.PRE_ROLL&&self.game.analytics.showInterstitialAd(t),this.type===GameCore.Ads.Types.MID_ROLL&&self.game.analytics.showInterstitialAd(t),this.type===GameCore.Ads.Types.REWARDED&&self.game.analytics.showRewardedVideoAd(t),this.status=GameCore.Ads.Status.IDLE,this.instance=null,e.next=22;break;case 16:throw e.prev=16,e.t0=e.catch(0),e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code")&&"ADS_NOT_LOADED"===e.t0.code?this.status=GameCore.Ads.Status.FILLED:(this.status=GameCore.Ads.Status.IDLE,this.instance=null),n=this.getSceneName(),self.game.analytics.showAdFail(this.type,n,e.t0),e.t0;case 22:return e.prev=22,window.focus(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[0,16,22,25]])})));return function(){return e.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var e=(0,i.Z)(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=self.game.facebook,e.t0=t,e.next=e.t0===GameCore.Ads.Types.MID_ROLL||e.t0===GameCore.Ads.Types.PRE_ROLL?4:e.t0===GameCore.Ads.Types.REWARDED?7:10;break;case 4:return e.next=6,n.getInterstitialAdAsync(this.placementId);case 6:case 9:return e.abrupt("return",e.sent);case 7:return e.next=9,n.getRewardedVideoAsync(this.placementId);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getSceneName=function(){try{var e=self.game.globalScene;return e instanceof o.Z?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},t}(GameCore.Ads.AdInstance);t.Z=c},98297:function(e,t,n){"use strict";n.d(t,{DW:function(){return c},EH:function(){return s},fJ:function(){return a},kL:function(){return i},qj:function(){return r},rh:function(){return o}});var i="CONTEXT_RECEIVED",a="CONTEXT_PROCESSED",s="CONTEXT_GAME_MODE_DETECTED",r="MESSAGES_SENT_UPDATE",o="MESSAGES_SENT_REMOVE",c="SCENE_KEY_UPDATE"},62187:function(e,t,n){"use strict";var i=n(51527),a=function(){function e(e,t){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(t.targets.length<1)){this.buildConfig(e,t);var n=this.config.targets[0].scene;n&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var t=e.prototype;return t.buildConfig=function(e,t){this.config=(0,i.TS)(e,t)},t.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.tween.play(),this.isStarted=!0))},t.restart=function(){var e;null==(e=this.tween)||e.restart()},t.stop=function(){var e;null==(e=this.tween)||e.stop()},t.remove=function(){var e;null==(e=this.tween)||e.remove()},t.next=function(e){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween):null},e}();t.Z=a},51743:function(e,t,n){"use strict";var i=n(5281),a=n(41819),s=n(62187),r={targets:[],repeat:-1,yoyo:!0,duration:33,ease:Phaser.Math.Easing.Sine.InOut,props:{x:5}},o=function(e){function t(t){var n,a,s;return(s=e.call(this,r,t)||this).posX=void 0,s.handleSwitchPosition=function(){var e;s.posX=-s.posX,null==(e=s.tween)||e.updateTo("x",-s.posX)},null!=(n=s.config)&&n.props?(s.posX=s.config.props.x,null==(a=s.tween)||a.on(Phaser.Tweens.Events.TWEEN_REPEAT,s.handleSwitchPosition),s):(0,i.Z)(s)}return(0,a.Z)(t,e),t}(s.Z);t.Z=o},53270:function(e,t,n){"use strict";var i=n(41819),a=n(62187),s={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},66573:function(e,t,n){"use strict";var i=n(41819),a=n(62187),s={targets:[],duration:400,ease:n(97308).Z,props:{scale:"-=0.1"}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},87922:function(e,t,n){"use strict";var i=n(41819),a=n(62187),s={targets:[],duration:400,ease:n(97308).Z,props:{scale:"+=0.1"}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},97308:function(e,t,n){"use strict";var i=n(73431),a=n.n(i)()(.48,1.57,.6,.83);t.Z=a},20746:function(e,t,n){"use strict";var i=n(41819),a=n(62187),s={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},77087:function(e,t,n){"use strict";var i=n(41819),a=n(62187),s={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},62698:function(e,t,n){"use strict";var i=n(41819),a=n(62187),s={targets:[],duration:300,ease:n(97308).Z,props:{scale:{from:1.2,to:1}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},99873:function(e,t,n){"use strict";var i=n(41819),a=n(62187),s={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250,to:0},scale:{from:.9,to:1},alpha:{start:0,from:0,to:1}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},22438:function(e,t,n){"use strict";var i=n(41884),a=n(5281),s=n(41819),r=n(71944),o=n(66573),c=n(20468),h=n(4396),l=n(93397),u=function(e){function t(t,n,i,s,r,l){var u;return void 0===l&&(l=!1),(u=e.call(this,t)||this).useSound=!0,u.isClicked=!1,u.scaleUp=-1,u.scaleDown=-1,u.button=void 0,u.upAnimation=void 0,u.downAnimation=void 0,u.isUsePixelPerfect=!1,u.hitArea=void 0,u.hitZone=void 0,u.scaleDownPress=void 0,u.parentName=void 0,u.handelObjectDestroy=function(){u.scene&&u.scene.events.off(Phaser.Scenes.Events.SLEEP,u.handleSceneSleep)},u.handleSceneSleep=function(){u.scene&&u.scene.tweens.killTweensOf((0,a.Z)(u))},u.handlePointerDown=function(){var e,t;u.isClicked||null!=(e=u.upAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(u.isClicked=!0,u.runDownAnimation())},u.handleOnClick=function(e){return function(){var t,n,i,a;u.isClicked&&(null!=(t=u.upAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(u.isClicked=!1,u.runUpAnimation(),null==(i=u.upAnimation)||null==(a=i.tween)||a.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){u.logButtonEvent(),u.addDebugData(),u.processCallback(e)}))))}},u.handlePointerOut=function(){var e,t;u.isClicked&&(null!=(e=u.upAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(u.isClicked=!1,u.runUpAnimation()))},u.runDownAnimation=function(){var e;-1===u.scaleDown&&(u.scaleUp=u.scale,u.scaleDown=u.scaleDownPress),u.useSound&&u.scene.audio.playSound(h.Z.BUTTON_CLICK),null==(e=u.downAnimation)||e.remove(),u.downAnimation=new o.Z({targets:[(0,a.Z)(u)],duration:150,props:{scale:u.scaleDown},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.downAnimation.play()},u.runUpAnimation=function(){var e;-1!==u.scaleUp&&(null==(e=u.upAnimation)||e.remove(),u.upAnimation=new o.Z({targets:[(0,a.Z)(u)],duration:150,props:{scale:u.scaleUp},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.upAnimation.play())},u.isUsePixelPerfect=l,u.setDepth(c.Z.BUTTON),u.createButton(n,i,s,r),u.updateSize(),u.listenEvents(),u.scene.add.existing((0,a.Z)(u)),u}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.processCallback=function(e){var t,n,i;null==(t=this.upAnimation)||t.stop(),null==(n=this.downAnimation)||n.stop(),null==(i=this.scene)||i.tweens.killTweensOf(this),-1!==this.scaleUp&&this.setScale(this.scaleUp),e()},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=this.scene.add.image(0,0,e,t),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.1;var a=this.button,s=a.displayWidth,r=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:s,displayHeight:r}),this.add([this.button,this.hitZone])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,a=n/100*10,s=i<10?i:10,r=a<10?a:10;this.setSize(t+s,n+r),this.hitZone.setSize(t+s,n+r)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,l.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(r._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.Z)(t,[{key:"onClick",set:function(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),t}(Phaser.GameObjects.Container);t.Z=u},20402:function(e,t,n){"use strict";var i=n(5281),a=n(41819),s=n(54255),r=n(53270),o=s.Z.DEFAULT,c=o.KEY,h=o.FRAME,l=function(e){function t(t){var n;return(n=e.call(this,t,0,0,c,h.PRELOADER)||this).anim=void 0,n.runAnimation(),n.setWorldSize(80,80),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.runAnimation=function(){var e;null==(e=this.anim)||e.remove(),this.anim=new r.Z({targets:[this],repeat:-1,duration:1200}),this.anim.play()},n.setVisible=function(t){return e.prototype.setVisible.call(this,t),t?this.runAnimation():this.anim.stop(),this},t}(Phaser.GameObjects.Image);t.Z=l},96308:function(e,t,n){"use strict";var i=n(41884),a=n(5281),s=n(41819),r=n(20468),o=n(54255).Z.DEFAULT,c=o.KEY,h=o.FRAME,l=function(e){function t(t,n,i,s,o,c){var h;return(h=e.call(this,t,n,i)||this).top=void 0,h.mid=void 0,h.bottom=void 0,h.payload=void 0,h.payload=c,h.setSize(s,o),h.setDepth(r.Z.POPUP),h.createPopup(),h.scene.add.existing((0,a.Z)(h)),h}(0,s.Z)(t,e);var n=t.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){var e,t,n;this.top=this.scene.add.image(0,0,c,(null==(e=this.payload)?void 0:e.framePopupTop)||h.POPUP_TOP),this.mid=this.scene.add.image(0,0,c,(null==(t=this.payload)?void 0:t.framePopupMid)||h.POPUP_MID),this.bottom=this.scene.add.image(0,0,c,(null==(n=this.payload)?void 0:n.framePopupBottom)||h.POPUP_BOTTOM),this.add([this.top,this.mid,this.bottom])},n.updatePopupSize=function(){var e,t=(null==(e=this.payload)?void 0:e.forceHeightTop)||this.width*this.top.height/this.top.width;this.top.setWorldSize(this.width,t),this.bottom.setWorldSize(this.width,this.width*this.bottom.height/this.bottom.width),this.mid.setWorldSize(this.width,this.height-this.top.displayHeight-this.bottom.displayHeight)},n.alignPopupImages=function(){Phaser.Display.Align.In.Center(this.top,this,0,-this.mid.displayHeight/2-this.top.displayHeight/2),Phaser.Display.Align.In.Center(this.mid,this),Phaser.Display.Align.In.Center(this.bottom,this,0,this.mid.displayHeight/2+this.bottom.displayHeight/2)},n.setFrameTop=function(e,t,n){t||(t=this.top.displayWidth),n||(n=this.top.displayHeight),this.top.setFrame(e),this.top.setWorldSize(t,n)},(0,i.Z)(t,[{key:"onClose",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}}]),t}(Phaser.GameObjects.Container);t.Z=l},26108:function(e,t,n){"use strict";var i=n(73126),a=n(41884),s=n(5281),r=n(41819),o=n(97606),c=n.n(o),h=n(24282),l=n.n(h),u=n(47475),p=n.n(u),d=n(14418),f=n.n(d),m=n(24278),g=n.n(m),v=n(25110),y=n.n(v),S=n(33733),E=n.n(S),A=n(19389),b=n.n(A),T=n(20468),C=n(2938);function P(e,t){var n="undefined"!==typeof E()&&b()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return w(e,t);var i=g()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return y()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var I=function(e){function t(t,n){var a,r;(r=e.call(this,t)||this).config=void 0,r.isEnable=void 0,r.maxHeight=void 0,r.isScrolling=void 0,r.boundTop=void 0,r.boundBottom=void 0,r.maskGraphics=void 0,r.objects=void 0,r._value=0,r.velocity=0,r.isScrollingSmooth=void 0,r.lastScrollY=void 0,r.isScrollingBack=void 0,r.scrollingBackTo=void 0,r.lastScrollYCount=0,r.hitArea=void 0,r.onScrollEvents=[],r.update=function(e,t){r.isScrollingSmooth&&r.velocity&&r.scrollingSmooth(t),r.isScrollingBack&&r.scrollingBack(t)},r.checkReachBound=function(){return r.isReachTop()||r.isReachBottom()},r.onMouseScroll=(0,C.D)((function(e,t,n){if(r.isEnable){var i;if(r.isScrolling=!0,r.checkReachBound())return r.lastScrollY=c()(i=r.lastScrollY).call(i,(function(){return 0})),void(r.isScrolling=!1);r.stopScrollingBack(),r.startScrollSmooth(-n*r.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),r.onTouchScroll=function(e){if(r.isEnable){r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack(),r.isScrolling=!0;var t=r.scene.game.world.getZoomRatio(),n=e.position,i=e.prevPosition,a=(n.y-i.y)/t,s=r.height*r.maxScrollOver,o=1;if(r.lastScrollY[++r.lastScrollYCount%r.lastScrollY.length]=a,r.isReachTop()&&a>=0){var c=(s-(r.value-r.marginTop))/s;o=Math.min(o,c)}if(r.isReachBottom()&&a<=0){var h=(s-(-r.maxHeight-r.value))/s;o=Math.min(o,h)}var l=a*o,u=r.maxScrollOver*r.height;r.value+l>r.marginTop+u?r.value=r.marginTop+u:r.value+l<-r.maxHeight-u?r.value=-r.maxHeight-u:r.value+=l,r.callOnScrollEvents(r.value,l)}},r.onTouchDown=function(){r.isEnable&&(r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack())},r.onTouchEnd=function(){var e,t;if(r.isReachTop()&&(r.startScrollingBack(r.marginTop),r.stopScrollSmooth()),r.isReachBottom()&&(r.startScrollingBack(-r.maxHeight),r.stopScrollSmooth()),r.isScrolling){var n=l()(e=r.lastScrollY).call(e,(function(e,t){return e+t}))/r.lastScrollY.length;r.startScrollSmooth(n*r.scrollSmooth),r.lastScrollY=c()(t=r.lastScrollY).call(t,(function(){return 0}))}},r.config=(0,i.Z)({marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5,useMask:!0},n);var o=n.width,h=n.height;return r.isEnable=!1,r.maxHeight=0,r.lastScrollY=p()(a=new Array(3)).call(a,0),r.setSize(o,h),r.createGroup(),r.createInput(),r.createEvents(),r.scene.add.existing((0,s.Z)(r)),r}(0,r.Z)(t,e);var n=t.prototype;return n.onScroll=function(e){this.onScrollEvents.push(e)},n.gotoTop=function(){this.value=this.config.marginTop},n.reset=function(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){this.drawDebugBox(16711680,.8)},n.setEnable=function(e){this.isEnable=e,e?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(e){this.addAt(e),this.objects.add(e);var t=e.y+e.height+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,t,0),this.updateObjectVisible()},n.addItems=function(e){var t=this;this.addAt(e),this.objects.addMultiple(e);var n=c()(e).call(e,(function(e){return e.y+e.height+t.marginBottom-t.height/2}));this.maxHeight=Math.max(this.maxHeight,Math.max.apply(Math,n),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.getChildren=function(){var e;return f()(e=this.objects.getChildren()).call(e,(function(e){return e.active}))},n.createBound=function(e,t,n,i){this.boundTop=this.scene.make.image({key:e,frame:t}),this.boundBottom=this.scene.make.image({key:e,frame:t}),i&&(this.boundTop.setTint(i),this.boundBottom.setTint(i)),this.boundTop.setAlpha(0,0,0,0),this.boundBottom.setAlpha(0,0,0,0),this.boundTop.setDepth(T.Z.PRIORITY),this.boundBottom.setDepth(T.Z.PRIORITY);var a=this.width,s=n,r=this.getWorldPosition(),o=r.x,c=r.y;this.boundTop.setDisplaySize(a,s),this.boundBottom.setDisplaySize(a,s),this.boundTop.setY(-this.displayHeight/2+s/2+c-this.y-1),this.boundBottom.setY(this.displayHeight/2-s/2+c-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(){var e;null==(e=this.maskGraphics)||e.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1},visible:!0}),this.maskGraphics.setName("MaskGraphics");var t=this.width,n=this.height;this.maskGraphics.fillRoundedRect(0-t/2,0-n/2,t,n,0),this.config.useMask&&this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var e=this.getWorldPosition(),t=e.x,n=e.y;this.maskGraphics.setPosition(t,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(e){this.objects.incY(e),this.updateObjectVisible()},n.updateObjectVisible=function(){for(var e=this.objects.getChildren(),t=0;t<e.length;t++){var n=e[t];n.y+n.height<-this.height/2||n.y-n.height>this.height/2?n.setVisible(!1):n.setVisible(!0)}},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(e,t){for(var n,i=P(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,e,t)}},n.scrollingBack=function(e){var t=(this.scrollingBackTo-this.value)*e*this.scrollingBackRate/1e3;this.value+=t,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,t)},n.startScrollingBack=function(e){this.isScrollingBack=!0,this.scrollingBackTo=e},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(e){var t=this.velocity*e/1e3;this.value+=t;var n=Math.abs(this.velocity)/this.velocity;this.velocity-=n*this.acceleration*e/1e3,Math.abs(this.velocity)<this.acceleration*e/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,t)},n.startScrollSmooth=function(e){this.isScrollingSmooth=!0,e&&(e*this.velocity>0?this.velocity+=e:this.velocity=e)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0},n.isReachTop=function(){return this.value>this.marginTop},n.isReachBottom=function(){return-this.value>this.maxHeight},(0,a.Z)(t,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(e){var t=e-this._value;this._value=e,this.updateObject(t)}}]),t}(Phaser.GameObjects.Container);t.Z=I},10515:function(e,t,n){"use strict";var i=n(54255).Z.EFFECTS,a=i.KEY,s=i.FRAME,r={CONFETTI_HEXAGON:{KEY:"confetti-hexagon-animation",TEXTURE:a,PREFIX:s.FX_CONFETTI_HEXAGON,FRAME_RATE:8,END:5,ZERO_PAD:0},CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:a,PREFIX:s.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:a,PREFIX:s.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0}};t.Z=r},20468:function(e,t){"use strict";t.Z={BACKGROUND:1,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,TILE:25,TEXT:30,ENCOURAGING:31,EFFECT:32,MESSAGE:33,POPUP:999,PRIORITY:80,DEBUG:90,DICE:99,PIECE:99,ON_TOP:1e4}},70932:function(e,t){"use strict";t.Z={min:18,max:60}},27033:function(e,t){"use strict";t.Z={FONT_WEIGHT_500:{KEY:"font-main-500",TEXTURE:"./assets/fonts/500.png",DATA:"./assets/fonts/500.xml"},FONT_WEIGHT_600:{KEY:"font-main-600",TEXTURE:"./assets/fonts/600.png",DATA:"./assets/fonts/600.xml"},PRIMARY:{KEY:"font-main",TEXTURE:"./assets/fonts/primary.png",DATA:"./assets/fonts/primary.fnt"},PRIMARY_LIGHT:{KEY:"font-main-light",TEXTURE:"./assets/fonts/primary-light.png",DATA:"./assets/fonts/primary-light.fnt"},NUMBER_LIGHT:{KEY:"number-light",TEXTURE:"./assets/fonts/number-light.png",DATA:"./assets/fonts/number-light.xml"},NUMBER_DARK:{KEY:"number-dark",TEXTURE:"./assets/fonts/number-dark.png",DATA:"./assets/fonts/number-dark.xml"},FONT_FAMILY:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',FONT_FAMILY_ARIAL:"Arial"}},90143:function(e,t){"use strict";var n={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},BACKGROUND:{KEY:"background",FILE:"./assets/images/"+GameCore.Utils.Image.getImageScale()+"x/bg.jpg",CONFIG:{}}};t.Z=n},54255:function(e,t,n){"use strict";var i=n(73126),a=GameCore.Utils.Image.getImageScale(),s={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:"./assets/textures/"+a+"x/tutorial-resources.png",JSON:"./assets/textures/"+a+"x/tutorial-resources.json",FRAME:{HAND:"hand",BLANK:"blank",BG_YELLOW_LIGHT:"bg-yellow-light",BULB:"bulb"}},DEFAULT:{KEY:"default-resources",TEXTURE:"./assets/textures/"+a+"x/default-resources.png",JSON:"./assets/textures/"+a+"x/default-resources.json",URL:"./assets/textures/"+a+"x/",FRAME:{BLANK:"blank",LOGO:"logo",BOARD:"board",TEXT_LOADING:"loading",GLARE:"glare",FOOTER:"footer",LET_GO:"let-go",ROAD_1:"road-1",ROAD_2:"road-2",FLAG_LEFT:"flag-left",FLAG_RIGHT:"flag-right",LEVEL_PLAYED:"bg/level-played",LEVEL_PLAYING:"bg/level-playing",LEVEL_LOCKED:"bg/level-locked",BG_WHITE_TOP:"bg/bg-white-top",BG_WHITE_MID:"bg/bg-white-middle",BG_WHITE_BOT:"bg/bg-white-bottom",BG_LEADER:"bg/bg-grey",CALENDAR_BG_BLUE:"calendar/bg-blue",CALENDAR_BG_LIGHT_BLUE:"calendar/bg-light-blue",CALENDAR_BG_GREY:"calendar/bg-grey",PRELOADER:"preloader/dual-ring",LEADERBOARD_BG_ITEM:"leaderboards/bg-item",AVATAR_BORDER:"avatar/border",AVATAR_BACKGROUND:"avatar/background",POPUP_TOP:"popup/top",POPUP_TOP_1:"popup/top-1",POPUP_MID:"popup/middle",POPUP_MID_1:"popup/middle-1",POPUP_BOTTOM:"popup/bottom",POPUP_BOTTOM_1:"popup/bottom-1",ICON_CUP_GOLD:"icons/cup-gold",ICON_CUP_SILVER:"icons/cup-silver",ICON_CUP_COPPER:"icons/cup-bronze",ICON_SOUND:"icons/sound",ICON_VIBRATE:"icons/vibrate",ICON_PLAY:"icons/play",ICON_PLAY_BLUE:"icons/play-blue",ICON_SHARE:"icons/share",ICON_FLAG:"icons/flag",ICON_SETTING:"icons/setting",ICON_REPLAY:"icons/replay",ICON_HOME:"icons/home",ICON_CUP:"icons/cup",ICON_SHARE_BLUE:"icons/share-blue",ICON_CROWN:"icons/crown",ICON_STAR:"icons/star",ICON_CHECK:"icons/check",ICON_PLUS:"icons/plus",ICON_PLUS_BLUE:"icons/plus-blue",ICON_USER:"icons/user",ICON_CALENDER:"icons/calender",ICON_DISCOVER:"icons/discover",ICON_CHART:"icons/chart",ICON_CALENDER_BLUE:"icons/calender-blue",ICON_DISCOVER_BLUE:"icons/discover-blue",ICON_CHART_BLUE:"icons/chart-blue",ICON_HOME_BLUE:"icons/home-blue",ICON_LOSE_FACE:"icons/lose-face",ICON_VIDEO_PLAY:"icons/video-play",ICON_DANGER_TRIANGLE:"icons/danger-triangle",ICON_ARROW_LEFT:"icons/arrow-left",ICON_ARROW_RIGHT:"icons/arrow-right",ICON_CLOSE:"icons/close",BUTTON_CLOSE:"buttons/close",BUTTON_BLUE:"buttons/blue",BUTTON_BLUE_SMALL:"buttons/blue-small",BUTTON_CHALLENGE_LIGHT:"buttons/challenge_light",BUTTON_SHARE_DARK:"buttons/share",BUTTON_MINOR:"buttons/minor",BUTTON_SMALL_MINOR:"buttons/minor-small",BUTTON_LONG_MINOR:"buttons/minor-long",BUTTON_LONG_MINOR_WHITE:"buttons/long-white",BUTTON_CIRCLE:"buttons/circle-button",BUTTON_TOGGLE_OFF:"buttons/toggle-off",BUTTON_TOGGLE_ON:"buttons/toggle-on",BUTTON_LONG_BLUE:"buttons/long-blue",BUTTON_LONG_ORANGE:"buttons/long-orange",BUTTON_LONG_WHITE:"buttons/long-white",BUTTON_GREY_SMALL:"buttons/grey-small",BUTTON_BLUE_SMALL_TALL:"buttons/blue-small-tall",BUTTON_BLUE_NORMAL:"buttons/blue-normal",BUTTON_BLUE_SHORT:"buttons/blue-short",BUTTON_MINOR_NORMAL:"buttons/minor-normal",BUTTON_MINOR_BIG:"buttons/minor-big",DAILY_BORDER:"daily-challenge/border",DAILY_BACKGROUND:"daily-challenge/bg",DAILY_BORDER_TOP:"daily-challenge/top-panel",DAILY_BORDER_MIDDLE:"daily-challenge/middle-panel",DAILY_BORDER_BOTTOM:"daily-challenge/bottom-panel",TEXT_NO_THANKS:"texts/text-no-thanks",TEXT_SECOND_CHANGE:"texts/text-second-chance",TEXT_VS:"texts/vs",TEXT_LOSE:"texts/lose",TEXT_WIN:"texts/win",TEXT_DRAW:"texts/draw",TEXT_CONTINUE:"texts/text-continue",TEXT_CONTINUE_BLUE:"texts/continue-blue",TEXT_WORLD:"texts/world",TEXT_WORLD_DISABLE:"texts/world-disable",TEXT_FRIENDS:"texts/friends",TEXT_FRIENDS_DISABLE:"texts/friends-disable",TEXT_JOURNEY:"texts/text-journey",TEXT_JOURNEY_BLUE:"texts/text-journey-blue",TEXT_SETTING:"texts/setting",TEXT_REPLAY:"texts/replay",TEXT_YOUR_SCORE:"texts/your-score",TEXT_TRY_AGAIN:"texts/try-again",TEXT_LEVEL_FAIL:"texts/level-failed",TEXT_LEVEL_COMPLETE:"texts/level-completed",TEXT_CONGRATULATION:"texts/congratulations",TEXT_SHARE:"texts/share",TEXT_PLAY:"texts/play",TEXT_MISSION:"texts/mission",TEXT_COLLECT:"texts/collect",TEXT_DAILY_CHALLENGE:"texts/text-daily-challenge",TEXT_DAILY_CHALLENGE_BLUE:"texts/text-daily-challenge-blue",TEXT_RESULT:"texts/result",TEXT_RANKING:"texts/text-ranking",TEXT_RANKING_BLUE:"texts/text-ranking-blue",TEXT_RANKING_DARK:"texts/text-ranking-dark",TEXT_KEEP_PLAYING:"texts/keep-playing",TEXT_OUT_OF_LIVES:"texts/out of lives",TEXT_REFILL_LIVES:"texts/refill-lives",TEXT_BLOCK_PUZZLE_SUDOKU:"texts/text-block-puzzle-sudoku",TEXT_NEW_GAME:"texts/text-new-game",TEXT_PLAY_WITH_FRIEND:"texts/text-play-with-friend",TEXT_HOME:"texts/text-home",TEXT_HOME_BLUE:"texts/text-home-blue",TEXT_VIBRATE:"texts/vibrate",TEXT_SOUND:"texts/sound",TEXT_OUT_OF_MOVES:"texts/text-out-of-moves",TEXT_BEST_SCORE:"texts/text-best score",TEXT_BEST_SCORE_2:"texts/best-score",TEXT_RESTART:"texts/restart",TEXT_WAITING:"texts/waiting",TEXT_PLAY_BLUE:"texts/play-blue",TEXT_CHALLENGE:"texts/challenge",TEXT_ALMOST_DONE:"texts/almost-done",TEXT_WELCOME:"texts/text-welcome!",TEXT_SKIP:"texts/skip",TEXT_CANCEL:"texts/cancel",TEXT_TARGET_SCORE:"texts/target-score",TEXT_INVITE_FRIEND:"texts/invite-friend",TEXT_JOIN_GLOBAL:"texts/join-global",LIVES_HEART:"lives/heart",LIVES_TIME_BLOCK_2:"lives/time-block-2",EMOJI_WAITING:"emoji/waiting",EMOJI_DRAW:"emoji/draw",EMOJI_LOSE:"emoji/lose",EMOJI_WIN:"emoji/win",D_BAG:"decorate/d-bag",D_BOOK:"decorate/d-book",D_CAMERA:"decorate/d-camera",D_CLOCK:"decorate/d-clock",D_MAP:"decorate/d-map",D_PLANE:"decorate/d-plane",D_ICON_1:"decorate/icon-1",D_ICON_2:"decorate/icon-2",D_ICON_3:"decorate/icon-3",D_ICON_4:"decorate/icon-4"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/effects-resources.png",JSON:"./assets/textures/"+a+"x/effects-resources.json",FRAME:{BLANK:"blank",GLOW_CIRCLE:"glow-circle",GLARE_CROSS:"glare-cross",DUST:"dust",DUST_BLUE:"dust-blue",DUST_YELLOW:"dust-yellow",FX_STAR:"star",FX_STAR_YELLOW:"star-yellow",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_CONFETTI_RIBBON:"ribbon",TEXT_COOL:"text/text_cool",TEXT_EXCELLENT:"text/text_excellent",TEXT_GOOD:"text/text_good",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-"}},ANIMATION_SCENE:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/animation-scene-resources.json",FRAME:{BLANK:"blank",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-resources.json",FRAME:{BLANK:"blank",BOARD:"board",VIOLET_GLOW:"violet-glow",MASK:"mask",DUST:"dust",CUP_GLARE:"cup-glare",AVATAR_BORDER:"avatars/border",AVATAR_BACKGROUND:"avatars/background",ICON_SETTING:"icons/setting",ICON_CUP:"icons/cup",ICON_CUP_GREY:"icons/cup_grey",ICON_CHECK:"icons/check",ICON_STAR:"icons/star",ICON_STAR_1:"icons/star-1",ICON_BACK:"icons/back",TEXT_VS:"text/vs",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right"}},GAMEPLAY_32:{KEY:"gameplay-32-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-32-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-32-resources.json",FRAME:{GEM:"gem/gem",GEM_LIGHT:"gem/gem_light",GEM_X_LIGHT:"gem/gem_x_light",GEM_SILVER:"gem/gem_silver",GEM_TRANSPARENT:"gem/gem_transparent",GEM_WHITE:"gem/gem_white",GEM_GLARE:"gem/gem_glare",GEM_HIGHT_LIGHT:"gem/gem_highlight",GEM_DIAMOND_10:"gem/diamond/diamond-10",GEM_DIAMOND_11:"gem/diamond/diamond-11",GEM_DIAMOND_12:"gem/diamond/diamond-12",GEM_DIAMOND_13:"gem/diamond/diamond-13",GEM_DIAMOND_14:"gem/diamond/diamond-14",GEM_DIAMOND_15:"gem/diamond/diamond-15",GEM_DIAMOND_10_LIGHT:"gem/diamond/diamond-10_light",GEM_DIAMOND_11_LIGHT:"gem/diamond/diamond-11_light",GEM_DIAMOND_12_LIGHT:"gem/diamond/diamond-12_light",GEM_DIAMOND_13_LIGHT:"gem/diamond/diamond-13_light",GEM_DIAMOND_14_LIGHT:"gem/diamond/diamond-14_light",GEM_DIAMOND_15_LIGHT:"gem/diamond/diamond-15_light",BLOCK_GRADIENT_PREFIX:"gem/block_gradient/block_color",STAR_1:"gem/star/star-1",STAR_2:"gem/star/star-2",STAR_3:"gem/star/star-3",ICON_STAR_1:"icons/star-1",ICON_STAR_2:"icons/star-2",ICON_STAR_3:"icons/star-3"}},DEMO_SPINE:{KEY:"demo-spine",jsonPATH:"./assets/spines/demo/demo.json",atlasPATH:"./assets/spines/demo/demo.atlas"}};GameCore.Utils.Valid.isDebugger()&&(s.EFFECTS.FRAME=(0,i.Z)({},s.ANIMATION_SCENE.FRAME,s.EFFECTS.FRAME)),t.Z=s},58123:function(e,t,n){"use strict";n.d(t,{Co:function(){return s},K5:function(){return r}});var i=n(33733),a=n.n(i),s={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",DASHBOARD_SCENE:"DASHBOARD_SCENE",GAME_OVER_SCENE:"GAME_OVER_SCENE",LEADERBOARD_SCENE:"LEADERBOARD_SCENE",JOURNEY_SCENE:"JOURNEY_SCENE",LEVEL_SCENE:"LEVEL_SCENE",DAILY_SCENE:"DAILY_SCENE",RANKING_SCENE:"RANKING_SCENE",TEST_SCENE:"TEST_SCENE",ANIMATIONS_SCENE:"ANIMATIONS_SCENE"},r={SWITCH:a()("SWITCH"),LAUNCH:a()("LAUNCH"),RUN:a()("RUN")};!function(e){e[e.SCENE=0]="SCENE",e[e.POPUP=1]="POPUP"}({})},58644:function(e,t,n){"use strict";n.d(t,{Ks:function(){return a},o4:function(){return i}});var i={ALERT_SCREEN:"ALERT_SCREEN",NOTIFY_SCREEN:"NOTIFY_SCREEN",REWARD_SCREEN:"REWARD_SCREEN",RESCUE_SCREEN:"RESCUE_SCREEN",SETTINGS_SCREEN:"SETTINGS_SCREEN",BEST_SCORE_SCREEN:"BEST_SCORE_SCREEN",RESULT_SCREEN:"RESULT_SCREEN",DAILY_REWARD_SCREEN:"DAILY_REWARD_SCREEN",DAILY_MISSIONS_SCREEN:"DAILY_MISSIONS_SCREEN",GAME_OVER_SCREEN:"GAME_OVER_SCREEN",TUTORIAL_PLAY_SCREEN:"TUTORIAL_PLAY_SCREEN",LEADER_BOARD_SCREEN:"LEADER_BOARD_SCREEN",MINI_JOURNEY_SCREEN:"MINI_JOURNEY_SCREEN",DAILY_CHALLENGE_SCREEN:"DAILY_CHALLENGE_SCREEN",YOUR_SCORE_SCREEN:"YOUR_SCORE_SCREEN",LEVEL_SCREEN:"LEVEL_SCREEN",MISSION_SCORE_COMPLETE_SCREEN:"MISSION_SCORE_COMPLETE_SCREEN",MISSION_COLLECTION_COMPLETE_SCREEN:"MISSION_COLLECTION_COMPLETE_SCREEN",MISSION_FAIL_SCREEN:"MISSION_FAIL_SCREEN",COLLISION_COMPLETED_SCREEN:"COLLISION_COMPLETED_SCREEN",NO_SPACE_LEFT_SCREEN:"NO_SPACE_LEFT_SCREEN",SCORE_REACHED_SCREEN:"SCORE_REACHED_SCREEN",NEXT_TARGET_SCORE_SCREEN:"NEXT_TARGET_SCORE_SCREEN",COLLECTION_ITEMS_SCREEN:"COLLECTION_ITEMS_SCREEN",TARGET_SCORE_SCREEN:"TARGET_SCORE_SCREEN",LUCKY_REWARD_SCREEN:"LUCKY_REWARD_SCREEN",CLAIM_HEART_SCREEN:"CLAIM_HEART_SCREEN",START_OVER_SCREEN:"START_OVER_SCREEN"},a={SCREEN:200,POPUP:300,PRIORITY:999}},4396:function(e,t){"use strict";t.Z={BUTTON_CLICK:"button_click",CONGRATULATION:"congratulation",DAILY_REWARD:"daily_reward",GAME_OVER_SCENE:"game_over_scene",GAME_OVER:"game_over",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",SCORE_COUNT:"score_count",PIECE_PICK:"piece_pick",PIECE_DROP:"piece_drop",PIECE_INVALID_MOVE:"piece_invalid_move",BOARD_GAME_OVER:"board_end",RESCUE_TIME:"rescue_timer",EAT_BLOCK:"eat_block",GOOD:"good",COOL:"cool",EXCELLENT:"excellent",SCORE_REACHED:"reach_score",TARGET_REACHED:"reach_goal",WAIT_OPPONENT:"wait_opponent",WIN:"win",LOSE:"lose",DRAW:"draw",FIREWORKS_BIG:"fireworks_big",FIREWORKS_SOAR:"fireworks_soar",FIREWORKS_SMALL:"fireworks_small"}},62157:function(e,t,n){"use strict";var i=n(5281),a=n(41819),s=n(54255),r=n(51527),o=s.Z.EFFECTS,c=o.KEY,h=o.FRAME,l=function(e){function t(t,n){var a;return(a=e.call(this,t,c,h.BLANK)||this).config=void 0,a.emitter=void 0,a.config=n||{},a.scene.add.existing((0,i.Z)(a)),a}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=h.FX_CONFETTI_SMALL_1,t=h.FX_CONFETTI_SMALL_2,n=h.FX_CONFETTI_SMALL_3,i=h.FX_CONFETTI_SMALL_4,a=1/GameCore.Utils.Image.getImageScale(),s={on:!1,particleBringToTop:!0,frame:[e,t,n,i],tint:[14223402,1021804,5420529,16702052],timeScale:1,frequency:300,maxParticles:120,gravityY:-10,speedX:{min:-100,max:100},speedY:{min:80,max:250},alpha:{start:1,end:.8},rotate:{start:0,end:1080},scale:{min:.8*a,max:2*a},angle:{min:20,max:160},lifespan:{min:8e3,max:12e3}},o=(0,r.TS)(s,this.config);this.emitter=this.createEmitter(o)},n.run=function(e,t,n){this.stop(),this.emitter.setQuantity(e),this.emitter.setPosition(t,n),this.emitter.start()},n.explode=function(e,t,n){this.emitter||this.createEmitters(),this.emitter.explode(e,t,n)},n.stop=function(){var e,t,n;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop(),null==(n=this.emitter)||n.remove(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=l},45353:function(e,t,n){"use strict";n.d(t,{Z:function(){return ue}});var i=n(73126),a=n(5281),s=n(41819),r=n(54255),o=n(10515),c=o.Z.RIBBON_A,h=c.KEY,l=c.TEXTURE,u=c.FRAME_RATE,p=c.END,d=c.PREFIX,f=c.ZERO_PAD,m=function(e){function t(t){var n={repeat:-1,frameRate:u,frames:t.generateFrameNames(l,{prefix:d,end:p,zeroPad:f,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,h,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),g=o.Z.RIBBON_B,v=g.KEY,y=g.TEXTURE,S=g.FRAME_RATE,E=g.END,A=g.PREFIX,b=g.ZERO_PAD,T=function(e){function t(t){var n={repeat:-1,frameRate:S,frames:t.generateFrameNames(y,{prefix:A,end:E,zeroPad:b,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,v,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),C=o.Z.RIBBON_C,P=C.KEY,w=C.TEXTURE,I=C.FRAME_RATE,k=C.END,x=C.PREFIX,_=C.ZERO_PAD,O=function(e){function t(t){var n={repeat:-1,frameRate:I,frames:t.generateFrameNames(w,{prefix:x,end:k,zeroPad:_,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,P,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),D=o.Z.RIBBON_D,R=D.KEY,M=D.TEXTURE,L=D.FRAME_RATE,B=D.END,N=D.PREFIX,F=D.ZERO_PAD,G=function(e){function t(t){var n={repeat:-1,frameRate:L,frames:t.generateFrameNames(M,{prefix:N,end:B,zeroPad:F,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,R,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),Z=o.Z.CONFETTI_STAR_X,U=Z.KEY,H=Z.TEXTURE,V=Z.FRAME_RATE,W=Z.END,Y=Z.PREFIX,z=Z.ZERO_PAD,K=function(e){function t(t){var n={repeat:-1,frameRate:V,frames:t.generateFrameNames(H,{prefix:Y,end:W,zeroPad:z,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,U,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),j=o.Z.CONFETTI_STAR_Y,X=j.KEY,q=j.TEXTURE,J=j.FRAME_RATE,Q=j.END,$=j.PREFIX,ee=j.ZERO_PAD,te=function(e){function t(t){var n={repeat:-1,frameRate:J,frames:t.generateFrameNames(q,{prefix:$,end:Q,zeroPad:ee,start:1}),showOnStart:!0};return e.call(this,t,X,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),ne=n(97606),ie=n.n(ne),ae=n(47475),se=n.n(ae),re=function(e){function t(t){var n,i,a;(a=e.call(this,t)||this).scene=void 0,a.ribbon=void 0,a.graphics=void 0,a.colorUse=void 0,a.lastChange=void 0,a.currentFrame=void 0,a.isYoyo=void 0,a.isGravityChanged=void 0,a.points=void 0,a.scene=t.manager.scene;var s=a.emitter.manager,r=s.x,o=s.y;return a.points=ie()(n=se()(i=new Array(10)).call(i,null)).call(n,(function(){return{x:a.x+r,y:a.y+o}})),a.isYoyo=!1,a.isGravityChanged=!1,a.lastChange=0,a.currentFrame=-1,a.createGraphics(),a.randomRibbonUsedWhenFall(),a}(0,s.Z)(t,e);var n=t.prototype;return n.randomRibbonUsedWhenFall=function(){switch(Phaser.Math.Between(0,3)){case 0:default:this.ribbon=this.scene.anims.get(o.Z.RIBBON_A.KEY);break;case 1:this.ribbon=this.scene.anims.get(o.Z.RIBBON_B.KEY);break;case 2:this.ribbon=this.scene.anims.get(o.Z.RIBBON_C.KEY);break;case 3:this.ribbon=this.scene.anims.get(o.Z.RIBBON_D.KEY)}},n.setRibbonPosition=function(e,t){var n;ie()(n=this.points).call(n,(function(n){n.x=e,n.y=t}))},n.createGraphics=function(){var e=[8443204,2928867,12013036,16376097,15285798];this.colorUse=e[Phaser.Math.Between(0,e.length-1)],this.graphics=this.scene.add.graphics({lineStyle:{width:3,color:this.colorUse}});var t=this.emitter.manager,n=t.x,i=t.y,a=t.depth;this.graphics.setDepth(a),this.graphics.setPosition(n,i)},n.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.updateFrames(t),this.updatePoints(),this.updateGraphics(),this.updateGravity(),this.updateVelocity(),this.updateColor(),a},n.updateFrames=function(e){this.lastChange+=e,this.lastChange>=this.ribbon.msPerFrame&&(this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1),this.currentFrame>=this.ribbon.frames.length&&(this.isYoyo=!0,this.currentFrame-=1),this.frame=this.ribbon.frames[this.currentFrame].frame,this.lastChange-=this.ribbon.msPerFrame)},n.updatePoints=function(){this.graphics.visible&&(this.points.shift(),this.points.push({x:this.x,y:this.y}))},n.updateGraphics=function(){this.graphics.visible&&(this.graphics.clear(),this.graphics.strokePoints(this.points))},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.graphics.destroy(),this.emitter.setVisible(!0),this.emitter.setGravityY(45))},n.updateVelocity=function(){this.graphics.visible&&(this.lifeCurrent>this.life-1800?this.velocityX+=Phaser.Math.Between(-12,12):this.velocityX>0?this.velocityX+=Phaser.Math.Between(-10,6):this.velocityX+=Phaser.Math.Between(-6,10))},n.updateColor=function(){this.graphics.visible||(this.tint=this.colorUse)},t}(Phaser.GameObjects.Particles.Particle),oe=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.isYoyo=void 0,n.isGravityChanged=void 0,n.lastChange=void 0,n.currentFrame=void 0,n.star=void 0,n.starX=void 0,n.starY=void 0,n.isYoyo=!1,n.isGravityChanged=!1,n.lastChange=0,n.currentFrame=-1,n.scene=t.manager.scene,n.starX=n.scene.anims.get(o.Z.CONFETTI_STAR_X.KEY),n.starY=n.scene.anims.get(o.Z.CONFETTI_STAR_Y.KEY),n.star=n.starX,n}(0,s.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.updateGravity(),this.updateVelocity(),this.updateFrameRate(),this.updateFrames(t),a},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.emitter.setGravityY(15),this.emitter.setSpeedX(0))},n.updateVelocity=function(){this.lifeCurrent>this.life-2e3||(this.velocityX>0?this.velocityX+=Phaser.Math.Between(-6,3):this.velocityX+=Phaser.Math.Between(-3,6))},n.updateFrames=function(e){if(this.lastChange+=e,this.lastChange>=this.star.msPerFrame){var t=Phaser.Math.RND.between(0,1);this.star=t>0?this.starX:this.starY,this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1,this.emitter.setAlpha(1)),this.currentFrame>=this.star.frames.length&&(this.isYoyo=!0,this.currentFrame-=1,this.emitter.setAlpha(.8)),this.frame=this.star.frames[this.currentFrame].frame,this.lastChange-=this.star.msPerFrame}},n.updateFrameRate=function(){this.lifeCurrent<this.life-2e3?this.star.msPerFrame=150:this.star.msPerFrame=Phaser.Math.RND.between(300,600)},t}(Phaser.GameObjects.Particles.Particle),ce=r.Z.EFFECTS,he=ce.KEY,le=ce.FRAME,ue=function(e){function t(t){var n;return(n=e.call(this,t,he,le.BLANK)||this).emitterConfetti=void 0,n.emitterRibbons=void 0,n.ribbonConfig=void 0,n.confettiConfig=void 0,n.width=void 0,n.height=void 0,n.emitterRibbons=[],n.emitterConfetti=[],n.createConfigs(),n.createAnimations(),n.scene.add.existing((0,a.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createConfigs=function(){var e=1/GameCore.Utils.Image.getImageScale();this.ribbonConfig={on:!1,visible:!1,timeScale:1.5,frame:le.BLANK,particleBringToTop:!0,speedY:{min:-480,max:-560},gravityY:290,lifespan:{min:4e3,max:6e3},rotate:{start:0,end:1800,random:!0},scale:{min:.6*e,max:e},particleClass:re},this.confettiConfig={on:!1,delay:200,timeScale:2,tint:[8443204,2928867,12013036,16376097,15285798],particleBringToTop:!0,frame:le.PREFIX_ANIMATION_RIBBON_CONFETTI_A+"1",speedY:{min:-460,max:-580},gravityY:280,lifespan:{min:5e3,max:8e3},rotate:{start:0,end:1080},scale:{min:.6*e,max:e},particleClass:oe}},n.createAnimations=function(){if(!this.scene.anims.get(o.Z.CONFETTI_STAR_X.KEY)){var e=new K(this.scene.anims);this.scene.anims.add(o.Z.CONFETTI_STAR_X.KEY,e)}if(!this.scene.anims.get(o.Z.CONFETTI_STAR_Y.KEY)){var t=new te(this.scene.anims);this.scene.anims.add(o.Z.CONFETTI_STAR_Y.KEY,t)}if(!this.scene.anims.get(o.Z.RIBBON_A.KEY)){var n=new m(this.scene.anims);this.scene.anims.add(o.Z.RIBBON_A.KEY,n)}if(!this.scene.anims.get(o.Z.RIBBON_B.KEY)){var i=new T(this.scene.anims);this.scene.anims.add(o.Z.RIBBON_B.KEY,i)}if(!this.scene.anims.get(o.Z.RIBBON_C.KEY)){var a=new O(this.scene.anims);this.scene.anims.add(o.Z.RIBBON_C.KEY,a)}if(!this.scene.anims.get(o.Z.RIBBON_D.KEY)){var s=new G(this.scene.anims);this.scene.anims.add(o.Z.RIBBON_D.KEY,s)}},n.run=function(e,t,n,i){this.setPosition(e,t),this.width=n,this.height=i,this.createEmitters(),this.emitterConfetti.forEach((function(e){e.emitParticle(25)})),this.emitterRibbons.forEach((function(e){e.emitParticle(20)}))},n.stop=function(){this.emitterConfetti.forEach((function(e){e.killAll()})),this.emitterRibbons.forEach((function(e){e.killAll()})),this.kill()},n.createEmitters=function(){this.emitterRibbons=[],this.emitterConfetti=[],this.createConfettiLeftEmitter(),this.createConfettiRightEmitter(),this.createRibbonLeftEmitter(),this.createRibbonRightEmitter()},n.createConfettiLeftEmitter=function(){var e=(0,i.Z)({},this.confettiConfig,{speedX:{min:5,max:90}}),t=this.createEmitter(e);this.emitterConfetti.push(t)},n.createConfettiRightEmitter=function(){var e=this.width,t=(0,i.Z)({},this.confettiConfig,{x:e,speedX:{min:-5,max:-90}}),n=this.createEmitter(t);this.emitterConfetti.push(n)},n.createRibbonLeftEmitter=function(){var e=(0,i.Z)({},this.ribbonConfig,{speedX:{min:20,max:80},emitCallback:function(e){e.setRibbonPosition(0,0)}}),t=this.createEmitter(e);this.emitterRibbons.push(t)},n.createRibbonRightEmitter=function(){var e=this.width,t=(0,i.Z)({},this.ribbonConfig,{x:e,speedX:{min:-20,max:-80},emitCallback:function(t){t.setRibbonPosition(e,0)}}),n=this.createEmitter(t);this.emitterRibbons.push(n)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager)},16470:function(e,t,n){"use strict";var i=n(5281),a=n(41819),s=n(54255).Z.EFFECTS,r=s.KEY,o=s.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,r,o.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/GameCore.Utils.Image.getImageScale();this.emitter=this.createEmitter({on:!1,frame:o.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:500,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Expo.Out},lifespan:{min:800,max:1500}})},n.run=function(e,t,n,i,a){this.stop(),this.reset(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},n.reset=function(){this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},75742:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var i=n(41819),a=n(14418),s=n.n(a),r=n(71944),o=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i)||this).setOrigin(0,0),a}return(0,i.Z)(t,e),t}(Phaser.GameObjects.Zone),c=n(70932),h=n(58123),l=function(e){function t(){var t;return(t=e.call(this,{visible:!1})||this).unsubscribeList=void 0,t.gameZone=void 0,t.background=void 0,t.handleOpenScene=function(){t.logPageviewOnOpen(),t.logEventOpen()},t.removeStateChange=function(){t.unsubscribeList.forEach((function(e){return e()}))},t}(0,i.Z)(t,e);var n=t.prototype;return n.create=function(){var e=this;this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.scaleGame(),this.createGameZone();var t=GameCore.Configs.Game;this.events.on(Phaser.Scenes.Events.UPDATE,(function(){t.AutoDropFps&&e.autoUpdateFPS()}))},n.scaleGame=function(){var e=this.getCamera("main"),t=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,a=n.height;e.setZoom(t),e.centerOn(i/2,a/2)},n.createGameZone=function(){var e=this.world.getWorldSize(),t=e.width,n=e.height;this.gameZone=new o(this,t,n)},n.autoUpdateFPS=function(){this.allowUpdateFPS()&&(this.tweenPlaying()||this.particlePlaying()?this.game.updateFps(c.Z.max):this.game.updateFps(c.Z.min))},n.allowUpdateFPS=function(){return this.scene.key===h.Co.GAME_SCENE||this.scene.key===h.Co.JOURNEY_SCENE},n.tweenPlaying=function(){for(var e=this.tweens.getAllTweens(),t=0;t<e.length;t++)if(e[t].isPlaying())return!0;return!1},n.particlePlaying=function(){var e=this.getAllParticles();if(!e)return!0;var t=!1;return e.forEach((function(e){e.emitters.list.forEach((function(e){e.alive&&e.alive.length>0&&(t=!0)}))})),t},n.getAllParticles=function(){if(this.input.enabled&&this.scene.isActive()&&!this.scene.isPaused()){var e=this.children.list;return!e||e.length<=0?[]:s()(e).call(e,(function(e){return"ParticleEmitterManager"===e.type}))}},n.getCamera=function(e){return"main"===e?this.cameras.main:this.cameras.getCamera(e)},n.createMask=function(e){void 0===e&&(e=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+e+")")},n.fontSize=function(e){return e/2.4},n.createBackground=function(e,t,n,i){try{this.background?(this.background.setTexture(e),t&&this.background.setFrame(t)):this.background=this.make.image({key:e,frame:t}),this.background.setName(e);var a=this.gameZone,s=a.displayWidth,r=a.displayHeight;this.background.setDisplaySize(s,r),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone)}catch(o){}},n.handleStateChange=function(e){var t=this;this.unsubscribeList=[],e.forEach((function(e){var n=e.selector,i=e.callback,a=t.storage.watch(n,i);t.unsubscribeList.push(a)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},n.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},n.logEventOpen=function(){this.analytics.event(r._.SCREEN_OPEN,{screen_name:this.getSceneName()})},n.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},t}(Phaser.Scene)},6359:function(e,t,n){"use strict";n.d(t,{Z:function(){return V}});var i=n(41884),a=n(41819),s=n(39022),r=n.n(s),o=n(20746),c=n(77087),h=n(54255),l=n(58123),u=n(58644),p=n(55481),d=n(72898),f=n(93397),m=n(75742),g=n(5281),v=n(27033),y=n(20468),S=h.Z.DEFAULT,E=S.KEY,A=S.FRAME,b=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<800)){n.lastUpdate=e;var t=Math.floor(n.scene.game.loop.actualFps);n.setFps(t)}},n.createFps(),n.setDepth(y.Z.DEBUG),n.scene.add.existing((0,g.Z)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.Z)(t,e);var n=t.prototype;return n.setFps=function(e){this.fps=e;var t=Phaser.Utils.String.Format(this.fpsString,[e]);this.fpsText.setText(t)},n.createFps=function(){this.background=this.scene.make.image({key:E,frame:A.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(45,25),this.fpsText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.fpsString,font:v.Z.FONT_WEIGHT_500.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background),this.add([this.background,this.fpsText]),this.setFps(0)},t}(Phaser.GameObjects.Container),T=b,C=function(e){function t(t){var n;if((n=e.call(this,t,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<1e3)){n.lastUpdate=e;var t=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,a=Math.round(t/1048576);n.setMemory(a),n.memoryText.setTint(n.normalColor),t>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),t>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(y.Z.DEBUG),n.scene.add.existing((0,g.Z)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,g.Z)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.Z)(t,e);var n=t.prototype;return n.isSupport=function(){var e;return this.performance&&!(null==(e=this.performance)||!e.memory)},n.setMaxMemory=function(e){this.maxMemoryLimit=Math.round(e)},n.setMemory=function(e){this.memory=e;var t=Phaser.Utils.String.Format(this.memoryString,[e,this.maxMemoryLimit]);this.memoryText.setText(t)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:v.Z.FONT_WEIGHT_500.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},t}(Phaser.GameObjects.Container),P=C,w=n(62698),I=n(99873),k=n(22438),x=n(96308),_=n(4396),O=h.Z.DEFAULT,D=O.KEY,R=O.FRAME,M=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.contents=void 0,s.buttonCancel=void 0,s.buttonSkip=void 0,s.messageText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.onHandleYes=void 0,s.open=function(t){e.prototype.open.call((0,g.Z)(s),t),s.setVisible(!0);var n=s.getData(["message","onHandleYes"]),i=n[0],a=void 0===i?"":i,r=n[1];s.setTextMessage(a),s.onHandleYes=r,s.runOpenAnimation()},s.handleClosePopup=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){s.scene.screen.close(s.name)}))},s.handleNo=function(){s.close()},s.handleYes=function(){s.onHandleYes&&s.onHandleYes(),s.close()},s.setVisible(!1),s.setDepth(u.Ks.POPUP),s.createPopup(),s.createPopupContent(),s.background.setAlpha(.5),s}(0,a.Z)(t,e);var n=t.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new x.Z(this.scene,0,0,343,404,{framePopupTop:R.POPUP_TOP_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createIconBulb(),this.createMessage(),this.createButtonCancel(),this.createButtonSkip(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonCancel,this.buttonSkip])},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:D,frame:R.BLANK});e.setWorldSize(153,26),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title,0,10);var t=new k.Z(this.scene,D,R.ICON_CLOSE,20,20);t.onClick=this.handleClosePopup,t.setName("Close"),Phaser.Display.Align.In.Center(t,this.title,145,t.height/2),this.title.add([e,t]),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createIconBulb=function(){var e=this.scene.make.image({key:h.Z.TUTORIAL.KEY,frame:h.Z.TUTORIAL.FRAME.BULB});e.setWorldSize(202,204),this.popup.add(e),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-20)},n.createButtonCancel=function(){this.buttonCancel=new k.Z(this.scene,D,R.BUTTON_MINOR_NORMAL,150,56),this.buttonCancel.setName("Cancel");var e=this.scene.make.image({key:D,frame:R.TEXT_CANCEL});e.setWorldSize(56,12),this.buttonCancel.add(e),Phaser.Display.Align.In.Center(e,this.buttonCancel),this.popup.add(this.buttonCancel),Phaser.Display.Align.In.Center(this.buttonCancel,this.popup,-80,139),this.buttonCancel.onClick=this.handleNo},n.createButtonSkip=function(){this.buttonSkip=new k.Z(this.scene,D,R.BUTTON_BLUE_NORMAL,150,56),this.buttonSkip.setName("Skip");var e=this.scene.make.image({key:D,frame:R.TEXT_SKIP});e.setWorldSize(34,12),this.buttonSkip.add(e),Phaser.Display.Align.In.Center(e,this.buttonSkip),this.popup.add(this.buttonSkip),Phaser.Display.Align.In.Center(this.buttonSkip,this.popup,80,139),this.buttonSkip.onClick=this.handleYes},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:v.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.messageText.setTint(3552586),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,63),this.messageText.setScale(0).setAlpha(0)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(e,t){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new c.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setTextMessage=function(e){this.messageText.setText(""+e)},n.runOpenAnimation=function(){this.scene.audio.playSound(_.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new I.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){this.contentShowUpAnimation||(this.contentShowUpAnimation=new w.Z({targets:this.contents.getChildren(),duration:t,delay:this.scene.tweens.stagger(80,{start:e}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},t}(GameCore.Screen),L=M,B=n(20402),N=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).loadingIcon=void 0,s.messageText=void 0,s.openAnimation=void 0,s.closeTimerEvent=void 0,s.addLoadingIcon(),s.addMessageText(),s.setDepth(u.Ks.PRIORITY),s.background.setAlpha(.8),s}(0,a.Z)(t,e);var n=t.prototype;return n.open=function(t){var n,i=this;e.prototype.open.call(this,t);var a=this.getData(["message","duration","loading"]),s=a[0],r=void 0===s?"":s,o=a[1],c=void 0===o?0:o,h=a[2],l=void 0!==h&&h;this.setMessage(r),this.showLoading(l),null==(n=this.closeTimerEvent)||n.remove(),c>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:c,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addLoadingIcon=function(){this.loadingIcon=new B.Z(this.scene),this.add(this.loadingIcon),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:this.scene.fontSize(50),font:v.Z.FONT_WEIGHT_500.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),this.add(this.messageText)},n.setMessage=function(e){this.messageText.setText(e)},n.showLoading=function(e){this.loadingIcon.setVisible(e);var t=!1===e?20:80;Phaser.Display.Align.In.Center(this.messageText,this.zone,0,t)},n.runOpenAnimation=function(){var e,t;null==(e=this.openAnimation)||e.stop(),null==(t=this.openAnimation)||t.remove(),this.openAnimation=new w.Z({targets:[this.messageText,this.loadingIcon],props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}}}}),this.openAnimation.play()},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},t}(GameCore.Screen),F=N,G=h.Z.DEFAULT,Z=G.KEY,U=G.FRAME,H=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,r()(t=[this]).call(t,a))||this).mask=void 0,n.fadeInAnim=void 0,n.fadeOutAnim=void 0,n.fpsMeter=void 0,n.memoryMeter=void 0,n.switchScene=function(e){n.currentScene.key!==e&&n.currentScene.switch(e)},n.runScene=function(e){n.currentScene.run(e)},n.emitGameEventStartScene=function(e){var t=e.scene.key;n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(t),n.game.events.emit(Phaser.Scenes.Events.START,t),(0,f.sw)("scene","Start scene: "+t)},n.emitGameEventSleepScene=function(e){var t=e.scene.scene.key;t!==l.Co.LOAD_SCENE&&(n.runMaskFadeInAnimation(),n.game.events.emit(Phaser.Scenes.Events.SLEEP,t))},n.emitGameEventWakeScene=function(e){var t=e.scene.scene.key;t!==l.Co.LOAD_SCENE&&(n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(t),n.game.events.emit(Phaser.Scenes.Events.WAKE,t))},n.emitGameEventPauseScene=function(e){var t=e.scene.scene.key;n.game.events.emit(Phaser.Scenes.Events.PAUSE,t)},n.emitGameEventResumeScene=function(e){var t=e.scene.key;n.game.events.emit(Phaser.Scenes.Events.RESUME,t)},n.emitGameEventShutdownScene=function(e){var t=e.scene.scene.key;n.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,t)},n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addAlertScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){var e=this.screen.add(u.o4.NOTIFY_SCREEN,F);Phaser.Display.Align.In.Center(e,this.gameZone)},n.addAlertScreen=function(){var e=this.screen.add(u.o4.ALERT_SCREEN,L);Phaser.Display.Align.In.Center(e,this.gameZone)},n.addMask=function(){this.mask=this.make.image({key:Z,frame:U.BLANK});var e=this.gameZone,t=e.width,n=e.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(0),this.mask.setWorldSize(t,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new T(this),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new P(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeInAnim=new o.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.In,props:{alpha:{start:0,from:0,to:.6}}}),this.mask.setAlpha(0),this.fadeInAnim.play())},n.runMaskFadeOutAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeOutAnim=new c.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.6,from:.6,to:0}}}),this.mask.setAlpha(1),this.fadeOutAnim.play())},n.listenScenesEvents=function(){var e=this;this.scene.manager.getScenes(!1).forEach((function(t){t.events.on(Phaser.Scenes.Events.CREATE,e.emitGameEventStartScene),t.events.on(Phaser.Scenes.Events.SLEEP,e.emitGameEventSleepScene),t.events.on(Phaser.Scenes.Events.WAKE,e.emitGameEventWakeScene),t.events.on(Phaser.Scenes.Events.PAUSE,e.emitGameEventPauseScene),t.events.on(Phaser.Scenes.Events.RESUME,e.emitGameEventResumeScene),t.events.on(Phaser.Scenes.Events.SHUTDOWN,e.emitGameEventShutdownScene)})),this.events.on(l.K5.SWITCH,this.switchScene),this.events.on(l.K5.RUN,this.runScene)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.getCurrentScene=function(){return this.currentScene},n.updateActiveSceneKey=function(e){e!==l.Co.GLOBAL_SCENE&&this.storage.dispatch((0,p.I)(e))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,i.Z)(t,[{key:"currentScene",get:function(){var e=this.storage.getState(),t=(0,d.$)(e);return(t?this.scene.manager.getScene(t):this.getActiveScene()).scene}}]),t}(m.Z),V=H},45211:function(e,t,n){"use strict";var i=n(93397),a=n(70268),s=n(73126),r=n(33938),o=n(41819),c=n(30222),h=n.n(c),l=n(61154),u=0,p=0,d=function(){function e(e){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=e}var t=e.prototype;return t.loadingProgressFbBootScene=function(){var e=this,t=100;p=30;!function n(){t<=0?clearTimeout(e.progressFbTimeEvent):e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(p)),p+=30/t,t--,n()}),50)}()},t.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},t.loadingProgressFbLoadScene=function(){var e=this;(!p||p<30)&&(p=60),u=p;!function t(){e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(p)),p+=.1,t()}),50)}()},t.onProgress=function(e){var t=100-p,n=Math.round(e*t+p);n>u&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},e}(),f=d,m=function(){function e(e){this.game=void 0,this.game=e}var t=e.prototype;return t.addKillRevive=function(){var e=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager].forEach((function(t){t.prototype.kill=e.kill,t.prototype.revive=e.revive}))},t.addKillReviveGroup=function(){Phaser.GameObjects.Group.prototype.killGroup=this.killGroup,Phaser.GameObjects.Group.prototype.reviveGroup=this.reviveGroup},t.addSetWorldSize=function(){var e=this;[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(t){t.prototype.setWorldSize=e.setWorldSize}))},t.addSetWorldSizeForContainer=function(){var e=this;[Phaser.GameObjects.Container].forEach((function(t){t.prototype.setWorldSize=e.setWorldSizeForContainer}))},t.addGetWorldPosition=function(){var e=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText].forEach((function(t){t.prototype.getWorldPosition=e.getWorldPosition}))},t.addDrawDebugBox=function(){var e=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(t){t.prototype.drawDebugBox=e.drawDebugBox}))},t.addHighQuality=function(){var e=this;[Phaser.GameObjects.Text].forEach((function(t){t.prototype.setHighQuality=e.setHighQuality}))},t.addSetLineHeightForBitmapText=function(){Phaser.GameObjects.BitmapText.prototype.setLineHeight=function(e){this.lineHeight=e,this.updateDisplayOrigin()}},t.kill=function(){this.setActive(!1),this.setVisible(!1)},t.revive=function(){this.setActive(!0),this.setVisible(!0)},t.killGroup=function(){this.getChildren().forEach((function(e){e.setActive(!1),e.setVisible(!1)}))},t.reviveGroup=function(){this.getChildren().forEach((function(e){e.setActive(!0),e.setVisible(!0)}))},t.setWorldSize=function(e,t){this.setSize(e,t),this.setDisplaySize(e,t)},t.setWorldSizeForContainer=function(e,t,n){void 0===n&&(n=2),this.setSize(e*n,t*n),this.setDisplaySize(e,t)},t.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},t.drawDebugBox=function(e,t){var n=this.x,i=this.y,a=this.width,s=this.height,r=this.depth,o=this.originX,c=this.originY,h=this.scene.add.rectangle(n,i,a,s,e,t);h.setName("Debug Box"),h.setDepth(r);var l=GameCore.Utils.Valid.isNumber;return l(o)&&l(c)&&h.setOrigin(o,c),h},t.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},e}(),g=m,v=n(39022),y=n.n(v),S=n(14418),E=n.n(S),A=n(97606),b=n.n(A),T={LOADED:"loaded",DISPLAYED:"displayed"},C=function(e){return e.IDLE="idle",e.LOADING="loading",e.FILLED="filled",e.SHOWING="showing",e}(C||{}),P=C,w=function(e){return e.REWARDED="rewarded",e.PRE_ROLL="pre-roll",e.MID_ROLL="mid-roll",e}(w||{}),I=w,k=n(42131),x=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).code=void 0,i.code=t,i.message=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),_=function(e){this.type=void 0,this.status=void 0,this.type=e,this.status=P.IDLE},O=GameCore.Configs.Ads.Mockup.GiphyApiKey,D=function(){function e(){}return e.loadBannerAdAsync=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r,o,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAdContentAsync();case 2:if(n=e.sent,i=document.getElementById(t.placementId),a=t.bannerHeight,s=t.bannerWidth,!i){e.next=13;break}if((r=i.getElementsByTagName("img"))&&!(r.length<=0)){e.next=10;break}return e.abrupt("return");case 10:r[0].src=n,e.next=30;break;case 13:(o=document.createElement("div")).id=t.placementId,o.style.bottom="var(--sab)",o.style.position="fixed",o.style.background="#fff url("+n+") center center/auto no-repeat",o.style.outline="2px solid #ffffff40",o.style.outlineOffset="-2px",o.style.zIndex="98",o.style.overflow="hidden","right"==t.position?(o.style.bottom="0px",o.style.right="0px",o.style.top="0px",o.style.height="100%",o.style.width=s+"px"):"left"==t.position?(o.style.bottom="0px",o.style.left="0px",o.style.top="0px",o.style.height="100%",o.style.width=s+"px"):"bottom"==t.position?(o.style.bottom="0px",o.style.top="",o.style.height=a+"px",o.style.width="100%"):"top"==t.position&&(o.style.top="0px",o.style.bottom="",o.style.height=a+"px",o.style.width="100%"),c=document.createElement("style"),(document.head||document.getElementsByTagName("head")[0]).appendChild(c),"@keyframes fake-gif {\n                0%,10% {\n                    background-position-y: top\n                }\n                60% {\n                    background-position-y: center\n                }\n                100% {\n                    background-position-y: bottom\n                }\n            }",c.appendChild(document.createTextNode("@keyframes fake-gif {\n                0%,10% {\n                    background-position-y: top\n                }\n                60% {\n                    background-position-y: center\n                }\n                100% {\n                    background-position-y: bottom\n                }\n            }")),o.style.animation="fake-gif 6s ease-in-out 0s infinite alternate both",document.body.appendChild(o);case 30:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e.getAdContentAsync=function(){var e=(0,r.Z)(h().mark((function e(){var t,n,i,a,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://api.giphy.com/v1/gifs/trending?api_key="+O+"&rate=pg&bundle=low_bandwidth",e.next=3,fetch(t,{method:"GET"});case 3:return n=e.sent,e.next=6,n.json();case 6:if(i=e.sent,GameCore.Utils.Valid.isObject(i)){e.next=9;break}return e.abrupt("return","");case 9:return a=i.data,s=Math.floor(Math.random()*a.length),e.abrupt("return",a[s].images.downsized.url);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.hideBannerAdAsync=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.getElementById(t)){e.next=3;break}return e.abrupt("return");case 3:n.remove();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e}(),R=function(){function e(e){this.config=void 0,this.isShowing=void 0,this.reloadBannerAdInterval=void 0,this.config=e,this.reloadBannerAdInterval=null}var t=e.prototype;return t.show=function(){var e=this;if(!this.isShowing){var t=this.config,n=t.placementId,i=t.secondsReload;if(i>0){if(this.reloadBannerAdInterval)return;return this.loadBannerAdAsync(n),void(this.reloadBannerAdInterval=setInterval((function(){e.loadBannerAdAsync(n)}),1e3*i))}this.loadBannerAdAsync(n)}},t.loadBannerAdAsync=function(){var e=(0,r.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!GameCore.Configs.Ads.Mockup.Enable){e.next=7;break}return e.next=5,D.loadBannerAdAsync(this.config);case 5:e.next=9;break;case 7:return e.next=9,GameSDK.loadBannerAdAsync(t,this.config);case 9:this.isShowing=!0,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),t.hideAsync=function(){var e=(0,r.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isShowing){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,t=GameCore.Configs.Ads,n=this.config.placementId,this.isShowing=!1,this.reloadBannerAdInterval&&(clearInterval(this.reloadBannerAdInterval),this.reloadBannerAdInterval=null),!t.Mockup.Enable){e.next=12;break}return e.next=10,D.hideBannerAdAsync(n);case 10:e.next=14;break;case 12:return e.next=14,GameSDK.hideBannerAdAsync(n);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2);case 19:case"end":return e.stop()}}),e,this,[[2,16]])})));return function(){return e.apply(this,arguments)}}(),e}();GameCore.Ads={Types:I,Status:P,Events:T,AdError:x,AdInstance:_};var M=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).events=void 0,n.enabled=void 0,n.config=void 0,n.lastInterAdShownTime=void 0,n.lastRewardAdShownTime=void 0,n.preRollAd=void 0,n.midRollAd=void 0,n.rewardedVideo=void 0,n.safeAreaBottom=void 0,n.showingBannerAd=void 0,n.reloadBannerAdIntervals=void 0,n.bannerAdConfig=void 0,n.isHaveBannerAdOptions=void 0,n.bannerAds=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.events=new Phaser.Events.EventEmitter,this.safeAreaBottom=0,this.lastInterAdShownTime=0,this.lastRewardAdShownTime=0,this.bannerAds=[]},n.calculateSafeAreaBottom=function(){try{if(!this.config.CalculateSafeAreaBottom)return;this.safeAreaBottom=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}},n.configure=function(e,t){this.enabled=t.Enabled,this.config=t,this.initBannerAd(),this.setAdInstance(e),this.calculateSafeAreaBottom()},n.setAdInstance=function(e){this.preRollAd=new e(I.PRE_ROLL,"pre-roll"),this.midRollAd=new e(I.MID_ROLL,"mid-roll"),this.rewardedVideo=new e(I.REWARDED,"rewarded")},n.preloadPreRollAdAsync=function(){return this.preloadAdAsync(I.PRE_ROLL)},n.showPreRollAdAsync=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowInterstitialAd()){e.next=2;break}throw new x("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return e.next=4,this.showAdAsync(I.PRE_ROLL);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadMidRollAdAsync=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(I.MID_ROLL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showMidRollAdAsync=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowInterstitialAd()){e.next=2;break}throw new x("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return e.next=4,this.showAdAsync(I.MID_ROLL);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadRewardedVideoAsync=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(I.REWARDED);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowRewardAd()){e.next=2;break}throw new x("REWARDED_VIDEO_CAN_NOT_SHOW","Can't show rewarded video");case 2:return e.next=4,this.showAdAsync(I.REWARDED);case 4:this.lastRewardAdShownTime=window.performance.now()/1e3;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getRemainingRewardTime=function(){var e=window.performance.now()/1e3,t=this.config.RewardAdOptions.secondsBetweenAds,n=e-this.lastRewardAdShownTime;return n<t?t-n:0},n.preloadAdAsync=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new x("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(t))){e.next=5;break}throw new x("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 5:return e.next=7,n.loadAsync();case 7:this.events.emit(T.LOADED,t);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.showAdAsync=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new x("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(t))){e.next=5;break}throw new x("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 5:return t!==I.PRE_ROLL&&t!==I.MID_ROLL||(this.lastInterAdShownTime=window.performance.now()/1e3),t===I.REWARDED&&(this.lastRewardAdShownTime=window.performance.now()/1e3,this.config.EnableRewardVideoResetInterstitial&&(this.lastInterAdShownTime=this.lastRewardAdShownTime)),e.next=9,n.showAsync();case 9:this.events.emit(T.DISPLAYED,t);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getAdStatus=function(e){var t=this.getAdInstanceByType(e);return t?t.getStatus():null},n.getAdInstanceByType=function(e){switch(e){case I.PRE_ROLL:return this.preRollAd;case I.MID_ROLL:return this.midRollAd;case I.REWARDED:return this.rewardedVideo;default:return null}},n.canbeShowInterstitialAd=function(){return this.canbeShowInterstitialAdByTime()},n.canbeShowInterstitialAdByTime=function(){var e=window.performance.now()/1e3,t=this.config.InterstitialAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=Math.floor(e-this.lastInterAdShownTime);return this.lastInterAdShownTime>0?a>=i:a>=n},n.canbeShowRewardAd=function(){var e=window.performance.now()/1e3,t=this.config.RewardAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=Math.floor(e-this.lastRewardAdShownTime);return this.lastRewardAdShownTime>0?a>=i:a>=n},n.initBannerAd=function(){for(var e=this.config.BannerAdOptions,t=GameCore.Utils.Device.isDesktop(),n=0;n<e.length;n++){var i=e[n],a=i.platform;("ALL"==a||"DESKTOP"==a&&t||"MOBILE"==a&&!t)&&this.bannerAds.push(new R(i))}return this.bannerAds.length>0},n.isEnoughSpaceToShowBannerAds=function(e){var t=this.game.world.getScreenWidth(),n=this.game.world.getScreenHeight(),i=this.game.world.getPixelRatio(),a=this.game.canvas,s=a.width,r=a.height;s/=i,r/=i;var o=this.game.world.getDefaultRatio();if("left"==e.position||"right"==e.position){var c=e.bannerWidth||120;return!(n<(e.bannerHeight||600))&&(t-s)/2>c}var h=e.bannerHeight||90;return!(e.bannerWidth&&t<e.bannerWidth)&&((n-r)/2>h||s/(r-e.bannerHeight+50)<o)},n.showBannerAdAsync=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:n=0;case 3:if(!(n<this.bannerAds.length)){e.next=11;break}if(void 0==t){e.next=7;break}if(this.bannerAds[n].config.placementId==t){e.next=7;break}return e.abrupt("continue",8);case 7:this.bannerAds[n].show();case 8:n++,e.next=3;break;case 11:return e.abrupt("return");case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideBannerAdAsync=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:n=0;case 3:if(!(n<this.bannerAds.length)){e.next=11;break}if(void 0==t){e.next=7;break}if(this.bannerAds[n].config.placementId==t){e.next=7;break}return e.abrupt("continue",8);case 7:this.bannerAds[n].hideAsync();case 8:n++,e.next=3;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getBannerHeight=function(){var e;if(!this.enabled)return 0;var t=E()(e=this.bannerAds).call(e,(function(e){return"bottom"==e.config.position})),n=0;t.length>0&&(n=Math.max.apply(Math,b()(t).call(t,(function(e){return e.config.bannerHeight}))));var i=n+this.safeAreaBottom;if(this.game.world){var a=this.game.world,s=a.getPixelRatio(),r=a.getZoomRatio();return this.game.world.getPhysicPixels(i,s/r)}return i},t}(Phaser.Plugins.BasePlugin),L=M,B=function(){function e(e,t,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=e,this.color=n||"#FFF",this.options=t,this.selfLog=!0}var t=e.prototype;return t.event=function(e,t,n){this.processEvent(e,t,n),this.selfLog},t.pageview=function(e){var t=this.getPageByKey(e);this.processPageView(t),this.selfLog},t.levelStart=function(e,t,n){this.processLevelStart(e,t,n),this.selfLog},t.levelFail=function(e,t,n){this.processLevelFail(e,t,n),this.selfLog},t.levelRescue=function(e,t,n){this.processLevelRescue(e,t,n),this.selfLog},t.levelComplete=function(e,t,n){this.processLevelComplete(e,t,n),this.selfLog},t.showInterstitialAd=function(e){this.processShowInterstitialAd(e),this.selfLog},t.showRewardedVideoAd=function(e){this.processShowRewardedVideoAd(e),this.selfLog},t.receiveReward=function(e){this.processReceiveReward(e),this.selfLog},t.showAdFail=function(e,t,n){this.processShowAdFail(e,t,n),this.selfLog},t.getPageByKey=function(e){var t=e.replace(/_/g,"-");return t=t.toLowerCase()},t.processLevelStart=function(e,t,n){},t.processLevelFail=function(e,t,n){},t.processLevelRescue=function(e,t,n){},t.processLevelComplete=function(e,t,n){},t.processShowInterstitialAd=function(e){},t.processShowRewardedVideoAd=function(e){},t.processReceiveReward=function(e){},t.processShowAdFail=function(e,t,n){},e}();GameCore.Analytics={BaseAnalytics:B};var N=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).analytics=void 0,n.pageview=function(e){n.isActive()&&n.analytics.forEach((function(t){t.pageview(e)}))},n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.analytics=[]},n.add=function(e){this.analytics.push(e)},n.event=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.event(e,t,n)}))},n.levelStart=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelStart(e,t,n)}))},n.levelRescue=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelRescue(e,t,n)}))},n.levelFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(e,t,n)}))},n.levelComplete=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(e,t,n)}))},n.showInterstitialAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showInterstitialAd(e)}))},n.showRewardedVideoAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showRewardedVideoAd(e)}))},n.receiveReward=function(e){this.isActive()&&this.analytics.forEach((function(t){t.receiveReward(e)}))},n.showAdFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.showAdFail(e,t,n)}))},n.isActive=function(){return this.analytics.length>=1},t}(Phaser.Plugins.BasePlugin),F=N,G=function(){function e(e,t,n){var i=this;this.name=void 0,this.game=void 0,this.isSprite=void 0,this.audio=void 0,this.markers=void 0,this.volume=void 0,this.isMusicEnabled=function(){return!!i.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!i.game.player.getPlayerSetting("sound")},this.name=t,this.game=e,this.markers={},this.isSprite=n,this.isSprite||(this.audio=this.game.sound.add(this.name))}var t=e.prototype;return t.play=function(e,t){var n,i,a,r=(0,s.Z)({volume:this.volume},t||{});if(r.volume!==this.volume&&(r.volume*=this.volume),!this.isSprite)return(null==(i=this.audio)?void 0:i.seek)>0?void this.audio.resume():void(null==(a=this.audio)||a.play(e,r));this.createMaker(e),null==(n=this.markers[e])||n.play(e,r)},t.pause=function(e){var t,n;this.isSprite?null==(t=this.markers[e])||t.pause():null==(n=this.audio)||n.pause()},t.stop=function(e){var t,n;this.isSprite?null==(t=this.markers[e])||t.stop():null==(n=this.audio)||n.stop()},t.setVolume=function(e){this.volume=e},t.createMaker=function(e){if(!this.markers[e])try{this.markers[e]=this.game.sound.addAudioSprite(this.name)}catch(t){}},e}(),Z=G,U=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).soundManager=void 0,n.musicManager=void 0,n.isMuteAll=void 0,n.initMusic=function(e){n.musicManager=new Z(n.game,e,!1),n.setMusicVolume(1)},n.initSound=function(e){n.soundManager=new Z(n.game,e,!0),n.setSoundVolume(1)},n}(0,o.Z)(t,e);var n=t.prototype;return n.playSound=function(e,t){try{if(!this.soundManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(e,t)}catch(n){}},n.stopSound=function(e){try{this.soundManager.stop(e)}catch(t){}},n.playMusic=function(e){void 0===e&&(e={});try{if(!this.musicManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play("",(0,s.Z)({loop:!0,volume:.2},e))}catch(t){}},n.pauseMusic=function(){try{if(!this.musicManager)return;this.musicManager.pause("")}catch(e){}},n.stopMusic=function(){try{if(!this.musicManager)return;this.musicManager.stop("")}catch(e){}},n.setSoundVolume=function(e){try{if(!this.soundManager)return;this.soundManager.setVolume(e)}catch(t){}},n.setMusicVolume=function(e){try{if(!this.musicManager)return;this.musicManager.setVolume(e)}catch(t){}},n.muteAll=function(){this.isMuteAll=!0,this.game.sound.mute=!0},n.unmuteAll=function(){this.isMuteAll=!1,this.game.sound.mute=!1},t}(Phaser.Plugins.BasePlugin),H=U,V=n(41884),W="AUTH_TOKEN_REQUEST",Y="AUTH_TOKEN_RECEIVED",z=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="RequestTokenFail",i.message=t||"Request token fail",i.payload=n||{},i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),K=n(20573),j="auth",X=(0,K.P1)([function(e){return e[j].token}],(function(e){return e})),q=(0,K.P1)([function(e){return e[j].isRequesting}],(function(e){return e})),J=function(e){return{type:Y,payload:{token:e}}},Q=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.requestToken=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=window.game.facebook,s=n(),r=X(s),!q(s)&&""===r){e.next=7;break}return e.abrupt("return");case 7:return t({type:W,payload:{}}),e.next=10,a.getPlayerToken();case 10:o=e.sent,t(J(o)),e.next=25;break;case 14:if(e.prev=14,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=19;break}if("PENDING_REQUEST"!==e.t0.code){e.next=19;break}return e.abrupt("return");case 19:if(t(J("")),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"message"))){e.next=24;break}if("string"!==typeof e.t0.message){e.next=24;break}return(0,i.tO)(new Error(e.t0.message)),e.abrupt("return");case 24:(0,i.tO)(new z);case 25:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getToken=function(){return X(this.state)},(0,V.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),$=Q,ee=n(28222),te=n.n(ee),ne=n(6226),ie=n.n(ne),ae=function(e,t){void 0===t&&(t=1);var n=new Image;n.onload=function(){var e,n;e=this.width*t,n=this.height*t,Math.floor(n/2),Math.floor(e/2)},n.src=e},se=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).width=void 0,n.height=void 0,n.renderOptions=void 0,n.canvas=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(e){return false;var t=this,n=te()(e);n.length<1||(n.forEach((function(n){t.scene.load.image(n,e[n])})),this.scene.load.start())},n.capture=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.width,i=t.height,a=t.renderOptions,this.width=n,this.height=i,this.renderOptions=a,this.createCanvas(),e.next=7,this.loadImages();case 7:return this.drawObjects(),e.abrupt("return",this.snapshotFrame());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var e=this;return new(ie())((function(t,n){for(var i in e.renderOptions){var a=e.renderOptions[i],s=a.name,r=a.image;if(r)e.scene.textures.get(s).key!==s&&e.scene.load.image(s,r)}e.scene.load.on(Phaser.Loader.Events.COMPLETE,t),e.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(){var e=new Error("Load image failed");n(e)})),e.scene.load.start()}))},n.drawObjects=function(){for(var e in this.renderOptions){var t=this.renderOptions[e];switch(t.type){case"text":this.drawText(t);break;case"image":this.drawImage(t)}}},n.drawText=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.font,s=e.text,r=e.fillStyle,o=e.lineWidth,c=e.textAlign;t.font=a+' nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',t.fillStyle=r||"#ffffff",o&&(t.lineWidth=o),c&&(t.textAlign=c),t.fillText(s,n,i)},n.drawImage=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.name,s=e.frame,r=e.width,o=e.height,c=e.fallbackWithImage,h=this.scene.textures.get(a),l=h.getSourceImage(s);"__MISSING"===h.key&&c&&(l=(h=this.scene.textures.get(c)).getSourceImage()),t.drawImage(l,n,i,r,o)},n.snapshotFrame=function(){var e=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&ae(e),e},t}(Phaser.Plugins.ScenePlugin),re=se,oe=n(58118),ce=n.n(oe),he=function(e){function t(t,n,i){var a;return(a=e.call(this)||this).game=void 0,a.options=void 0,a.performance=void 0,a.isRunning=!1,a.checkTimer=void 0,a.fpsHistory=void 0,a.start=function(){if(!a.isRunning){a.isRunning=!0;var e=a.options.checkInterval;a.checkTimer=e,a.fpsHistory=[],a.game.events.on(Phaser.Core.Events.POST_STEP,a.onPostStep)}},a.stop=function(){a.isRunning&&(a.isRunning=!1,a.game.events.off(Phaser.Core.Events.POST_STEP,a.onPostStep),a.options.onlyUpdateWhenSwitchScene&&a.checkFps())},a.onPostStep=function(e,t){if(a.checkTimer-=t,!(a.checkTimer>0)){var n=a.options,i=n.checkInterval,s=n.onlyUpdateWhenSwitchScene;a.checkTimer+=i,a.fpsHistory.push(a.game.loop.actualFps),!1===s&&a.fpsHistory.length>=5&&a.checkFps()}},a.game=t,a.options=i,a.performance=n,a}(0,o.Z)(t,e);var n=t.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var e=this.options.autoUpgradeQuality,t=!1;this.isLowFps()?t=this.performance.downgradeGraphicsQuality():e&&this.isHighFps()&&(t=this.performance.upgradeGraphicsQuality()),t&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},t}(Phaser.Events.EventEmitter),le=he,ue=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],pe=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).fpsTracker=void 0,n.pixelRatio=void 0,n.minQuality=void 0,n.maxQuality=void 0,n.qualityAdjustStep=void 0,n.trackingSceneKeys=[],n.trackingScene=function(e){var t;if(ce()(t=n.trackingSceneKeys).call(t,e)){var i=n.game.scene.getScene(e);i.events.once(Phaser.Scenes.Events.UPDATE,n.fpsTracker.start),i.events.once(Phaser.Scenes.Events.SLEEP,n.fpsTracker.stop)}},n}(0,o.Z)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.pixelRatio,n=e.minQuality,i=e.maxQuality,s=e.qualityAdjustStep,r=e.trackingSceneKeys,o=(0,a.Z)(e,ue);this.pixelRatio=t,this.minQuality=n,this.maxQuality=i,this.qualityAdjustStep=s,this.trackingSceneKeys=r,this.fpsTracker=new le(this.game,this,o)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e<=this.minQuality)return!1;var t=+(e-this.qualityAdjustStep).toFixed(2);return!(t<this.minQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),!0)},n.upgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e>=this.maxQuality)return!1;var t=+(e+this.qualityAdjustStep).toFixed(2);return!(t>this.maxQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),!0)},t}(Phaser.Plugins.BasePlugin),de=pe,fe={sound:!0,music:!0,vibrate:!0,language:"en",theme:GameCore.Configs.DefaultTheme},me=fe.sound,ge=fe.music,ve=fe.vibrate,ye=fe.language,Se=fe.theme,Ee=function(){function e(e){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.language=void 0,this.theme=void 0;var t=e||{},n=t.sound,i=t.music,a=t.vibrate,s=t.language,r=t.theme;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:me,this.music=GameCore.Utils.Valid.isBoolean(i)?i:ge,this.vibrate=GameCore.Utils.Valid.isBoolean(a)?a:ve,this.language=GameCore.Utils.Valid.isString(s)?s:ye,this.theme=GameCore.Utils.Valid.isString(r)?r:Se}return e.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,language:this.language,theme:this.theme}},e}(),Ae=Ee,be=GameCore.Utils,Te=be.Valid,Ce=be.Object,Pe=function(){function e(e){this.score=void 0,this.settings=void 0,this.gameData=void 0,this.userGuideDisplays=void 0,this.setupDefaultData(),this.updateScore(e),this.updateSettings(e),this.updateGameData(e),this.updateUserGuideDisplays(e)}var t=e.prototype;return t.setupDefaultData=function(){this.score=0,this.settings=(0,s.Z)({},fe),this.gameData={coins:0,diamond:0,lastReceiveGift:0,dailyRewarded:{lastRewarded:0,logDays:[]},dailyTasks:{startedTime:0,logTasks:{}}},this.userGuideDisplays=0},t.updateScore=function(e){var t=e.score;!1!==Te.isNumber(t)&&(this.score=t)},t.updateSettings=function(e){var t=e.settings;if(!1!==Te.isObject(t)){var n=new Ae(t).toObject();this.settings=n}},t.updateGameData=function(e){var t=e.gameData;if(!1!==Te.isObject(t)){if(Ce.hasOwn(t,"coins")&&Te.isNumber(t.coins)&&(this.gameData.coins=t.coins),Ce.hasOwn(t,"diamond")&&Te.isNumber(t.diamond)&&(this.gameData.diamond=t.diamond),Ce.hasOwn(t,"lastReceiveGift")&&Te.isNumber(t.lastReceiveGift)&&(this.gameData.lastReceiveGift=t.lastReceiveGift),Ce.hasOwn(t,"dailyRewarded")&&Te.isObject(t.dailyRewarded)){var n=t.dailyRewarded;Ce.hasOwn(n,"lastRewarded")&&Te.isNumber(n.lastRewarded)&&(this.gameData.dailyRewarded.lastRewarded=n.lastRewarded),Ce.hasOwn(n,"logDays")&&Array.isArray(n.logDays)&&(this.gameData.dailyRewarded.logDays=n.logDays)}if(Ce.hasOwn(t,"dailyTasks")&&Te.isObject(t.dailyTasks)){var i=t.dailyTasks;Ce.hasOwn(i,"startedTime")&&Te.isNumber(i.startedTime)&&(this.gameData.dailyTasks.startedTime=i.startedTime),Ce.hasOwn(i,"logTasks")&&Te.isObject(i.logTasks)&&(this.gameData.dailyTasks.logTasks=i.logTasks)}}},t.updateUserGuideDisplays=function(e){var t=e.userGuideDisplays;!1!==Te.isNumber(t)&&(this.userGuideDisplays=t)},t.toObject=function(){return{score:this.score,settings:this.settings,gameData:this.gameData,userGuideDisplays:this.userGuideDisplays}},t.convertToPlayerData=function(){var e=this.gameData,t=e.coins,n=e.diamond,i=e.dailyTasks,a=e.dailyRewarded,s=e.lastReceiveGift;return{score:this.score,settings:this.settings,customFields:{coins:t,diamond:n,dailyTasks:i,dailyRewarded:a,lastReceiveGift:s},userGuideDisplays:this.userGuideDisplays}},t.convertToFacebookData=function(e){var t=e.score,n=e.settings,i=e.customFields,a=e.userGuideDisplays;return this.updateScore({score:t}),this.updateSettings({settings:n}),this.updateGameData({gameData:i}),this.updateUserGuideDisplays({userGuideDisplays:a}),this.toObject()},e}(),we=(GameCore.Configs.ApiHost,function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ie=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ke="PLAYER_RECEIVED",xe="PLAYER_DATA_UPDATE",_e="PLAYER_SCORE_UPDATE",Oe="PLAYER_PROFILE_UPDATE",De="PLAYER_SETTING_UPDATE",Re="PLAYER_CONNECTED_PLAYERS_UPDATE",Me=n(46352),Le=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=t||"The name of player data is not supported",i.payload=n||{},i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),Be=n(24278),Ne=n.n(Be),Fe="player",Ge=(0,K.P1)([function(e){return e[Fe]}],(function(e){return e})),Ze=(0,K.P1)([Ge],(function(e){return e.playerId})),Ue=(0,K.P1)([Ge],(function(e){return e.ASID})),He=(0,K.P1)([function(e){return e[Fe].data}],(function(e){return e})),Ve=((0,K.P1)([He],(function(e){return e.settings})),(0,K.P1)([function(e){return e[Fe].connectedPlayers}],(function(e){return e}))),We=(0,K.P1)([Ve,function(e,t){return t.limit},function(e,t){return t.offset}],(function(e,t,n){if("number"!==typeof t)return[];if("number"!==typeof n)return[];var i=te()(e);return Ne()(i).call(i,n,t+n)||[]})),Ye=(0,K.P1)([He],(function(e){return e.score})),ze=(0,K.P1)([He],(function(e){return e.customFields})),Ke=GameCore.Configs,je=Ke.AppId,Xe=Ke.Tutorial,qe=function(e,t){return function(n){var i=e.playerId,a=e.name,s=e.photo,r=e.locale;n({type:ke,payload:{playerId:i,name:a,photo:s,locale:r,data:t||{}}})}},Je=function(e){return{type:Re,payload:{connectedPlayers:e}}},Qe=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(a,s){var r,o,c;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a({type:De,payload:{name:e,value:t}});case 3:r=s(),o=He(r),c=new Pe({}).convertToFacebookData(o),FBInstant.player.setDataAsync(c),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),(0,i.tO)(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}()},$e=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(a,s){var r,o,c,l,u;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o={customFields:(r={},r[e]=t,r)},n.next=4,a(tt(o));case 4:c=s(),l=He(c),u=new Pe({}).convertToFacebookData(l),FBInstant.player.setDataAsync(u),n.next=15;break;case 10:if(n.prev=10,n.t0=n.catch(0),!(n.t0 instanceof Le)){n.next=14;break}return n.abrupt("return");case 14:(0,i.tO)(n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e,t){return n.apply(this,arguments)}}()},et=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n,a){var s,r,o,c;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s={customFields:e},t.next=4,n(tt(s));case 4:r=a(),o=He(r),c=new Pe({}).convertToFacebookData(o),FBInstant.player.setDataAsync(c),t.next=16;break;case 10:if(t.prev=10,t.t0=t.catch(0),!(t.t0 instanceof Le)){t.next=15;break}return t.abrupt("return");case 15:(0,i.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},tt=function(e){return{type:xe,payload:{data:e}}},nt=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n,a){var s,r,o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({type:_e,payload:{score:e}});case 3:we({score:e}),s=a(),r=He(s),o=new Pe({}).convertToFacebookData(r),FBInstant.player.setDataAsync(o),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,i.tO)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},it=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.incUserGuideDisplays=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!Xe.ForceUseTutorial){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t(tt({userGuideDisplays:1}));case 5:a=n(),s=Ze(a),r=He(a),o=new Pe({}).convertToFacebookData(r),FBInstant.player.setDataAsync(o),Ie(s),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,i.tO)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=(0,r.Z)(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(qe(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o,c,l,u,p;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n(),s=Ge(a),r=s.playerId,o=s.name,c=s.photo,l=s.locale,e.next=6,FBInstant.player.getASIDAsync();case 6:return u=e.sent,p={appId:je,playerId:r,name:o,photo:c,locale:l,ASID:u},e.next=10,t({type:Oe,payload:{profile:p}});case 10:return e.next=12,we(p);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,i.tO)(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setBestScore=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(nt(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setSetting=function(){var e=(0,r.Z)(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(Qe(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setCustomData=function(){var e=(0,r.Z)(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch($e(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setMultiCustomData=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(et(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestConnectedPlayers=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t){var n,a,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=window.game.facebook,e.next=4,new(ie())((function(e,t){a.once("players",(function(t){e(t)})),a.once("playersfail",(function(){return t([])})),a.getPlayers()}));case 4:if(s=e.sent,r=function(e){return!!e},o=E()(n=b()(s).call(s,(function(e){var t=e.getID(),n=e.getName(),i=e.getPhoto();return t&&n&&i?new Me.Z(t,n,i).toObject():null}))).call(n,r),!(o.length<1)){e.next=9;break}return e.abrupt("return");case 9:t(Je(o)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,i.tO)(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Je(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getPlayer=function(){return Ge(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerASID=function(){return Ue(this.state)},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(e){var t=this.getPlayerSettings();return"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:GameCore.Utils.Object.hasOwn(fe,e)?fe[e]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.getPlayer().isUserNew},n.getDiamond=function(){var e=this.getCustomData("diamond");return GameCore.Utils.Valid.isNumber(e)?e:0},n.getBestScore=function(){return Ye(this.state)},n.getCustomData=function(e){var t=ze(this.state);return GameCore.Utils.Valid.isObject(t)&&GameCore.Utils.Object.hasOwn(t,e)?t[e]:null},n.getConnectedPlayers=function(){return Ve(this.state)},n.getConnectedPlayerIds=function(e,t){return We(this.state,{limit:e,offset:t})},(0,V.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),at=it,st=n(35627),rt=n.n(st),ot=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="BadRequest",i.message=t||"This request is bad",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),ct=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="RequestTimeout",i.message=t||"This request is timeout",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),ht=n(39482),lt=GameCore.Configs,ut=lt.AppId,pt=lt.Network,dt=function(e){if(!e.ok)throw new ot(null,{response:e})},ft=function(){var e=window.game.auth.getToken();return{token:e,timeout:pt.Timeout,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}},mt=function(e,t,n,i){return(0,r.Z)(h().mark((function a(){var s,r,o,c,l;return h().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s=e+"/apps/"+ut+"/"+t,r=new AbortController,n.signal=r.signal,o=setTimeout((function(){r.abort()}),n.timeout),GameCore.Utils.Valid.isObject(i)&&(n.body=rt()(i)),a.next=8,fetch(s,n);case 8:return c=a.sent,clearTimeout(o),dt(c),a.next=13,c.json();case 13:if(a.t0=a.sent,a.t0){a.next=16;break}a.t0={};case 16:return l=a.t0,a.abrupt("return",l);case 20:if(a.prev=20,a.t1=a.catch(0),!(a.t1 instanceof ot)){a.next=24;break}return a.abrupt("return",null);case 24:if(!(a.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(a.t1,"name"))){a.next=27;break}if("AbortError"!==a.t1.name){a.next=27;break}throw new ct(null);case 27:throw a.t1;case 28:case"end":return a.stop()}}),a,null,[[0,20]])})))},gt=function(){var e=(0,r.Z)(h().mark((function e(t,n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t());case 4:if(e.prev=4,e.t0=e.catch(0),!(e.t0 instanceof ct&&n>0)){e.next=18;break}return e.prev=7,e.next=10,(0,ht.qZ)(600);case 10:return e.next=12,gt(t,n-1);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t1=e.catch(7),e.abrupt("return",{});case 18:if(!(e.t0 instanceof ct)){e.next=20;break}return e.abrupt("return",{});case 20:return e.abrupt("return",{});case 22:case"end":return e.stop()}}),e,null,[[0,4],[7,15]])})));return function(t,n){return e.apply(this,arguments)}}(),vt=function(){var e=(0,r.Z)(h().mark((function e(t,n,i,a){var r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),void 0===a&&(a=pt.Retries),e.prev=2,r=(0,s.Z)({},ft(),n,{method:"GET"}),o=mt(i,t,r),e.next=7,gt(o,a);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a){return e.apply(this,arguments)}}(),yt=function(){var e=(0,r.Z)(h().mark((function e(t,n,i,a,r){var o,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i={}),void 0===r&&(r=pt.Retries),e.prev=2,o=(0,s.Z)({},ft(),i,{method:"POST"}),c=mt(a,t,o,n),e.next=7,gt(c,r);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a,s){return e.apply(this,arguments)}}(),St=GameCore.Configs.ApiHost,Et=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,vt("players?"+n,{},St);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),At="PROFILES_DATA_UPDATE",bt="profile",Tt=(0,K.P1)([function(e){return e[bt].data}],(function(e){return e})),Ct=(0,K.P1)([function(e){return e[bt].profileIds}],(function(e){return e})),Pt=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n,a){var s,r,o,c;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s=a(),r=Ct(s),!((o=GameCore.Utils.Array.difference(e,r)).length<1)){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,Et({playerIds:o});case 8:c=t.sent,n({type:At,payload:{data:c}}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),(0,i.tO)(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,n){return t.apply(this,arguments)}}()},wt=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.requestProfiles=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Pt(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getProfiles=function(){return Tt(this.state)},(0,V.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),It=wt,kt=n(11882),xt=n.n(kt),_t=n(57662),Ot=n.n(_t),Dt=["player","match"],Rt="null",Mt=GameCore.Configs.Rollbar,Lt=Mt.UseMockup,Bt=Mt.FilterError,Nt=Mt.ListPlayerDevIds,Ft=function(e){function t(){for(var t,n,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(n=e.call.apply(e,y()(t=[this]).call(t,s))||this).enable=void 0,n.rollbar=void 0,n.events=[],n.beforeSend=function(e,t,i){Lt&&n.showPopupError(i)},n.checkIgnore=function(e,t,i){try{return!!n.isErrorIgnore(t)}catch(a){return!1}},n.showPopupError=function(e){var t,i,a,s,r,o=null==e||null==(t=e.body)||null==(i=t.trace)?void 0:i.exception;o&&n.events.push(o);var c=(null==e||null==(a=e.body)||null==(s=a.trace)?void 0:s.frames)||[];(r=n.events).push.apply(r,c);var h=document.getElementById("popup-error");h||((h=document.createElement("div")).id="popup-error",document.body.appendChild(h)),h.innerHTML='<div style="color: #fff; display: flex; flex-flow: column; align-items: center; ">\n      <pre id="json" style="overflow: auto; background-color: rgb(195 112 97 / 80%); padding: 10px; max-height: 80vh; max-width: 90vw; border: 5px solid #545454;">'+rt()(n.events,null,2)+'</pre>\n      <button id="close" style="cursor: pointer; padding: 10px 20px; border-radius: 100px;">Close</button>\n      </div>',h.style="top: 0px; z-index: 10000; width: 100vw; max-height: 100vh; position: absolute; display: flex; align-items: center; justify-content: center;";var l=document.getElementById("close");l&&(l.onclick=n.closePopup)},n.closePopup=function(){n.events=[{}];var e=document.getElementById("popup-error");null==e||e.remove()},n.isNoneErrorEvent=function(e){if(!e||0===e.length)return!1;if(!e[0].message)return!1;return"Non-Error promise rejection captured with keys: code, message"===e[0].message},n.isErrorIgnore=function(e){if(!e||0===e.length)return!1;var t=!1,i=e[0];return i instanceof Object&&(t=n.isIgnoreByCode(i)||n.isIgnoreByMessage(i)),t},n.isIgnoreByCode=function(e){if(GameCore.Utils.Object.hasOwn(e,"code")){var t=e.code,n=Bt.Codes,i=n.accepted,a=n.ignored;if("string"===typeof t){if(xt()(i).call(i,t)>=0)return!1;if(xt()(a).call(a,t)>=0)return!0}}else if(GameCore.Utils.Object.hasOwn(e,"name")){var s=e.name,r=Bt.Codes,o=r.accepted,c=r.ignored;if("string"===typeof s){if(xt()(o).call(o,s)>=0)return!1;if(xt()(c).call(c,s)>=0)return!0}}return!1},n.isIgnoreByMessage=function(e){if(GameCore.Utils.Object.hasOwn(e,"message")){var t=e.message,n=Bt.Messages,i=n.accepted,a=n.ignored;if("string"===typeof t){if(xt()(i).call(i,t)>=0)return!1;if(xt()(a).call(a,t)>=0)return!0}}return!1},n.addExtraState=function(){try{if(!GameCore.Utils.Object.hasOwn(window,"game"))return;if(!GameCore.Utils.Object.hasOwn(window.game,"storage"))return;if(!GameCore.Utils.Object.hasOwn(window.game.storage,"getState"))return;var e=(0,window.game.storage.getState)()||{},t=e.player,i=e.match,s=(0,a.Z)(e,Dt);n.rollbar.configure({payload:{player:t,match:i,other:s}})}catch(r){}},n}(0,o.Z)(t,e);var n=t.prototype;return n.setup=function(){this.rollbar=new(Ot())({accessToken:Rt,checkIgnore:this.checkIgnore,onSendCallback:this.beforeSend,captureUncaught:!0,scrubTelemetryInputs:!0,captureUnhandledRejections:!0,autoInstrument:{dom:!1,navigation:!1},payload:{environment:"production",client:{javascript:{code_version:"5"}},server:{root:"webpack:///./",branch:"master"}}}),this.enable=!0,this.sendTestException()},n.configure=function(e){this.rollbar&&this.rollbar.configure(e)},n.sendTestException=function(){var e=this.game.facebook.getPlayerID();ce()(Nt).call(Nt,e)&&this.rollbar.debug(new Error("Test rollbar"),{playerID:e})},n.sendException=function(e,t){e&&this.enable&&this.rollbar&&(this.addExtraState(),this.rollbar.error(e,t))},t}(Phaser.Plugins.BasePlugin),Gt=Ft,Zt=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.emit=function(t,n){return e.prototype.emit.call(this,t,n)},t}(Phaser.Events.EventEmitter),Ut=Zt,Ht=n(71944),Vt=function(e){function t(t,n,i,a){var s;(s=e.call(this,t)||this).zone=void 0,s.background=void 0,s.setName(n),s.setVisible(!1);var r=s.scene.world.getWorldSize(),o=r.width,c=r.height;return s.setSize(i||o,a||c),s.addZone(),s.addBackground(),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(e){GameCore.Utils.Valid.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.setBlockInputOutsideEnabled(!0),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logPageviewOnOpen(),this.logEventOpen())},n.close=function(){this.setBlockInputOutsideEnabled(!1),this.visible&&(this.setVisible(!1),this.logPageviewOnClose())},n.incY=function(e){this.y+=e,this.background.y-=e},n.incX=function(e){this.x+=e,this.background.x-=e},n.incScale=function(e){this.scale+=e,this.background.scale-=e^e*(100/e)},n.setBlockInputOutsideEnabled=function(e){this.scene.input.setTopOnly(e)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){var e="screen-background";if(!this.scene.textures.exists(e)){var t=this.width+2,n=this.height+2,i=this.scene.add.graphics();i.fillStyle(0,1),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}this.background=this.scene.add.image(0,0,e),this.background.setInteractive(),this.add(this.background)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(Ht._.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},t}(Phaser.GameObjects.Container),Wt=Vt,Yt={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=Wt,GameCore.Screens={Events:Yt};var zt=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).events=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.boot=function(){this.events=new Ut,this.registryScreenFactory()},n.get=function(e){var t=this.scene.children.getByName(e);return null===t?null:t},n.add=function(e,t,n,i){var a=this.get(e);return a||(a=this.scene.add.screen(e,t,n,i),this.events.emit(GameCore.Screens.Events.CREATED,a),a)},n.open=function(e,t){var n=this.get(e);return!!n&&(n.open(t),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),!0)},n.close=function(e){var t=this.get(e);return!!t&&(t.close(),t.emit(GameCore.Screens.Events.CLOSE,t),this.events.emit(GameCore.Screens.Events.CLOSE,t),!0)},n.bringToTop=function(e){var t=this.scene.children.getByName(e);t&&this.scene.children.bringToTop(t)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(e,t,n,i){var a=new t(this.scene,e,n,i);return Phaser.Display.Align.In.Center(a,this.scene.gameZone),this.existing(a),a},t}(Phaser.Plugins.ScenePlugin),Kt=zt,jt=n(20050),Xt=n.n(jt),qt=n(14791),Jt=n(53894),Qt=n(98297),$t=n(12902),en={currentSceneKey:"",prevSceneKey:""};(0,$t.pV)();var tn,nn,an,sn,rn,on,cn,hn,ln,un,pn,dn={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:""},fn=dn,mn={data:{}},gn={token:"",isRequesting:!1},vn=(tn={},tn[j]=function(e,t){return void 0===e&&(e=gn),(0,$t.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.token;switch(t.type){case W:e.isRequesting=!0;break;case Y:e.token=i,e.isRequesting=!1}}}))},tn),yn=n(51527),Sn={ASID:"",playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{score:0,settings:fe,userGuideDisplays:0,customFields:{}},isUserNew:!0},En=(nn={},nn[Fe]=function(e,t){return void 0===e&&(e=Sn),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.name,s=i.value,r=i.data,o=void 0===r?{}:r,c=i.score,h=i.connectedPlayers,l=void 0===h?[]:h,u=i.profile;switch(t.type){case ke:var p=i.playerId,d=i.name,f=i.photo,m=i.locale,g=i.data;if(n.playerId=p,n.name=d,n.photo=f,n.locale=m,GameCore.Utils.Valid.isObject(g)){var v=g;n.data=(0,yn.TS)(e.data,v)}g.userGuideDisplays>0&&(n.isUserNew=!1);break;case Oe:var y=u.playerId,S=u.name,E=u.photo,A=u.locale,b=u.ASID;n.ASID=b,n.playerId=y,n.name=S,n.photo=E,n.locale=A;break;case _e:n.data.score=c;break;case De:if(!GameCore.Utils.Object.hasOwn(n.data.settings,a))break;n.data.settings[a]=s;break;case xe:n.data=(0,yn.TS)(e.data,o),o.userGuideDisplays>0&&(n.isUserNew=!1);break;case Re:if(l.length<=0)break;var T=GameCore.Utils.Object.keyBy(l,"playerId");n.connectedPlayers=(0,yn.TS)(e.connectedPlayers,T)}}}))},nn),An=n(82737),bn=n.n(An),Tn={data:{},profileIds:[]},Cn=(an={},an[bt]=function(e,t){return void 0===e&&(e=Tn),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.data,r=void 0===a?[]:a;if(t.type===At){var o,c,h=GameCore.Utils.Object.keyBy(r,"playerId"),l=te()(h);n.data=(0,yn.TS)((0,s.Z)({},e.data),h),n.profileIds=y()(o=[]).call(o,new(bn())(y()(c=[]).call(c,e.profileIds,l)))}}}))},an),Pn="match",wn="MATCH_GAMEPLAY_INITIALIZE",In="MATCH_GAMEPLAY_START",kn="MATCH_GAMEPLAY_FINISH",xn="MATCH_GAMEPLAY_UPDATE",_n="MATCH_GAMEPLAY_RESCUE",On="MATCH_GAMEPLAY_RESET_RESCUE",Dn="MATCH_GAMEPLAY_SHOW_MINI_JOURNEY",Rn="MATCH_STATS_DATA_CLEAR",Mn="MATCH_STATS_DATA_UPDATE",Ln="MATCH_STATS_CURRENT_UPDATE",Bn="MATCH_SINGLE_CREATE_REQUEST",Nn="MATCH_SINGLE_DETAIL_REQUEST",Fn="MATCH_SINGLE_MOVE_UPDATED",Gn="MATCH_SINGLE_DATA_RECEIVED",Zn="MATCH_SINGLE_DATA_CLEAR",Un="MATCH_JOURNEY_CREATE_REQUEST",Hn="MATCH_JOURNEY_MOVE_UPDATED",Vn="MATCH_JOURNEY_DATA_RECEIVED",Wn="MATCH_JOURNEY_DAILY_CHALLENGE_START",Yn="MATCH_JOURNEY_DAILY_CHALLENGE_COMPLETED",zn="MATCH_JOURNEY_SCORE_RECEIVED",Kn="MATCH_JOURNEY_LEVEL_RECEIVED",jn="MATCH_CHALLENGE_JOIN_REQUEST",Xn="MATCH_CHALLENGE_CREATE_REQUEST",qn="MATCH_CHALLENGE_FINISH_REQUEST",Jn="MATCH_CHALLENGE_CONTINUE_REQUEST",Qn="MATCH_CHALLENGE_DATA_RECEIVED",$n="MATCH_CHALLENGE_DATA_CLEAR",ei="MATCH_GROUP_CREATE_REQUEST",ti="MATCH_GROUP_FINISH_REQUEST",ni="MATCH_ONLINE_CREATE_REQUEST",ii="MATCH_ONLINE_DATA_RECEIVED",ai="open",si="active",ri="finished",oi={mode:"",status:ai,rescued:0,startAt:0,finishAt:0,showMiniJourney:null},ci={single:{_id:"",data:{fen:""},playerId:"",status:ai},group:{status:ai,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:ai,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:ai,players:{}},journey:{_id:"",data:{fen:""},playerId:"",status:ai,challengeMode:!1},updateAt:0,isRequesting:!1},hi={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},li=(sn={},sn[Pn]=(0,qt.UY)({gameplay:function(e,t){return void 0===e&&(e=oi),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.mode,s=i.status,r=i.stateShowMiniJourney,o=i.rescued;switch(t.type){case wn:n.status=ai,n.mode=oi.mode,n.rescued=oi.rescued,n.startAt=oi.startAt,n.finishAt=oi.finishAt,n.opponentInfo=oi.opponentInfo;break;case In:n.mode=a,n.status=si,n.rescued=o,n.startAt=Date.now();break;case xn:n.mode="string"===typeof a?a:e.mode,n.status=s||e.status;break;case kn:n.status=ri,n.finishAt=Date.now();break;case _n:n.rescued+=1;break;case Dn:n.showMiniJourney=r;break;case On:n.rescued=0}}}))},match:function(e,t){return void 0===e&&(e=ci),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.match,r=i.opponentInfo,o=i.players,c=i.score,h=i.level;switch(t.type){case Bn:case Nn:case jn:case qn:case ni:case Un:n.isRequesting=!0;break;case Fn:n.single=(0,s.Z)({},e.single,a),n.updateAt=Date.now();break;case Hn:n.journey=(0,s.Z)({},e.journey,a),n.updateAt=Date.now();break;case Wn:n.journey.challengeMode=!0;break;case Yn:n.journey.challengeMode=!1;break;case Gn:n.isRequesting=!1,n.single=a||ci.single;break;case Vn:n.isRequesting=!1,n.journey=a||ci.journey;break;case zn:n.journey.score=c;break;case Kn:n.journey.level=h;break;case Zn:n.isRequesting=!1,n.single=ci.single;break;case"MATCH_JOURNEY_DATA_CLEAR":n.isRequesting=!1,n.journey=ci.journey;break;case Xn:case Jn:n.isRequesting=!0,n.challenge.opponentInfo=r;break;case Qn:n.isRequesting=!1,n.challenge=(0,s.Z)({},a||ci.challenge),n.challenge.opponentInfo=e.challenge.opponentInfo;break;case $n:n.isRequesting=!1,n.challenge=ci.challenge;break;case ei:n.group.status=si,r&&(n.group.opponentInfo=r);break;case ti:n.group.status=ri;break;case"MATCH_ONLINE_DATA_CLEAR":n.online.status=ci.online.status,n.online.players=ci.online.players;break;case ii:n.online.status=si,n.online.players=o;break;case"MATCH_ONLINE_FINISH_REQUEST":n.online.status=ri}}}))},stats:function(e,t){return void 0===e&&(e=hi),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.playerId,r=i.stats,o=i.match,c=i.current,h=i.players,l=i.leaders;switch(t.type){case Rn:delete n.data[a],n.current=hi.current;break;case"MATCH_STATS_CONTEXT_REQUEST":n.data=hi.data,n.isRequesting=!0;break;case"MATCH_STATS_CONTEXT_RECEIVED":n.data=r,n.isRequesting=!1;break;case Mn:n.data[a]=r;break;case Ln:n.current=(0,yn.TS)((0,s.Z)({},e.current),r);break;case ii:te()(h).forEach((function(e){n.data[e]={score:0}}));break;case"MATCH_ONLINE_STATS_UPDATE":l.forEach((function(e){var t=e.playerId,i=e.score,a=e.rank;n.data[t]={score:i,rank:a}}));break;case Qn:var u=o||{},p=u.blackPlayerId,d=u.blackPlayerScore,f=u.whitePlayerId,m=u.whitePlayerScore,g=u.whitePlayerLevel,v=u.blackPlayerLevel;if(!p||!f)break;c&&(n.current=c),n.data[p]={score:d,level:v},n.data[f]={score:m,level:g}}}}))}}),sn),ui="TOURNAMENT_ACTIVE",pi="TOURNAMENT_REQUEST",di="TOURNAMENT_RECEIVED",fi={active:!1,tournamentId:null,bestSessionScore:0,isRequesting:!1},mi=(rn={},rn.tournament=function(e,t){return void 0===e&&(e=fi),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.score,s=void 0===a?0:a,r=i.tournamentId;switch(t.type){case ui:n.active=!0,n.tournamentId=r;break;case pi:n.isRequesting=!0;break;case di:n.isRequesting=!1,s>e.bestSessionScore&&(n.bestSessionScore=s)}}}))},rn),gi="leaderboards",vi=n(3665),yi=n.n(vi),Si=n(2578),Ei=n.n(Si),Ai="LEADERBOARD_DATA_REQUEST",bi="LEADERBOARD_DATA_UPDATE",Ti="LEADERBOARD_DATA_CLEAR",Ci={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},Pi=(on={},on[gi]=function(e,t){return void 0===e&&(e=Ci),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.leaderboardId,r=i.type,o=i.limit,c=i.offset,h=i.leaders;switch(t.type){case Ai:e.type!==r&&0===c&&(n.leaders=Ci.leaders),n.isRequesting=!0,n.leaderboardId=a,n.type=r,n.limit=o,n.offset=c;break;case bi:if(n.isRequesting=!1,e.type!==r)break;var l=GameCore.Utils.Json.clone((0,s.Z)({},e.leaders,h)),u=yi()(l),p=E()(u).call(u,(function(e){return!!e.name&&!!e.photo}));Ei()(p).call(p,(function(e,t){return+t.score-+e.score})),p.forEach((function(t,i){t.rank=i+1,e.leaders[t.playerId]||(n.leaders[t.playerId]=t)}));break;case Ti:n.isRequesting=!1,n.type=Ci.type,n.limit=Ci.limit,n.offset=Ci.offset,n.leaders=Ci.leaders,n.leaderboardId=Ci.leaderboardId}}}))},on),wi="missions",Ii="MISSIONS_DATA_REQUEST",ki="MISSIONS_DATA_RECEIVE",xi="MISSION_UPDATE",_i="MISSION_COMPLETED",Oi={mission:null,missions:null,isRequesting:!1},Di=(cn={},cn[wi]=function(e,t){return void 0===e&&(e=Oi),(0,$t.ZP)(e,(function(n){var i,a,s=t.payload;if(s){var r=s.name,o=s.type,c=s.value,h=s.missions;switch(t.type){case Ii:n.isRequesting=!0;break;case ki:if(n.isRequesting=!1,h.length<1)return;n.missions={},h.forEach((function(e){n.missions[e.name]=e}));break;case"MISSION_START":if(null===e.missions)break;var l=e.missions[r];n.mission={name:r,process:{},require:l.require,reward:l.reward},te()(l.require).forEach((function(e){n.mission.process[e]=0}));break;case xi:if((null==(i=e.mission)?void 0:i.name)!==r)break;n.mission.process[o]+=c;break;case _i:if((null==(a=e.mission)?void 0:a.name)!==r)break;n.mission=null}}}))},cn),Ri="dailyTasks",Mi="DAILY_TASKS_DATA_REQUEST",Li="DAILY_TASKS_DATA_RECEIVE",Bi="DAILY_TASKS_PROCESS_UPDATE",Ni="DAILY_TASK_VALUE_ADD",Fi="DAILY_TASK_FINISHED",Gi={tasks:[],process:[],isRequesting:!1,isNotice:!1},Zi=(hn={},hn[Ri]=function(e,t){return void 0===e&&(e=Gi),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.id,s=i.type,r=i.value,o=i.tasks,c=i.process;switch(t.type){case Mi:n.isRequesting=!0;break;case Li:n.isRequesting=!1,n.tasks=o;break;case Bi:n.process=c;break;case Ni:if(!e.process[a])break;n.process[a][s]+=r;break;case"DAILY_TASK_REWARDED":if(!e.process[a])break;n.process[a].rewarded=!0;break;case"DAILY_TASKS_SEEN":n.isNotice=!1;break;case Fi:n.isNotice=!0}}}))},hn),Ui={rewards:[],isRequesting:!1},Hi=(ln={},ln.dailyRewards=function(e,t){return void 0===e&&(e=Ui),(0,$t.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.rewards;switch(t.type){case"DAILY_REWARDS_REQUEST":e.isRequesting=!0;break;case"DAILY_REWARDS_RECEIVE":e.isRequesting=!1,e.rewards=i}}}))},ln),Vi="dailyChallenge",Wi="DAILY_CHALLENGE_REQUEST",Yi="DAILY_CHALLENGE_UPDATE",zi="DAILY_CHALLENGE_TIME_PLAY_UPDATE",Ki={leaders:{},isRequesting:!1,time:0},ji=(un={},un[Vi]=function(e,t){return void 0===e&&(e=Ki),(0,$t.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.leaders,a=n.time;switch(t.type){case Wi:e.isRequesting=!0;break;case Yi:e.isRequesting=!1,e.leaders=i;break;case zi:e.time=a}}}))},un),Xi="lives",qi="LIVES_REQUEST",Ji="LIVES_UPDATED",Qi="LIVES_RESET",$i="LIVES_COUNT_DOWN_START",ea={isRequesting:!1,lives:0,lastBonusLifeTime:0,countDownStartAt:0},ta=(pn={},pn[Xi]=function(e,t){return void 0===e&&(e=ea),(0,$t.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.data;switch(t.type){case qi:e.isRequesting=!0;break;case Ji:e.isRequesting=!1,e.lives=i.lives,e.lastBonusLifeTime=i.lastBonusLifeTime;break;case Qi:e.isRequesting=!1,e.lives=ea.lives,e.lastBonusLifeTime=ea.lastBonusLifeTime,e.countDownStartAt=0;break;case $i:e.countDownStartAt=(new Date).getTime()}}}))},pn),na=(0,qt.UY)((0,s.Z)({scene:function(e,t){return void 0===e&&(e=en),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.sceneKey;if(t.type===Qt.DW)n.currentSceneKey=a,n.prevSceneKey=e.currentSceneKey}}))},context:function(e,t){return void 0===e&&(e=dn),(0,$t.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.gameMode,a=n.contextId,s=n.contextType,r=n.entryPointData;switch(t.type){case Qt.kL:e.contextId=a,e.contextType=s,e.entryPointData=r;break;case Qt.fJ:e.contextId=a,e.contextType=s,e.processed=!0;break;case Qt.EH:e.currentGameMode=i}}}))},messages:function(e,t){return void 0===e&&(e=mn),(0,$t.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.opponentId;if("string"===typeof a)switch(t.type){case Qt.qj:e.data[a]?n.data[a].sent=!0:n.data[a]={sent:!0};break;case Qt.rh:e.data[a]?n.data[a].sent=!1:n.data[a]={sent:!1}}}}))}},vn,En,Cn,li,mi,Pi,Di,Zi,Hi,ji,ta)),ia=na,aa=window,sa=aa.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,ra=qt.qC,oa=function(e){sa&&(ra=sa({trace:!0,traceLimit:25})||qt.qC);var t=ra((0,qt.md)(Jt.Z));return(0,qt.MT)(ia,e,t)},ca=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).store=void 0,n.initiator=void 0,n.dispatch=function(e){return n.store.dispatch(e)},n.getState=function(){return n.store.getState()},n.subscribe=function(e){return n.store.subscribe(e)},n.watch=function(e,t){var i=Xt()((function(){var t=n.getState();return e(t)}));return n.subscribe(i((function(e){t(e)})))},n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.store=oa({})},n.setInitiator=function(e){this.initiator=e},n.syncStore=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initiator.initContext(),e.next=3,this.initiator.initPlayer();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),ha=ca,la=n(75933),ua=n.n(la),pa=function(e){function t(t,n){var i;return(i=e.call(this,t,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,o.Z)(t,e);var n=t.prototype;return n.load=function(){var e;switch(this.payload.type){case"google":e=this.getGoogleFontConfig(this.payload);break;case"local":e=this.getLocalFontConfig(this.payload)}ua().load(e)},n.getGoogleFontConfig=function(e){var t=this,n=e.character,i=e.fontName,a=e.fontWeight;return{google:{families:[i+":"+(void 0===a?400:a)],text:n},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},n.getLocalFontConfig=function(e){var t=this,n=e.fontName,i=e.fontType,a=document.createElement("style");document.head.appendChild(a);var s=a.sheet;if(s){var r='@font-face { font-family: "'+n+'"; src: url("./resource/v5/assets/fonts/'+n+("opentype"===i?".otf":".ttf")+'") format("'+i+'"); }';s.insertRule(r,0)}return{custom:{families:[n]},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},t}(Phaser.Loader.File),da=pa,fa=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.addFont=function(e){var t=new da(this.scene.load,e);this.scene.load.addFile(t)},t}(Phaser.Plugins.ScenePlugin),ma=fa,ga=n(2938),va=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).portraitRatio=void 0,n.portraitWidth=void 0,n.portraitHeight=void 0,n.landscapeRatio=void 0,n.landscapeWidth=void 0,n.landscapeHeight=void 0,n.worldWidth=void 0,n.worldHeight=void 0,n.worldRatio=void 0,n.defaultRatio=void 0,n.autoResize=void 0,n.disableLandscape=void 0,n.fullSizeOnLandscape=void 0,n.forcePixelRatio=void 0,n.handleResize=(0,ga.D)((function(){n.resize(),FBInstant.updateSizeBannerAds()}),300),n}(0,o.Z)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.autoResize,n=e.portraitRatio,i=e.portraitWidth,a=e.portraitHeight,s=e.landscapeWidth,r=e.landscapeHeight,o=e.landscapeRatio,c=e.disableLandscape,h=e.fullSizeOnLandscape;this.autoResize=t,this.disableLandscape=c,this.fullSizeOnLandscape=h,this.portraitRatio=n,this.portraitWidth=i,this.portraitHeight=a,this.landscapeRatio=o,this.landscapeWidth=s,this.landscapeHeight=r,this.initWorldSize(),this.addEventResize()},n.resize=function(e){var t=this;e&&e>0&&(this.forcePixelRatio=e);var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,a=n.height;this.resizeCanvas(i,a),this.game.scene.scenes.forEach((function(e){var n=e.cameras.main;if(n){var i=t.getZoomRatio(),a=t.getWorldSize(),s=a.width,r=a.height;n.setZoom(i),n.centerOn(s/2,r/2)}}))},n.resizeCanvas=function(e,t){this.game.canvas.width=e,this.game.canvas.height=t,this.game.scale.resize(e,t)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.initWorldSize=function(){if(this.worldWidth=this.portraitWidth,this.worldHeight=this.portraitHeight,this.isScreenSmallerRatio(this.portraitRatio))this.defaultRatio=this.worldWidth/this.worldHeight,this.worldHeight=this.worldWidth/this.getScreenRatio();else if(!this.disableLandscape&&(this.worldWidth=this.landscapeWidth,this.worldHeight=this.landscapeHeight,this.defaultRatio=this.worldWidth/this.worldHeight,this.fullSizeOnLandscape)){this.worldRatio=this.worldWidth/this.worldHeight,this.landscapeRatio=this.getScreenRatio();var e=this.getCanvasSizeFixedRatio(this.landscapeRatio),t=e.width,n=e.height,i=this.getZoomRatio();this.worldWidth=t/i,this.worldHeight=n/i}this.worldRatio=this.worldWidth/this.worldHeight},n.getZoomRatio=function(){var e=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/e},n.getPixelRatio=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;if(GameCore.Utils.Device.isDesktop())return 2;var e=GameCore.Utils.Device.pixelRatio();return e>2&&(e=2),e},n.getPhysicPixels=function(e,t){return e*t},n.getCanvasSizeFixedRatio=function(e){var t=this.getPixelRatio(),n=this.getScreenWidth()*t,i=this.getScreenHeight()*t;return this.isScreenSmallerRatio(e)?i=n/e:n=i*e,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientHeight,a=n.clientHeight;return Math.max(a,i)||0},n.getScreenWidth=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientWidth,a=n.clientWidth;return Math.max(a,i)||0},n.isScreenSmallerRatio=function(e){return this.getScreenRatio()<e},n.addEventResize=function(){this.autoResize&&window.addEventListener("resize",this.handleResize)},n.isLandscape=function(){return!this.disableLandscape&&this.worldRatio>this.portraitRatio},n.getDefaultRatio=function(){return this.defaultRatio},t}(Phaser.Plugins.BasePlugin),ya=va,Sa=function(){function e(e,t,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=e||fn.contextId,this.contextType=t||fn.contextType,this.entryPointData=n||fn.entryPointData}return e.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},e}(),Ea=Sa,Aa=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidPlayerId",i.message=t||"The playerId is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),ba=Aa,Ta="share_invite",Ca="tournament",Pa="challenge_friend_match",wa="matching_group_match",Ia=n(90143),ka=new Me.Z("10","Your Friend",Ia.Z.AVATAR.FILE).toObject(),xa="single",_a="challenge-friends",Oa="matching-group",Da="tournaments",Ra="journey",Ma=(0,K.P1)([function(e){return e.context}],(function(e){return e})),La=(0,K.P1)([function(e){return e.context.currentGameMode}],(function(e){return e})),Ba=function(e,t){return{type:Qt.fJ,payload:{contextId:e,contextType:t}}},Na=function(e){return function(t){t({type:Qt.EH,payload:{gameMode:e}}),(0,i.sw)("game-mode",e)}},Fa={score:"score",settings:"settings",gameData:"gameData",userGuideDisplays:"userGuideDisplays"},Ga=GameCore.Configs.SyncProfileFromAPI,Za=function(e){var t=this;this.game=void 0,this.initContext=function(){var e=window.GameSDK.context.getID(),n=window.GameSDK.context.getType(),i=window.GameSDK.getEntryPointData(),a=new Ea(e,n,i).toObject(),s=a.contextId,r=a.contextType,o=a.entryPointData;t.game.storage.dispatch(function(e,t,n){return{type:Qt.kL,payload:{contextId:e,contextType:t,entryPointData:n}}}(s,r,o))},this.initPlayer=(0,r.Z)(h().mark((function e(){var n,i,a,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.game.player,i=t.getPlayerInfo(),a=yi()(Fa),e.next=5,FBInstant.player.getDataAsync(a);case 5:return s=e.sent,r=new Pe(s),e.next=11,t.maintainDataStructure(r);case 11:return r=e.sent,!0===r.toObject().settings.music&&window.game.audio.playMusic(),e.next=16,n.receiveData(i,r.convertToPlayerData());case 16:case"end":return e.stop()}}),e)}))),this.maintainDataStructure=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Ga){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,FBInstant.player.getDataAsync(["isSynced","customFields"]);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(n=e.t0,!0!==(n.isSynced||!1)){e.next=12;break}return e.abrupt("return",t);case 12:if(i=n.customFields||!1){e.next=15;break}return e.abrupt("return",t);case 15:return(a=t.convertToPlayerData()).customFields=i,r=new Pe({}).convertToFacebookData(a),e.next=20,FBInstant.player.setDataAsync((0,s.Z)({},r,{isSynced:!0}));case 20:return e.abrupt("return",new Pe(r));case 23:return e.prev=23,e.t1=e.catch(0),e.abrupt("return",t);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t){return e.apply(this,arguments)}}(),this.getPlayerInfo=function(){try{var e=window.GameSDK.player.getID(),t=window.GameSDK.player.getName(),n=window.GameSDK.player.getPhoto(),i=window.GameSDK.getLocale();if(!GameCore.Utils.Valid.isString(e))throw new ba(null,{playerId:e});return GameCore.Utils.Valid.isString(t)||(t="You"),new Me.Z(e,t,n,i).toObject()}catch(a){return new Me.Z("123","You").toObject()}},this.game=e},Ua=n(58123),Ha=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).Text=void 0,n.Texture=void 0,n.currentLocale=void 0,n.supportedLanguages=void 0,n.data=void 0,n.options=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.configure=function(e){this.applyOptions(e)},n.getCurrentLanguage=function(){return this.currentLocale},n.switchLanguage=function(e){void 0===e&&(e="en");var t=this.getCorrectLocale(e);this.currentLocale=t,this.Text=this.data[t].Text,this.Texture=this.data[t].Texture},n.getText=function(e){if("object"==typeof e){var t=e.key,n=e.variables,i=void 0===n?[]:n,a=e.locale,s=void 0===a?this.currentLocale:a,r=this.getCorrectLocale(s),o=this.data[r].Text[t];return this.replaceVariables(o,i)}return this.Text[e]},n.getTexture=function(e){if("object"==typeof e){var t=e.key,n=e.variables,i=void 0===n?[]:n,a=e.locale,s=void 0===a?this.currentLocale:a,r=this.getCorrectLocale(s),o=this.data[r].Texture[t];return this.replaceVariables(o,i)}return this.Texture[e]},n.isSupportLanguage=function(e){var t;return xt()(t=this.supportedLanguages).call(t,e)>=0},n.applyOptions=function(e){this.options=(0,s.Z)({},e);var t=e.data,n=e.locale,i=void 0===n?"en":n,a=e.upperCaseText,r=void 0!==a&&a;this.data=t,this.supportedLanguages=te()(t);var o=this.getCorrectLocale(i);if(this.currentLocale=o,this.Text=t[o].Text,this.Texture=t[o].Texture,r)for(var c in this.Text)this.Text[c]=this.Text[c].toUpperCase()},n.replaceVariables=function(e,t){var n=t.length;if(0==n)return e;var i=0;return e.replace(/{.*}/,(function(){return String(t[Math.min(i++,n-1)])}))},n.getCorrectLocale=function(e){var t=e;return this.isSupportLanguage(e)||(t="en"),t},t}(Phaser.Plugins.BasePlugin),Va=JSON.parse('{"Text":{"empty_{X}":"empty_{X}"},"Texture":{"empty_2_{abc}":"empty_2_{abc}"}}'),Wa={en:Va},Ya=Wa,za=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,(0,s.Z)({data:Ya,locale:"en",upperCaseText:!1},t))},t}(Ha),Ka=za,ja=[Ht._.BUTTON_CLICK,Ht._.SCREEN_OPEN],Xa=function(e){function t(t,n,i){var a;return(a=e.call(this,"FacebookAnalytics",{prefix:n},"#0F52BA")||this).game=void 0,a.game=t,a.selfLog=!!i,a}(0,o.Z)(t,e);var n=t.prototype;return n.processEvent=function(e,t,n){var i;if(!(xt()(ja).call(ja,e)>=0)){var a=this.getEventName(e),s={};b()(i=te()(t||{})).call(i,(function(e){t&&"string"===typeof t[e]&&(s[e]=t[e])})),FBInstant.logEvent(a,n,s)}},n.processPageView=function(e){},n.processLevelStart=function(e,t,n){this.processEvent(Ht._.LEVEL_START,{level:e,score:t,level_name:n})},n.processLevelRescue=function(e,t,n){this.processEvent(Ht._.LEVEL_RESCUE,{level:e,score:t,level_name:n})},n.processLevelFail=function(e,t,n){this.processEvent(Ht._.LEVEL_END,{level:e,score:t,level_name:n,success:!1})},n.processLevelComplete=function(e,t,n){this.processEvent(Ht._.LEVEL_END,{level:e,score:t,level_name:n,success:!0})},n.processShowInterstitialAd=function(e){this.processEvent(Ht._.AD_SHOW,{ad_type:"interstitial",screen_name:""+e})},n.processShowRewardedVideoAd=function(e){this.processEvent(Ht._.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+e})},n.processShowAdFail=function(e,t){var n=e===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(Ht._.AD_SHOW_FAILED,{ad_type:n,screen_name:""+t})},n.getEventName=function(e){return this.options.prefix+"_"+e},t}(GameCore.Analytics.BaseAnalytics),qa=Xa,Ja=[Ht._.SCREEN_OPEN],Qa=function(e){function t(t,n){var i;(i=e.call(this,"GoogleAnalytics",(0,s.Z)({},n),"#E35335")||this).game=void 0,i.trackingId=void 0,i.currentPath="/";var a=n.trackingId;i.game=t;var r=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!r,i.trackingId=a,i}(0,o.Z)(t,e);var n=t.prototype;return n.processEvent=function(e,t,n){if(!(xt()(Ja).call(Ja,e)>=0)){var i=this.formatEventName(e),a=t?(0,s.Z)({},t):{};a=n?(0,s.Z)({},a,{value:n}):a,a=(0,s.Z)({},a,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,a)}},n.processLevelStart=function(e,t,n){this.processEvent(Ht._.LEVEL_START,{level:e,score:t,level_name:n})},n.processLevelRescue=function(e,t,n){this.processEvent(Ht._.LEVEL_RESCUE,{level:e,score:t,level_name:n})},n.processLevelFail=function(e,t,n){this.processEvent(Ht._.LEVEL_END,{level:e,score:t,level_name:n,success:!1})},n.processLevelComplete=function(e,t,n){this.processEvent(Ht._.LEVEL_END,{level:e,score:t,level_name:n,success:!0})},n.processShowInterstitialAd=function(e){this.processEvent(Ht._.AD_SHOW,{ad_type:"interstitial",screen_name:""+e}),this.processEvent(Ht._.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processShowRewardedVideoAd=function(e){this.processEvent(Ht._.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+e}),this.processEvent(Ht._.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processShowAdFail=function(e,t){var n=e===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(Ht._.AD_SHOW_FAILED,{ad_type:n,screen_name:""+t})},n.processPageView=function(e){var t="/"+this.getGameplayMode()+"/"+e;this.currentPath=t,gtag("event","page_view",{page_path:this.currentPath,send_to:["GA",this.trackingId]})},n.getGameplayMode=function(){var e=this.game.storage.getState();return La(e)},n.formatEventName=function(e){return e.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(e,t){return this.toUpperCamelCaseWithSpace(e)+"::"+this.toUpperCamelCaseWithSpace(t)},n.toUpperCamelCaseWithSpace=function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?" "+t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)},t}(GameCore.Analytics.BaseAnalytics),$a=Qa,es="G-R65KL9Q9T2",ts="UA-261518513-17",ns=function(e){function t(){for(var t,n,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=e.call.apply(e,y()(t=[this]).call(t,s))||this).startGame=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.auth.requestToken();case 3:return e.next=5,n.storage.syncStore();case 5:n.configureSentry(),n.configureRollbar(),n.detectGameMode(),n.initGoogleAnalytics(),n.initFacebookAnalytics(),n.analytics.event(Ht._.LOAD_START),n.scene.launch(Ua.Co.GLOBAL_SCENE),n.scene.start(Ua.Co.LOAD_SCENE),n.analytics.pageview(Ua.Co.LOAD_SCENE),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),(0,i.tO)(e.t0);case 19:return e.prev=19,n.facebook.progressLoading.finishLoadingProgressFbBootScene(),n.scene.sleep(Ua.Co.BOOT_SCENE),e.finish(19);case 23:case"end":return e.stop()}}),e,null,[[0,16,19,23]])}))),n}(0,o.Z)(t,e);var n=t.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame(),this.ads.showBannerAdAsync().catch((function(e){}))},n.configureSentry=function(){var e=this.player.getPlayer();(0,i.Tv)({id:e.playerId,username:e.name})},n.configureRollbar=function(){if(this.rollbar){var e=this.player.getPlayer();this.rollbar.configure({payload:{person:{id:e.playerId,name:e.name}}})}},n.detectGameMode=function(){this.storage.dispatch((function(e,t){var n,i=t(),a=Ma(i),s=window.game.player.getPlayerId(),r=a.contextId,o=a.entryPointData||{},c=o.type,h=o.matchId,l=o.playerId,u=o.opponentId,p=void 0===u?ka.playerId:u,d=o.tournamentContextId,f=s===l,m=p===ka.playerId||ce()(n=[p,l]).call(n,s),g=xa;!r||void 0!==c&&c!==Ca||(g=Da),c===Ca&&d&&(g=Da),r&&c===Ta&&!f&&(g=_a),h&&r&&m&&c===Pa&&(g=_a),r&&c===wa&&(g=Oa),e(Na(g))}))},n.initGoogleAnalytics=function(){var e=this.player.getPlayerId();this.analytics.add(new $a(this.game,{userId:e,trackingId:ts,measuringId:es,version:"5"}))},n.initFacebookAnalytics=function(){var e=GameCore.Configs.Analytics.FacebookAnalytics||{},t=e.prefix,n=e.consoleLog;"string"===typeof t&&this.analytics.add(new qa(this.game,t,n))},t}(Phaser.Scene),is=ns,as=n(5281),ss=n(39940),rs=n.n(ss),os=n(47475),cs=n.n(os),hs=n(29982),ls=n.n(hs),us=n(54255),ps=n(58644),ds=n(4396),fs=n(22438),ms=n(20468),gs=n(27033),vs={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},ys={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Ss=ys.STATUS,Es=function(){function e(e){this.state=void 0,this.scene=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.setState(Ss.READY)},t.start=function(){this.isRunning()||this.setState(Ss.RUNNING)},t.stop=function(){this.isRunning()&&this.setState(Ss.STOPPED)},t.setState=function(e){this.state=e},t.isReady=function(){return this.state===Ss.READY},t.isRunning=function(){return this.state===Ss.RUNNING},t.isStopped=function(){return this.state===Ss.STOPPED},e}(),As=Es,bs=n(77087),Ts=n(62698),Cs=n(99873),Ps=n(96308),ws=us.Z.DEFAULT,Is=ws.KEY,ks=ws.FRAME,xs=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.contents=void 0,s.buttonPlay=void 0,s.messageText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.onPlay=void 0,s.open=function(t){e.prototype.open.call((0,as.Z)(s),t),s.setVisible(!0);var n=s.getData(["onPlay"])[0];s.onPlay=n,s.runOpenAnimation()},s.handlePlay=function(){s.onPlay&&s.onPlay(),s.close()},s.setVisible(!1),s.setDepth(ps.Ks.POPUP),s.createPopup(),s.createPopupContent(),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,325,260),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createMessage(),this.createButtonPlay(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonPlay])},n.createButtonPlay=function(){this.buttonPlay=new fs.Z(this.scene,Is,ks.BUTTON_BLUE_NORMAL,170,63),this.buttonPlay.setName("Play");var e=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(60),text:"Play",origin:{x:.5,y:.5}});this.buttonPlay.add(e),Phaser.Display.Align.In.Center(e,this.buttonPlay),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,50),this.buttonPlay.onClick=this.handlePlay},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5},text:"The game will end when there s no\nmore space for your given blocks."}),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,-45),this.messageText.setScale(0).setAlpha(0)},n.runPopupExitsAnimation=function(e,t){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{y:250,scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup,i=n.y,a=n.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:{from:350,to:i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:a}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){this.contentShowUpAnimation||(this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:this.scene.tweens.stagger(80,{start:e}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},t}(GameCore.Screen),_s=xs,Os=[{minCol:0,minRow:0,cols:4,rows:4},{minCol:4,minRow:0,cols:4,rows:4},{minCol:0,minRow:4,cols:4,rows:4},{minCol:4,minRow:4,cols:4,rows:4}],Ds=[{minCol:0,minRow:0,cols:5,rows:5},{minCol:3,minRow:0,cols:5,rows:5},{minCol:0,minRow:3,cols:5,rows:5},{minCol:3,minRow:3,cols:5,rows:5}],Rs=[{minCol:0,minRow:0,cols:6,rows:6},{minCol:3,minRow:0,cols:6,rows:6},{minCol:0,minRow:3,cols:6,rows:6},{minCol:3,minRow:3,cols:6,rows:6}],Ms="vertical",Ls="horizontal",Bs="left",Ns="right",Fs="top",Gs="bottom",Zs="vertical_left",Us="vertical_right",Hs="horizontal_left",Vs="horizontal_right",Ws="gem/gem",Ys="gem/gem",zs="gem/gem",Ks="gem/gem",js="gem/gem",Xs="gem/gem",qs="gem/gem",Js="gem/gem",Qs="gem/gem",$s=[{level:1,frames:[],width:480,height:189},{level:2,frames:[us.Z.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[us.Z.EFFECTS.FRAME.TEXT_GOOD],width:579,height:189},{level:4,frames:[us.Z.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[us.Z.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[us.Z.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189}],er=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],tr="l",nr="l_1",ir="l_3",ar="line_2",sr="line_3",rr="line_4",or="line_5",cr="square_1",hr="square_2",lr="square_3",ur="trapezoid",pr="triangle",dr="t_piece",fr="plus_piece",mr="cross_piece_2",gr="cross_piece_3",vr="cross_piece_4",yr="cross_piece_5",Sr="u_piece",Er=[tr,nr,ir,ar,sr,rr,or,cr,hr,lr,pr,ur,dr,fr,mr,gr,vr,Sr],Ar=[{type:tr,rate:2},{type:nr,rate:8},{type:ir,rate:6},{type:ar,rate:9},{type:sr,rate:9},{type:rr,rate:8},{type:or,rate:8},{type:cr,rate:9},{type:hr,rate:8},{type:pr,rate:2},{type:ur,rate:2},{type:dr,rate:1},{type:fr,rate:1},{type:mr,rate:2},{type:gr,rate:1},{type:vr,rate:1},{type:Sr,rate:1}],br=[[1,0],[1,0],[1,1]],Tr=[[0,1],[0,1],[1,1]],Cr=[[1,0],[1,1]],Pr=[[1,0,0],[1,0,0],[1,1,1]],wr=[[1,1,1],[1,0,0]],Ir=[[1,1,1],[0,0,1]],kr=[[1,1],[1,0]],xr=[[1,1,1],[1,0,0],[1,0,0]],_r=[[1,1],[0,1],[0,1]],Or=[[1,1],[1,0],[1,0]],Dr=[[1,1],[0,1]],Rr=[[1,1,1],[0,0,1],[0,0,1]],Mr=[[0,0,1],[1,1,1]],Lr=[[1,0,0],[1,1,1]],Br=[[0,1],[1,1]],Nr=[[0,0,1],[0,0,1],[1,1,1]],Fr=[[1],[1]],Gr=[[1,1]],Zr=[[1],[1],[1]],Ur=[[1,1,1]],Hr=[[1],[1],[1],[1]],Vr=[[1,1,1,1]],Wr=[[1],[1],[1],[1],[1]],Yr=[[1,1,1,1,1]],zr=[[1]],Kr=[[1,1],[1,1]],jr=[[1,1,1],[1,1,1],[1,1,1]],Xr=[[1,0],[1,1],[0,1]],qr=[[0,1],[1,1],[1,0]],Jr=[[1,1,0],[0,1,1]],Qr=[[0,1,1],[1,1,0]],$r=[[0,1],[1,1],[0,1]],eo=[[1,0],[1,1],[1,0]],to=[[0,1,0],[1,1,1]],no=[[1,1,1],[0,1,0]],io=[[0,0,1],[1,1,1],[0,0,1]],ao=[[1,0,0],[1,1,1],[1,0,0]],so=[[0,1,0],[0,1,0],[1,1,1]],ro=[[1,1,1],[0,1,0],[0,1,0]],oo=[[0,1,0],[1,1,1],[0,1,0]],co=[[1,0],[0,1]],ho=[[0,1],[1,0]],lo=[[1,0,0],[0,1,0],[0,0,1]],uo=[[0,0,1],[0,1,0],[1,0,0]],po=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],fo=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],mo=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],go=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],vo=[[1,1],[0,1],[1,1]],yo=[[1,0],[1,1],[1,0]],So=[[1,0,1],[1,1,1]],Eo=[[1,1,1],[1,0,1]],Ao=function(){function e(e){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"4bb3/4bb3/4bb3/3bb4/bbbb2bbb/bbbb1bbbb/4bb3/4bb3/4bb3 l tz-vr,b",piece:cr,position:{x:4,y:3}},this.scene=e.scene,this.manager=e}var t=e.prototype;return t.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},t.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},t.createTweenHand=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(t/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:t/2-80,to:t/2+30},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},t.handleHighlight=function(){for(var e=[{x:5,y:3},{x:5,y:4},{x:4,y:4},{x:4,y:5}],t=0;t<e.length;t++){var n=e[t],i=n.x,a=n.y;this.scene.main.board.dataBoard[a][i].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()}},t.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},t.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},t.nextLevel=function(){this.tweenHand.stop().remove()},e}(),bo=Ao,To=function(){function e(e){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/x/bbbb1ryry/x/x/x/x l s1,b",piece:cr,position:{x:4,y:4}},this.scene=e.scene,this.manager=e}var t=e.prototype;return t.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},t.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},t.createTweenHand=function(){var e=this.scene.gameZone,t=e.width,n=e.height,i=n/2+176+30,a=i+(n-85-i)/2;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(t/2-120,n-50),this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:t/2-80,to:t/2+15},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},t.handleHighlight=function(){for(var e=this.dataInit.position,t=e.x,n=e.y,i=0;i<1;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][t+a].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},t.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},t.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},t.nextLevel=function(){this.tweenHand.stop().remove()},e}(),Co=To,Po=function(){function e(e){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/4bb3/4bb3/5b3/x/x/x l l-dt,b",piece:cr,position:{x:3,y:3}},this.scene=e.scene,this.manager=e}var t=e.prototype;return t.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},t.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},t.createTweenHand=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(t/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:t/2-80,to:t/2-20},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},t.handleHighlight=function(){for(var e=this.dataInit.position,t=e.x,n=e.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][t+a].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking();this.scene.main.board.dataBoard[5][4].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},t.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},t.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},t.nextLevel=function(){this.tweenHand.stop().remove()},e}(),wo=Po,Io=function(){function e(e){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"2r/2r/2r/2r/x/x/x/2r/2r l e3-v,r",piece:sr,position:{x:2,y:4}},this.scene=e.scene,this.manager=e}var t=e.prototype;return t.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},t.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},t.createTweenHand=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(t/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:t/2-80,to:t/2-60},y:{from:a,to:n/2+30},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},t.handleHighlight=function(){for(var e=this.dataInit.position,t=e.x,n=e.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][t+a].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},t.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},t.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},t.nextLevel=function(){this.tweenHand.stop().remove()},e}(),ko=Io,xo=vs.STATUS,_o=us.Z.TUTORIAL,Oo=_o.KEY,Do=_o.FRAME,Ro=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.currentLevel=1,n.tutorialId=void 0,n.inputType=void 0,n.handFrame=void 0,n.background=void 0,n.headerContainer=void 0,n.maskGraphics=void 0,n.textTutorial=void 0,n.skipButton=void 0,n.stepOne=void 0,n.stepTwo=void 0,n.stepThree=void 0,n.stepFour=void 0,n.popup=void 0,n.showTutorialWhenStart=function(){switch(n.scene.analytics.event(Ht._.TUTORIAL_STEP,{tutorial_step:n.currentLevel}),n.currentLevel){case 1:n.stepOne.start(),n.setTextTutorial("Place the block in the horizontal\nline and see what happens!");break;case 2:n.stepTwo.start(),n.setTextTutorial("Now see what happens\nwhen you make a vertical line.");break;case 3:n.stepThree.start(),n.setTextTutorial("You can also make a 3x3 square.\nGive it a try!");break;case 4:n.stepFour.start(),n.setTextTutorial("Arrange lines and squares\nto get combo points!");break;default:n.handleCompleteTutorial()}},n.nextTutorial=function(){switch(n.currentLevel){case 1:n.stepOne.nextLevel();break;case 2:n.stepTwo.nextLevel();break;case 3:n.stepThree.nextLevel();break;case 4:n.stepFour.nextLevel()}n.currentLevel++,n.showTutorialWhenStart()},n.validTargetPosition=function(e){var t={x:0,y:0};switch(n.currentLevel){case 1:t=n.stepOne.dataInit.position;break;case 2:t=n.stepTwo.dataInit.position;break;case 3:t=n.stepThree.dataInit.position;break;case 4:t=n.stepFour.dataInit.position}return t.x===e.x&&t.y===e.y},n.scene=t,n.createHand(),n.createTutorialPlayScreen(),n.createHeader(),n.createSkipButton(),n.initTutorialStep(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createTutorialPlayScreen=function(){this.scene.screen.add(ps.o4.TUTORIAL_PLAY_SCREEN,_s)},n.createHeader=function(){this.headerContainer=this.scene.add.container(),this.headerContainer.setVisible(!1);var e=this.scene.make.image({key:Oo,frame:Do.BG_YELLOW_LIGHT});e.setAlpha(.5),e.setWorldSize(359,97),this.headerContainer.add(e),Phaser.Display.Align.In.Center(e,this.headerContainer),this.textTutorial=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(25),origin:{x:.5,y:.5}}),this.textTutorial.align=1,this.textTutorial.setTint(3304186),this.headerContainer.add(this.textTutorial),Phaser.Display.Align.In.TopCenter(this.headerContainer,this.scene.gameZone,0,-53)},n.createSkipButton=function(){this.skipButton=new fs.Z(this.scene,us.Z.DEFAULT.KEY,us.Z.DEFAULT.FRAME.BUTTON_BLUE_SMALL_TALL,80,32);var e=this.scene.make.image({key:us.Z.DEFAULT.KEY,frame:us.Z.DEFAULT.FRAME.TEXT_SKIP});e.setWorldSize(26,9),this.skipButton.add(e),this.headerContainer.add(this.skipButton),this.skipButton.onClick=this.handleSkip.bind(this),Phaser.Display.Align.In.BottomRight(this.skipButton,this.headerContainer,-10,-10)},n.handleSkip=function(){this.scene.game.globalScene.screen.open(ps.o4.ALERT_SCREEN,{message:"Are you sure you want to\nskip the tutorials?",onHandleYes:this.handleCompleteTutorial.bind(this)})},n.initTutorialStep=function(){this.stepOne=new Co(this),this.stepTwo=new ko(this),this.stepThree=new wo(this),this.stepFour=new bo(this)},n.start=function(){this.isRunning()||(this.scene.analytics.pageview("tutorial-screen"),this.setState(xo.RUNNING),this.headerContainer.setVisible(!0),this.showTutorialWhenStart())},n.setTextTutorial=function(e){var t=this,n=e.split(""),i="";this.scene.time.addEvent({repeat:n.length,delay:10,callback:function(){var e=n.shift()||"";i+=e,t.textTutorial.setText(i),Phaser.Display.Align.In.Center(t.textTutorial,t.headerContainer,-t.scene.gameZone.width/2,-67)}})},n.stop=function(){this.isRunning()&&(this.scene.tweens.killTweensOf([this.background]),this.background.setVisible(!1),this.maskGraphics.setVisible(!1),this.setState(xo.STOPPED))},n.handleCompleteTutorial=function(){this.scene.analytics.pageview("game-scene"),this.scene.analytics.event(Ht._.TUTORIAL_COMPLETE),this.setState(xo.STOPPED),this.scene.main.praise.tweenShowScoreText.stop().remove(),this.scene.startGame(),this.handFrame.setVisible(!1),this.headerContainer.setVisible(!1)},n.createHand=function(){this.handFrame=this.scene.make.image({key:Oo,frame:Do.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(ms.Z.ON_TOP),this.handFrame.setWorldSize(64,55)},n.isValidForTutorial=function(){return this.scene.game.player.getPlayerIsNew()},n.dragStart=function(){switch(this.currentLevel){case 1:this.stepOne.dragStart();break;case 2:this.stepTwo.dragStart();break;case 3:this.stepThree.dragStart();break;case 4:this.stepFour.dragStart()}},n.skipTutorial=function(){this.isRunning()&&(this.handFrame.setVisible(!1),this.setState(xo.STOPPED))},n.invalidMove=function(){switch(this.currentLevel){case 1:this.stepOne.invalidMove();break;case 2:this.stepTwo.invalidMove();break;case 3:this.stepThree.invalidMove();break;case 4:this.stepFour.invalidMove()}},n.handleGuidePlayStep=function(e){try{this.scene.main.board.clearBoard(),this.scene.footer.pieces.clearPieces();var t=null,n=null;if(e){var i=this.scene.main.board.getBoardByFen(e);t=this.scene.handleDynamicFenSize(i),n=this.scene.footer.pieces.getPiecesByFen(e)}this.scene.main.board.startGame(t),this.scene.footer.pieces.showAvailablePieces(n)}catch(a){}},t}(As),Mo=Ro,Lo={START_GAME:"start-game",REPLAY:"replay",RESCUE:"rescue",RECEIVE_DIAMONDS:"receive-diamonds",GAME_OVER:"game-over"},Bo="global",No="friend",Fo=GameCore.Configs,Go=Fo.ApiHost,Zo=Fo.OtherHost,Uo=Fo.LeadersBoard,Ho=Uo.Prefix,Vo=Uo.LeaderboardId,Wo=Uo.Name,Yo=Ho+"/"+Vo+"/leaders",zo=Ho+"/"+Vo+"/players",Ko=function(e){var t="";return Vo?(e===Bo?t=Yo:e===No&&(t=zo),t):t},jo=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,r,o,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=b()(t).call(t,(function(e){return e.playerId})),a=GameCore.Utils.Object.keyBy(t,"playerId"),r=GameCore.Utils.String.params({playerIds:i}),e.next=5,vt("players?"+r,{},Go);case 5:return o=e.sent,c=b()(n=o.data).call(n,(function(e){var t=a[e.playerId];return(0,s.Z)({},e,{score:t.score,rank:t.rank,getScore:function(){return t.score},getFormattedScore:function(){return""},getTimestamp:function(){return(new Date).valueOf()},getRank:function(){return t.rank},getExtraData:function(){return t.extraData},getPlayer:function(){return{getName:function(){return e.name},getPhoto:function(){return e.photo},getID:function(){return e.playerId}}}})})),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xo=function(){var e=(0,r.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),null==Vo){e.next=3;break}return e.abrupt("return",qo(t));case 3:return e.abrupt("return",Jo(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qo=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=Ko(Bo)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,vt(i+"?"+a,{},Zo);case 8:if(s=e.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=r,e.abrupt("return",jo(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Jo=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),i=(n=t).limit,a=n.offset,e.next=4,window.GameSDK.getLeaderboardAsync(Wo);case 4:return s=e.sent,e.next=7,s.getEntriesAsync(i,a);case 7:return r=e.sent,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Qo=function(){var e=(0,r.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),null==Vo){e.next=3;break}return e.abrupt("return",$o(t));case 3:return e.abrupt("return",ec(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$o=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=Ko(No)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,vt(i+"?"+a,{},Zo);case 8:if(s=e.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=r,e.abrupt("return",jo(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ec=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),i=(n=t).limit,a=n.offset,e.next=4,window.GameSDK.getLeaderboardAsync(Wo);case 4:return s=e.sent,e.next=7,s.getConnectedPlayerEntriesAsync(i,a);case 7:return r=e.sent,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tc=(function(){var e=(0,r.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==Vo){e.next=2;break}return e.abrupt("return",tc(t));case 2:return e.abrupt("return",nc());case 3:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,t){e.next=3;break}return e.abrupt("return",n);case 3:if(i=Ko(No)){e.next=6;break}return e.abrupt("return",n);case 6:return a=GameCore.Utils.String.params({playerIds:t}),e.next=9,vt(i+"?"+a,{},Zo);case 9:if(s=e.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){e.next=13;break}return e.abrupt("return",n);case 13:return e.next=15,jo(r);case 15:return n=e.sent[0],e.abrupt("return",n);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),nc=function(){var e=(0,r.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.getLeaderboardAsync(Wo);case 2:return t=e.sent,e.next=5,t.getPlayerEntryAsync();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ic=function(){var e=(0,r.Z)(h().mark((function e(t,n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==Vo){e.next=2;break}return e.abrupt("return",ac(t,n));case 2:return e.abrupt("return",sc(n));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ac=function(){var e=(0,r.Z)(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yt("leaderboards/"+Vo+"/players/"+t,{score:n},{},Zo);case 2:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),sc=function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.getLeaderboardAsync(Wo);case 2:return n=e.sent,e.next=5,n.setScoreAsync(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),rc=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidContextId",i.message=t||"This contextId is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),oc=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="NewScoreIsBad",i.message=t||"The new score is bad",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),cc=function(e){return e[Pn]},hc=(0,K.P1)([function(e){return cc(e).gameplay.mode}],(function(e){return e})),lc=((0,K.P1)([function(e){return cc(e).gameplay.status}],(function(e){return e})),(0,K.P1)([function(e){return cc(e).gameplay.rescued}],(function(e){return e}))),uc=(0,K.P1)([function(e){return cc(e).gameplay.startAt}],(function(e){return e})),pc=(0,K.P1)([function(e){return cc(e).gameplay.finishAt}],(function(e){return e})),dc=(0,K.P1)([function(e){return cc(e).gameplay.showMiniJourney}],(function(e){return e})),fc=GameCore.Configs,mc=fc.AppId,gc=fc.OtherHost,vc=fc.LeadersBoard,yc=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={appId:mc,resetScore:0,numberOfLeaders:15,timezone:"utc+0",sortOrder:"desc",statistics:"max",resettable:"manually",description:"no description"},!vc.UseMock){e.next=5;break}return e.next=4,(0,ht.qZ)(1e3);case 4:return e.abrupt("return",(0,s.Z)({},n,t,{_id:vc.LeaderboardId,type:"app_leaderboard",description:"mockup_leaderboard",createdAt:new Date(Date.now()).toISOString(),updatedAt:new Date(Date.now()).toISOString()}));case 5:return"leaderboards",e.next=8,yt("leaderboards",(0,s.Z)({},n,t),{},gc);case 8:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Sc=(function(){var e=(0,r.Z)(h().mark((function e(t,n){var i,a,s,r,o,c,l,u,p,d,f,m;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n={}),i=[],!vc.UseMock){e.next=7;break}return e.next=5,(0,ht.qZ)(1e3);case 5:return o=(r=n).limit,c=void 0===o?10:o,l=r.offset,u=void 0===l?0:l,e.abrupt("return",b()(a=cs()(s=new Array(c)).call(s,null)).call(a,(function(e,t){var n=(t+1)*(u+1);return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(1e5/n+1e4*Math.random())}})));case 7:return p=GameCore.Utils.String.params(n),d="leaderboards/"+t+"/leaders",e.next=11,vt(d+"?"+p,{},gc);case 11:if((f=e.sent)&&(null==f||!f.error)){e.next=14;break}throw new Error((null==f?void 0:f.error)||"Leaderboard not found");case 14:if(!((m=(null==f?void 0:f.data)||[]).length<1)){e.next=17;break}return e.abrupt("return",i);case 17:return i=m,e.abrupt("return",i);case 19:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(h().mark((function e(t,n,i){var a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yt("leaderboards/"+t+"/players/"+n,{score:i},{},gc);case 2:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}()),Ec=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="CurrentTournamentScoreIsNotBest",i.message=t||"The new score is not best",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),Ac=GameCore.Configs.Tournament.UseLeaderboard,bc=function(e){return{type:ui,payload:{tournamentId:e}}},Tc=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n){var a,s,r,o,c,l,u,p,d;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=window.game.facebook,s=e.playerId,r=e.playerName,o=e.score,c=e.autoStartGame,l=r+"'s Tournament",u=GameCore.Utils.String.generateObjectId(),t.next=7,a.tournament.createAsync({initialScore:o,config:{title:l,tournamentTitle:l},data:{playerId:s,playerName:r,leaderboardId:u}});case 7:return p=t.sent,d=p.getID(),c&&(n(bc(d)),n(Nl())),t.next=12,yc({_id:u,createdBy:s,name:d,description:l,expireTime:6048e5});case 12:if(t.sent._id!==u){t.next=16;break}return t.next=16,Sc(u,s,o);case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),(0,i.tO)(t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e){return t.apply(this,arguments)}}()},Cc=function(e){return(0,r.Z)(h().mark((function t(){var n,i,a,s,r;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.facebook,i=e.playerId,a=e.playerName,s=e.leaderboardId,r=e.score,s&&Sc(s,i,r),t.next=5,n.tournament.shareAsync({score:r,data:{type:Ca,playerId:i,playerName:a}});case 5:Sc(s,i,r);case 6:case"end":return t.stop()}}),t)})))},Pc=function(){var e=(0,r.Z)(h().mark((function e(){var t,n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=window.game.facebook,e.next=4,t.getTournamentAsync();case 4:return n=e.sent,i=JSON.parse(n.getPayload()||"{}"),e.abrupt("return",i.leaderboardId);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),wc=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=window.game.facebook,e.next=4,t.getTournamentAsync();case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),Ic=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n,i){var a,s,r,o,c,l,u,p,d,f,m,g,v,y;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=null,s=window.game,r=s.player,o=s.facebook,c=s.analytics,t.prev=2,u=i(),p=hc(u),ce()(l=[xa,Da]).call(l,p)){t.next=7;break}return t.abrupt("return");case 7:return n({type:pi,payload:{}}),d=r.getPlayer(),f=d.playerId,m=d.name,t.next=11,wc();case 11:if(!t.sent){t.next=23;break}if(a=Ht._.TOURNAMENT_SHARE,!Ac){t.next=21;break}return t.next=17,Pc();case 17:return g=t.sent,v={playerId:f,playerName:m,score:e,leaderboardId:g},t.next=21,n(Cc(v));case 21:t.next=28;break;case 23:if(a=Ht._.TOURNAMENT_CREATE,!Ac){t.next=28;break}return y={playerId:f,playerName:m,score:e,autoStartGame:!1},t.next=28,n(Tc(y));case 28:if(c.event(a,{success:!0}),!1!==Ac){t.next=32;break}return t.next=32,o.requestTournamentAsync(e);case 32:n(kc(e)),t.next=40;break;case 35:if(t.prev=35,t.t0=t.catch(2),!(t.t0 instanceof Ec)){t.next=39;break}return t.abrupt("return");case 39:a&&c.event(a,{success:!1});case 40:case"end":return t.stop()}}),t,null,[[2,35]])})));return function(e,n){return t.apply(this,arguments)}}()},kc=function(e){return{type:di,payload:{score:e}}},xc=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"This opponentId is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),_c=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="WideFrameRenderFail",i.message=t||"Wide frame render fail",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),Oc={PASS_LEVELS:{ID:"pass-levels",EVENTS:{PASS_LEVEL:"pass-level"}},COLLECT_DIAMONDS:{ID:"collect-diamonds",EVENTS:{COLLECT_DIAMONDS:"collect-diamonds"}},INVITE_FRIENDS:{ID:"invite-friends",EVENTS:{INVITED_FRIEND:"INVITED_FRIEND"}},REACH_SCORE:{ID:"reach-score",EVENTS:{ADD_SCORE:"add-score"}},EVENTS:{TASKS_RESET:"tasks-reset",NOTICE_UPDATE:"notice-update"}},Dc=function(e,t){return t.playerId},Rc=(0,K.P1)([function(e){return cc(e).match.isRequesting}],(function(e){return e})),Mc=(0,K.P1)([function(e){return cc(e).match.single}],(function(e){return e})),Lc=(0,K.P1)([function(e){return cc(e).match.single._id}],(function(e){return e})),Bc=(0,K.P1)([function(e){return cc(e).match.single.score}],(function(e){return e||0})),Nc=((0,K.P1)([function(e){return cc(e).match.single.level}],(function(e){return e||0})),(0,K.P1)([function(e){var t;return null==(t=cc(e).match.single.data)?void 0:t.diamond}],(function(e){return e||0})),(0,K.P1)([function(e){var t;return null==(t=cc(e).match.single.data)?void 0:t.fen}],(function(e){return e||null})),(0,K.P1)([function(e){return cc(e).match.single.status}],(function(e){return e})),(0,K.P1)([function(e){return cc(e).match.single.playerId}],(function(e){return e})),(0,K.P1)([function(e){return cc(e).match.challenge}],(function(e){return e}))),Fc=(0,K.P1)([function(e){return cc(e).match.challenge._id}],(function(e){return e})),Gc=(0,K.P1)([function(e){return cc(e).match.challenge.status}],(function(e){return e})),Zc=(0,K.P1)([function(e){return cc(e).match.challenge.opponentInfo}],(function(e){return e})),Uc=((0,K.P1)([function(e){return cc(e).match.challenge.whitePlayerId}],(function(e){return e})),(0,K.P1)([function(e){return cc(e).match.challenge.blackPlayerId}],(function(e){return e})),(0,K.P1)([Nc,Dc],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId;return n!==t&&i===t?n:i!==t&&n===t?i:""})),(0,K.P1)([Nc,Dc],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId;return n===t?n:i===t?i:ka.playerId}))),Hc=(0,K.P1)([Nc,Dc],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,a=e.whitePlayerFinish,s=e.blackPlayerFinish;return t&&n===t?a:!(!t||i!==t)&&s})),Vc=(0,K.P1)([Nc,function(e,t){return t.opponentId}],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,a=e.whitePlayerFinish,s=e.blackPlayerFinish;return t&&n===t?a:!(!t||i!==t)&&s})),Wc=(0,K.P1)([function(e){return cc(e).match.group.opponentInfo}],(function(e){return e})),Yc=((0,K.P1)([function(e){return cc(e).match.online.players}],(function(e){return e})),(0,K.P1)([function(e){return cc(e).match.journey}],(function(e){return e}))),zc=(0,K.P1)([function(e){return cc(e).match.journey._id}],(function(e){return e})),Kc=(0,K.P1)([function(e){return cc(e).match.journey.level}],(function(e){return e})),jc=(0,K.P1)([function(e){return cc(e).match.journey.challengeMode}],(function(e){return e})),Xc=(0,K.P1)([function(e){return cc(e).match.journey.score}],(function(e){return e})),qc=(0,K.P1)([function(e){return cc(e).stats.data}],(function(e){return e})),Jc=(0,K.P1)([function(e){return cc(e).stats.current}],(function(e){return e})),Qc=((0,K.P1)([function(e){return cc(e).stats.isRequesting}],(function(e){return e})),(0,K.P1)([function(e){return e.messages.data}],(function(e){return e}))),$c=(0,K.P1)([Qc,function(e,t){return t.opponentId}],(function(e,t){return!!GameCore.Utils.Valid.isString(t)&&(!!GameCore.Utils.Object.hasOwn(e,t)&&e[t].sent)})),eh=n(26729),th=new(n.n(eh)()),nh=n(8712),ih=n.n(nh),ah=n(25110),sh=n.n(ah),rh=n(33733),oh=n.n(rh),ch=n(19389),hh=n.n(ch);function lh(e,t){var n="undefined"!==typeof oh()&&hh()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return uh(e,t);var i=Ne()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return sh()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return uh(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ph=function(e){if("string"!==typeof e||!e)throw new _c(null,{imageShare:e})},dh=function(e){return(0,r.Z)(h().mark((function t(){var n,a,s,r,o,c,l,u,p,d;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game,a=n.player,s=n.analytics,r=n.facebook,o=n.globalScene,t.prev=1,o.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),t.next=5,fh(e);case 5:return c=t.sent,ph(c),l=a.getPlayer(),u=l.playerId,p=l.name,d=l.photo,t.next=10,r.shareAsync({text:"Great! I have a best score!",intent:"SHARE",image:c||"",data:{playerId:u,playerName:p,playerPhoto:d,type:Ta}});case 10:s.event(Ht._.SHARE,{share_content_type:"BestScore",success:!0}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),s.event(Ht._.SHARE,{share_content_type:"BestScore",success:!1}),(0,i.tO)(t.t0);case 17:return t.prev=17,o.screen.close(ps.o4.NOTIFY_SCREEN),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[1,13,17,20]])})))},fh=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r,o,c,l,u,p;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=i.getPlayer(),r=s.playerId,o=s.photo,c=s.data,l=(c||{}).score,u=gh({playerId:r,playerPhoto:o,playerScore:l,listPositionGems:t})){e.next=7;break}return e.abrupt("return");case 7:return p={name:"share-best-score",width:952,height:492,renderOptions:u},e.next=10,a.frameCapture.capture(p);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mh=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r,o,c,l,u,p,d,f;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=Jc(t),r=qc(t),o=i.getPlayer(),c=o.playerId,l=o.photo,u=r[c]||{},p=u.score,s.bestScore>p&&(p=s.bestScore),d=gh({playerId:c,playerPhoto:l,playerScore:p})){e.next=10;break}return e.abrupt("return");case 10:return f={name:"share-current-score",width:952,height:492,renderOptions:d},e.next=13,a.frameCapture.capture(f);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gh=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.playerScore,r=void 0===s?0:s;e.listPositionGems;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof r?null:{avatar:{name:""+n,type:"image",x:195,y:132,image:a,width:180,height:180,fallbackWithImage:Ia.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:286,y:400,font:"600 70px",fillStyle:"#c4683f",text:""+r,textAlign:"center"},playerScore:{type:"text",x:286,y:400,font:"600 70px",fillStyle:"#f2a62e",text:""+r,textAlign:"center"}}},vh=(function(){var e=(0,r.Z)(h().mark((function e(){var t,n,i,a,s,r,o,c,l,u,p,d,f,m,g,v,y,S,E,A,b;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.profile,a=t.globalScene,s=n.getPlayer(),r=s.playerId,o=s.name,c=s.photo,l=n.getBestScore(),(u=n.getConnectedPlayerIds(99,0)).push(r),p=[],e.next=8,Qo({playerIds:GameCore.Utils.Array.unique(u),limit:u.length});case 8:d=e.sent,f=GameCore.Utils.Object.keyBy(d,"playerId"),m={playerId:r,name:o,photo:c,score:0},GameCore.Utils.Object.hasOwn(f,r)&&(m=f[r]),p.push(m),e.t0=ih()(h()).call(h(),f);case 15:if((e.t1=e.t0()).done){e.next=28;break}if(g=e.t1.value,!GameCore.Utils.Object.hasOwn(f,g)){e.next=26;break}if(v=f[g],3!==p.length){e.next=21;break}return e.abrupt("break",28);case 21:if(v.playerId!==r){e.next=23;break}return e.abrupt("continue",15);case 23:if(!(Number(v.score)>Number(m.score))){e.next=25;break}return e.abrupt("continue",15);case 25:p.push(v);case 26:e.next=15;break;case 28:return y=GameCore.Utils.Array.unique(u),e.next=31,i.requestProfiles(y);case 31:if(S=i.getProfiles(),p.forEach((function(e,t){var n=e.playerId;if(GameCore.Utils.Object.hasOwn(S,n)){var i=S[n],a=i.name,s=i.photo;p[t].name=a,p[t].photo=s}})),p.length<3)for(E=0;E<=3-p.length;)p.push({playerId:"bot"+E,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),E++;if(A=vh({playerId:r,playerName:o,playerPhoto:c,playerScore:l})){e.next=38;break}return e.abrupt("return");case 38:return b={name:"share-leaderboard",width:1500,height:2e3,renderOptions:A},e.next=41,a.frameCapture.capture(b);case 41:return e.abrupt("return",e.sent);case 42:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.listLeaders,r=void 0===s?[]:s,o=e.playerScore,c=void 0===o?"???":o;if(!Array.isArray(r))return null;if("string"!==typeof n)return null;if("string"!==typeof a)return null;var h={avatar:{name:""+n,type:"image",x:490,y:190,image:a,width:525,height:525,fallbackWithImage:Ia.Z.AVATAR.KEY}};return r.forEach((function(e,t){var n=e.playerId,i=e.photo;h["photo_"+n]={name:""+n,type:"image",x:475,y:1215+385*t,image:i,width:150,height:150,fallbackWithImage:Ia.Z.AVATAR.KEY}})),h.wideFrame={name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:1500,height:2e3},h.playerScore={type:"text",x:1100,y:220,font:"600 170px",text:""+c,textAlign:"center"},r.forEach((function(e,t){var n=e.playerId,i=e.name,a=e.score;h["name_"+n]={type:"text",x:690,y:1312+193*t,font:"600 60px",text:i,fillStyle:"#b18151"},h["score_"+n]={type:"text",x:1070,y:1312+193*t,font:"600 55px",text:a,fillStyle:"#b18151"}})),h}),yh=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r,o,c,l,u,p,d,f,m,g,v,y,S,E;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=qc(t),r=i.getPlayer(),o=r.photo,c=r.playerId,l=Zc(t),u=l.playerId,p=l.photo,d=Hc(t,{playerId:c}),f=Vc(t,{opponentId:u}),m=s[c]||{},g=m.score,v=s[u]||{},y=v.score,S=Eh({playerId:c,playerPhoto:o,playerScore:g,opponentId:u,opponentPhoto:p,opponentScore:y,isPlayerFinished:d,isOpponentFinished:f})){e.next=12;break}return e.abrupt("return");case 12:return E={name:"share-game-result",width:952,height:492,renderOptions:S},e.next=15,a.frameCapture.capture(E);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Sh=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r,o,c,l,u,p,d,f,m,g,v;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=qc(t),r=i.getPlayer(),o=r.photo,c=r.playerId,l=Wc(t),u=l.playerId,p=l.photo,d=l.score,f=s[c]||{},m=f.score,g=Eh({playerId:c,playerPhoto:o,playerScore:m,opponentId:u,opponentPhoto:p,opponentScore:d})){e.next=9;break}return e.abrupt("return");case 9:return v={name:"share-group-match-result",width:952,height:492,renderOptions:g},e.next=12,a.frameCapture.capture(v);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Eh=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.playerScore,r=void 0===s?0:s,o=e.opponentId,c=void 0===o?"20":o,h=e.opponentPhoto,l=void 0===h?"":h,u=e.opponentScore,p=void 0===u?0:u,d=e.isPlayerFinished,f=e.isOpponentFinished;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof r)return null;if("string"!==typeof c)return null;if("string"!==typeof l)return null;if("number"!==typeof p)return null;if("boolean"!==typeof d)return null;if("boolean"!==typeof f)return null;var m=r===p,g=r>p,v=d||f,y=d&&f,S={leftPhoto:{name:""+n,type:"image",x:240,y:112,image:a,width:220,height:220,fallbackWithImage:Ia.Z.AVATAR.KEY},rightPhoto:{name:""+c,type:"image",x:35,y:142,image:l,width:200,height:200,fallbackWithImage:Ia.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:952,height:492}};return v&&(S.leftScoreShadow={type:"text",x:358,y:413,font:"600 70px",fillStyle:"#c4683f",text:d?""+r:"???",textAlign:"center"},S.leftScore={type:"text",x:358,y:413,font:"600 70px",fillStyle:"#f2a62e",text:d?""+r:"???",textAlign:"center"},S.rightScoreShadow={type:"text",x:135,y:383,font:"600 40px",fillStyle:"#c4683f",text:f?""+p:"???",textAlign:"center"},S.rightScore={type:"text",x:135,y:383,font:"600 40px",fillStyle:"#f2a62e",text:f?""+p:"???",textAlign:"center"}),!m&&y&&(g?S.leftCrown={name:"crown-icon",type:"image",x:312,y:32,image:"./assets/images/others/crown-icon.png",width:66,height:66}:S.rightCrown={name:"crown-icon",type:"image",x:99,y:73,image:"./assets/images/others/crown-icon.png",width:66,height:66}),S},Ah=function(){return function(){var e=(0,r.Z)(h().mark((function e(t){var n,a,s,r,o,c,l,u,p,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game,a=n.player,s=n.analytics,r=n.facebook,o=n.globalScene,e.prev=1,o.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),e.next=5,bh();case 5:return c=e.sent,ph(c),l=a.getPlayer(),u=l.playerId,p=l.name,d=l.photo,e.next=10,r.shareAsync({text:"Great! I have a score!",intent:"SHARE",image:c||"",data:{playerId:u,playerName:p,playerPhoto:d,type:Ta}});case 10:s.event(Ht._.SHARE,{share_content_type:"Score",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),s.event(Ht._.SHARE,{share_content_type:"Score",success:!1}),(0,i.tO)(e.t0);case 17:return e.prev=17,o.screen.close(ps.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})));return function(t){return e.apply(this,arguments)}}()},bh=function(){var e=(0,r.Z)(h().mark((function e(){var t,n,i,a,s,r,o,c,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,o=n.getBestScore(),c=Th({playerId:s,playerPhoto:r,playerScore:o})){e.next=7;break}return e.abrupt("return");case 7:return l={name:"share-score",width:952,height:492,renderOptions:c},e.next=10,i.frameCapture.capture(l);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Th=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.playerScore,r=void 0===s?0:s;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof r?null:{avatar:{name:""+n,type:"image",x:195,y:132,image:a,width:180,height:180,fallbackWithImage:Ia.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:286,y:400,font:"600 70px",fillStyle:"#c4683f",text:""+r,textAlign:"center"},playerScore:{type:"text",x:286,y:400,font:"600 70px",fillStyle:"#f2a62e",text:""+r,textAlign:"center"}}},Ch=(function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r,o,c,l,u,p;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=i.getPlayer(),r=s.playerId,o=s.photo,c=s.data,l=(c||{}).score,u=Ch({playerId:r,playerPhoto:o,playerScore:l,listPositionGems:t})){e.next=7;break}return e.abrupt("return");case 7:return p={name:"share-daily-challenge",width:606,height:304,renderOptions:u},e.next=10,a.frameCapture.capture(p);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,s=e.playerScore,r=void 0===s?0:s,o=e.listPositionGems,c=void 0===o?[]:o;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof r)return null;for(var h,l={avatar:{name:""+n,type:"image",x:403,y:70,image:a,width:136,height:136,fallbackWithImage:Ia.Z.AVATAR.KEY,radius:2*Math.PI},background:{name:"bg",type:"image",x:0,y:0,image:"./assets/wideframes/bg.png",width:606,height:304},board:{name:"board",type:"image",x:20,y:20,image:"./assets/wideframes/board.png",width:261,height:261},playerScore:{type:"text",x:470,y:260,font:"600 50px",fillStyle:"blue",text:""+r,textAlign:"center"}},u=lh(c);!(h=u()).done;){var p=h.value,d=p.index,f=p.i,m=p.j;l["gem_"+d+f+m]={name:d,type:"image",x:29*m+20,y:29*f+20,image:"./assets/wideframes/"+d+".png",width:29,height:29}}return l}),Ph=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new rc(null,{contextId:t})},wh=function(e){var t=e.opponentId,n=e.contextId;if(""===t||"string"!==typeof t)throw new xc(null,{opponentId:t});if(""===n||"string"!==typeof n)throw new rc(null,{contextId:n})},Ih=function(e){if(null===e.imageShare)throw new _c},kh=function(e,t){return void 0===t&&(t=!0),function(n,i){var a,s=i(),r=Qc(s);if(t){var o;if(null!=(o=r[e])&&o.sent)return;n(xh(e))}null!=(a=r[e])&&a.sent&&n(_h(e))}},xh=function(e){return{type:Qt.qj,payload:{opponentId:e}}},_h=function(e){return{type:Qt.rh,payload:{opponentId:e}}},Oh=function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=window.game.facebook,wh({opponentId:t,contextId:n}),(s=FBInstant.context.getID())!==n||""===n){e.next=6;break}return e.abrupt("return",s);case 6:if("10"!==t||""===n){e.next=8;break}return e.abrupt("return",n);case 8:if(!n){e.next=12;break}return e.next=11,a.switchAsync(n);case 11:return e.abrupt("return",FBInstant.context.getID());case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,i.tO)(e.t0);case 17:return e.abrupt("return","");case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}(),Dh=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(a,s){var r,o,c,l,u,p,d,f,m,g,v,y;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,o=r.player,c=r.analytics,l=r.facebook,n.prev=1,u=t.matchId,p=t.contextId,n.next=5,Oh(e,p);case 5:return d=n.sent,Ph({contextId:d}),f=s(),n.next=10,yh(f);case 10:return m=n.sent,Ih({imageShare:m}),g=o.getPlayer(),v=g.name,y=g.playerId,n.next=15,l.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:v+" challenges you",localizations:{en_US:v+" challenges you",vi_VN:v+" th\u1eed th\xe1ch b\u1ea1n trong tr\u1eadn \u0111\u1ea5u n\xe0y. Ch\u01a1i ngay!"}},image:m||"",template:"challenge",data:{type:Pa,matchId:u,playerId:y,opponentId:e,status:si}});case 15:a(kh(e)),c.event(Ht._.MESSAGE,{message_content_type:"Invite",success:!0}),th.emit(Oc.INVITE_FRIENDS.EVENTS.INVITED_FRIEND,{type:"friend",value:1,opponentId:e}),n.next=24;break;case 20:n.prev=20,n.t0=n.catch(1),c.event(Ht._.MESSAGE,{message_content_type:"Invite",success:!1}),(0,i.tO)(n.t0);case 24:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(e,t){return n.apply(this,arguments)}}()},Rh=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(a,s){var r,o,c,l,u,p,d,f,m,g,v,y;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,o=r.player,c=r.analytics,l=r.facebook,n.prev=1,u=t.matchId,p=t.contextId,n.next=5,Oh(e,p);case 5:return d=n.sent,Ph({contextId:d}),f=s(),n.next=10,yh(f);case 10:return m=n.sent,Ih({imageShare:m}),g=o.getPlayer(),v=g.name,y=g.playerId,n.next=15,l.sendMessage({cta:{default:"See result",localizations:{en_US:"See result",vi_VN:"Xem k\u1ebft qu\u1ea3"}},text:{default:v+" just finished. Check them now.",localizations:{en_US:v+" just finished. Check them now.",vi_VN:v+" v\u1eeba ho\xe0n th\xe0nh m\xe0n ch\u01a1i. Nh\u1ea5n \u0111\u1ec3 xem k\u1ebft qu\u1ea3 tr\u1eadn \u0111\u1ea5u."}},image:m||"",template:"finished",data:{type:Pa,matchId:u,playerId:y,opponentId:e,status:ri}});case 15:a(kh(e)),c.event(Ht._.MESSAGE,{message_content_type:"FinishMatch",success:!0}),n.next=23;break;case 19:n.prev=19,n.t0=n.catch(1),c.event(Ht._.MESSAGE,{message_content_type:"FinishMatch",success:!1}),(0,i.tO)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[1,19]])})));return function(e,t){return n.apply(this,arguments)}}()},Mh=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(a,s){var r,o,c,l,u,p,d,f,m,g,v,y,S,E,A,b;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,o=r.player,c=r.analytics,l=r.facebook,n.prev=1,u=t.matchId,p=t.contextId,n.next=5,Oh(e,p);case 5:return d=n.sent,Ph({contextId:d}),f=s(),n.next=10,yh(f);case 10:return m=n.sent,Ih({imageShare:m}),g=o.getPlayer(),v=g.name,y=g.playerId,S=qc(f),E=S[y]||{},A=E.score,b=void 0===A?0:A,n.next=17,l.sendMessage({cta:{default:"See result",localizations:{en_US:"See result",vi_VN:"Xem k\u1ebft qu\u1ea3"}},text:{default:v+" beat your high score. Their score: "+b,localizations:{en_US:v+" beat your high score. Their score: "+b,vi_VN:v+" \u0111\xe3 v\u01b0\u1ee3t qua \u0111i\u1ec3m s\u1ed1 c\u1ee7a b\u1ea1n, v\u1edbi "+b+" \u0111i\u1ec3m!"}},image:m||"",template:"pass_score",data:{type:Pa,matchId:u,playerId:y,opponentId:e,status:ri}});case 17:a(kh(e)),c.event(Ht._.MESSAGE,{message_content_type:"BestScore",success:!0}),n.next=25;break;case 21:n.prev=21,n.t0=n.catch(1),c.event(Ht._.MESSAGE,{message_content_type:"BestScore",success:!1}),(0,i.tO)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[1,21]])})));return function(e,t){return n.apply(this,arguments)}}()},Lh=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(a,s){var r,o,c,l,u,p,d,f,m,g,v,y,S;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,o=r.player,c=r.analytics,l=r.facebook,n.prev=1,u=t.matchId,p=t.contextId,d=t.score,n.next=5,Oh(e,p);case 5:return f=n.sent,Ph({contextId:f}),m=s(),n.next=10,yh(m);case 10:return g=n.sent,Ih({imageShare:g}),v=o.getPlayer(),y=v.name,S=v.playerId,n.next=15,l.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:y+" got "+d+" scores. So easy! Can you?",localizations:{en_US:y+" got "+d+" scores. So easy! Can you?",vi_VN:y+" \u0111\xe3 \u0111\u1ea1t "+d+" \u0111i\u1ec3m! Nh\u1ea5n Ch\u01a1i \u0111\u1ec3 so t\xe0i!"}},image:g||"",template:"play_turn",data:{type:Pa,matchId:u,playerId:S,opponentId:e,status:si}});case 15:a(kh(e)),c.event(Ht._.MESSAGE,{message_content_type:"FinishTurn",success:!0}),n.next=25;break;case 19:if(n.prev=19,n.t0=n.catch(1),c.event(Ht._.MESSAGE,{message_content_type:"FinishTurn",success:!1}),!(n.t0 instanceof rc)){n.next=24;break}return n.abrupt("return");case 24:(0,i.tO)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[1,19]])})));return function(e,t){return n.apply(this,arguments)}}()},Bh=function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o,c,l,u,p,d,f;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=window.game,s=a.player,r=a.facebook,o=s.getPlayer(),c=o.playerId,l=o.name,u=o.photo,p=Jc(n),d=p.score,f={type:wa,playerId:c,playerName:l,playerPhoto:u,playerScore:d},e.next=7,r.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i"}},text:{default:l+" beats your high score. Their score: "+d+".",localizations:{en_US:l+" beats your high score. Their score: "+d+".",vi_VN:l+" v\u1eeba v\u01b0\u1ee3t \u0111i\u1ec3m s\u1ed1 cao nh\u1ea5t c\u1ee7a b\u1ea1n! Ch\u01a1i l\u1ea7n n\u1eefa ch\u1ee9?"}},image:t||"",template:"play_turn",data:f});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,i.tO)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Nh=function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o,c,l,u,p,d,f;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=window.game,s=a.player,r=a.facebook,e.prev=1,o=s.getPlayer(),c=o.playerId,l=o.name,u=o.photo,p=Jc(n),d=p.score,f={type:wa,playerId:c,playerName:l,playerPhoto:u,playerScore:d},e.next=7,r.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:l+" got "+d+" scores. So easy! Can you?",localizations:{en_US:l+" got "+d+" scores. So easy! Can you?",vi_VN:l+" \u0111\xe3 \u0111\u1ea1t "+d+" \u0111i\u1ec3m! Qu\xe1 d\u1ec5 lu\xf4n. Ch\u01a1i l\u1ea1i n\xe0o!"}},image:t||"",template:"play_turn",data:f});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),(0,i.tO)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Fh=n(87339),Gh=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchId",i.message=t||"Invalid match id",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),Zh=GameCore.Configs.ApiHost,Uh=(function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"single-matches",e.next=3,yt("single-matches",t,{},Zh);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"single-matches/active",e.next=3,vt("single-matches/active",{},Zh);case 3:return t=e.sent,e.abrupt("return",(null==t?void 0:t.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(h().mark((function e(t,n){var i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="single-matches/"+t+"/move",e.next=3,yt(i,n,{},Zh);case 3:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="single-matches/"+t+"/finish",e.next=3,yt(n,{},{},Zh);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"matches",e.next=3,yt("matches",{opponentPlayerId:t},{},Zh);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Hh=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t+"/join",e.next=3,yt(n,{},{},Zh);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vh=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t,e.next=3,vt(n,{},Zh);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Wh=function(){var e=(0,r.Z)(h().mark((function e(t,n,i,a){var s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="matches/"+t+"/finish",e.next=3,yt(s,{matchId:t,score:n,level:i,extraData:a},{},Zh);case 3:return r=e.sent,e.abrupt("return",(null==r?void 0:r.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),Yh=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchStatus",i.message=t||"The match status is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),zh=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"Invalid opponent id",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),Kh=zh,jh=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidBlackPlayerId",i.message=t||"Invalid black player id",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),Xh=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidRequestedMatchId",i.message=t||"The matchId in match data not matched with requested matchId",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),qh=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidScore",i.message=t||"The score is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),Jh=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidWhitePlayerId",i.message=t||"Invalid white player id",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),Qh=function(e){var t=e.matchId,n=e.score;if(""===t||"string"!==typeof t)throw new Gh(null,{matchId:t});if("number"!==typeof n)throw new qh(null,{score:n})},$h=function(e){var t=e.matchId,n=e.currentMatchId;if(""===t||"string"!==typeof t)throw new Gh(null,{matchId:t});if(""===n||"string"!==typeof n)throw new Gh(null,{currentMatchId:n});if(t!==n)throw new Xh(null,{matchId:t,currentMatchId:n})},el=function(e){var t=e.matchId,n=e.currentMatchId;if(""===t||"string"!==typeof t)throw new Gh(null,{matchId:t});if(""===n||"string"!==typeof n)throw new Gh(null,{currentMatchId:n});if(t!==n)throw new Xh(null,{matchId:t,currentMatchId:n})},tl=function(e){var t=e.playerId,n=e.match,i=n._id,a=n.playerId,s=n.status;if(""===i||"string"!==typeof i)throw new Gh(null,{matchId:i});if("finished"===s||"string"!==typeof s)throw new Yh("This match is finished",{status:s});if(a!==t)throw new ba(null,{playerId:a,currentPlayerId:t})},nl=function(e){var t=e.opponentId;if(""===t||"string"!==typeof t)throw new Kh(null,{opponentId:t})},il=function(e){var t=e.matchId;if(""===t||"string"!==typeof t)throw new Gh(null,{matchId:t})},al=function(e){var t=e.match,n=t._id,i=t.whitePlayerId,a=t.blackPlayerId;if(""===n||"string"!==typeof n)throw new Gh(null,{matchId:n});if(""===i||"string"!==typeof i)throw new Jh(null,{whitePlayerId:i});if(""===a||"string"!==typeof a)throw new jh(null,{blackPlayerId:a})},sl=GameCore.Configs.Match,rl=function(e){try{return GameCore.Utils.Hash.stringToHash(rt()(e))}catch(t){return""}},ol=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}},cl=function(){return function(){var e=(0,r.Z)(h().mark((function e(t){var n,a,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=window.game,a=n.player,n.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),t({type:Bn,payload:{}}),r=a.getPlayerId(),o=(0,s.Z)({},sl.LocalSingleMatchDefault,{status:"active",playerId:r,startedAt:Date.now(),rescued:0}),tl({playerId:r,match:o}),t(pl(o)),(0,Fh.vk)(sl.SingleMatchStore,o),e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(0),t(pl(null)),!(e.t0 instanceof Gh)){e.next=16;break}return e.abrupt("return");case 16:if(!(e.t0 instanceof Yh)){e.next=18;break}return e.abrupt("return");case 18:(0,i.tO)(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},hl=function(e,t){return function(n,a){try{Qh((0,s.Z)({matchId:e},t));var r=a(),o=Lc(r);$h({matchId:e,currentMatchId:o}),n({type:Fn,payload:{match:t}});var c=t.data;c&&te()(c).length>0?t.data=rl(c):t.data={},(0,Fh.vk)(sl.SingleMatchStore,t)}catch(h){if(h instanceof Gh)return;(0,i.tO)(h)}}},ll=function(e,t){return function(n,a){try{Qh((0,s.Z)({matchId:e},t));var r=a(),o=zc(r);$h({matchId:e,currentMatchId:o}),n({type:Hn,payload:{match:t}});var c=t.data;t.data=rl(c),t.challengeMode=!1;var h=window.game.player;(0,Fh.vk)(sl.JourneyMatchStore+"-"+h.getPlayerId(),t)}catch(l){if(l instanceof Gh)return;(0,i.tO)(l)}}},ul=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n,a){var r,o,c,l,u,p,d,f;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=window.game.player,il({matchId:e}),o=a(),c=Lc(o),l=r.getPlayerId(),el({matchId:e,currentMatchId:c}),n({type:"MATCH_SINGLE_FINISH_REQUEST",payload:{matchId:e}}),u=Mc(o),tl({playerId:l,match:u}),p=(0,s.Z)({},sl.LocalSingleMatchDefault,u,{_id:e,status:"finished",playerId:l,finishAt:Date.now()}),n(pl(p)),d=p.data,f=(0,s.Z)({},p),d&&te()(d).length>0?f.data=rl(d):f.data={},(0,Fh.vk)(sl.SingleMatchStore,f),t.next=26;break;case 18:if(t.prev=18,t.t0=t.catch(0),n(pl(null)),!(t.t0 instanceof Gh)){t.next=23;break}return t.abrupt("return");case 23:if(!(t.t0 instanceof Yh)){t.next=25;break}return t.abrupt("return");case 25:(0,i.tO)(t.t0);case 26:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e,n){return t.apply(this,arguments)}}()},pl=function(e){return{type:Gn,payload:{match:e}}},dl=function(e){return{type:Vn,payload:{match:e}}},fl=function(){return{type:Zn,payload:{}}},ml=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n){var a,s,r,o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=window.game,s=a.profile,a.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),r=e.playerId,nl({opponentId:r}),n({type:Xn,payload:{opponentInfo:e}}),t.next=8,Uh(r);case 8:return o=t.sent,al({match:o}),t.next=12,s.requestProfiles([r]);case 12:n(Sl(o)),t.next=23;break;case 15:if(t.prev=15,t.t0=t.catch(0),n(Sl(null)),!(t.t0 instanceof Gh)){t.next=20;break}return t.abrupt("return");case 20:if(!(t.t0 instanceof Kh)){t.next=22;break}return t.abrupt("return");case 22:(0,i.tO)(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}()},gl=function(e,t){return void 0===t&&(t=!0),function(){var n=(0,r.Z)(h().mark((function n(a){var s,r,o,c,l,u,p,d,f,m;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s=window.game,r=s.player,o=s.profile,c=s.globalScene,t&&c.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),il({matchId:e}),a({type:jn,payload:{matchId:e}}),n.next=7,Hh(e);case 7:if(l=n.sent,al({match:l}),u=l.status,p=l.whitePlayerId,d=l.blackPlayerId,u!==si){n.next=16;break}return f=r.getPlayerId(),m=f===p?d:p,n.next=16,o.requestProfiles([m]);case 16:a(Sl(l)),n.next=25;break;case 19:if(n.prev=19,n.t0=n.catch(0),a(Sl(null)),!(n.t0 instanceof Gh)){n.next=24;break}return n.abrupt("return");case 24:(0,i.tO)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[0,19]])})));return function(e){return n.apply(this,arguments)}}()},vl=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(a){var s,r,o,c,l,u,p,d,f;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s=window.game,r=s.player,s.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),il({matchId:e}),a({type:Jn,payload:{matchId:e,opponentInfo:t}}),n.next=7,Vh(e);case 7:o=n.sent,al({match:o}),c=o.whitePlayerId,l=o.whitePlayerScore,u=o.blackPlayerScore,p=r.getPlayerId(),d=r.getPlayerData(),f=d.score,a(Sl(o,{score:p===c?l:u,bestScore:f})),n.next=23;break;case 17:if(n.prev=17,n.t0=n.catch(0),a(Sl(null)),!(n.t0 instanceof Gh)){n.next=22;break}return n.abrupt("return");case 22:(0,i.tO)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[0,17]])})));return function(e){return n.apply(this,arguments)}}()},yl=function(e,t,n){return function(){var a=(0,r.Z)(h().mark((function a(s){var r,o;return h().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,window.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),il({matchId:e}),s({type:qn,payload:{matchId:e,score:t,extraData:n}}),r=n.level,a.next=8,Wh(e,t,r,n);case 8:return o=a.sent,al({match:o}),a.next=12,s(Sl(o));case 12:a.next=20;break;case 14:if(a.prev=14,a.t0=a.catch(0),s(Sl(null)),!(a.t0 instanceof Gh)){a.next=19;break}return a.abrupt("return");case 19:(0,i.tO)(a.t0);case 20:case"end":return a.stop()}}),a,null,[[0,14]])})));return function(e){return a.apply(this,arguments)}}()},Sl=function(e,t,n){return void 0===n&&(n=null),{type:Qn,payload:{match:e,opponentInfo:t,current:n}}},El=function(){return{type:$n,payload:{}}},Al=function(e){return{type:ei,payload:{opponentInfo:e}}},bl=function(e,t){return{type:ii,payload:{matchId:e,players:t}}},Tl=function(){return function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,r,o,c,l,u,p,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game.player,i=n.getPlayer(),a=i.playerId,e.prev=2,t({type:Nn,payload:{}}),e.next=6,window.FBInstant.player.getDataAsync(["level"]);case 6:r=e.sent,o=r.level,c=(0,Fh.Th)(sl.JourneyMatchStore+"-"+a)||{},l=c.data,u=c.level,c.data=ol(l),o!==u&&(c.data={}),p=o||1,d=(0,s.Z)({},c,{level:p,playerId:a}),t({type:Vn,payload:{match:d}}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2);case 20:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}()},Cl=function(){return function(){var e=(0,r.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:Wn,payload:{}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Pl=function(){return function(){var e=(0,r.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:Yn,payload:{}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},wl=function(e){return{type:Kn,payload:{level:e}}},Il=function(e){return{type:Rn,payload:{playerId:e}}},kl=function(e,t){return{type:Mn,payload:{playerId:e,stats:t}}},xl=function(e){return{type:Ln,payload:{stats:e}}},_l=GameCore.Configs.Match,Ol=[],Dl=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new rc(null,{contextId:t})},Rl=null,Ml=function(e){clearTimeout(Rl),Rl=setTimeout((function(){window.game.globalScene.screen.close(ps.o4.NOTIFY_SCREEN)}),e)},Ll=function(){return{type:wn,payload:{}}},Bl=function(e){return{type:Dn,payload:{stateShowMiniJourney:e}}},Nl=function(){return function(e){try{e(fl()),e(Kl(Da))}catch(t){(0,i.tO)(t)}}},Fl=function(){return function(e){try{e((function(){var e=(0,Fh.Th)(sl.SingleMatchStore);(0,Fh.vk)(sl.SingleMatchStore,(0,s.Z)({},e,{data:"",score:0}))})),e(fl()),e(Kl(xa))}catch(t){(0,i.tO)(t)}}},Gl=function(){return function(e){try{e(jl())}catch(t){(0,i.tO)(t)}}},Zl=function(){return function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),s=n(),r=hc(s),ce()(a=[xa,Da]).call(a,r)&&(t(fl()),t(cl())),o=null,r===_a&&(o=Zc(s),t(El())),t(Il()),e.next=11,t(Kl(r,o));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,i.tO)(e.t0);case 16:return e.prev=16,Ml(300),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()},Ul=function(e,t){return void 0===e&&(e="10"),void 0===t&&(t=!1),function(n){try{n(Hl("reset",e,t))}catch(a){(0,i.tO)(a)}}},Hl=function(e,t,n){return void 0===t&&(t="10"),void 0===n&&(n=!1),function(){var a=(0,r.Z)(h().mark((function a(s){var r,o,c,l,u,p,d,f,m,g,v,y,S,E,A,b,T;return h().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,r=window.game,o=r.player,c=r.facebook,(l=r.globalScene).screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),u=e,p=c.contextType,t||(d=GameCore.Configs.PlayerIdMock,f=GameCore.Configs.PlayerIdMock2,t=o.getPlayerId()===d?f:d),e){a.next=15;break}return a.next=9,c.chooseAsync();case 9:if(!1!==(u=a.sent)){a.next=13;break}return n&&l.events.emit(Ua.K5.SWITCH,Ua.Co.DASHBOARD_SCENE),a.abrupt("return");case 13:a.next=23;break;case 15:if(!t||t===ka.playerId){a.next=21;break}if(!1!==(u="123")){a.next=20;break}return n&&l.events.emit(Ua.K5.SWITCH,Ua.Co.DASHBOARD_SCENE),a.abrupt("return");case 20:u||"reset"===e||(u=e);case 21:p=c.contextType,s(Ba(u,p));case 23:return Dl({contextId:u}),m=o.getPlayerId(),g=o.getConnectedPlayers(),a.next=28,c.getContextPlayers(m);case 28:return v=a.sent,t!==(y=ka).playerId&&g[t]?y=g[t]:1===v.length&&(y=v[0]),s(Il()),E=(S=y).playerId,A=S.name,b=S.photo,T={playerId:E,name:A,photo:b},a.next=36,s(Kl(_a,T));case 36:s(Ba(u,p)),th.emit(Lo.START_GAME),a.next=50;break;case 40:if(a.prev=40,a.t0=a.catch(0),Ml(1e3),!(a.t0 instanceof rc)){a.next=45;break}return a.abrupt("return");case 45:if("USER_INPUT"!==(null==a.t0?void 0:a.t0.code)){a.next=47;break}return a.abrupt("return");case 47:if("INVALID_OPERATION"!==(null==a.t0?void 0:a.t0.code)){a.next=49;break}return a.abrupt("return");case 49:(0,i.tO)(a.t0);case 50:return a.prev=50,Ml(1e3),a.finish(50);case 53:case"end":return a.stop()}}),a,null,[[0,40,50,53]])})));return function(e){return a.apply(this,arguments)}}()},Vl=function(e){var t=window.game.player.getConnectedPlayerIds(20,0);if(!e||0===e.length)return t;for(var n=[],i=0;i<t.length;i++)ce()(e).call(e,t[i])||n.push(t[i]);return n},Wl=function(e){return void 0===e&&(e=null),function(){var t=(0,r.Z)(h().mark((function t(n){var a,s,r,o,c;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=window.game,s=a.facebook,r=a.globalScene,o=a.analytics,r.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),c=s.getContextID(),Dl({contextId:c}),o.event(Ht._.JOIN_GROUP,{group_id:c}),t.next=8,n(Kl(Oa,e));case 8:t.next=17;break;case 10:if(t.prev=10,t.t0=t.catch(0),!(t.t0 instanceof rc)){t.next=14;break}return t.abrupt("return");case 14:if("INVALID_OPERATION"!==(null==t.t0?void 0:t.t0.code)){t.next=16;break}return t.abrupt("return");case 16:(0,i.tO)(t.t0);case 17:return t.prev=17,Ml(1e3),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[0,10,17,20]])})));return function(e){return t.apply(this,arguments)}}()},Yl=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(a,s){var r,o,c,l,u,p,d,f,m,g,v,y,S,E,A;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,r=window.game,o=r.player,c=r.profile,l=r.facebook,(u=r.globalScene).screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),p=s(),d=o.getPlayerId(p),!((f=o.getConnectedPlayers(p)).length>0)||f[t]){n.next=9;break}return u.events.emit(Ua.K5.SWITCH,Ua.Co.DASHBOARD_SCENE),n.abrupt("return");case 9:return m=ka,n.next=12,l.getContextPlayers(d);case 12:if(g=n.sent,t===d||t===m.playerId||!f[t]){n.next=17;break}m=f[t],n.next=25;break;case 17:if(1!==g.length){n.next=21;break}m=g[0],n.next=25;break;case 21:return n.next=23,c.requestProfiles([t]);case 23:(v=c.getProfiles())[t]&&(m=v[t]);case 25:return n.next=27,a(vl(e,m));case 27:if(p=s(),Uc(p,{playerId:d})!==ka.playerId){n.next=32;break}return n.next=32,a(gl(e));case 32:if(p=s(),Uc(p,{playerId:d})===d||!f[t]){n.next=37;break}return a(Ul(t,!0)),n.abrupt("return");case 37:if(Fc(p)===e){n.next=41;break}return u.events.emit(Ua.K5.SWITCH,Ua.Co.DASHBOARD_SCENE),n.abrupt("return");case 41:if(y=Gc(p),S=Hc(p,{playerId:d}),a(ql({mode:_a,status:y})),E=l.getContextID(),A=l.contextType,a(Ba(E,A)),!S){n.next=52;break}return n.next=50,o.requestConnectedPlayers();case 50:return u.events.emit(Ua.K5.SWITCH,Ua.Co.GAME_SCENE),n.abrupt("return");case 52:u.events.emit(Ua.K5.SWITCH,Ua.Co.GAME_SCENE),n.next=58;break;case 55:n.prev=55,n.t0=n.catch(0),(0,i.tO)(n.t0);case 58:return n.prev=58,Ml(1e3),n.finish(58);case 61:case"end":return n.stop()}}),n,null,[[0,55,58,61]])})));return function(e,t){return n.apply(this,arguments)}}()},zl=function(e){return function(t){try{var n=window.game.player,a=n.getPlayerId();ic(a,e).catch((function(e){(0,i.tO)(new Error(e))}));var s=n.getPlayerData(),r=s.score,o=void 0===r?0:r,c=s.level;o<e&&n.setBestScore(e);var h={score:e,level:c};t(kl(a,h)),t(xl(h))}catch(l){if(l instanceof oc)return;(0,i.tO)(l)}}},Kl=function(e,t){return void 0===t&&(t=null),function(){var n=(0,r.Z)(h().mark((function n(a,s){var o,c,l,u,p,d,f,m,g,v,y,S,E,A,T,C,P,w,I;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,c=window.game,l=c.player,u=c.analytics,p=c.facebook,d=c.globalScene,f=p.getContextID(),m=0,g=s(),u.event(Ht._.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(e),level:1,level_name:"level_1"}),a(Ll()),!ce()(o=[xa,Da]).call(o,e)){n.next=16;break}return n.next=10,a((function(e){try{var t=window.game.player;e({type:Nn,payload:{}});var n=t.getPlayerId(),a=(0,Fh.Th)(sl.SingleMatchStore)||{},s=a.data;a.data=ol(s),tl({playerId:n,match:a}),e(pl(a))}catch(r){if(e(pl(null)),r instanceof Gh)return;if(r instanceof ba)return;if(r instanceof Yh)return;(0,i.tO)(r)}}));case 10:if(g=s(),Lc(g)){n.next=15;break}return n.next=15,a(cl());case 15:m=Bc(g);case 16:if(e===Oa&&a(Al(t)),e!==_a){n.next=26;break}return n.next=20,a(ml(t));case 20:g=s(),v=Fc(g),y=Zc(g),S=y.playerId,f||(f=window.FBInstant.context.getID()),E=$c(g,{opponentId:S}),f&&S&&!E&&a(Dh(S,{contextId:f,matchId:v}));case 26:"online"===e&&a(function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r,o,c,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=window.game.player,s=a.getPlayer(),r=s.playerId,o=s.name,c=s.photo,t({type:ni,payload:{playerId:r}}),l={},b()(n=cs()(i=new Array(20)).call(i,null)).call(n,(function(e,t){var n="0"+(t+1);l[n]={playerId:n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png"}})),l[r]={playerId:r,name:o,photo:c},t(bl("mock",l));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),g=s(),A=l.getPlayerData(g),T=A.score,C=void 0===T?0:T,P=Mc(g),w=P.rescued,I=void 0===w?0:w,a(xl({score:m,bestScore:C})),a({type:In,payload:{mode:e,contextId:f,rescued:I}}),a(Na(e)),d.events.emit(Ua.K5.SWITCH,Ua.Co.GAME_SCENE),n.next=44;break;case 37:if(n.prev=37,n.t0=n.catch(0),!(n.t0 instanceof Gh)){n.next=43;break}return window.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Sorry!, you can now\ncreate this match!",duration:2500,loading:!1}),n.abrupt("return");case 43:(0,i.tO)(n.t0);case 44:return n.prev=44,Ml(0),n.finish(44);case 47:case"end":return n.stop()}}),n,null,[[0,37,44,47]])})));return function(e,t){return n.apply(this,arguments)}}()},jl=function(){return function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,o,c,l,u,p,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=window.game,o=a.analytics,c=a.facebook,l=a.globalScene,u=c.getContextID(),p=n(),d=Kc(p)||1,o.event(Ht._.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(Ra),level:d}),t(Ll()),p=n(),zc(p)){e.next=12;break}return e.next=12,t(function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,r,o,c,l,u,p;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=window.game,r=a.player,a.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),t({type:Un,payload:{}}),o=n(),c=Kc(o)||1,l=jc(o),u=r.getPlayerId(),p=(0,s.Z)({},sl.LocalSingleMatchDefault,{level:c,status:"active",playerId:u,challengeMode:l,startedAt:Date.now(),updateAt:Date.now()}),tl({playerId:u,match:p}),t(dl(p)),(0,Fh.vk)(sl.JourneyMatchStore+"-"+u,p),e.next=22;break;case 14:if(e.prev=14,e.t0=e.catch(0),t(dl(null)),!(e.t0 instanceof Gh)){e.next=19;break}return e.abrupt("return");case 19:if(!(e.t0 instanceof Yh)){e.next=21;break}return e.abrupt("return");case 21:(0,i.tO)(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 12:t({type:In,payload:{mode:Ra,contextId:u}}),l.events.emit(Ua.K5.SWITCH,Ua.Co.JOURNEY_SCENE),e.next=23;break;case 16:if(e.prev=16,e.t0=e.catch(0),!(e.t0 instanceof Gh)){e.next=22;break}return window.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Sorry!, you can now\ncreate this match!",duration:2500,loading:!1}),e.abrupt("return");case 22:(0,i.tO)(e.t0);case 23:return e.prev=23,Ml(0),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[0,16,23,26]])})));return function(t,n){return e.apply(this,arguments)}}()},Xl=function(e,t){return function(){var n=(0,r.Z)(h().mark((function n(i,a){var s,r,o,c,l,u,p,d,f,m;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=window.game.player,o=t.score,c=void 0===o?0:o,l=t.level,u=void 0===l?0:l,p=a(),!ce()(s=[xa,Da]).call(s,e)){n.next=7;break}return d=Lc(p),n.next=7,i(ul(d));case 7:if(e===Oa&&(i({type:ti,payload:{}}),f=r.getPlayerId(),i(kl(f,t))),e!==_a){n.next=12;break}return m=Fc(p),n.next=12,i(yl(m,c,{level:u}));case 12:i({type:kn,payload:{mode:e}}),th.emit(Lo.GAME_OVER);case 14:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},ql=function(e){return function(t){var n=e.mode,a=e.status;t({type:xn,payload:{mode:n,status:a}}),(0,i.sw)("game-mode",n)}},Jl=function(){return function(e,t){var n=t(),i=Jc(n).level,a=void 0===i?0:i,s=hc(n);window.game.analytics.event(Ht._.MATCH_RESCUE,{game_mode:GameCore.Utils.String.toUpperCamelCase(s),level:a,level_name:"level_"+a}),e({type:_n,payload:{}})}},Ql=n(75742),$l={LOGO:{KEY:"spine-logo",JSON:"assets/spine/logo/logo.json",ATLAS:"assets/spine/logo/logo.atlas",ANIMATIONS:{START_GROW:"start_grow",IDLE_GROW:"idle_grow"}},BEST_SCORE:{KEY:"best-score",JSON:"assets/spine/best-score/newbest-trim.json",ATLAS:"assets/spine/best-score/newbest-trim.atlas",ANIMATIONS:{ANIM:"anim5"}}},eu=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.bestScoreSpine=void 0,n.scene=t,t.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createSpineEffect=function(){var e=this,t=this.scene.world.getPixelRatio(),n=this.scene.gameZone,i=n.width,a=n.height/2;this.bestScoreSpine=this.scene.add.spine(-i/2,a,$l.BEST_SCORE.KEY,$l.BEST_SCORE.ANIMATIONS.ANIM),this.bestScoreSpine.preMultipliedAlpha=!0,this.bestScoreSpine.scale=1/t,this.add(this.bestScoreSpine),this.bestScoreSpine.on("complete",(function(){e.bestScoreSpine.setVisible(!1)}))},n.playEffect=function(){this.bestScoreSpine?(this.bestScoreSpine.setVisible(!0),this.bestScoreSpine.play($l.BEST_SCORE.ANIMATIONS.ANIM)):this.createSpineEffect()},t}(Phaser.GameObjects.Container),tu=n(12373),nu=n.n(tu),iu=GameCore.Configs,au=iu.Gameplay,su=iu.Match.Levels,ru=function(){function e(){this.levelIndex=0,this.levels=su,this.recentLevel=void 0}var t=e.prototype;return t.increaseLevel=function(){this.levelIndex++},t.getCurrentTargetScore=function(){return this.levels[this.levelIndex]},t.getNextTargetScoreLevel=function(){return this.levels[this.levelIndex+1]},t.getCurrentIndex=function(){return this.levelIndex},t.updateCurrentLevelByScore=function(e){var t,n=nu()(t=this.levels).call(t,(function(t){return t>e}));if(-1===n)return this.handleAutoGrantNewLevel(e);this.levelIndex=n;var i=this.levels[n-1];return i&&(this.recentLevel=i),this.levels[n]},t.restart=function(){this.levelIndex=0,this.recentLevel=0},t.handleAutoGrantNewLevel=function(e){var t=au.Progress.BonusScore,n=this.levels[this.levels.length-1]+t;return this.levels.push(n),n<=e?this.handleAutoGrantNewLevel(e):(this.levelIndex=this.levels.length-1,this.recentLevel=this.levels[this.levelIndex],n)},e}(),ou=n(70932),cu=function(){var e,t=window.game.facebook;return t?(null==(e=t.platform)?void 0:e.toLowerCase())||"":null},hu=function(){return"web"==cu()},lu=Math.sin,uu=Math.cos,pu=function(e,t,n){return e*uu(t)*n},du=function(e,t,n,i){return void 0===i&&(i=10),e*lu(t)*n-.5*i*Math.pow(n,2)},fu=us.Z.GAMEPLAY_32,mu=fu.KEY,gu=fu.FRAME,vu=function(e){function t(t,n){var i;return(i=e.call(this,t,n.x+(n.padding||0),n.y+(n.padding||0),mu,gu.GEM)||this).scene=void 0,i.canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.imageBreak=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenStartMission=void 0,i.setWorldSize(n.width,n.height),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.scene=t,i.createImageGameStart(),i.createImageBreak(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),t.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:mu,frame:gu.GEM_WHITE}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:mu,frame:gu.GEM_GLARE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:mu,frame:gu.GEM_SILVER}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:1200,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:mu,frame:gu.GEM_LIGHT}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var e=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:e,to:0,start:e},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:150,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:.2,to:.68},paused:!0})},n.showImageHighlight=function(){this.imageHighlight.setVisible(!0).setAlpha(1)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(e){this.rateShaking=e},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.x=this.x0,this.imageGameOver.y=this.y0,this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(){this.resetImageBreak(),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play(),this.tweenScaleDown.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var e=this.alpha0<90?1:-1;this.t0+=3e3/1900;var t=.016*this.t0,n=pu(this.v0,this.alpha0,t),i=du(this.v0,this.alpha0,t);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,this.imageBreak.rotation+=.04*e,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,s=a.width,r=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>s||this.imageBreak.y-this.imageBreak.displayHeight/2>r)&&(this.status="")},t}(Phaser.GameObjects.Image),yu=vu,Su=n(81607),Eu=n.n(Su),Au=GameCore.Configs.Board,bu=(Au.cols,Au.rows),Tu=void 0===bu?8:bu,Cu=0,Pu=function(){return Cu},wu=function(e,t){Cu=0;for(var n=[],i=e.length,a=e[0].length,s=[],r=[],o=function(t){for(var i=!0,r=0;r<a;r++)0===e[t][r].value&&(i=!1);if(i){s.push(t);for(var o=function(e){n.some((function(n){return n.x===e&&n.y===t}))||n.push({x:e,y:t})},c=0;c<a;c++)o(c)}},c=0;c<i;c++)o(c);for(var h=function(t){for(var a=!0,s=0;s<i;s++)0===e[s][t].value&&(a=!1);if(a){r.push(t);for(var o=function(e){n.some((function(n){return n.x===t&&n.y===e}))||n.push({x:t,y:e})},c=0;c<i;c++)o(c)}},l=0;l<a;l++)h(l);var u=xu(e,t);if(u&&u.length>0)for(var p=function(){var e=u[d],t=e.x,i=e.y;n.some((function(e){return e.x===t&&e.y===i}))||n.push({x:t,y:i})},d=0;d<u.length;d++)p();return Cu+=s.length,Cu+=r.length,Cu+=Math.floor(u.length/9),n},Iu=function(e,t){if(0===e.length)return!1;var n=E()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return!(!n||n.length<=0)},ku=function(e,t){for(var n=t.x,i=t.y,a=[],s=n;s<n+3;s++)for(var r=i;r<i+3;r++){if(0===e[r][s].value)return[];a.push({x:s,y:r})}return a},xu=function(e,t){for(var n=[],i=function(e){for(var t,n=[],i=0;i<e.length;i++){var a=(t=e[i],{x:3*Math.floor(t.x/3),y:3*Math.floor(t.y/3)});Iu(n,a)||n.push(a)}return n}(t),a=0;a<i.length;a++){var s=i[a],r=ku(e,s);n.push.apply(n,r)}return n},_u=function(e){for(var t=e.length,n=e[0].length,i=[],a=0;a<t;a++){for(var s=!0,r=0;r<n;r++)0===e[a][r].value&&(s=!1);s&&i.push(a)}return i},Ou=function(e){for(var t=e.length,n=e[0].length,i=[],a=0;a<n;a++){for(var s=!0,r=0;r<t;r++)0===e[r][a].value&&(s=!1);s&&i.push(a)}return i},Du=function(e,t){var n=e.length,i=e[0].length;if(0===t.length)return!1;for(var a=0;a<n;a++)for(var s=0;s<i;s++)for(var r=0;r<t.length;r++)if(Ru(e,s,a,t[r]))return!1;return!0},Ru=function(e,t,n,i){for(var a=!0,s=0;s<i.data.length;s++)for(var r=0;r<i.data[s].length;r++)i.data[s][r].texture&&(e[n+s]&&e[n+s][t+r]&&0===e[n+s][t+r].value||(a=!1));return a},Mu=function(e,t){for(var n=e.length,i=e[0].length,a=0;a<n;a++)for(var s=0;s<i;s++)if(Ru(e,s,a,t))return!0;return!1},Lu=0,Bu=function(){return Lu++,18+10*(Nu()-1)},Nu=function(){return Lu+1},Fu=function(e){var t=e;switch(e){case Ws:t="b";break;case Ys:t="c";break;case zs:t="d";break;case Ks:t="g";break;case js:t="o";break;case Xs:t="p";break;case qs:t="q";break;case Js:t="r";break;case Qs:t="y";break;case tr:t="l";break;case nr:t="l1";break;case ir:t="l3";break;case ar:t="e2";break;case sr:t="e3";break;case rr:t="e4";break;case or:t="e5";break;case cr:t="s1";break;case hr:t="s2";break;case lr:t="s3";break;case ur:t="tz";break;case pr:t="ta";break;case Fs:t="dt";break;case Bs:t="dl";break;case Ns:t="dr";break;case Gs:t="db";break;case Ms:t="v";break;case Ls:t="h";break;case Zs:t="vl";break;case Us:t="vr";break;case Hs:t="hl";break;case Vs:t="hr"}return t},Gu=function(e){var t=e;switch(e){case"b":t=Ws;break;case"c":t=Ys;break;case"d":t=zs;break;case"g":t=Ks;break;case"o":t=js;break;case"p":t=Xs;break;case"q":t=qs;break;case"r":t=Js;break;case"y":t=Qs;break;case"l":t=tr;break;case"l1":t=nr;break;case"l3":t=ir;break;case"e2":t=ar;break;case"e3":t=sr;break;case"e4":t=rr;break;case"e5":t=or;break;case"s1":t=cr;break;case"s2":t=hr;break;case"s3":t=lr;break;case"tz":t=ur;break;case"ta":t=pr;break;case"dt":t=Fs;break;case"dl":t=Bs;break;case"dr":t=Ns;break;case"db":t=Gs;break;case"v":t=Ms;break;case"h":t=Ls;break;case"vl":t=Zs;break;case"vr":t=Us;break;case"hl":t=Hs;break;case"hr":t=Vs}return t},Zu=function(e){for(var t=[],n="12345678x",i=e.split(""),a=0;a<i.length;a++)if(xt()(n).call(n,i[a])>=0)for(var s="x"===i[a]?Tu:Number(i[a]),r=0;r<s;r++)t.push({value:0,frame:"gem/gem_transparent"});else t.push({value:1,frame:Gu(i[a])});return t},Uu=function(e){var t=e.split(","),n=t[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:Gu(n[0]),direction:Gu(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,frame:Gu(t[1])}},Hu=us.Z.GAMEPLAY_32,Vu=Hu.KEY,Wu=Hu.FRAME,Yu=GameCore.Configs.Board,zu=Yu.cols,Ku=Yu.rows,ju=function(e){function t(n,i,a){var s;return(s=e.call(this,n)||this).scene=void 0,s.type=void 0,s.direction=void 0,s.isReverse=!1,s.data=[],s.matrixData=void 0,s.texture=void 0,s.frame=void 0,s.maxHeight=void 0,s.cellItems=[],s.originalData=void 0,s.isSetDrag=!1,s.isCreateCell=!1,s.wrap=void 0,s.wrapPiece=void 0,s.isDragEnd=!1,s.isActive=!0,s.isVisible=!0,s.pointerY=void 0,s.parentHeight=void 0,s.index=void 0,s.props=void 0,s.cells=[],s.parent=void 0,s.moveTopNumber=30,s.backupPx=void 0,s.backupPy=void 0,s.animMoveTopAndScaleUp=void 0,s.animMoveDownAndScaleDown=void 0,s.animScaleUp=void 0,s.animScaleDown=void 0,s.distancePY=void 0,s.isCanMove=void 0,s.correctAlpha=1,s.props=a,s.type=a.type,s.matrixData=a.matrixData,s.data=t.buildData(s.matrixData),s.direction=a.direction||null,s.parentHeight=a.parentHeight||0,s.isReverse=a.isReverse||!1,s.parent=i,s.scene=n,s.scene.add.existing((0,as.Z)(s)),s.createWrapPiece(),s.listenEvents(),s}(0,o.Z)(t,e);var n=t.prototype;return n.createWrapPiece=function(){var e=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:Vu,frame:Wu.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(e,e)},n.updatePosition=function(e,t){var n=this.getContainerSize(),i=n.width,a=n.height,s=this.parent.cellSize,r=this.scene.gameZone.width;this.setPosition(e+r/6-i/2+s/2,t-a/2+s/2),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(e,t){this.wrapPiece.setPosition(e+this.wrapPiece.displayWidth/2,t-20)},n.listenEvents=function(){var e=this;this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,(function(){e.parent.playTweenToEnableMaxFps()})),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,(function(t){e.handleDragStart(t)})),this.wrapPiece.on(Phaser.Input.Events.DRAG,(function(t){e.handleDrag(t)})),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,(function(){e.handleDragEnd(),e.parent.stopTweenToEnableMaxFps()}))},n.setIndex=function(e){this.index=e},n.setInteractiveContainer=function(){var e=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,e/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.handleDragStart=function(e){var t,n,i=this;if(!this.scene.isGameOver&&this.isCanMove){null==(t=this.animScaleUp)||t.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(ms.Z.PIECE+1),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.dragStart(),this.scene.audio.playSound(ds.Z.PIECE_PICK);var a=this.scene.main.board.cellSize/this.parent.cellSize,s=this.getContainerSize(),r=s.width,o=s.height,c=e.worldX+this.parent.cellSize*a/2-r*a/2,h=0;if(hu())h=e.worldY+this.parent.cellSize*a/2-o*a;else{var l=this.scene.gameZone.height/2+this.scene.main.board.width/2-2*this.parent.cellSize+this.moveTopNumber,u=this.y+o*a-l+o;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?44+o*a:53+o*a,h=e.worldY-u}this.distancePY=e.worldY-h;this.scene.main.board.cellPadding;this.updateCellsWithPadding(.5),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:c,y:h,scale:a,duration:150,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){if(!i.isDragEnd){i.setPosition(c,h);var e=i.getCellsHighlight();i.scene.main.board.handleRemoveHighlight(),i.scene.main.board.handleHighlight(e,i.highlightCellCanCapture.bind(i))}}}),this.drawSuggestCells()}},n.handleDrag=function(e){if(!this.scene.isGameOver&&this.isCanMove&&this.isSetDrag)try{if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying()){var t=this.scene.main.board.cellSize/this.parent.cellSize;this.animMoveTopAndScaleUp.complete(),this.animMoveTopAndScaleUp.stop(),this.setScale(t)}this.resetCellItems(),this.scene.game.updateFps(ou.Z.max);var n=this.getContainerSize().width,i=e.worldX+this.parent.cellSize*this.scale/2-n/2,a=e.worldY-this.distancePY;this.setPosition(i,a),this.canMove();var s=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(s,this.highlightCellCanCapture.bind(this))}catch(r){this.handleDragPieceInvalidMove()}},n.highlightCellCanCapture=function(e,t,n,i){for(var a=this,s=zu,r=Ku,o=[],c=0;c<i.length;c++){var h=i[c],l=h.x,u=h.y;s>l&&(s=l),r>u&&(r=u)}for(var p=function(){var t=e[d],n=E()(i).call(i,(function(e){return e.y===t}));if(!n||0===n.length)return"continue";for(var s=0;s<n.length;s++){var r=n[s];a.checkItemInArray(o,r)||o.push(r)}},d=0;d<e.length;d++)p();for(var f=function(){var e=t[m],n=E()(i).call(i,(function(t){return t.x===e}));if(!n||0===n.length)return"continue";for(var s=0;s<n.length;s++){var r=n[s];a.checkItemInArray(o,r)||o.push(r)}},m=0;m<t.length;m++)f();for(var g=function(){var e=n[v],t=E()(i).call(i,(function(t){return t.x===e.x&&t.y===e.y}));if(!t||0===t.length)return"continue";var s=t[0];a.checkItemInArray(o,s)||o.push(s)},v=0;v<n.length;v++)g();for(var y=function(){var e,t=o[S],n=t.x,i=t.y,c=E()(e=a.cellItems).call(e,(function(e){return e.x===n-s&&e.y===i-r}));if(!c||0===c.length)return"continue";c[0].cell.setFrame(Wu.GEM_X_LIGHT)},S=0;S<o.length;S++)y()},n.resetCellItems=function(){for(var e=0;e<this.cellItems.length;e++)this.cellItems[e].cell.setFrame(Wu.GEM)},n.checkItemInArray=function(e,t){var n=E()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return!(!n||0===n.length)},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag&&this.isCanMove){this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(ms.Z.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(ds.Z.PIECE_DROP),this.handleBoardMoveCompleted(),this.wrapPiece.disableInteractive()}catch(e){this.handleInvalidMove()}}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(ms.Z.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.calculatePY=function(e,t){return 15==e?this.parent.cellSize*t*-2:30==e?0:45==e?this.parent.cellSize*t*2:60==e?this.parent.cellSize*t*4:75==e?this.parent.cellSize*t*6:e},n.handleBoardMoveCompleted=function(){var e=this,t=this.getPositionTopLeftInBoard();if(t){var n=this.calcScore();this.scene.tutorialManager.isRunning()||(this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0));var i=t.x,a=t.y,s=this.scene.main.board.dataBoard[a][i],r=s.x+this.scene.main.board.cellPadding,o=s.y+this.scene.main.board.cellPadding,c=this.getCellsHighlight();this.scene.add.tween({targets:this,x:r,y:o,duration:50,onComplete:function(){e.updateCellsWithPadding(.5),e.scene.main.board.handleRemoveHighlight(),e.hide(),e.setScale(1),e.parent.removeActivePiece(e.index),e.scene.main.board.handleMove(c,e.onBoardHandleMoveCompleted.bind(e))}})}else this.scene.main.board.handleRemoveHighlight()},n.calcScore=function(){var e;if(!this.matrixData)return 0;var t=this.matrixData.length||0;if(0===t)return 0;for(var n=(null==(e=this.matrixData[0])?void 0:e.length)||0,i=0,a=0;a<t;a++)for(var s=0;s<n;s++)1===this.matrixData[a][s]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){this.scene.tutorialManager.isRunning()||(this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces())},n.drawSuggestCells=function(){var e=function(e,t){for(var n=e.length,i=e[0].length,a=0,s=0,r=0,o=0;o<n;o++)for(var c=0;c<i;c++)if(Ru(e,c,o,t)&&(s=c,r=o,++a>1))return null;if(0===a)return null;for(var h=[],l=0;l<t.data.length;l++)for(var u=0;u<t.data[l].length;u++)t.data[l][u].texture&&h.push({x:s+u,y:r+l});return h&&h.length>0?h:null}(this.scene.main.board.dataBoard,{data:this.data});e&&this.scene.main.board.handleSuggestMove(e)},n.getPositionFirstCellHighlight=function(){var e=this.scene.main.board.dataBoard,t=this.getPositionTopLeftInBoard();if(!t)return{x:0,y:0};var n=t.x,i=t.y;return t?{x:e[i][n].x,y:-(this.scene.scale.height-this.parentHeight-e[i][n].y)}:{x:0,y:0}},n.handleInvalidMove=function(){var e=this;this.scene.audio.playSound(ds.Z.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.invalidMove(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){e.updateCellsWithPadding(.5)}})},n.canMove=function(){var e=this.scene.main.board.dataBoard,t=this.getCellsHighlight();if(0===t.length)throw new Error("Invalid Move");for(var n=!0,i=0;i<t.length;i++){var a=t[i],s=a.x,r=a.y;if(!e[r]||!e[r][s]||0!==e[r][s].value){n=!1;break}}if(!n||0===t.length)throw new Error("Invalid Move");return n},n.getCellsHighlight=function(){var e=this.scene.main.board.dataBoard,t=[],n=this.getPositionTopLeftInBoard();if(null===n)return t;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return t;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var s=a+n.x,r=i+n.y,o=e[r]&&e[r][s]?e[r][s].x:0,c=e[r]&&e[r][s]?e[r][s].y:0;if(r>=Ku||s>=zu||!e[r][s]||1===e[r][s].value)return[];t.push({x:s,y:r,pX:o,pY:c})}return t},n.getPositionTopLeftInBoard=function(){for(var e=this.scene.main.board.dataBoard,t=this.x+this.parent.cellSize*this.scale/2,n=this.y+this.parent.cellSize*this.scale/2,i=this.scene.main.board.cellPadding,a=-1,s=-1,r=0;r<Ku;r++)for(var o=0;o<zu;o++)if(e[r][o].x-i/2<=t&&e[r][o].x+e[r][o].width+i/2>=t&&e[r][o].y-i/2<=n&&e[r][o].y+e[r][o].height+i/2>=n){a=o,s=r;break}return a<0||a>zu-1||s<0||s>Ku-1?null:{x:a,y:s}},t.buildData=function(e){for(var t=[],n=0;n<e.length;n++){t[n]=[];for(var i=0;i<e[n].length;i++){var a=1===e[n][i]?Wu.GEM:null;t[n][i]={x:i,y:n,texture:a}}}return t},n.getPaddingCell=function(){return this.height/this.data.length/40},n.drawPiece=function(){return this.isCreateCell||this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.createAnimShow=function(){var e=this,t=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:t,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){e.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Sine.Out})},n.createCells=function(e){for(var t=this.parent.cellSize,n=0;n<this.data.length;n++){this.cells[n]=[];for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture){var a={x:0+i*t+e,y:0+n*t+e,width:t-2*e,height:t-2*e},s=new yu(this.scene,a);s.setVisible(!0),this.cells[n][i]=s,this.cellItems.push({x:i,y:n,cell:s}),this.add(s)}}this.isCreateCell=!0},n.updateCellsWithPadding=function(e){for(var t=this.parent.cellSize-1,n=t-2*e,i=t-2*e,a=0;a<this.data.length;a++)for(var s=0;s<this.data[a].length;s++)if(this.data[a][s].texture){var r=this.cells[a][s],o=s*t+e,c=a*t+e;r.setWorldSize(n,i),r.setPosition(o,c)}},n.getContainerSize=function(){for(var e=0,t=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>e&&(e=this.data[n].length);var i=this.parent.cellSize;return{width:e*i*this.scale,height:t*i*this.scale}},n.resetPropsCells=function(e){for(var t=this.parent.cellSize,n=0;n<this.data.length;n++)for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture)Math.floor(0+i*t+e),Math.floor(t-2*e),Math.floor(t-2*e),this.texture,this.frame,ms.Z.PIECE,Math.floor(0+i*t+e),Math.floor(t-2*e),Math.floor(t-2*e),this.texture,this.frame,this.type,this.direction,this.isReverse},n.setCanMove=function(e){this.isCanMove=e,this.correctAlpha=e?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive()},t}(Phaser.GameObjects.Container),Xu=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.type,a.direction,a.isReverse)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e,t,n){void 0===n&&(n=!1);var i=[];switch(t){case Bs:n?i=Lr:(i=Mr,e===nr&&(i=Br),e===ir&&(i=Nr));break;case Ns:n?i=Ir:(i=wr,e===nr&&(i=kr),e===ir&&(i=xr));break;case Fs:if(n){i=Tr;break}i=br,e===nr&&(i=Cr),e===ir&&(i=Pr);break;case Gs:n?i=Or:(i=_r,e===nr&&(i=Dr),e===ir&&(i=Rr))}return i},t.getData=function(e,n,i){return void 0===i&&(i=!1),t.buildData(t.getMatrixData(e,n,i))},t}(ju),qu=Xu,Ju=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.type,a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e,t){var n=[];switch(e){case or:n=t===Ms?Wr:Yr;break;case rr:n=t===Ms?Hr:Vr;break;case ar:n=t===Ms?Fr:Gr;break;case sr:n=t===Ms?Zr:Ur}return n},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(ju),Qu=Ju,$u=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.type)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case cr:t=zr;break;case hr:t=Kr;break;case lr:t=jr}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(ju),ep=$u,tp=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=$r;break;case"right":t=eo;break;case"top":t=to;break;case"bottom":t=no}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(ju),np=tp,ip=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.type,a.direction)}))||this}return(0,o.Z)(t,e),t.getDataByDirectionCross2=function(e){var t=[];switch(e){case"left":default:t=co;break;case"right":t=ho}return t},t.getDataByDirectionCross3=function(e){var t=[];switch(e){case"left":default:t=lo;break;case"right":t=uo}return t},t.getDataByDirectionCross4=function(e){var t=[];switch(e){case"left":default:t=po;break;case"right":t=fo}return t},t.getDataByDirectionCross5=function(e){var t=[];switch(e){case"left":default:t=mo;break;case"right":t=go}return t},t.getMatrixData=function(e,n){var i=[];switch(e){case mr:i=t.getDataByDirectionCross2(n);break;case gr:i=t.getDataByDirectionCross3(n);break;case vr:i=t.getDataByDirectionCross4(n);break;case yr:i=t.getDataByDirectionCross5(n)}return i},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(ju),ap=ip,sp=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"vertical_left":default:t=Xr;break;case"vertical_right":t=qr;break;case"horizontal_right":t=Qr;break;case"horizontal_left":t=Jr}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(ju),rp=sp,op=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData()}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(){return oo},t.getData=function(){return t.buildData(t.getMatrixData())},t}(ju),cp=op,hp=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=io;break;case"right":t=ao;break;case"top":t=so;break;case"bottom":t=ro}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(ju),lp=hp,up=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case"left":default:t=vo;break;case"right":t=yo;break;case"top":t=So;break;case"bottom":t=Eo}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(ju),pp=up;function dp(e,t){var n="undefined"!==typeof oh()&&hh()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return fp(e,t);var i=Ne()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return sh()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return fp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}for(var mp=us.Z.EFFECTS,gp=(mp.KEY,mp.FRAME,function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.chars=void 0,i.listText=[],i.tweenShowText=void 0,i.tweenDropText=void 0,i.runAnimTimer=void 0,i.dropTextTimer=void 0,i.payload=n,i.initListText(),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.initListText=function(){var e=this.payload.text;if(e){this.chars=e.split("");for(var t=0,n=0;n<this.chars.length;n++){var i=this.chars[n],a=this.spawnText(i);this.listText.push(a),t+=a.width}for(var s=-t/2+4,r=0;r<this.chars.length;r++){var o=this.listText[r];o.setX(s),o.setAlpha(0),s+=o.width+1}this.add(this.listText)}},n.spawnText=function(e){var t=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(35),origin:{x:.5,y:.5},text:e});return t.setTint(3049197),t},n.createAnim=function(){this.tweenShowText=this.scene.tweens.add({targets:this.listText,paused:!0,y:"-=15",scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Back.easeOut",delay:this.scene.tweens.stagger(50,{})}),this.tweenDropText=this.scene.tweens.add({targets:this.listText,paused:!0,y:"+=15",scale:{from:1,to:0},alpha:{from:0,to:1},ease:"Back.easeOut",delay:this.scene.tweens.stagger(50,{})})},n.runAnim=function(e){var t,n,i=this;void 0===e&&(e=0),this.resetListText(),this.createAnim(),null==(t=this.runAnimTimer)||t.remove(),null==(n=this.dropTextTimer)||n.remove(),this.runAnimTimer=this.scene.time.delayedCall(0+e,(function(){i.tweenShowText.play(),i.dropTextTimer=i.scene.time.delayedCall(1e3,(function(){i.tweenDropText.play()}))}))},n.resetListText=function(){for(var e=0;e<this.listText.length;e++)this.listText[e].setScale(0).setAlpha(0)},n.restart=function(){var e,t;null==(e=this.runAnimTimer)||e.remove(),null==(t=this.dropTextTimer)||t.remove(),this.resetListText()},n.hideListText=function(){this.listText.forEach((function(e){e.setVisible(!1)}))},n.updateText=function(e,t,n){this.hideListText();for(var i=e.split(""),a=this.calTotalWidthListText(e),s=t,r=0;r<i.length;r++){var o=i[r],c=this.listText[r];this.listText[r]||(c=this.spawnText(o),this.listText.push(c)),c.setVisible(!0),c.setScale(1),c.setText(o),c.setPosition(s-a/2,n),s+=c.width+1}},n.updateTextCombo=function(e,t,n){this.hideListText();for(var i=e.split(""),a=this.calTotalWidthListTextCombo(e),s=t,r=0;r<i.length;r++){var o=i[r],c=this.listText[r];this.listText[r]||(c=this.spawnText(o),this.listText.push(c)),c.setVisible(!0),c.setScale(1.5),c.setText(o),c.setPosition(s-1.5*a/2,n),s+=c.width/1.5+1}},n.calTotalWidthListText=function(e){for(var t,n=0,i=dp(e.split(""));!(t=i()).done;){var a=t.value,s=this.spawnText(a);n+=s.width+1,s.destroy()}return n},n.calTotalWidthListTextCombo=function(e){for(var t,n=0,i=dp(e.split(""));!(t=i()).done;){var a=t.value,s=this.spawnText(a);n+=s.width/1.5+1,s.destroy()}return n},n.start=function(e,t){var n,i,a=this;void 0===e&&(e=0),void 0===t&&(t=0),this.restart(),null==(n=this.tweenShowText)||n.stop(),null==(i=this.tweenDropText)||i.stop(),e?this.scene.time.addEvent({delay:e,callback:function(){a.runAnim(t)}}):this.runAnim(t)},t}(Phaser.GameObjects.Container)),vp=function(){function e(e){this.scene=void 0,this.bubbleDrop=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){this.bubbleDrop=new gp(this.scene,{text:"STREAK 0X"})},t.runEffectBubbleDrop=function(e,t,n){var i=this.scene.gameZone.width,a=0,s=this.bubbleDrop.calTotalWidthListText("STREAK "+e+"X"),r=t-s,o=i-s-t;r<0&&(a=Math.abs(r/2)),o<0&&(a=o/2),this.bubbleDrop.updateText(e+"X STREAK",t+a,n),this.bubbleDrop.start(0,650)},t.runEffectBubbleCombo=function(e,t,n){var i=this.scene.gameZone.width,a=0,s=this.bubbleDrop.calTotalWidthListTextCombo(e+"X COMBO"),r=t-s,o=i-s-t;r<0&&(a=Math.abs(r/2)),o<0&&(a=o/2),this.bubbleDrop.updateTextCombo(e+"X COMBO",t+a,n),this.bubbleDrop.start(0,650)},e}(),yp=function(){function e(){}return e.create=function(e,t,n){var i;switch(n.type){case tr:case nr:case ir:i=new qu(e,t,n);break;case ar:case sr:case rr:case or:i=new Qu(e,t,n);break;case cr:case hr:case lr:i=new ep(e,t,n);break;case pr:i=new np(e,t,n);break;case dr:i=new lp(e,t,n);break;case Sr:i=new pp(e,t,n);break;case fr:i=new cp(e,t,n);break;case mr:case gr:case vr:case yr:i=new ap(e,t,n);break;case ur:i=new rp(e,t,n);break;default:i=new ep(e,t,n)}return i},e}(),Sp=yp,Ep=us.Z.GAMEPLAY_32,Ap=Ep.KEY,bp=Ep.FRAME,Tp=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],t.add.existing((0,as.Z)(n)),n.scene=t,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps()},n.initCellSize=function(){this.cellSize=41*this.scene.main.board.cellSize/100},n.setContentPosition=function(e,t){this.setPosition(e,t)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(e){if([cr,hr,lr].some((function(t){return t===e})))return[];var t=[];switch(e){case tr:case nr:case ir:t=[Fs,Bs,Ns,Gs];break;case ar:case sr:case rr:case or:t=[Ms,Ls];break;case pr:t=[Fs,Bs,Ns,Gs];break;case ur:t=[Zs,Us,Hs,Vs];break;case dr:case Sr:t=[Fs,Bs,Ns,Gs];break;case fr:t=[];break;case mr:case gr:case vr:case yr:t=[Bs,Ns]}return t},n.createAllPieces=function(){for(var e=this.cellSize,t=[],n=0;n<Er.length;n++){var i=this.getDirectionsByType(Er[n]);if(i.length<=0)t.push({type:Er[n]});else{for(var a=0;a<i.length;a++)t.push({type:Er[n],direction:i[a]});if(tr===Er[n])for(var r=0;r<i.length;r++)t.push({type:Er[n],direction:i[r],isReverse:!0})}}for(var o=0;o<t.length;o++){var c=(0,s.Z)({},t[o],{texture:Ap,frame:bp.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2),cellLength:Math.floor(e/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2)}}),h=Sp.create(this.scene,this,c);h.hide(),this.allPieces.push(h)}},n.createAllPiecesGroup=function(){for(var e=0;e<this.allPieces.length;e++){var t=this.allPieces[e];this.allPiecesGroup[t.type]||(this.allPiecesGroup[t.type]=[]),this.allPiecesGroup[t.type].push(e)}},n.randomPieces=function(){var e=this;this.scene.game.updateFps(ou.Z.max);for(var t=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*t.length),a=t[i];if(!e.allPiecesGroup[a])return"continue";var s=Math.floor(Math.random()*e.allPiecesGroup[a].length),r=e.allPiecesGroup[a][s],o=[rr,or].some((function(e){return e===a}));if(e.canCaptureLines.isCapture&&o){for(var c=0;c<e.allPiecesGroup[a].length;c++){var h=e.allPiecesGroup[a][c];if(e.allPieces[h]&&e.allPieces[h].direction===e.canCaptureLines.direction){r=h;break}}t=e.buildPieceRates(!1)}n.some((function(e){return e.index===r}))||n.push({index:r,type:a})};n.length<3;)i();for(var a=[],s=0;s<n.length;s++){var r=n[s].index,o=this.allPieces[r];a.push({position:r,texture:Ap,frame:bp.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<Ar.length;n++)t.push((0,s.Z)({},Ar[n]));if(e){var i=this.scene.main.board.dataBoard,a=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var r=0;r<t.length;r++)t[r].type===or&&(t[r].rate=8);else if(a=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var o=0;o<t.length;o++)t[o].type===rr&&(t[o].rate=8)}for(var c=[],h=0;h<t.length;h++)for(var l=t[h],u=l.type,p=l.rate,d=0;d<p;d++)c.push(u);return c},n.drawPieces=function(){for(var e=this.scene.gameZone,t=e.width,n=e.height,i=[20,t/3,2*t/3-20],a=n/2+176-13,s=a+(n-85-a)/2,r=0;r<this.piecesActive.length;r++){var o=this.allPieces[this.piecesActive[r].position],c=i[r];o.updatePosition(c,s),o.updatePositionWrapPiece(c+20*(r-1),s),o.setIndex(r),o.drawPiece(),this.allPieces[this.piecesActive[r].position]=o}},n.removeActivePiece=function(e){this.piecesActive[e].used=!0},n.existPiecesActive=function(){var e,t=E()(e=this.piecesActive).call(e,(function(e){return!e.used}));return t&&t.length>0},n.showNewPieces=function(){for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].reset();this.randomPieces(),this.setActivePieces(),this.drawPieces()},n.calculatePieceInfo=function(){for(var e=0,t=0,n=this.cellSize,i=0;i<this.piecesActive.length;i++){var a=this.allPieces[this.piecesActive[i].position].data;e+=a[0].length,a.length>t&&(t=a.length)}return{cellLength:n/2,cols:e}},n.setActivePieces=function(){for(var e=this.scene.main.board.dataBoard,t=0;t<this.piecesActive.length;t++){var n=this.piecesActive[t].position,i=Mu(e,this.allPieces[n]);this.allPieces[n].setCanMove(i)}},n.getPiecesByFen=function(e){var t=[],n=e.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=rs()(n).call(n,2),a=0;a<i.length;a++){var s,r;if("l"!==Eu()(s=i[a]).call(s)){var o=Uu(Eu()(r=i[a]).call(r));t.push(o)}}return t},n.getFenByPieces=function(){for(var e="l",t=0;t<this.piecesActive.length;t++){var n=this.piecesActive[t],i=n.type,a=n.direction,s=n.isReverse,r=n.frame;if(!n.used){var o=Fu(i);a&&""!==a&&(o+="-"+Fu(a)),s&&(o+="-r"),e+=" "+o+","+Fu(r)}}return e},n.clearPieces=function(){for(var e=0;e<this.piecesActive.length;e++){var t=this.piecesActive[e].position;this.allPieces[t].hide()}this.piecesActive=[]},n.showAvailablePieces=function(e){if(e&&!(e.length<=0)){for(var t=[],n=0;n<e.length;n++)for(var i=e[n],a=i.type,s=i.direction,r=i.isReverse,o=i.frame,c=0;c<this.allPieces.length;c++){var h=this.allPieces[c];if(a===h.type&&s===h.direction&&r===h.isReverse){t.push({position:c,texture:Ap,frame:o,type:h.type,direction:h.direction,isReverse:h.isReverse});break}}this.piecesActive=t,this.setActivePieces(),this.drawPieces()}},n.debuggerNextPieces=function(){for(var e=0;e<this.piecesActive.length;e++)this.removeActivePiece(e);for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].wrapPiece.setVisible(!1);this.showNewPieces()},t}(Phaser.GameObjects.Container),Cp=us.Z.DEFAULT,Pp=Cp.KEY,wp=Cp.FRAME,Ip=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.textExist=void 0,n.scene=t,n.setSize(n.scene.gameZone.width,76),t.add.existing((0,as.Z)(n)),n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createPieces(),this.createDebugButton()},n.createPieces=function(){this.pieces=new Tp(this.scene)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new fs.Z(this.scene,Pp,wp.BUTTON_BLUE_SMALL_TALL,100,40),this.debugButton.setName("Debug");var e=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([e]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},t}(Phaser.GameObjects.Container),kp=Ip,xp=n(72898),_p=us.Z.GAMEPLAY,Op=_p.KEY,Dp=_p.FRAME,Rp=function(e){function t(t){var n;return(n=e.call(this,t,Op,Dp.BLANK)||this).button.setVisible(!1),n.setName("Back"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Op,frame:Dp.ICON_BACK});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(fs.Z),Mp=Rp,Lp=us.Z.DEFAULT,Bp=Lp.KEY,Np=Lp.FRAME,Fp=function(e){function t(t){var n;return(n=e.call(this,t)||this).titleText=void 0,n.bestScoreText=void 0,n.createTitleText(),n.createScoreText(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createTitleText=function(){this.titleText=this.scene.make.image({key:Bp,frame:Np.TEXT_BEST_SCORE}),this.titleText.setWorldSize(58,8),this.add(this.titleText),Phaser.Display.Align.In.Center(this.titleText,this,0,0)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(36),origin:{x:0,y:.5}}),this.bestScoreText.setTint(262685),this.add(this.bestScoreText),Phaser.Display.Align.In.LeftCenter(this.bestScoreText,this.titleText,0,25)},n.setScoreText=function(e){this.bestScoreText.setText(String(e))},n.updateBestScoreText=function(e){var t=this.scene.storage.getState();e>Jc(t).bestScore&&this.setScoreText(e)},t}(Phaser.GameObjects.Container),Gp=Fp,Zp=us.Z.GAMEPLAY,Up=(Zp.KEY,Zp.FRAME,function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scoreText=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=void 0,n.currentScore=0,n.scene=t,n.scene.add.existing((0,as.Z)(n)),n.createScoreText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(60),text:"0",origin:{x:.5,y:.5}}),this.scoreText.setTint(3304186),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this,0,0)},n.setScore=function(e){this.score=e},n.setScoreText=function(e){this.scoreText.setText(String(e))},n.animAddScore=function(e){var t=this,n=this.score+e;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-e,to:this.score,duration:100,ease:Phaser.Math.Easing.Sine.Out,onUpdate:function(e){var n=Math.floor(e.getValue());t.setScoreText(n),t.scene.header.bestScoreBlock.updateBestScoreText(n),t.scene.updateProgressTargetScore(n)},onComplete:function(){t.setScoreText(t.score),t.scene.header.bestScoreBlock.updateBestScoreText(t.score),t.scene.tutorialManager.isRunning()?t.scene.tutorialManager.nextTutorial():(t.scene.handleNextTargetScore(),t.scene.bestScoreReached())}})},t}(Phaser.GameObjects.Container)),Hp=Up,Vp=n(20402),Wp=function(e){function t(t,n){var i;(i=e.call(this,t)||this).payload=void 0,i.loading=void 0,i.photo=void 0,i.avtFrame=void 0,i.background=void 0,i.loadPhotoTimer=void 0,i.handleLoadPhotoAfterDelay=function(e,t){return function(){var n=i.scene.textures.get(e);n&&n.key===e?i.handleLoadComplete(e):(i.scene.load.once("filecomplete-image-"+e,i.handleLoadComplete),i.scene.load.image(e,t),i.scene.load.start())}},i.handleLoadComplete=function(e){if(i.scene){var t=i.payload,n=t.id,a=t.radius,s=void 0===a?0:a;if(n&&n===e){var r=n+"_bordered_"+s,o=s>0?r:n,c=i.scene.textures.get(o);if(c&&c.key===o)i.setPhoto(c.key);else if(0!=s&&s<100){if(!GameCore.Utils.Image.drawBorder({scene:i.scene,key:n,newKey:r,radius:s}))return void i.showLoading(!1);i.setPhoto(r)}else if(100==s){if(!GameCore.Utils.Image.drawCircle({scene:i.scene,key:n,newKey:r}))return void i.showLoading(!1);i.setPhoto(r)}else i.setPhoto(n)}}},i.handleLoadPhotoFailed=function(e){e.key===i.payload.id&&i.setDefaultAvatar(e.key)},i.scene.add.existing((0,as.Z)(i)),i.payload=n,i.setSize(n.width,n.height),i.createBackground(),i.createLoading(),i.createPhoto(),i.createFrame();var a=i.payload,s=a.id,r=a.url,o=a.radius;return s&&r&&i.loadPhoto(s,r,o),i.addDefaultListeners(),i}(0,o.Z)(t,e);var n=t.prototype;return n.setFrame=function(e){this.avtFrame.setFrame(e),this.avtFrame.setVisible(!0)},n.setBackground=function(e){this.background.setFrame(e)},n.loadPhoto=function(e,t,n){var i;if(void 0===n&&(n=0),this.payload.id=e,this.payload.url=t,this.payload.radius=n,null==(i=this.loadPhotoTimer)||i.remove(),e&&t){var a=this.scene.textures.get(e);if(a&&a.key===e)this.handleLoadComplete(e);else{this.showLoading(!0);var s=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(s,this.handleLoadPhotoAfterDelay(e,t))}}else this.setPhoto(Ia.Z.AVATAR.KEY)},n.addDefaultListeners=function(){var e=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var t;null==(t=e.loadPhotoTimer)||t.remove(),e.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,e.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(e){this.loadPhoto(e,Ia.Z.AVATAR.FILE,this.payload.radius)},n.createBackground=function(){var e=this.payload,t=e.key,n=e.background,i=e.borderWidth,a=void 0===i?0:i;this.background=this.scene.make.image({key:t,frame:n}),this.background.setWorldSize(this.width-a,this.height-a),this.add(this.background)},n.createLoading=function(){this.loading=new Vp.Z(this.scene),this.loading.setWorldSize(.75*this.width,.75*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){var e=this.payload,t=e.key,n=e.frame,i=e.width,a=e.height;n?(this.avtFrame=this.scene.make.image({key:t,frame:n}),this.avtFrame.setWorldSize(i,a)):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)},n.showLoading=function(e){this.photo.setVisible(!e),this.loading.setVisible(e)},n.setPhoto=function(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);var t=this.payload,n=t.width,i=t.height,a=Math.min(n,i)-(this.payload.borderWidth||8);this.photo.setWorldSize(a,a),Phaser.Display.Align.In.Center(this.photo,this.background)},t}(Phaser.GameObjects.Container),Yp=Wp,zp=us.Z.GAMEPLAY,Kp=zp.KEY,jp=zp.FRAME,Xp=function(e){function t(t){var n;return(n=e.call(this,t)||this).titleSprite=void 0,n.background=void 0,n.textScore=void 0,n.avatar=void 0,n.score=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.initScoreBlockAvatar=function(){this.createAvatar(),this.createScoreText(),this.setScore(0),this.setScoreText(0)},n.createAvatar=function(){this.avatar=new Yp(this.scene,{key:Kp,frame:jp.AVATAR_BORDER,background:jp.AVATAR_BACKGROUND,width:52,height:52,radius:100,borderWidth:5}),this.avatar.background.setVisible(!1),this.avatar.avtFrame.setVisible(!1),this.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this,0,-10)},n.createScoreText=function(){this.textScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(55),text:"0",origin:{x:.5,y:.5}}),this.textScore.setTint(3304186),this.add(this.textScore)},n.setScore=function(e){this.score=e},n.setScoreText=function(e){this.textScore.setText(this.convertScoreToString(e))},n.alignTextScoreLeft=function(){Phaser.Display.Align.In.Center(this.textScore,this.avatar,-60,5)},n.alignTextScoreRight=function(){Phaser.Display.Align.In.Center(this.textScore,this.avatar,60,5)},n.convertScoreToString=function(e){if(e<1e3)return String(e);var t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)/100);return t+"K"+(n||"")},t}(Phaser.GameObjects.Container),qp=Xp,Jp=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.addScore=void 0,n.currentScore=0,n.scene=t,n.initScoreBlockAvatar(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.updateInfo=function(){var e=this.scene.player.getPlayer(),t=e.playerId,n=e.photo;if(this.avatar.loadPhoto(t,n,100),this.scene.gamePlayMode===_a){var i=this.scene.storage.getState(),a=(Jc(i)[t]||{}).score,s=void 0===a?0:a;this.textScore.setText(this.formatScore(s))}this.alignTextScoreLeft()},n.formatScore=function(e){return e<1e4?""+e:Math.floor(e/1e3%1e3)+"K"+Math.floor(e%1e3/100)},n.animAddScore=function(e){var t=this,n=this.score+e;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-e,to:this.score,duration:100,onUpdate:function(e){var n=Math.floor(e.getValue());t.setScoreText(n),t.scene.header.bestScoreBlock.updateBestScoreText(n),t.scene.updateProgressTargetScore(n)},onComplete:function(){t.setScore(t.score),t.scene.header.bestScoreBlock.updateBestScoreText(t.score),t.setScoreText(n),t.scene.handleNextTargetScore(),t.scene.bestScoreReached()}})},t}(qp),Qp=Jp,$p=function(e){function t(t){var n;return(n=e.call(this,t)||this).initScoreBlockAvatar(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.updateInfo=function(){var e=this.scene.storage.getState(),t=qc(e),n=Zc(e),i=n.playerId,a=n.photo,s=(t[i]||{}).score,r=void 0===s?0:s;this.textScore.setText(this.formatScore(r)),this.avatar.loadPhoto(i,a,100),this.alignTextScoreRight()},n.formatScore=function(e){return e<1e4?""+e:Math.floor(e/1e3%1e3)+"K"+Math.floor(e%1e3/100)},t}(qp),ed=$p,td=n(53270),nd=us.Z.EFFECTS,id=nd.KEY,ad=nd.FRAME,sd=function(e){function t(t){var n;return(n=e.call(this,t,id,ad.FX_STAR_WHITE)||this).emitZone=void 0,n.emitter=void 0,n._isPlaying=!1,n.frequency=void 0,n.count=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({frame:ad.DUST_BLUE,emitZone:{source:this.emitZone,type:"random"},frequency:16,speedX:{min:-25,max:-10},speedY:{min:-7,max:7},lifespan:{min:500,max:1500},alpha:{start:.7,end:.3},scale:{min:1*e,max:1.5*e},delay:300})},n.run=function(e,t,n,i,a,s){this.emitZone.setSize(a,s),this.emitZone.setPosition(n-a/2,i-s/2),t!=this.frequency&&(this.emitter.setFrequency(t),this.frequency=t),e!=this.count&&(this.emitter.setQuantity(e),this.count=e),this._isPlaying||(this.emitter.start(),this._isPlaying=!0)},n.stop=function(){var e;null==(e=this.emitter)||e.stop(),this._isPlaying=!1},n.isPlaying=function(){return this._isPlaying},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),rd=sd,od=us.Z.GAMEPLAY,cd=od.KEY,hd=od.FRAME,ld=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.rightWhiteProgress=void 0,a.titleTargetScore=void 0,a.iconCup=void 0,a.glareCup=void 0,a.textTargetScore=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.sparkling=void 0,a.setSize(n,i),a.scene=t,a.init(),a}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createGlareCup(),this.createParticle(),this.createEmitter(),this.createTweenGlare(),this.createTitleTargetScore(),this.createTextTargetScore(),this.createIconCup(),this.createSparkling()},n.initBg=function(){this.leftBg=this.scene.make.image({key:cd,frame:hd.PROGRESS_BG_LEFT}),this.midBg=this.scene.make.image({key:cd,frame:hd.PROGRESS_BG_MID}),this.rightBg=this.scene.make.image({key:cd,frame:hd.PROGRESS_BG_RIGHT});var e=this.leftBg,t=e.width,n=e.height,i=t*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,s=a.width,r=a.height,o=s*this.height/r;this.rightBg.setWorldSize(o,this.height);var c=this.width-(i+o);this.midBg.setWorldSize(c,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:cd,frame:hd.PROGRESS_BAR_LEFT}),this.midProgress=this.scene.make.image({key:cd,frame:hd.PROGRESS_BAR_MID}),this.rightProgress=this.scene.make.image({key:cd,frame:hd.PROGRESS_BAR_RIGHT}),this.rightWhiteProgress=this.scene.make.image({key:cd,frame:hd.PROGRESS_BAR_RIGHT});var e=this.leftProgress,t=e.width,n=e.height,i=t*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,s=a.width,r=a.height,o=s*this.height/r;this.rightProgress.setWorldSize(o,this.height);var c=this.rightWhiteProgress,h=c.width,l=c.height,u=h*this.height/l;this.rightWhiteProgress.setWorldSize(u,this.height);var p=this.width-(i+o)+2;this.midProgress.setWorldSize(p,this.height),this.add(this.rightWhiteProgress),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createTitleTargetScore=function(){this.titleTargetScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(15),text:"TARGET SCORE"}),this.titleTargetScore.setTint(10526880),this.add(this.titleTargetScore),Phaser.Display.Align.In.RightCenter(this.titleTargetScore,this,0,20)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:cd,frame:hd.ICON_CUP_GREY}),this.iconCup.setWorldSize(12,12),this.add(this.iconCup)},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(27),text:"0"}),this.textTargetScore.setTint(6842231),this.textTargetScore.setOrigin(1,.5),this.add(this.textTargetScore),Phaser.Display.Align.In.RightCenter(this.textTargetScore,this,0,37)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:cd,frame:hd.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new td.Z({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(cd),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.2,max:.5},speed:{min:10,max:20},lifespan:{min:300,max:700},quantity:1,on:!1,frame:hd.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-72,34)},n.createSparkling=function(){this.sparkling=new rd(this.scene),this.add(this.sparkling)},n.createMilestoneFrame=function(){var e=this.scene.make.image({key:cd,frame:hd.BLANK});return e.setWorldSize(16,22),e},n.getMilestoneFrame=function(){var e,t=E()(e=this.listPoolMilestoneFrame).call(e,(function(e){return!e.visible}));if(!t||0===t.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return t[0]},n.handleSetAlphaListMilestone=function(e){this.listMilestoneFrame.forEach((function(t){t.score<=e?t.frame.setAlpha(1):t.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(e){e>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(e){e.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(e){this.targetScore=e,this.textTargetScore.setText(""+e),Phaser.Display.Align.In.LeftCenter(this.iconCup,this.textTargetScore,18,-2),Phaser.Display.Align.In.Center(this.glareCup,this.iconCup,0,0)},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(e){var t=e*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth,s=this.leftBg.width+this.midBg.width+this.rightBg.width;if(this.sparkling.setPosition(),0===e)return this.rightWhiteProgress.setVisible(!1),this.sparkling.stop(),this.stopAnimGlare(),void this.stopEmitter();var r=s*(e>1?1:e),o=this.leftBg.x+r-this.leftBg.width/2+this.rightWhiteProgress.width/2-1;if(this.scene.isNextTarget?(this.runSparklingEmitZone(o-2),this.scene.isNextTarget=!1):this.sparkling.run(2,50,o,this.leftBg.y-.5,4,4),this.rightWhiteProgress.setVisible(!0),this.rightWhiteProgress.x=t-s/2+this.rightWhiteProgress.width/2-3,e>=1){this.rightWhiteProgress.x=s-this.rightProgress.x-a;var c=s-this.rightProgress.x-a;if(this.sparkling.run(2,50,c,this.leftBg.y-.5,4,4),this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}if(this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,t<n)return this.leftProgress.setVisible(!0),e<=.01?(this.leftProgress.setCrop(0,0,5,2*this.height),void(this.rightWhiteProgress.x+=2)):void this.leftProgress.setCrop(0,0,t/this.leftProgress.scaleX,2*this.height);if(t>n+i){this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),this.rightProgress.setCrop(0,0,(t-(n+i-2))/this.rightProgress.scaleX,2*this.height),this.rightWhiteProgress.x=this.rightProgress.x-2;var h=this.rightProgress.x-2;this.sparkling.run(2,50,h,this.leftBg.y-.5,4,4)}else this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,(t-n)/this.midProgress.scaleX,2*this.height)},n.runSparklingEmitZone=function(e){this.scene.tweens.add({targets:this.sparkling.emitZone,x:e,duration:400})},t}(Phaser.GameObjects.Container),ud=us.Z.GAMEPLAY,pd=ud.KEY,dd=ud.FRAME,fd=function(e){function t(t){var n;return(n=e.call(this,t,pd,dd.BLANK)||this).button.setVisible(!1),n.setName("Setting"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:pd,frame:dd.ICON_SETTING});e.setWorldSize(19,21),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(fs.Z),md=fd,gd=us.Z.GAMEPLAY,vd=gd.KEY,yd=gd.FRAME,Sd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.buttonBack=void 0,n.buttonSetting=void 0,n.bestScoreBlock=void 0,n.mainScoreBlock=void 0,n.myScoreBlock=void 0,n.opponentScoreBlock=void 0,n.iconBattle=void 0,n.progressBar=void 0,n.scene=t,t.add.existing((0,as.Z)(n)),n.createBackButton(),n.creatIconBattle(),n.createBestScoreBlock(),n.createSettingButton(),n.createMainScoreBlock(),n.createMyScoreBlock(),n.createOpponentScoreBlock(),n.createProgressBar(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createBackButton=function(){this.buttonBack=new Mp(this.scene),this.buttonBack.onClick=this.handleBack.bind(this),this.add(this.buttonBack),Phaser.Display.Align.In.Center(this.buttonBack,this,-159,41)},n.handleBack=function(){var e=this.scene.storage.getState(),t=(0,xp.V)(e);t!==Ua.Co.LOAD_SCENE?this.scene.scene.switch(t):this.scene.scene.switch(Ua.Co.DASHBOARD_SCENE)},n.createBestScoreBlock=function(){this.bestScoreBlock=new Gp(this.scene),this.add(this.bestScoreBlock),this.bestScoreBlock.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.bestScoreBlock,this,145.5,22)},n.createMainScoreBlock=function(){this.mainScoreBlock=new Hp(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,44)},n.createMyScoreBlock=function(){this.myScoreBlock=new Qp(this.scene),this.myScoreBlock.setVisible(!1),this.add(this.myScoreBlock),Phaser.Display.Align.In.Center(this.myScoreBlock,this,-87,50)},n.createOpponentScoreBlock=function(){this.opponentScoreBlock=new ed(this.scene),this.opponentScoreBlock.setVisible(!1),this.add(this.opponentScoreBlock),Phaser.Display.Align.In.Center(this.opponentScoreBlock,this,21,50)},n.createSettingButton=function(){this.buttonSetting=new md(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,159,42)},n.createProgressBar=function(){this.progressBar=new ld(this.scene,306,8),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,0,92)},n.creatIconBattle=function(){this.iconBattle=this.scene.make.image({key:vd,frame:yd.TEXT_VS}),this.iconBattle.setWorldSize(17,9),this.iconBattle.setVisible(!1),this.add(this.iconBattle),Phaser.Display.Align.In.Center(this.iconBattle,this,-30,40)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0),this.myScoreBlock.setVisible(!1),this.opponentScoreBlock.setVisible(!1),this.iconBattle.setVisible(!1),this.buttonBack.setVisible(!0)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1),this.opponentScoreBlock.setVisible(!0),this.myScoreBlock.setVisible(!0),this.iconBattle.setVisible(!0),this.bestScoreBlock.setVisible(!1),this.buttonBack.setVisible(!1)},t}(Phaser.GameObjects.Container),Ed=Sd,Ad=us.Z.GAMEPLAY_32.FRAME,bd=[""+Ad.BLOCK_GRADIENT_PREFIX+9,""+Ad.BLOCK_GRADIENT_PREFIX+8],Td=[],Cd=1;Cd<=9;Cd++)Td.push(""+Ad.BLOCK_GRADIENT_PREFIX+Cd);for(var Pd=function(){var e=GameCore.Utils.Device,t=window.navigator.vibrate;return e.isAndroid()&&"function"===typeof t||e.isMobileWeb()&&"function"===typeof t},wd=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Math.round(t/80),i=0,a=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.performHapticFeedbackAsync();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();case 3:if(!(i<n)){e.next=11;break}return s=a(),o=(0,ht.qZ)(80),i+=1,e.next=9,ie().all([s,o]);case 9:e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Id=function(e){window.navigator.vibrate(0),window.navigator.vibrate(e)},kd=function(e){try{if(!Pd())return!1;var t=GameCore.Utils.Device;t.isAndroid()||t.isMobileWeb()?Id(e):t.isIOS()&&wd(e).catch((function(e){}))}catch(n){}},xd=function(){function e(e){this.angle=void 0,this.scene=void 0,this.scaleUpTween=void 0,this.breakingTween=void 0,this.breakingDelay=0,this.captureCells=void 0,this.timerEventRemoveCaptureCells=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){this.createTweenBreaking()},t.handleShowEffect=function(e){var t=this;e&&0!==e.length&&(this.removeCaptureCell(),this.captureCells=e,this.setValueCaptureCell(),this.breakingTween.resetTweenData(!1),this.breakingTween.restart(),this.timerEventRemoveCaptureCells&&this.timerEventRemoveCaptureCells.remove(),this.timerEventRemoveCaptureCells=this.scene.time.addEvent({delay:500,callback:function(){t.breakingTween.isPlaying()||t.removeCaptureCell()}}))},t.onCaptureCellComplete=function(){if(this.captureCells&&this.scene.main&&this.scene.main.board)for(var e=this.scene.main.board.dataBoard,t=0;t<this.captureCells.length;t++){var n=this.captureCells[t],i=n.x;e[n.y][i].cell.resetImageBreak()}},t.removeCaptureCell=function(){var e=this.scene.main.board.dataBoard;if(this.captureCells)for(var t=0;t<this.captureCells.length;t++){var n=this.captureCells[t],i=n.x;e[n.y][i].cell.resetImageBreak()}},t.setValueCaptureCell=function(){for(var e=this.scene.main.board.dataBoard,t=Math.round(68.25),n=0;n<this.captureCells.length;n++){var i=Phaser.Math.Between(50,t),a=Phaser.Math.Between(82,98)*Math.PI/180,s=Phaser.Math.Between(3,10)/1e3,r=this.captureCells[n],o=r.x,c=e[r.y][o].cell;c.maxScale0=Phaser.Math.FloatBetween(2.5,4)/10,c.imageBreak.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM),c.imageBreak.setVisible(!0),c.v0=i,c.alpha0=a,c.scaleRate0=s}},t.createTweenBreaking=function(){var e=this;this.breakingTween=this.scene.tweens.addCounter({from:0,to:1900,onUpdate:function(t){if(e.captureCells)for(var n=e.scene.main.board.dataBoard,i=0;i<e.captureCells.length;i++){e.angle=Phaser.Math.Between(-15,15);var a=e.captureCells[i],s=a.x,r=n[a.y][s].cell,o=r.imageBreak,c=r.maxScale0,h=r.alpha0<1.57?1:-1,l=.016*t.getValue(),u=pu(r.v0,r.alpha0,l),p=du(r.v0,r.alpha0,l);o.setVisible(!0),o.x=r.x0+u,o.y=r.y0+-p,o.rotation+=.04*h,o.scale>c?o.scale-=r.scaleRate0:o.scale=c}},onComplete:function(){e.onCaptureCellComplete()},delay:this.breakingDelay,duration:2500}).stop()},e}(),_d=xd,Od=us.Z.GAMEPLAY,Dd=Od.KEY,Rd=Od.FRAME,Md=us.Z.GAMEPLAY_32,Ld=Md.KEY,Bd=Md.FRAME,Nd=(us.Z.DEFAULT.FRAME,GameCore.Configs.Board),Fd=Nd.cols,Gd=Nd.rows,Zd=GameCore.Configs.Gameplay.VibrateValue,Ud=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.suggestCells=[],a.pX=void 0,a.pY=void 0,a.borderLeftSize=.1,a.borderTopSize=.1,a.cellSize=void 0,a.cellPadding=void 0,a.diceSize=void 0,a.dataBoard=[],a.cellsHighlight=[],a.cellSharking=[],a.boardFrame=void 0,a.woodenEffect=void 0,a.canCaptureLines=function(e,t){void 0===t&&(t=5);for(var n=e.length,i=e[0].length,a=[],r=[],o=[],c=0;c<n;c++){for(var h=0,l={x:-1,y:-1},u=0;u<i;u++)0===c&&(o[u]={count:0,x:-1,y:-1}),1===e[c][u].value?(o[u].count++,h++):(l.x=u,l.y=c,o[u].x=u,o[u].y=c);if(h===i-1&&r.push((0,s.Z)({row:c},l)),c===n-1)for(var p=0;p<i;p++)o[p].count===n-1&&a.push((0,s.Z)({col:p},o[p]))}if(r.length>=t)for(var d=0,f={x:-1,y:-1},m=0;m<r.length;m++)if(0!==m){if(r[m].x===f.x&&r[m].y===f.y+1?(f.x=r[m].x,f.y=r[m].y,d++):d=1,d>=t)return{isCapture:!0,direction:"vertical",minLine:t}}else f.x=r[m].x,f.y=r[m].y,d++;if(a.length>=t)for(var g=0,v={x:-1,y:-1},y=0;y<a.length;y++)if(0!==y){if(a[y].x===v.x+1&&a[y].y===v.y?(v.x=a[y].x,v.y=a[y].y,g++):g=1,g>=t)return{isCapture:!0,direction:"horizontal",minLine:t}}else v.x=a[y].x,v.y=a[y].y,g++;return{isCapture:!1,direction:"",minLine:t}},a.scene=t,a.setSize(n,i),a.woodenEffect=new _d(a.scene),a.init(),a}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createBoard(),this.calcCellLength(),this.initDataBoard()},n.createBoard=function(){var e=this.scene.gameZone,t=e.width/2,n=e.height/2-9;this.boardFrame=this.scene.make.image({x:t,y:n,key:Dd,frame:Rd.BOARD}),this.boardFrame.setWorldSize(this.width,this.height)},n.calcCellLength=function(){this.cellPadding=0,this.cellSize=(this.width-2*this.borderLeftSize-this.cellPadding*(Fd+1))/Fd},n.initDataBoard=function(){for(var e=this.boardFrame.x-this.boardFrame.displayWidth/2+this.cellSize/2+this.borderLeftSize,t=this.boardFrame.y-this.boardFrame.displayHeight/2+this.cellSize/2+this.borderTopSize,n=0;n<Gd;n++){this.dataBoard[n]=[];for(var i=0;i<Fd;i++){var a=e+i*this.cellSize+this.cellPadding*i,s=t+n*this.cellSize+this.cellPadding*n,r={x:a,y:s,width:this.cellSize,height:this.cellSize,texture:Ld,frame:Bd.GEM_TRANSPARENT,depth:ms.Z.PIECE-.1,padding:this.cellPadding,isWoodenEffect:!0},o=new yu(this.scene,r);o.setVisible(!1),this.dataBoard[n][i]={x:a,y:s,width:this.cellSize,height:this.cellSize,frame:Bd.GEM_TRANSPARENT,value:0,cell:o}}}},n.handleTweenStartMission=function(){for(var e=this,t=100,n=0;n<Gd;n++)for(var i=function(){var i=e.dataBoard[n][a].cell,s=0;s=4==n&&4==a?t:n>=3&&n<=5&&a>=3&&a<=5?200:n>=2&&n<=6&&a>=2&&a<=6?300:n>=1&&n<=7&&a>=1&&a<=7?400:500,e.scene.time.delayedCall(s,(function(){i.playTweenStartMission()}))},a=0;a<Fd;a++)i()},n.handleHighlight=function(e,t){this.cellsHighlight=e;for(var n=0;n<e.length;n++){var i=e[n],a=i.x,s=i.y;if(this.dataBoard[s]&&this.dataBoard[s][a]&&0===this.dataBoard[s][a].value){var r=this.dataBoard[s][a].cell;this.dataBoard[s][a].frame=Bd.GEM,r.setVisible(!0),r.setFrame(Bd.GEM),r.setAlpha(.3)}}this.canCaptureCells(e,t)},n.handleCapturePiece=function(e){var t=this;try{if(!e||e.length<=0)throw Lu=0,new Error("Invalid Capture");for(var n=0,i=300,a=_u(this.dataBoard),s=Ou(this.dataBoard),r=Pu(),o=Nu(),c=function(){var c=e[h],l=c.x,u=c.y,p=t.dataBoard[u][l].cell,d=0,f=0,m=0;if(a.length>0&&s.length>0){var g=0,v=0;m=u,n=i/Fd,-1!==xt()(a).call(a,u)&&-1===xt()(s).call(s,l)&&(g=n*l,v=0,f=xt()(a).call(a,u)),-1===xt()(a).call(a,u)&&-1!==xt()(s).call(s,l)&&(g=0,v=n*u,f=xt()(s).call(s,l)),-1!==xt()(a).call(a,u)&&-1!==xt()(s).call(s,l)&&(g=n*l,v=n*u,f=Math.max(xt()(s).call(s,l),xt()(a).call(a,u),0)),-1===xt()(a).call(a,u)&&-1===xt()(s).call(s,l)&&(g=n*l,v=n*u),d=Math.max(g,v,0)}else if(s.length>0)d=(n=i/Fd)*u,f=xt()(s).call(s,l),m=u,-1===f&&(f=l-s[0]);else if(a.length>0)d=(n=i/Gd)*l,f=xt()(a).call(a,u),m=l,-1===f&&(f=u-a[0]);else{n=100;var y=e[0].x;d=n*(l-y),(f=e[h].x-y)<0&&(m=0)}p.hideImageHighlight(),t.scene.time.delayedCall(d,(function(){var e="";r>2||o>2?(e=Td[m]||Td[0],p.imageBreak.setFrame(e)):(e=bd[f]||bd[0],p.imageBreak.setFrame(e)),p.playTweenScaleDown(),0==t.dataBoard[u][l].value&&p.setVisible(!1)})),t.dataBoard[u][l].frame=Bd.GEM_TRANSPARENT,t.dataBoard[u][l].value=0},h=0;h<e.length;h++)c()}catch(l){}},n.checkPositionCellOnCaptureCell=function(e,t){var n=E()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return n&&n.length>0},n.handlePraise=function(e,t){if(t&&0!==t.length){var n=Bu(),i=Pu();i>1&&(n=18*Cu+10*(Nu()-1));for(var a=[],s=0;s<e.length;s++){var r=e[s];this.checkPositionCellOnCaptureCell(r,t)&&a.push(r)}if(0!==a.length){for(var o=a[0].pX,c=0,h=a[0].pY,l=0,u=0;u<a.length;u++){var p=a[u];p.pX<o&&(o=p.pX),p.pX>c&&(c=p.pX),p.pY<h&&(h=p.pY),p.pY>l&&(l=p.pY)}var d=o+(c-o)/2,f=h+(l-h)/2;this.scene.main.praise.handlePraise(d,f,n,i),this.handleStreakBreak(d,f),this.playEatSound(i)}}},n.handleStreakBreak=function(e,t){if(!this.scene.tutorialManager.isRunning()){var n=Pu(),i=Nu()-1;if(e-75<0&&(e=75),e+75>375&&(e=300),!(i<2||n>=2)){var a=i>6?6:i,s=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&kd(s),this.playEatSound(a),this.scene.effectManager.runEffectBubbleDrop(i,e,t-20)}}},n.getVibrateByLevel=function(e){return Zd[e]||0},n.playEatSound=function(e){switch(this.scene.audio.playSound(ds.Z.EAT_BLOCK,{volume:1}),e){case 1:default:break;case 2:this.scene.audio.playSound(ds.Z.GOOD);break;case 3:this.scene.audio.playSound(ds.Z.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(ds.Z.EXCELLENT)}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var e=0;e<this.cellsHighlight.length;e++){var t=this.cellsHighlight[e],n=t.x,i=t.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=Bd.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(Bd.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(s){}},n.canCaptureCells=function(e,t){for(var n=this,i=this.dataBoard,a=[],r=0;r<i.length;r++){a[r]=[];for(var o=0;o<i[r].length;o++)a[r][o]=(0,s.Z)({},i[r][o])}for(var c=0;c<e.length;c++){var h=e[c],l=h.x;a[h.y][l].value=1}this.removeAnimCanCaptureCells(a,e);var u=wu(a,e);if(!u||u.length<=0)return!1;for(var p=function(){var t=u[d],i=t.x,a=t.y;e.some((function(e){return e.x===i&&e.y===a}))||n.cellSharking.push((0,s.Z)({},u[d]))},d=0;d<u.length;d++)p();for(var f=0;f<this.cellSharking.length;f++){var m=this.cellSharking[f],g=m.x,v=m.y,y=this.dataBoard[v][g].cell;y.isHighlight()||y.showImageHighlight()}t(_u(a),Ou(a),xu(a,e),e)},n.removeAnimCanCaptureCells=function(e,t){var n=this;if(0!==this.cellSharking.length){for(var i=_u(e),a=Ou(e),s=xu(e,t),r=function(){var e=n.cellSharking[o],t=e.x,r=e.y,c=n.dataBoard[r][t].cell;if(-1!==xt()(i).call(i,r)||-1!==xt()(a).call(a,t)||s.some((function(e){return e.x===t&&e.y===r})))return"continue";c.hideImageHighlight()},o=0;o<this.cellSharking.length;o++)r();this.cellSharking=[]}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var e=0;e<this.cellSharking.length;e++){var t=this.cellSharking[e],n=t.x,i=t.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleSuggestMove=function(e){try{this.suggestCells=e;for(var t=0;t<e.length;t++){var n=e[t],i=n.x,a=n.y,s=this.dataBoard[a][i].cell;s.setFrame(Bd.GEM_HIGHT_LIGHT),s.setVisible(!0),s.setAlpha(1)}}catch(r){}},n.handleRemoveSuggestMove=function(){try{for(var e=0;e<this.suggestCells.length;e++){var t=this.suggestCells[e],n=t.x,i=t.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(Bd.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(s){}},n.handleMove=function(e,t){try{for(var n=0;n<e.length;n++){var i=e[n],a=i.x,s=i.y;if(this.dataBoard[s]&&this.dataBoard[s][a]){this.dataBoard[s][a].frame=Bd.GEM,this.dataBoard[s][a].value=1;var r=this.dataBoard[s][a].cell;r.setVisible(!0),r.setFrame(Bd.GEM),r.setAlpha(1)}}var o=wu(this.dataBoard,e);this.handleCapturePiece(o),this.checkIsGameOver()&&this.scene.setIsGameOver(!0),this.handlePraise(e,o),t&&t(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(c){}},n.handleResetFrameBoard=function(){for(var e=0;e<Gd;e++)for(var t=0;t<Fd;t++)if(this.dataBoard[e]&&this.dataBoard[e][t]&&1===this.dataBoard[e][t].value){var n=this.dataBoard[e][t],a=n.frame,s=n.cell;s.visible||(0,i.tO)(new Error("Cell is invisible")),s.frame.name!==a&&(0,i.tO)(new Error("Cell is frame not true")),s.setVisible(!0).setFrame(a)}},n.checkIsGameOver=function(){for(var e=[],t=this.scene.footer.pieces.piecesActive,n=this.scene.footer.pieces.allPieces,i=0;i<t.length;i++){var a=t[i],s=a.position;if(!a.used){var r=n[s];e.push({data:r.data,type:r.type,direction:r.direction,isReverse:r.isReverse,frame:r.frame})}}return!!Du(this.dataBoard,e)},n.handleGameOver=function(){this.checkIsGameOver()&&(this.scene.clearMatchData(),this.scene.disableInput(),this.runAnimationGameOver())},n.runAnimationGameOver=function(){var e=this;try{this.scene.audio.playSound(ds.Z.BOARD_GAME_OVER);for(var t=[],n=function(n){for(var i=function(i){if(e.dataBoard[n]&&e.dataBoard[n][i]&&1===e.dataBoard[n][i].value){var a=Math.floor(100*(n+1));t.push({delay:a,x:i,y:n}),e.scene.time.delayedCall(a,(function(){e.dataBoard[n][i].cell.playAnimImageGameOver()}))}},a=0;a<Fd;a++)i(a)},i=0;i<Gd;i++)n(i);this.scene.time.addEvent({delay:t[t.length-1].delay+1500,callback:function(){e.scene.handleRequestFinishGame()}})}catch(a){}},n.rescue=function(){for(var e=0;e<this.dataBoard.length;e++)for(var t=0;t<this.dataBoard[e].length;t++)if(this.dataBoard[e]){var n=this.dataBoard[e][t];n&&1===n.value&&(this.dataBoard[e][t].cell.setFrame(Bd.GEM),this.dataBoard[e][t].cell.resetImageGameOver())}this.handleUseBomb()},n.hasPieceL5=function(){var e=this.scene.footer.pieces.piecesActive;return E()(e).call(e,(function(e){return e.type===or})).length>0},n.hasPieceCross5=function(){var e=this.scene.footer.pieces.piecesActive;return E()(e).call(e,(function(e){return e.type===yr})).length>0},n.handleUseBomb=function(){try{var e=this.hasPieceL5(),t=this.hasPieceCross5(),n=Math.floor(Math.random()*Os.length),i=Os[n];e&&(i=Ds[n]),t&&(i=Rs[n]);for(var a=[],s=i.minRow;s<i.minRow+i.rows;s++)for(var r=i.minCol;r<i.minCol+i.cols;r++)this.dataBoard[s][r].frame!==Bd.GEM_TRANSPARENT&&a.push({x:r,y:s});for(var o=0;o<a.length;o++){var c=a[o],h=c.x,l=c.y,u=this.dataBoard[l][h];u.frame=Bd.GEM_TRANSPARENT,u.value=0,u.cell.setFrame(Bd.GEM_TRANSPARENT),u.cell.setVisible(!1)}this.woodenEffect.handleShowEffect(a),this.scene.footer.pieces.setActivePieces(),this.scene.updateMatchData()}catch(p){}},n.getBoardByFen=function(e){var t=[],n=e.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,s=0;s<a;s++){t[s]=[];for(var r=Zu(i[s]),o=0;o<r.length;o++)t[s][o]=r[o]}return t},n.getFenByBoard=function(){for(var e="",t=0;t<Gd;t++){for(var n=0,i="",a=0;a<Fd;a++){if(0===this.dataBoard[t][a].value&&n++,1===this.dataBoard[t][a].value)n>0&&(i+=n>=Gd?"x":""+n,n=0),i+=""+Fu(this.dataBoard[t][a].frame);a===this.dataBoard[t].length-1&&n>0&&(i+=n>=Gd?"x":""+n)}e+=t===this.dataBoard.length-1?""+i:i+"/"}return e},n.startGame=function(e){if(e)for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++){var i=e[t][n],a=i.value,s=i.frame,r=this.dataBoard[t][n];1===a&&(r.value=1,r.frame=s,r.cell.setFrame(Bd.GEM),r.cell.setVisible(!0))}},n.clearBoard=function(){for(var e=0;e<Gd;e++)for(var t=0;t<Fd;t++){var n=this.dataBoard[e][t];n.value=0,n.frame=Bd.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(Bd.GEM_TRANSPARENT),n.cell.setVisible(!1),n.cell.resetImageGameOver()}},n.isCellHighlight=function(e){var t,n=E()(t=this.cellsHighlight).call(t,(function(t){return t.x===e.x&&t.y&&e.y}));return!!(n&&n.length>0)},t}(Phaser.GameObjects.Container),Hd=GameCore.Configs.Gameplay.VibrateValue,Vd=us.Z.EFFECTS,Wd=Vd.KEY,Yd=Vd.FRAME,zd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenMoveDownScoreText=void 0,n.tweenMoveUpScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=t,t.add.existing((0,as.Z)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(Wd),this.particle.setDepth(ms.Z.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:Yd.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(40),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setTint(3049197),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(ms.Z.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var e=this;this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},delay:650,duration:185,onComplete:function(){e.tweenMoveDownScoreText=e.scene.tweens.add({targets:e.scoreText,y:"+=5",duration:170,delay:170,onComplete:function(){e.tweenMoveUpScoreText=e.scene.tweens.add({targets:e.scoreText,y:"-=21",duration:340,onComplete:function(){e.tweenHideScoreText=e.scene.tweens.add({targets:e.scoreText,y:"-=6",alpha:{from:1,to:0},duration:185,onComplete:function(){e.scoreText.setVisible(!1),e.scoreText.setAlpha(0),e.scoreText.setScale(0),e.scene.handleAddScoreAnim(e.score||0)}})}})}})}})},n.playAnimShowScoreText=function(){var e,t;if(null==(e=this.tweenMoveDownScoreText)||e.stop(),null==(t=this.tweenMoveUpScoreText)||t.stop(),this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){var n;this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var i=this.scene.storage.getState(),a=hc(i),s=0;"single"===a?(s=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(s+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(s+(this.score||0))):xt()(n=[Oa,_a,Da]).call(n,a)>=0&&(s=this.scene.header.myScoreBlock.score,this.scene.header.myScoreBlock.setScore(s+(this.score||0)),this.scene.header.myScoreBlock.setScoreText(s+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:Wd}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(ms.Z.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var e=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var t=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:t},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){e.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:t,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){e.praiseFrame.setScale(0),e.praiseFrame.setAlpha(0),e.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(ms.Z.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(e,t,n,i){this.startX=e,this.startY=t+15,this.listScore.push(n);var a=e-10;this.scoreText.setPosition(a,t+15),this.scoreText.setText("+"+n),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,t+15)),this.playAnimShowScoreText(),i>=2&&this.scene.effectManager.runEffectBubbleCombo(i,e,t-20);var s=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&kd(s),i<=1||this.changeExplode(a,t,i)},n.getVibrateByLevel=function(e){return Hd[e]||0},n.changeExplode=function(e,t,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,e,t)},n.handlePraiseFrameText=function(e,t,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,s=0;switch(i){case Yd.TEXT_COOL:a=84,s=30;break;case Yd.TEXT_GOOD:a=115.5,s=30;break;case Yd.TEXT_EXCELLENT:a=207,s=30}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,s),this.praiseFrame.setPosition(e-a/2<0?a/2:e,t-40),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(e){return er[e-1]||er[0]||null},n.getMainFrameByLevel=function(e){if(e>6)return us.Z.EFFECTS.FRAME.TEXT_EXCELLENT;var t=$s[e-1]||$s[0];return Phaser.Utils.Array.GetRandom(t.frames)},n.reset=function(){this.createTweenScoreText()},t}(Phaser.GameObjects.Container),Kd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.board=void 0,n.praise=void 0,n.scene=t,t.add.existing((0,as.Z)(n)),n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createBoard(),this.createPraise()},n.createBoard=function(){this.board=new Ud(this.scene,306,306)},n.createPraise=function(){this.praise=new zd(this.scene)},t}(Phaser.GameObjects.Container),jd=Kd,Xd=n(45353),qd=n(16470),Jd=us.Z.DEFAULT,Qd=Jd.KEY,$d=Jd.FRAME,ef=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).glare=void 0,s.bestScoreText=void 0,s.tweenGlare=void 0,s.tweenScoreText=void 0,s.scorePanel=void 0,s.shareButton=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.paperFireworksCelebration=void 0,s.starTwinkle=void 0,s.scene=void 0,s.open=function(t){e.prototype.open.call((0,as.Z)(s),t),s.setVisible(!0),s.runOpenAnimation(),s.paperFireworksCelebration.run(0,s.scene.gameZone.height,375,200),s.scene.audio.playSound(ds.Z.CONGRATULATION),s.setBestScoreText(t.bestScore)},s.scene=t,s.setVisible(!1),s.setDepth(ps.Ks.POPUP),s.createContent(),s.createConfetti(),s.createStarTwinkle(),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.handleDelegate=function(){var e=this,t=this.getData(["duration"])[0],n=void 0===t?0:t;this.scene.time.delayedCall(n,(function(){e.runCloseAnimation()}))},n.createConfetti=function(){this.paperFireworksCelebration=new Xd.Z(this.scene),this.paperFireworksCelebration.setDepth(ms.Z.ON_TOP)},n.createStarTwinkle=function(){this.starTwinkle=new qd.Z(this.scene),this.add(this.starTwinkle)},n.runAnim=function(){this.glare.setScale(0).setAlpha(0),this.bestScoreText.setScale(0).setAlpha(0),this.tweenScoreText.play(),this.tweenGlare.play()},n.createContent=function(){this.createCup(),this.createScorePanel(),this.createButtons()},n.createCup=function(){var e=this.scene.make.image({key:Qd,frame:$d.ICON_CUP});e.setWorldSize(290,216),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-105)},n.createScorePanel=function(){this.scorePanel=this.scene.add.container();var e=this.scene.make.image({key:Qd,frame:$d.POPUP_MID_1});e.setWorldSize(200,56),this.scorePanel.add(e),this.bestScoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(60),origin:{x:.5,y:.5}}),this.bestScoreText.setText("0"),this.scorePanel.add(this.bestScoreText),this.add(this.scorePanel),Phaser.Display.Align.In.Center(e,this.scorePanel,0,0),Phaser.Display.Align.In.Center(this.bestScoreText,this.scorePanel,0,1.5),Phaser.Display.Align.In.Center(this.scorePanel,this,0,46.5)},n.createButtons=function(){this.createShareButton()},n.createShareButton=function(){this.shareButton=new fs.Z(this.scene,Qd,$d.BUTTON_BLUE_SMALL_TALL,119,47),this.shareButton.onClick=this.shareBestScore.bind(this),this.shareButton.setName("Share");var e=this.scene.make.image({key:Qd,frame:$d.BLANK});e.setWorldSize(55,15),this.shareButton.add(e);var t=this.scene.make.image({key:Qd,frame:$d.ICON_SHARE_BLUE});t.setWorldSize(22,28),this.shareButton.add(t),this.add(this.shareButton),Phaser.Display.Align.In.Center(e,this.shareButton,12,0),Phaser.Display.Align.In.Center(t,this.shareButton,-35,0),Phaser.Display.Align.In.Center(this.shareButton,this,0,129)},n.shareBestScore=function(){this.scene.storage.dispatch(dh())},n.setBestScoreText=function(e){this.bestScoreText.setText(""+e)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(e,t){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this],delay:e,duration:t,props:{y:250,scale:0},onComplete:function(){i.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){var e=this;this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.scene.time.delayedCall(2e3,(function(){e.scene.postSessionScore()}))},n.runPopupEntrancesAnimation=function(e,t){var n=this;if(!this.popupShowUpAnimation){var i=this.y,a=this.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this],delay:e,duration:t,props:{y:{from:350,to:i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:a}},onComplete:function(){n.starTwinkle.run(1,0,-108,290,216),n.handleDelegate()}})}this.popupShowUpAnimation.play()},t}(GameCore.Screen),tf=ef,nf=n(20746),af=n(62157),sf=us.Z.DEFAULT,rf=sf.KEY,of=sf.FRAME,cf=function(e){function t(t){var n;return(n=e.call(this,t,rf,of.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Home"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:rf,frame:of.ICON_HOME_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),hf=cf,lf=us.Z.DEFAULT,uf=lf.KEY,pf=lf.FRAME,df=function(e){function t(t){var n;return(n=e.call(this,t,uf,pf.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Share"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:uf,frame:pf.ICON_SHARE_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),ff=df,mf=us.Z.DEFAULT,gf=mf.KEY,vf=mf.FRAME,yf=function(e){function t(t){var n;return(n=e.call(this,t,gf,vf.BUTTON_BLUE_SMALL_TALL)||this).button.setWorldSize(120,48),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:gf,frame:vf.BLANK});e.setWorldSize(22,20),this.add(e),Phaser.Display.Align.In.Center(e,this,-40)},n.createText=function(){var e=this.scene.make.image({key:gf,frame:vf.BLANK});e.setWorldSize(76,12),this.add(e),Phaser.Display.Align.In.Center(e,this,12)},t}(fs.Z),Sf=yf,Ef=us.Z.DEFAULT,Af=Ef.KEY,bf=Ef.FRAME,Tf=function(e){function t(t){var n;return(n=e.call(this,t,Af,bf.BUTTON_BLUE_SMALL_TALL)||this).button.setWorldSize(120,48),n.setName("Play"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:Af,frame:bf.ICON_PLAY});e.setWorldSize(26,26),this.add(e),Phaser.Display.Align.In.Center(e,this,-30,-2)},n.createText=function(){var e=this.scene.make.image({key:Af,frame:bf.TEXT_PLAY});e.setWorldSize(56,17),this.add(e),Phaser.Display.Align.In.Center(e,this,15,-2)},t}(fs.Z),Cf=Tf,Pf=us.Z.DEFAULT,wf=Pf.KEY,If=Pf.FRAME,kf=function(e){function t(t){var n;return(n=e.call(this,t,wf,If.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Chart"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:wf,frame:If.ICON_CHART_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),xf=kf,_f=us.Z.DEFAULT,Of=_f.KEY,Df=_f.FRAME,Rf=function(e){function t(t){var n;return(n=e.call(this,t,Of,Df.BUTTON_LONG_BLUE)||this).button.setWorldSize(311,50),n.setName("Restart"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:Of,frame:Df.ICON_REPLAY});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,-25,0)},n.createText=function(){var e=this.scene.make.image({key:Of,frame:Df.TEXT_RESTART});e.setWorldSize(56,12),this.add(e),Phaser.Display.Align.In.Center(e,this,25,0)},t}(fs.Z),Mf=Rf,Lf=us.Z.DEFAULT,Bf=Lf.KEY,Nf=Lf.FRAME,Ff=function(e){function t(t){var n;return(n=e.call(this,t)||this).popup=void 0,n.avatarMe=void 0,n.textScoreMe=void 0,n.avatarOpponent=void 0,n.textScoreOpponent=void 0,n.title=void 0,n.titleFrame=void 0,n.emoji=void 0,n.contents=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.myInfoBlock=void 0,n.tweenMyInfoBlock=void 0,n.opponentInfoBlock=void 0,n.tweenOpponentInfoBlock=void 0,n.icon=void 0,n.tweenIcon=void 0,n.iconCrown=void 0,n.tweenIconCrown=void 0,n.playWithFriendsButton=void 0,n.playButton=void 0,n.restartButton=void 0,n.homeButton=void 0,n.shareButton=void 0,n.chartButton=void 0,n.buttonClose=void 0,n.clickPlayWithFriends=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.scene.storage.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t){var n,a,s,r,o,c,l,u,p,d,f,m,g,v,y;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=window.game,a=n.player,s=n.facebook,n.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),r=Vl(Ol),o="",c="",l=s.contextType,r.length>0&&(u=Phaser.Math.RND.between(0,r.length-1),o=r[u],Ol.push(o)),!o||"string"!==typeof o){e.next=13;break}return e.next=12,s.createAsync(o);case 12:c=e.sent;case 13:return Dl({contextId:c}),p=a.getPlayerId(),e.next=17,s.getContextPlayers(p);case 17:return d=e.sent,f=ka,o||1!==d.length||(f=d[0]||ka),t(Il()),g=(m=f).name,v=m.photo,y={playerId:o,name:g,photo:v},e.next=25,t(Kl(_a,y));case 25:t(Ba(c,l)),e.next=35;break;case 28:if(e.prev=28,e.t0=e.catch(0),!(e.t0 instanceof rc)){e.next=34;break}return t(ql({mode:xa,status:ai})),t(Fl()),e.abrupt("return");case 34:(0,i.tO)(e.t0);case 35:return e.prev=35,Ml(1e3),e.finish(35);case 38:case"end":return e.stop()}}),e,null,[[0,28,35,38]])})));return function(t){return e.apply(this,arguments)}}());case 2:th.emit(Lo.REPLAY);case 3:case"end":return e.stop()}}),e)}))))},n.clickPlay=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.scene.storage.dispatch(Fl());case 2:th.emit(Lo.REPLAY);case 3:case"end":return e.stop()}}),e)}))))},n.clickRestart=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.scene.storage.dispatch(Zl());case 2:th.emit(Lo.REPLAY);case 3:case"end":return e.stop()}}),e)}))))},n.clickShare=function(){n.scene.storage.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o,c,l,u,p,d,f,m;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=window.game,s=a.player,r=a.analytics,o=a.facebook,c=a.globalScene,e.prev=1,c.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),l=n(),e.next=6,yh(l);case 6:return u=e.sent,ph(u),p=s.getPlayer(),d=p.playerId,f=p.name,m=p.photo,e.next=12,o.shareAsync({text:"Pheww, a great match!",intent:"SHARE",image:u||"",data:{playerId:d,playerName:f,playerPhoto:m,type:Ta}});case 12:r.event(Ht._.SHARE,{share_content_type:"MatchResult",success:!0}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),r.event(Ht._.SHARE,{share_content_type:"MatchResult",success:!1}),(0,i.tO)(e.t0);case 19:return e.prev=19,c.screen.close(ps.o4.NOTIFY_SCREEN),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,15,19,22]])})));return function(t,n){return e.apply(this,arguments)}}())},n.clickChart=function(){n.scene.storage.dispatch(El()),n.scene.scene.switch(Ua.Co.RANKING_SCENE)},n.handleShareBestScore=function(){n.scene.storage.dispatch(dh())},n.createPopup(),n.createPopupContent(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,-12,343,464,{framePopupTop:Nf.POPUP_TOP_1,framePopupMid:Nf.POPUP_MID_1,framePopupBottom:Nf.POPUP_BOTTOM_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this,0,0)},n.createPopupContent=function(){this.createTitle(),this.createEmoji(),this.createMyInfoBlock(),this.createOpponentInfoBlock(),this.createIcon(),this.createIconCrown(),this.createButtons(),this.popup.add([this.title]),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.restartButton,this.playButton,this.shareButton])},n.updateButtons=function(){},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:Bf,frame:Nf.TEXT_WAITING}),this.titleFrame.setWorldSize(238,16),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,0),this.title.add(this.titleFrame),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-26)},n.createButtonClose=function(){this.buttonClose=new fs.Z(this.scene,Bf,Nf.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,this.title,155,-12),this.title.add(this.buttonClose)},n.createEmoji=function(){this.emoji=this.scene.make.image({key:Bf,frame:Nf.EMOJI_WAITING}),this.emoji.setWorldSize(150,150),this.popup.add(this.emoji),Phaser.Display.Align.In.Center(this.emoji,this.popup,0,-130)},n.createButtons=function(){this.createButtonPlayWithFriend(),this.createButtonPlay(),this.createButtonRestart(),this.createButtonHome(),this.createButtonShare(),this.createButtonChart()},n.createButtonHome=function(){this.homeButton=new hf(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.BottomCenter(this.homeButton,this.popup,-126,-42)},n.clickHome=function(){this.scene.storage.dispatch(El()),this.scene.scene.switch(Ua.Co.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new Sf(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.playWithFriendsButton.setVisible(!1),this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.popup,0,80)},n.createButtonPlay=function(){this.playButton=new Cf(this.scene),this.playButton.onClick=this.clickPlay,this.playButton.setVisible(!1),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.playButton,this.popup,0,65)},n.createButtonRestart=function(){this.restartButton=new Mf(this.scene),this.restartButton.onClick=this.clickRestart,this.popup.add(this.restartButton),Phaser.Display.Align.In.Center(this.restartButton,this.popup,0,74)},n.createButtonShare=function(){this.shareButton=new ff(this.scene),this.shareButton.onClick=this.clickShare,this.popup.add(this.shareButton),Phaser.Display.Align.In.BottomCenter(this.shareButton,this.popup,0,-42)},n.createButtonChart=function(){this.chartButton=new xf(this.scene),this.chartButton.onClick=this.clickChart,this.popup.add(this.chartButton),Phaser.Display.Align.In.BottomCenter(this.chartButton,this.popup,126,-42)},n.createMyInfoBlock=function(){this.myInfoBlock=this.scene.add.container(),this.avatarMe=new Yp(this.scene,{key:Bf,background:Nf.AVATAR_BACKGROUND,width:62,height:62,borderWidth:8,radius:100}),this.avatarMe.background.setVisible(!1),this.avatarMe.avtFrame.setVisible(!1),this.myInfoBlock.add(this.avatarMe),Phaser.Display.Align.In.Center(this.avatarMe,this.myInfoBlock,0,0),this.textScoreMe=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(42),text:"0",origin:{x:.5,y:.5}}),this.textScoreMe.setTint(3552586),this.myInfoBlock.add(this.textScoreMe),Phaser.Display.Align.In.LeftCenter(this.textScoreMe,this.myInfoBlock,65,2),this.popup.add(this.myInfoBlock),Phaser.Display.Align.In.Center(this.myInfoBlock,this.popup,-53,-13),this.myInfoBlock.setAlpha(0),this.tweenMyInfoBlock=this.scene.tweens.add({targets:this.myInfoBlock,paused:!0,duration:200,delay:400,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createOpponentInfoBlock=function(){this.opponentInfoBlock=this.scene.add.container(),this.avatarOpponent=new Yp(this.scene,{key:Bf,background:Nf.AVATAR_BACKGROUND,width:62,height:62,borderWidth:8,radius:160}),this.avatarOpponent.background.setVisible(!1),this.avatarOpponent.avtFrame.setVisible(!1),this.opponentInfoBlock.add(this.avatarOpponent),Phaser.Display.Align.In.Center(this.avatarOpponent,this.opponentInfoBlock,0,0),this.textScoreOpponent=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(42),text:"0",origin:{x:.5,y:.5}}),this.textScoreOpponent.setTint(3552586),this.opponentInfoBlock.add(this.textScoreOpponent),Phaser.Display.Align.In.RightCenter(this.textScoreOpponent,this.opponentInfoBlock,65,2),this.popup.add(this.opponentInfoBlock),Phaser.Display.Align.In.Center(this.opponentInfoBlock,this.popup,53,-13),this.opponentInfoBlock.setAlpha(0),this.tweenOpponentInfoBlock=this.scene.tweens.add({targets:this.opponentInfoBlock,paused:!0,duration:200,delay:500,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createIcon=function(){this.icon=this.scene.make.image({key:Bf,frame:Nf.TEXT_VS}),this.icon.setWorldSize(34,18);var e=this.icon.scale;this.popup.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this.popup,0,-14),this.icon.setAlpha(0),this.tweenIcon=this.scene.tweens.add({targets:this.icon,paused:!0,duration:200,delay:300,scale:{from:1.5,to:e},alpha:{from:0,to:1},ease:"Power1"})},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:Bf,frame:Nf.ICON_CROWN}),this.iconCrown.setWorldSize(20,20),this.iconCrown.setVisible(!1);var e=this.iconCrown.scale;this.popup.add(this.iconCrown),this.iconCrown.setScale(0),this.tweenIconCrown=this.scene.tweens.add({targets:this.iconCrown,paused:!0,duration:200,delay:300,scale:{from:1.5,to:e},alpha:{from:0,to:1},ease:"Power1"})},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(e,t){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(400,300),this.runPopupContentEntrancesAnimation(600,300)},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){this.contentShowUpAnimation||(this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:this.scene.tweens.stagger(80,{start:e}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.updateInfo=function(){var e=this.scene.storage.getState(),t=qc(e),n=this.scene.player.getPlayer().playerId,i=Zc(e).playerId,a=Hc(e,{playerId:n}),s=Vc(e,{opponentId:i}),r=(t[n]||{}).score,o=void 0===r?0:r,c=(t[i]||{}).score,h=void 0===c?0:c;return this.textScoreMe.setText(String(o)),this.textScoreOpponent.setText(String(h)),a&&s?o===h?(this.titleFrame.setFrame(Nf.TEXT_DRAW),this.titleFrame.setWorldSize(113,26),this.emoji.setFrame(Nf.EMOJI_DRAW),void this.scene.audio.playSound(ds.Z.DRAW)):o>h?(this.titleFrame.setFrame(Nf.TEXT_WIN),this.titleFrame.setWorldSize(159,26),this.emoji.setFrame(Nf.EMOJI_WIN),this.emoji.setWorldSize(156,150),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.avatarMe,-53,-50),void this.scene.audio.playSound(ds.Z.WIN)):o<h?(this.titleFrame.setFrame(Nf.TEXT_LOSE),this.titleFrame.setWorldSize(168,26),this.emoji.setFrame(Nf.EMOJI_LOSE),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.avatarMe,53,-50),void this.scene.audio.playSound(ds.Z.LOSE)):void 0:(this.titleFrame.setFrame(Nf.TEXT_WAITING),this.titleFrame.setWorldSize(186,26),this.emoji.setFrame(Nf.EMOJI_WAITING),this.emoji.setWorldSize(150,150),this.iconCrown.setVisible(!1),this.scene.audio.playSound(ds.Z.WAIT_OPPONENT),void this.textScoreOpponent.setText("...."))},n.loadAvatars=function(){var e=this.scene.storage.getState(),t=this.scene.player.getPlayer(),n=t.photo,i=t.playerId,a=Zc(e),s=a.playerId,r=a.photo;this.avatarMe.loadPhoto(i,n,100),this.avatarOpponent.loadPhoto(s,r,100)},n.runAnim=function(){this.icon.setVisible(!0),this.myInfoBlock.setVisible(!0),this.opponentInfoBlock.setVisible(!0),this.iconCrown.setScale(0),this.tweenIconCrown.play(),this.tweenIcon.play(),this.tweenMyInfoBlock.play(),this.tweenOpponentInfoBlock.play()},n.checkExistConnectedPlayerId=function(){var e=this,t=this.scene.player.getConnectedPlayerIds(20,0);return!(E()(t).call(t,(function(t){return t!==e.scene.player.getPlayerId()})).length<=Ol.length)},t}(Phaser.GameObjects.Container),Gf=Ff,Zf=n(62187),Uf={targets:[],yoyo:!0,duration:120,ease:Phaser.Math.Easing.Circular.Out,props:{scale:{from:1,to:1.3}}},Hf=function(e){function t(t){return e.call(this,Uf,t)||this}return(0,o.Z)(t,e),t}(Zf.Z),Vf=us.Z.DEFAULT,Wf=Vf.KEY,Yf=Vf.FRAME,zf=function(e){function t(t){var n;return(n=e.call(this,t)||this).popup=void 0,n.title=void 0,n.contents=void 0,n.scoreText=void 0,n.bestScoreText=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.scoreBlock=void 0,n.bestScoreBlock=void 0,n.flagLeft=void 0,n.flagRight=void 0,n.flagsLeftDropAnimation=void 0,n.flagsRightDropAnimation=void 0,n.playButton=void 0,n.restartButton=void 0,n.homeButton=void 0,n.bestScore=void 0,n.currentScore=void 0,n.payload=void 0,n.buttonClose=void 0,n.counterAnimation=void 0,n.scoreAnimation=void 0,n.clickPlay=function(){n.runCloseAnimation(),n.scene.storage.dispatch(Fl()),th.emit(Lo.REPLAY)},n.initScore(),n.scene=t,n.createPopup(),n.createPopupContent(),n.createScoreAnimation(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,363,{framePopupTop:Yf.POPUP_TOP_1,framePopupMid:Yf.POPUP_MID_1,framePopupBottom:Yf.POPUP_BOTTOM_1}),this.add(this.popup)},n.createPopupContent=function(){this.createFlags(),this.createFlagsDropAnimation(),this.createTitle(),this.createScoreBlock(),this.createBestScoreBlock(),this.createButtons(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.restartButton,this.homeButton,this.playButton])},n.createFlags=function(){this.flagLeft=this.scene.make.image({key:Wf,frame:Yf.FLAG_LEFT}),this.popup.add(this.flagLeft),this.flagLeft.setVisible(!1),this.flagLeft.setWorldSize(218,94),this.flagRight=this.scene.make.image({key:Wf,frame:Yf.FLAG_RIGHT}),this.popup.add(this.flagRight),this.flagRight.setVisible(!1),this.flagRight.setWorldSize(248,81);var e=this.scene.gameZone.height;Phaser.Display.Align.In.LeftCenter(this.flagLeft,this.popup,26,-e/2+this.flagLeft.height-212),Phaser.Display.Align.In.RightCenter(this.flagRight,this.popup,26,-e/2+this.flagRight.height-207)},n.createFlagsDropAnimation=function(){this.flagsLeftDropAnimation=this.scene.add.tween({targets:[this.flagLeft],delay:66.66,props:{scale:{from:this.flagLeft.scale,to:.9*this.flagLeft.scale,end:this.flagLeft.scale,duration:1e3},y:{value:"+=200",duration:1e3,ease:"Bounce.easeOut"}}}),this.flagsRightDropAnimation=this.scene.add.tween({targets:[this.flagRight],props:{scale:{from:this.flagRight.scale,to:.9*this.flagRight.scale,end:this.flagRight.scale,duration:1e3},y:{value:"+=200",duration:1e3,ease:"Bounce.easeOut"}}})},n.runFlagsDropAnimation=function(){var e,t;this.flagLeft.setVisible(!0),null==(e=this.flagsLeftDropAnimation)||e.remove(),this.flagsLeftDropAnimation.play(),this.flagRight.setVisible(!0),null==(t=this.flagsRightDropAnimation)||t.remove(),this.flagsRightDropAnimation.play()},n.updateButtons=function(){},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:Wf,frame:Yf.TEXT_YOUR_SCORE});e.setWorldSize(100,14),Phaser.Display.Align.In.Center(e,this.title,0,12),this.title.add(e),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-17)},n.createButtonClose=function(){this.buttonClose=new fs.Z(this.scene,Wf,Yf.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,this.title,155,-12),this.title.add(this.buttonClose)},n.createScoreBlock=function(){this.scoreBlock=this.scene.add.container(),this.scoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(105),text:"0",origin:{x:.5,y:.5}}),this.scoreText.setTint(3304186),this.scoreBlock.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.scoreBlock,0,4),this.popup.add(this.scoreBlock),Phaser.Display.Align.In.TopCenter(this.scoreBlock,this.popup,0,-82)},n.createBestScoreBlock=function(){this.bestScoreBlock=this.scene.add.container();var e=this.scene.make.image({key:Wf,frame:Yf.TEXT_BEST_SCORE_2});e.setWorldSize(68,10),this.bestScoreBlock.add(e),this.bestScoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(44),text:"0",origin:{x:.5,y:.5}}),this.bestScoreText.setTint(262685),this.bestScoreBlock.add(this.bestScoreText),this.popup.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(e,this.bestScoreBlock,0,-50),Phaser.Display.Align.In.Center(this.bestScoreText,this.bestScoreBlock,0,-22),Phaser.Display.Align.In.Center(this.bestScoreBlock,this.scoreBlock,0,90)},n.createButtons=function(){this.createButtonRestart(),this.createButtonHome(),this.createButtonPlay()},n.createButtonRestart=function(){this.restartButton=new Mf(this.scene),this.restartButton.onClick=this.clickPlay,this.popup.add(this.restartButton),Phaser.Display.Align.In.Center(this.restartButton,this.popup,0,37)},n.createButtonHome=function(){this.homeButton=new hf(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.BottomCenter(this.homeButton,this.popup,0,-31)},n.clickHome=function(){this.scene.scene.switch(Ua.Co.DASHBOARD_SCENE)},n.createButtonPlay=function(){this.playButton=new Cf(this.scene),this.playButton.onClick=this.clickPlay,this.playButton.setVisible(!1),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.playButton,this.bestScoreBlock,0,80)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(e,t){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setBestScore=function(e){this.bestScoreText.setText(""+e)},n.runOpenAnimation=function(){this.runFlagsDropAnimation(),this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(400,300),this.runPopupContentEntrancesAnimation(600,300)},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){this.contentShowUpAnimation||(this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:this.scene.tweens.stagger(80,{start:e}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.initScore=function(){var e=this.scene.player.getBestScore();this.bestScore=e,this.currentScore=0},n.updateScore=function(){var e=this.scene.storage.getState(),t=Jc(e),n=t.score,i=t.bestScore;if(void 0===n&&void 0===i){var a=qc(e)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n,this.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.updateData=function(e){this.payload=e;var t=e.bestScore,n=e.currentScore;if(this.setBestScore(t),n<=t)return this.setCurrentScore(0),this.runScoreAnimation(),void(n>0?this.runScoreCounter():this.counterAnimation=null);this.runAnimation()},n.runAnimation=function(){this.runScoreCounter()},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.createScoreAnimation=function(){this.scoreAnimation=new Hf({targets:[this.scoreText],props:{scale:{from:1,to:1.3}}})},n.runScoreCounter=function(){var e,t=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(e=this.counterAnimation)||e.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:700,duration:2e3,completeDelay:300,onUpdate:function(e){t.scene.audio.playSound(ds.Z.SCORE_COUNT);var n=Math.floor(e.getValue());t.runScoreAnimation(),t.setCurrentScore(n)},onComplete:function(){t.setBestScore(i<a?a:i),t.setCurrentScore(a)}})},n.setCurrentScore=function(e){this.scoreText.setText(""+e)},n.checkExistConnectedPlayerId=function(){var e=this,t=this.scene.player.getConnectedPlayerIds(20,0);return!(E()(t).call(t,(function(t){return t!==e.scene.player.getPlayerId()})).length<=Ol.length)},t}(Phaser.GameObjects.Container),Kf=zf,jf=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).bestScore=void 0,s.currentScore=void 0,s.confettiLeftEffect=void 0,s.confettiRightEffect=void 0,s.queueScreens=[],s.popupYourScore=void 0,s.popupResult=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.popupShowUpAnimation=void 0,s.open=function(){var t;e.prototype.open.call((0,as.Z)(s)),s.popupYourScore.setVisible(!1),s.popupResult.setVisible(!1),s.runFadeInMaskAnimation(100,300),s.runPopupEntrancesAnimation(400,300),s.initScore(),s.updateScore();var n=s.scene.storage.getState(),i=hc(n);i&&i!==xa&&xt()(t=[Oa,_a,Da]).call(t,i)>=0?s.showPopupResult():s.showPopupYourScore(),s.scene.audio.playSound(ds.Z.GAME_OVER_SCENE)},s.createConfettiSmallAnimation(),s.createPopups(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.showPopupYourScore=function(){this.popupYourScore.setVisible(!0),this.popupYourScore.runOpenAnimation(),this.popupYourScore.updateButtons(),this.popupYourScore.updateScore()},n.showPopupResult=function(){this.popupResult.setVisible(!0),this.popupResult.runOpenAnimation(),this.popupResult.updateInfo(),this.popupResult.loadAvatars(),this.popupResult.updateButtons(),this.popupResult.runAnim()},n.createPopups=function(){this.createPopupYourScore(),this.createPopupResult()},n.createPopupYourScore=function(){this.popupYourScore=new Kf(this.scene),this.popupYourScore.setVisible(!1),this.add(this.popupYourScore),Phaser.Display.Align.In.Center(this.popupYourScore,this,0,-39)},n.createPopupResult=function(){this.popupResult=new Gf(this.scene),this.popupResult.setVisible(!1),this.add(this.popupResult),Phaser.Display.Align.In.Center(this.popupResult,this,0,-61)},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new af.Z(this.scene,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new af.Z(this.scene,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(ms.Z.ON_TOP),this.confettiRightEffect.setDepth(ms.Z.ON_TOP)},n.initScore=function(){var e=this.scene.player.getBestScore();this.bestScore=e,this.currentScore=0},n.updateScore=function(){var e=this.scene.storage.getState(),t=Jc(e),n=t.score,i=t.bestScore;if(this.bestScore=i,void 0===n||void 0===i){var a=qc(e)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this],delay:e,duration:t,props:{y:210,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}},t}(GameCore.Screen),Xf=jf,qf=n(78490),Jf=n.n(qf),Qf=(GameCore.Utils.Valid.isDebugger(),[{key:"level-0",mapJson:"./assets/json/levels/level-0.json"}]),$f=1;$f<=200;$f++)Qf.push({key:"level-"+$f,mapJson:"./assets/json/levels/level-"+$f+".json"});var em=Qf,tm=function(e){return e[Xi]},nm=(0,K.P1)([function(e){return tm(e).lives}],(function(e){return e})),im=(0,K.P1)([function(e){return tm(e).lastBonusLifeTime}],(function(e){return e})),am=(0,K.P1)([function(e){return tm(e).countDownStartAt}],(function(e){return e})),sm=GameCore.Configs,rm=sm.Match,om=sm.Lives,cm=function(e){return function(t){setTimeout((function(){t(um()),t(lm()),t(hm())}),e)}},hm=function(){return function(e){var t=60*om.bonusDurationMins*1e3;setInterval((function(){e(um()),e(lm())}),t)}},lm=function(){return function(e){e({type:$i,payload:{}})}},um=function(){return function(){var e=(0,r.Z)(h().mark((function e(t,n){var i,a,s,r,o,c,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.player,a=i.getPlayer(),s=a.playerId,r=n(),o=nm(r),(c=om.bonusLife+o)>om.livesCapacity&&(c=om.livesCapacity),l={lives:c,lastBonusLifeTime:(new Date).getTime()},t({type:Ji,payload:{data:l}}),e.next=11,window.FBInstant.player.setDataAsync({lives:l});case 11:(0,Fh.vk)(rm.LivesStore+"-"+s,l),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}()},pm=function(){return function(){var e=(0,r.Z)(h().mark((function e(t,n){var i,a,s,r,o,c,l,u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.player,a=i.getPlayer(),s=a.playerId,r=n(),o=nm(r),c=im(r),(l=o-om.bonusLife)>om.livesCapacity&&(l=om.livesCapacity),l<0&&(l=0),t({type:Ji,payload:{data:u={lives:l,lastBonusLifeTime:c}}}),e.next=13,window.FBInstant.player.setDataAsync({lives:u});case 13:(0,Fh.vk)(rm.LivesStore+"-"+s,u),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(0);case 18:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,n){return e.apply(this,arguments)}}()},dm=function(){return function(){var e=(0,r.Z)(h().mark((function e(t,n){var i,a,s,r,o,c,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=n(),a=nm(i)||0,s=im(i)){e.next=8;break}return e.next=7,t(fm({lives:a,lastBonusLifeTime:(new Date).getTime()}));case 7:return e.abrupt("return");case 8:return r=(new Date).getTime(),o=Math.floor((r-s)/1e3/(60*om.bonusDurationMins)),(c=o+a)>om.livesCapacity&&(c=om.livesCapacity),l={lives:c,lastBonusLifeTime:c===a?s:(new Date).getTime()},e.next=15,t(fm(l));case 15:e.next=19;break;case 17:e.prev=17,e.t0=e.catch(0);case 19:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,n){return e.apply(this,arguments)}}()},fm=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n){var i,a,s;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game.player,a=i.getPlayer(),s=a.playerId,n({type:Ji,payload:{data:e}}),t.next=5,window.FBInstant.player.setDataAsync({lives:e});case 5:(0,Fh.vk)(rm.LivesStore+"-"+s,e);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},mm=n(96486),gm=us.Z.GAMEPLAY_32.FRAME,vm="vertical",ym="horizontal",Sm="left",Em="right",Am="top",bm="bottom",Tm="vertical_left",Cm="vertical_right",Pm="horizontal_left",wm="horizontal_right",Im="gem/gem",km="gem/diamond/diamond-10",xm="gem/diamond/diamond-11",_m="gem/diamond/diamond-12",Om="gem/diamond/diamond-13",Dm="gem/diamond/diamond-14",Rm="gem/diamond/diamond-15",Mm="gem/star/star-1",Lm="gem/star/star-2",Bm="gem/star/star-3",Nm="gem/ruby/ruby-20",Fm="gem/sapphire/sapphire-30",Gm=[{level:1,frames:[],width:480,height:189},{level:2,frames:[us.Z.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[us.Z.EFFECTS.FRAME.TEXT_GOOD],width:579,height:189},{level:4,frames:[us.Z.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[us.Z.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[us.Z.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189}],Zm=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],Um="l",Hm="l_1",Vm="l_3",Wm="line_2",Ym="line_3",zm="line_4",Km="line_5",jm="square_1",Xm="square_2",qm="square_3",Jm="trapezoid",Qm="triangle",$m="t_piece",eg="plus_piece",tg="cross_piece_2",ng="cross_piece_3",ig="cross_piece_4",ag="cross_piece_5",sg="u_piece",rg=[Um,Hm,Vm,Wm,Ym,zm,Km,jm,Xm,qm,Qm,Jm,$m,eg,tg,ng,ig,ag,sg],og=[{type:Um,rate:3},{type:Hm,rate:4},{type:Vm,rate:2},{type:Wm,rate:16},{type:Ym,rate:12},{type:zm,rate:8},{type:Km,rate:4},{type:jm,rate:16},{type:Xm,rate:8},{type:Qm,rate:4},{type:Jm,rate:4},{type:$m,rate:2},{type:eg,rate:1},{type:tg,rate:4},{type:ng,rate:2},{type:ig,rate:1},{type:sg,rate:2}],cg=[[1,0],[1,0],[1,1]],hg=[[0,1],[0,1],[1,1]],lg=[[1,0],[1,1]],ug=[[1,0,0],[1,0,0],[1,1,1]],pg=[[1,1,1],[1,0,0]],dg=[[1,1,1],[0,0,1]],fg=[[1,1],[1,0]],mg=[[1,1,1],[1,0,0],[1,0,0]],gg=[[1,1],[0,1],[0,1]],vg=[[1,1],[1,0],[1,0]],yg=[[1,1],[0,1]],Sg=[[1,1,1],[0,0,1],[0,0,1]],Eg=[[0,0,1],[1,1,1]],Ag=[[1,0,0],[1,1,1]],bg=[[0,1],[1,1]],Tg=[[0,0,1],[0,0,1],[1,1,1]],Cg=[[1],[1]],Pg=[[1,1]],wg=[[1],[1],[1]],Ig=[[1,1,1]],kg=[[1],[1],[1],[1]],xg=[[1,1,1,1]],_g=[[1],[1],[1],[1],[1]],Og=[[1,1,1,1,1]],Dg=[[1]],Rg=[[1,1],[1,1]],Mg=[[1,1,1],[1,1,1],[1,1,1]],Lg=[[1,0],[1,1],[0,1]],Bg=[[0,1],[1,1],[1,0]],Ng=[[1,1,0],[0,1,1]],Fg=[[0,1,1],[1,1,0]],Gg=[[0,1],[1,1],[0,1]],Zg=[[1,0],[1,1],[1,0]],Ug=[[0,1,0],[1,1,1]],Hg=[[1,1,1],[0,1,0]],Vg=[[0,0,1],[1,1,1],[0,0,1]],Wg=[[1,0,0],[1,1,1],[1,0,0]],Yg=[[0,1,0],[0,1,0],[1,1,1]],zg=[[1,1,1],[0,1,0],[0,1,0]],Kg=[[0,1,0],[1,1,1],[0,1,0]],jg=[[1,0],[0,1]],Xg=[[0,1],[1,0]],qg=[[1,0,0],[0,1,0],[0,0,1]],Jg=[[0,0,1],[0,1,0],[1,0,0]],Qg=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],$g=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],ev=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],tv=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],nv=[[1,1],[0,1],[1,1]],iv=[[1,1],[1,0],[1,1]],av=[[1,0,1],[1,1,1]],sv=[[1,1,1],[1,0,1]],rv={1:gm.GEM,10:gm.STAR_1,11:gm.STAR_2,12:gm.STAR_3,13:gm.STAR_1,14:gm.STAR_2,15:gm.STAR_3},ov={"gem/star/star-1":gm.ICON_STAR_1,"gem/star/star-2":gm.ICON_STAR_2,"gem/star/star-3":gm.ICON_STAR_3},cv={1:{type:jm,direction:null,isReverse:!1,data:Dg},I2:{type:Wm,direction:vm,isReverse:!1,data:Cg},I3:{type:Ym,direction:vm,isReverse:!1,data:wg},I4:{type:zm,direction:vm,isReverse:!1,data:kg},I5:{type:Km,direction:vm,isReverse:!1,data:_g},II2:{type:Wm,direction:ym,isReverse:!1,data:Pg},II3:{type:Ym,direction:ym,isReverse:!1,data:Ig},II4:{type:zm,direction:ym,isReverse:!1,data:xg},II5:{type:Km,direction:ym,isReverse:!1,data:Og},J1:{type:Um,direction:Am,isReverse:!0,data:cg},J2:{type:Um,direction:Sm,isReverse:!0,data:Ag},J3:{type:Um,direction:bm,isReverse:!0,data:vg},J4:{type:Um,direction:Em,isReverse:!0,data:dg},L1:{type:Um,direction:Am,isReverse:!1,data:cg},L2:{type:Um,direction:Em,isReverse:!1,data:pg},L3:{type:Um,direction:bm,isReverse:!1,data:gg},L4:{type:Um,direction:Sm,isReverse:!1,data:Eg},O:{type:Xm,direction:null,isReverse:!1,data:Rg},"polyplet-left-2":{type:tg,direction:Sm,isReverse:!1,data:jg},"polyplet-left-3":{type:ng,direction:Sm,isReverse:!1,data:qg},"polyplet-left-4":{type:ig,direction:Sm,isReverse:!1,data:Qg},"polyplet-left-5":{type:ag,direction:Sm,isReverse:!1,data:ev},"polyplet-right-2":{type:tg,direction:Em,isReverse:!1,data:Xg},"polyplet-right-3":{type:ng,direction:Em,isReverse:!1,data:Jg},"polyplet-right-4":{type:ig,direction:Em,isReverse:!1,data:$g},"polyplet-right-5":{type:ag,direction:Em,isReverse:!1,data:tv},S1:{type:Jm,direction:wm,isReverse:!1,data:Fg},S2:{type:Jm,direction:Tm,isReverse:!1,data:Lg},T1:{type:Qm,direction:Am,isReverse:!1,data:Ug},T2:{type:Qm,direction:Em,isReverse:!1,data:Zg},T3:{type:Qm,direction:bm,isReverse:!1,data:Hg},T4:{type:Qm,direction:Sm,isReverse:!1,data:Gg},TT1:{type:$m,direction:bm,isReverse:!1,data:zg},TT2:{type:$m,direction:Sm,isReverse:!1,data:Vg},TT3:{type:$m,direction:Am,isReverse:!1,data:Yg},TT4:{type:$m,direction:Em,isReverse:!1,data:Wg},U1:{type:sg,direction:Am,isReverse:!1,data:av},U2:{type:sg,direction:Em,isReverse:!1,data:iv},U3:{type:sg,direction:bm,isReverse:!1,data:sv},U4:{type:sg,direction:Sm,isReverse:!1,data:nv},V1:{type:Hm,direction:Em,isReverse:!1,data:fg},V2:{type:Hm,direction:bm,isReverse:!1,data:yg},V3:{type:Hm,direction:Am,isReverse:!1,data:lg},V4:{type:Hm,direction:Sm,isReverse:!1,data:bg},VV1:{type:Vm,direction:Em,isReverse:!1,data:mg},VV2:{type:Vm,direction:bm,isReverse:!1,data:Sg},VV3:{type:Vm,direction:Am,isReverse:!1,data:ug},VV4:{type:Vm,direction:Sm,isReverse:!1,data:Tg},X:{type:eg,direction:null,isReverse:!1,data:Kg},Z1:{type:Jm,direction:Pm,isReverse:!1,data:Ng},Z2:{type:Jm,direction:Cm,isReverse:!1,data:Bg}},hv=GameCore.Configs.Board,lv=(hv.cols,hv.rows,0),uv=function(){return lv},pv=function(e,t){lv=0;for(var n=[],i=e.length,a=e[0].length,s=[],r=[],o=function(t){for(var i=!0,r=0;r<a;r++)0===e[t][r].value&&(i=!1);if(i){s.push(t);for(var o=function(i){n.some((function(e){return e.x===i&&e.y===t}))||n.push({x:i,y:t,frame:e[t][i].frame})},c=0;c<a;c++)o(c)}},c=0;c<i;c++)o(c);for(var h=function(t){for(var a=!0,s=0;s<i;s++)0===e[s][t].value&&(a=!1);if(a){r.push(t);for(var o=function(i){n.some((function(e){return e.x===t&&e.y===i}))||n.push({x:t,y:i,frame:e[i][t].frame})},c=0;c<i;c++)o(c)}},l=0;l<a;l++)h(l);var u=mv(e,t);if(u&&u.length>0)for(var p=function(){var t=u[d],i=t.x,a=t.y;n.some((function(e){return e.x===i&&e.y===a}))||n.push({x:i,y:a,frame:e[a][i].frame})},d=0;d<u.length;d++)p();return lv+=s.length,lv+=r.length,lv+=Math.floor(u.length/9),n},dv=function(e,t){if(0===e.length)return!1;var n=E()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return!(!n||n.length<=0)},fv=function(e,t){for(var n=t.x,i=t.y,a=[],s=n;s<n+3;s++)for(var r=i;r<i+3;r++){if(0===e[r][s].value)return[];a.push({x:s,y:r})}return a},mv=function(e,t){for(var n=[],i=function(e){for(var t,n=[],i=0;i<e.length;i++){var a=(t=e[i],{x:3*Math.floor(t.x/3),y:3*Math.floor(t.y/3)});dv(n,a)||n.push(a)}return n}(t),a=0;a<i.length;a++){var s=i[a],r=fv(e,s);n.push.apply(n,r)}return n},gv=function(e){for(var t=e.length,n=e[0].length,i=[],a=0;a<t;a++){for(var s=!0,r=0;r<n;r++)0===e[a][r].value&&(s=!1);s&&i.push(a)}return i},vv=function(e){for(var t=e.length,n=e[0].length,i=[],a=0;a<n;a++){for(var s=!0,r=0;r<t;r++)0===e[r][a].value&&(s=!1);s&&i.push(a)}return i},yv=function(e,t){var n=e.length,i=e[0].length;if(0===t.length)return!1;for(var a=0;a<n;a++)for(var s=0;s<i;s++)for(var r=0;r<t.length;r++)if(Sv(e,s,a,t[r]))return!1;return!0},Sv=function(e,t,n,i){for(var a=!0,s=0;s<i.data.length;s++)for(var r=0;r<i.data[s].length;r++)i.data[s][r].texture&&(e[n+s]&&e[n+s][t+r]&&0===e[n+s][t+r].value||(a=!1));return a},Ev=function(e,t){for(var n=e.length,i=e[0].length,a=0;a<n;a++)for(var s=0;s<i;s++)if(Sv(e,s,a,t))return!0;return!1},Av=0,bv=function(){return Av++,18+10*(Tv()-1)},Tv=function(){return Av+1},Cv=function(e){var t=e;switch(e){case Im:t="g";break;case km:t="d10";break;case xm:t="d11";break;case _m:t="d12";break;case Om:t="d13";break;case Dm:t="d14";break;case Rm:t="d15";break;case Mm:t="st1";break;case Lm:t="st2";break;case Bm:t="st3";break;case Nm:t="r20";break;case Fm:t="s30";break;case Um:t="l";break;case Hm:t="l1";break;case Vm:t="l3";break;case Wm:t="e2";break;case Ym:t="e3";break;case zm:t="e4";break;case Km:t="e5";break;case jm:t="s1";break;case Xm:t="s2";break;case qm:t="s3";break;case Jm:t="tz";break;case Qm:t="ta";break;case eg:t="pl";break;case $m:t="tp";break;case tg:t="cr2";break;case ng:t="cr3";break;case ig:t="cr4";break;case ag:t="cr5";break;case sg:t="up";break;case Am:t="dt";break;case Sm:t="dl";break;case Em:t="dr";break;case bm:t="db";break;case vm:t="v";break;case ym:t="h";break;case Tm:t="vl";break;case Cm:t="vr";break;case Pm:t="hl";break;case wm:t="hr"}return t},Pv=function(e){var t=e;switch(e){case"g":t=Im;break;case"d10":t=km;break;case"d11":t=xm;break;case"d12":t=_m;break;case"d13":t=Om;break;case"d14":t=Dm;break;case"d15":t=Rm;break;case"st1":t=Mm;break;case"st2":t=Lm;break;case"st3":t=Bm;break;case"r20":t=Nm;break;case"s30":t=Fm;break;case"b":case"c":case"d":case"g":case"o":case"p":case"q":case"r":case"y":t="gem/gem";break;case"l":t=Um;break;case"l1":t=Hm;break;case"l3":t=Vm;break;case"e2":t=Wm;break;case"e3":t=Ym;break;case"e4":t=zm;break;case"e5":t=Km;break;case"s1":t=jm;break;case"s2":t=Xm;break;case"s3":t=qm;break;case"tz":t=Jm;break;case"ta":t=Qm;break;case"pl":t=eg;break;case"tp":t=$m;break;case"cr2":t=tg;break;case"cr3":t=ng;break;case"cr4":t=ig;break;case"cr5":t=ag;break;case"up":t=sg;break;case"dt":t=Am;break;case"dl":t=Sm;break;case"dr":t=Em;break;case"db":t=bm;break;case"v":t=vm;break;case"h":t=ym;break;case"vl":t=Tm;break;case"vr":t=Cm;break;case"hl":t=Pm;break;case"hr":t=wm}return t},wv=function(e){for(var t=[],n=e.split(","),i=0;i<n.length;i++){var a=n[i],s=Pv(a);"x"===a?t.push({value:0,frame:"gem/gem_transparent"}):t.push({value:1,frame:s})}return t},Iv=function(e){var t=e.split("|"),n=t[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:Pv(n[0]),direction:Pv(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,fenPiece:t[1]}},kv=us.Z.DEFAULT,xv=kv.KEY,_v=kv.FRAME,Ov=us.Z.GAMEPLAY,Dv=Ov.KEY,Rv=Ov.FRAME,Mv=us.Z.GAMEPLAY_32,Lv=Mv.KEY,Bv=Mv.FRAME,Nv=GameCore.Configs,Fv=Nv.Network,Gv=Nv.Board,Zv=function(e){function t(t,n,i,a){var s;(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.textCollect=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.collectTargetsContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var e=s.getData(["onClose"])[0];s.scene.screen.close(s.name),e&&e()}))},s.decodeMathData=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}};try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5)}catch(r){}return s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(h().mark((function t(n){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),t.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var e=this.scene.storage.getState(),t=Kc(e),n=em[t];n||(n=em[em.length-1]);var a=n,s=a.key,r=a.mapJson;if(this.scene.cache.tilemap.exists(s))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(s,r),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(o){(0,i.tO)(o)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.scene.storage.getState(),!Kc(t)){e.next=5;break}return e.abrupt("return");case 5:return this.showLoadingScreen(),e.next=8,this.scene.storage.dispatch(Tl());case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,i.tO)(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading level...",duration:Fv.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(ps.o4.NOTIFY_SCREEN)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,548,{forceHeightTop:47}),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,0)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:xv,frame:_v.TEXT_JOURNEY});e.setTint(262685),e.setWorldSize(89,22),this.buttonClose=new fs.Z(this.scene,xv,_v.ICON_CLOSE,20,20),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add(this.buttonClose),this.title.add(e),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,148,-3),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-13)},n.createTargetItems=function(){this.collectTargetsContainer=this.scene.add.container(),this.textCollect=this.scene.make.image({key:xv,frame:_v.TEXT_COLLECT}),this.textCollect.setWorldSize(63,14),this.collectTargetsContainer.add(this.textCollect),this.popup.add(this.collectTargetsContainer),Phaser.Display.Align.In.Center(this.textCollect,this.collectTargetsContainer,0,-65)},n.drawTargetItems=function(){var e,t,n=this.scene.storage.getState(),i=Kc(n),a=em[i];a||(a=em[em.length-1]);var s=this.scene.make.tilemap({key:a.key}).properties;if(s&&(0,mm.isArray)(s)&&!(s.length<2)){for(var r=s[0].value,o=Jf()(e=Jf()(t=Jf()(r).call(r,"{",'{"')).call(t,", ",', "')).call(e,":",'":'),c=JSON.parse(o),h=te()(c),l=[],u=0;u<h.length;u++){var p=h[u],d=rv[p];ce()(l).call(l,d)||l.push(d)}var f=this.calcPosition(l.length);l=[];for(var m=0;m<h.length;m++){var g=h[m],v=rv[g],y=c[g];if(!ce()(l).call(l,v)){var S=this.targetData[m];S||(S=this.spawnTargetItem(v,y));var E=S,A=E.container,b=E.text,T=E.gem;A.setVisible(!0),b.setText("x"+(y||1)),T.setFrame(v),this.targetData.push(S),this.collectTargetsContainer.add(A),Phaser.Display.Align.In.Center(A,this.textCollect,f[m]+80,0),l.push(v)}}var C=this.textCollect.width+41*h.length;Phaser.Display.Align.In.TopCenter(this.collectTargetsContainer,this.popup,-C/2,-139)}},n.spawnTargetItem=function(e,t){var n=this.scene.make.container({}),i=this.scene.make.image({key:Lv,frame:e});i.setWorldSize(30,30);var a=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(35),origin:{x:0,y:.5},text:"x"+t});return a.setTint(262685),n.add([i,a]),Phaser.Display.Align.In.Center(i,n,-10,0),Phaser.Display.Align.In.LeftCenter(a,i,-35,2),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(e){for(var t=[],n=0;n<e;n++)t.push(70*n);return t},n.createBoard=function(){var e=this.scene.make.image({key:Dv,frame:Rv.BOARD});e.setWorldSize(310.5,310.5),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,3),this.initCellBoard()},n.initCellBoard=function(){for(var e=0;e<Gv.rows;e++){this.boardCellData[e]=[];for(var t=0;t<Gv.cols;t++){var n=33.3*t-137+1*t,i=33.3*e-134+1*e,a=Bv.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[e].push(s)}}},n.updateCellBoard=function(){var e=this.scene.storage.getState(),t=Yc(e).data.fen;if(t){var n=t.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var e=0;e<this.targetData.length;e++){var t,n;null==(t=this.targetData[e])||null==(n=t.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var e=0;e<Gv.rows;e++)for(var t=0;t<Gv.cols;t++){this.boardCellData[e][t].setFrame(Bv.GEM_TRANSPARENT)}},n.drawBoardByFen=function(e){for(var t=Eu()(e).call(e).split("/"),n=0;n<t.length;n++)for(var i=t[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=Pv(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var e=this.scene.storage.getState(),t=Kc(e),n=em[t];n||(n=em[em.length-1]);var i=this.scene.make.tilemap({key:n.key}).layers;if((0,mm.isArray)(i)){var a=i[0].data;if((0,mm.isArray)(a))for(var s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var c=r[o];if(!(c.index<0)){var h=rv[c.index-1];this.boardCellData[s][o].setFrame(h)}}}},n.spawnCellBoard=function(e,t,n){var i=this.scene.make.image({key:Lv,frame:e});return i.setWorldSize(32,32),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,t,n),i},n.createButtonPlay=function(){this.buttonPlay=new fs.Z(this.scene,xv,_v.BUTTON_LONG_BLUE,311,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var e=this.scene.make.image({key:xv,frame:_v.TEXT_PLAY});e.setWorldSize(33,16),this.buttonPlay.add([e]),Phaser.Display.Align.In.Center(e,this.buttonPlay),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.BottomCenter(this.buttonPlay,this.popup,0,-45)},n.handlePlay=function(){var e=this,t=this.scene.storage.getState();nm(t)<1?this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN):(this.scene.storage.dispatch(pm()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){e.scene.screen.close(e.name);var t=e.scene.storage.getState(),n=Kc(t);n>em.length||(e.scene.analytics.levelStart(n,void 0,e.getLevelName(n)),e.scene.storage.dispatch(Gl()))})))},n.getLevelName=function(e){var t;return"journey_"+ls()(t=GameCore.Utils.Number).call(t,e,4,"0")},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),Uv=us.Z.DEFAULT,Hv=Uv.KEY,Vv=Uv.FRAME,Wv=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonContinue=void 0,s.contents=void 0,s.textScore=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.closeTimer=void 0,s.scene=t,s.createPopup(),s.createTitle(),s.createTexts(),s.createButtons(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(t){var n=this;e.prototype.open.call(this,t);var i=this.scene.levelManager.getCurrentTargetScore();this.textScore.setText(""+i);var a=this.getData(["duration"])[0];this.runOpenAnimation(),this.closeTimer=this.scene.time.delayedCall(a,(function(){n.clickButtonContinue()}))},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,280,{framePopupTop:Vv.POPUP_TOP_1,framePopupMid:Vv.POPUP_MID_1,framePopupBottom:Vv.POPUP_BOTTOM_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.title.setSize(343,47);var e=this.scene.make.image({key:Hv,frame:Vv.TEXT_MISSION});e.setWorldSize(71,15),this.title.add([e]),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title,0,0),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextScore()},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(160),text:"0",origin:{x:.5,y:.5}}),this.textScore.setTint(3552586),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.popup,0,0)},n.createButtons=function(){this.createButtonContinue()},n.createButtonContinue=function(){var e=this.scene.make.image({key:Hv,frame:Vv.TEXT_PLAY});e.setWorldSize(33,16),this.buttonContinue=new fs.Z(this.scene,Hv,Vv.BUTTON_LONG_BLUE,311,50),this.buttonContinue.setName("Continue"),this.buttonContinue.add(e),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(e,this.buttonContinue,0,0),Phaser.Display.Align.In.BottomCenter(this.buttonContinue,this.popup,0,-20)},n.clickButtonContinue=function(){var e;null==(e=this.closeTimer)||e.remove(),this.scene.nextLevel(),this.runCloseAnimation()},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.scene.main.board.handleTweenStartMission(),n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),Yv=us.Z.DEFAULT,zv=Yv.KEY,Kv=Yv.FRAME,jv=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.textOutOfMoves=void 0,s.closeTimerEvent=void 0,s.popupShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.contentShowUpAnimation=void 0,s.open=function(t){e.prototype.open.call((0,as.Z)(s),t),s.runOpenAnimation(),s.handleDelegate()},s.close=function(){e.prototype.close.call((0,as.Z)(s))},s.scene=t,s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s.createContent(),s}(0,o.Z)(t,e);var n=t.prototype;return n.handleDelegate=function(){var e,t=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(e=this.closeTimerEvent)||e.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){t.visible&&t.scene.screen.close(t.name),s&&s()}}))},n.createContent=function(){this.createPopup(),this.createText(),this.createIcon()},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,286,{framePopupTop:Kv.POPUP_TOP_1,framePopupMid:Kv.POPUP_MID_1,framePopupBottom:Kv.POPUP_BOTTOM_1}),this.add(this.popup)},n.createText=function(){this.textOutOfMoves=this.scene.make.image({key:zv,frame:Kv.TEXT_OUT_OF_MOVES}),this.textOutOfMoves.setWorldSize(270,27),this.popup.add(this.textOutOfMoves),Phaser.Display.Align.In.Center(this.textOutOfMoves,this.popup,0,-90)},n.createIcon=function(){var e=this.scene.make.image({key:zv,frame:Kv.ICON_LOSE_FACE});e.setWorldSize(150,150),this.popup.add(e),Phaser.Display.Align.In.Center(e,this,0,17)},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},t}(GameCore.Screen),Xv=n(97308),qv=us.Z.DEFAULT,Jv=qv.KEY,Qv=qv.FRAME,$v=GameCore.Configs,ey=$v.Match,ty=$v.Network,ny=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.isUseRescue=void 0,s.countdownCount=void 0,s.popup=void 0,s.skipText=void 0,s.continueButton=void 0,s.tweenContinueButton=void 0,s.continueButtonAnimation=void 0,s.textRescueTime=void 0,s.tweenTextRescueTime=void 0,s.skipTextTween=void 0,s.countdownTimer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.adsTimer=void 0,s.open=function(){e.prototype.open.call((0,as.Z)(s)),s.scene.audio.playSound(ds.Z.RESCUE_TIME),s.runOpenAnimation()},s.close=function(){e.prototype.close.call((0,as.Z)(s)),s.continueButton.setVisible(!1),s.skipText.setVisible(!1),s.textRescueTime.setScale(0).setAlpha(0)},s.handleShowRewardedVideoAd=(0,r.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.scene.audio.stopSound(ds.Z.RESCUE_TIME),t=s.scene.game.globalScene,s.countdownTimer.remove(),e.prev=3,!s.isUseRescue){e.next=6;break}return e.abrupt("return");case 6:return s.isUseRescue=!0,t.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading ads...",duration:0,loading:!0}),s.scene.audio.pauseMusic(),s.scene.audio.muteAll(),e.next=12,new(ie())((function(e,t){var n;null==(n=s.adsTimer)||n.remove(),s.adsTimer=s.scene.time.delayedCall(ty.Timeout,t),s.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?s.scene.ads.events.once(GameCore.Ads.Events.LOADED,e):s.scene.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 12:return e.next=15,s.scene.ads.showRewardedVideoAsync();case 15:s.scene.storage.dispatch(Jl()),s.scene.analytics.showRewardedVideoAd(s.scene.getSceneName()),t.screen.events.off(GameCore.Screens.Events.CLOSE),th.emit(Lo.RESCUE),s.scene.screen.close(s.name),s.scene.audio.playSound(ds.Z.DAILY_REWARD),t.screen.close(ps.o4.NOTIFY_SCREEN),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(3),s.showNotifyNoAds();case 27:return e.prev=27,null==(n=s.adsTimer)||n.destroy(),s.scene.audio.unmuteAll(),s.scene.audio.playMusic(),s.scene.ads.preloadRewardedVideoAsync().catch((function(e){})),e.finish(27);case 33:case"end":return e.stop()}}),e,null,[[3,24,27,33]])}))),s.showNotifyNoAds=function(e){if(!e||e.name===ps.o4.NOTIFY_SCREEN){var t=s.scene.game.globalScene;t.screen.events.off(GameCore.Screens.Events.CLOSE),t.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),t.screen.open(ps.o4.NOTIFY_SCREEN,{message:"There was an error...",duration:2e3,loading:!1})}},s.showNotifySkipAds=function(){var e=s.scene.game.globalScene;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),e.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Sorry, No Rewards!\nYou have cancelled the ad!",duration:3e3,loading:!1})},s.showGameOver=function(e){e&&e.name!==ps.o4.NOTIFY_SCREEN||(s.countdownTimer.remove(),s.scene.screen.close(s.name),s.scene.endGame())},s.handleSkip=function(){s.countdownTimer.remove(),s.scene.screen.close(s.name),s.scene.endGame()},s.handleRunCountdown=function(){s.countdownCount-=1,s.countdownCount<=0?s.rescueTimeout():s.setTime(s.countdownCount)},s.scene=t,s.countdownCount=ey.MaxRescueCount,s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s.createPopup(),s.createContent(),s}(0,o.Z)(t,e);var n=t.prototype;return n.runAnim=function(){this.tweenTextRescueTime.play(),this.skipText.setVisible(!0),this.skipTextTween.play(),this.tweenContinueButton.play()},n.updateInfo=function(){var e=this.scene.storage.getState(),t=Jc(e);this.textRescueTime.setText(String(t.score||0))},n.setTime=function(e){this.textRescueTime.setText(""+e),Phaser.Display.Align.In.Center(this.textRescueTime,this.zone,0,-43)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,346,{framePopupTop:Qv.POPUP_TOP_1,framePopupMid:Qv.POPUP_MID_1,framePopupBottom:Qv.POPUP_BOTTOM_1}),this.add(this.popup)},n.createContent=function(){this.createTitle(),this.createTextRescueTime(),this.createProgressCircle(),this.createContinueButton(),this.createSkipText()},n.createTitle=function(){var e=this.scene.add.container(),t=this.scene.make.image({key:Jv,frame:Qv.TEXT_SECOND_CHANGE});t.setWorldSize(150,14),Phaser.Display.Align.In.Center(t,e,0,10),e.add([t]),this.popup.add(e),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-20)},n.createTextRescueTime=function(){this.textRescueTime=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(180),origin:{x:.5,y:.5}}),this.textRescueTime.setTint(1419820),this.textRescueTime.setScale(0).setAlpha(0),this.add(this.textRescueTime),this.tweenTextRescueTime=this.scene.tweens.add({delay:100,targets:this.textRescueTime,paused:!0,duration:200,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Power1"})},n.createProgressCircle=function(){},n.setProgressCircle=function(e){},n.runCountdown=function(){this.startProgressCircle();var e={delay:1e3,loop:!0,callback:this.handleRunCountdown};this.countdownTimer=this.scene.time.addEvent(e)},n.startProgressCircle=function(){this.scene.tweens.addCounter({from:0,to:360,duration:1e3*ey.RescueGamePopupTimeout,onUpdate:function(e){e.getValue().toFixed(2)},onComplete:function(){}})},n.rescueTimeout=function(){this.countdownTimer.remove(),this.scene.screen.close(this.name),this.scene.endGame()},n.createContinueButton=function(){this.continueButton=new fs.Z(this.scene,Jv,Qv.BUTTON_LONG_BLUE,311,50),this.continueButton.setName("Continue"),this.add(this.continueButton),this.continueButton.onClick=this.handleShowRewardedVideoAd;var e=this.scene.make.image({key:Jv,frame:Qv.ICON_VIDEO_PLAY});e.setWorldSize(24,24),Phaser.Display.Align.In.Center(e,this.continueButton,-54,-2.5),this.continueButton.add(e);var t=this.scene.make.image({key:Jv,frame:Qv.TEXT_CONTINUE});t.setWorldSize(99,16),this.continueButton.add(t),Phaser.Display.Align.In.Center(t,this.continueButton,19,-2),Phaser.Display.Align.In.Center(this.continueButton,this.textRescueTime,0,50),this.continueButton.setScale(0).setAlpha(0),this.tweenContinueButton=this.scene.tweens.add({paused:!0,targets:this.continueButton,ease:Xv.Z,props:{alpha:{from:0,to:1},scale:{from:1.2,to:1}},delay:300,duration:300})},n.createSkipText=function(){this.skipText=new fs.Z(this.scene,Jv,Qv.BUTTON_LONG_WHITE,311,50),this.skipText.setName("NoThanks");var e=this.scene.make.image({key:Jv,frame:Qv.TEXT_NO_THANKS});e.setWorldSize(101,16),this.skipText.add(e);var t=this.scene.make.image({key:Jv,frame:Qv.ICON_DANGER_TRIANGLE});t.setWorldSize(24,24),this.skipText.add(t),Phaser.Display.Align.In.Center(e,this.skipText,19,0),Phaser.Display.Align.In.Center(t,this.skipText,-54,0),Phaser.Display.Align.In.BottomCenter(this.skipText,this.continueButton,0,65),this.skipText.onClick=this.handleSkip,this.skipText.setVisible(!1).setAlpha(0),this.popup.add(this.skipText),this.skipTextTween=this.scene.tweens.add({targets:this.skipText,delay:ey.DelayNoThank,paused:!0,alpha:{from:0,to:1},ease:"Power1",duration:500})},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300))},n.runPopupEntrancesAnimation=function(e,t){var n=this;if(!this.popupShowUpAnimation){var i=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.continueButton.setVisible(!0),n.skipText.setVisible(!0),n.runAnim(),n.updateInfo(),n.isUseRescue=!1,n.countdownCount=ey.RescueGamePopupTimeout,n.setTime(n.countdownCount),n.runCountdown()}})}this.popupShowUpAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),iy=ny,ay=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).textMain=void 0,i.payload=void 0,i.chars=void 0,i.listText=[],i.tweenText=void 0,i.payload=n,i.createTextMain(),i.initListText(),i.createAnim(),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.createTextMain=function(){var e=this.payload,t=e.font,n=e.size,i=e.text;this.textMain=this.scene.make.bitmapText({font:t,size:n,origin:{x:.5,y:.5},text:i}).setVisible(!1),this.add(this.textMain)},n.initListText=function(){var e=this.payload,t=e.text,n=e.font,i=e.size;if(t){this.chars=t.split("");for(var a=0,s=0;s<this.chars.length;s++){var r=this.chars[s],o=this.scene.make.bitmapText({font:n,size:i,origin:{x:.5,y:.5},text:r});this.listText.push(o),a+=o.width}for(var c=-a/2+4,h=0;h<this.chars.length;h++){var l=this.listText[h],u=0;"!"===l.text&&(u=-5),"W"===l.text&&(u=10),l.setX(c+u),l.setAlpha(0),c+=l.width+1}this.add(this.listText)}},n.createAnim=function(){this.tweenText=this.scene.tweens.add({targets:this.listText,paused:!0,duration:150,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Back.easeOut",delay:this.scene.tweens.stagger(100,{})})},n.runAnim=function(){this.resetListText(),this.tweenText.play()},n.resetListText=function(){for(var e=0;e<this.listText.length;e++)this.listText[e].setScale(0).setAlpha(0)},n.restart=function(){this.resetListText()},n.start=function(e){var t=this;void 0===e&&(e=0),e?this.scene.time.addEvent({delay:e,callback:function(){t.runAnim()}}):this.runAnim()},t}(Phaser.GameObjects.Container),sy=n(63482),ry=n.n(sy),oy=function(e,t,n){return void 0===t&&(t=.1),void 0===n&&(n=.04),t*e+ry()(e)*n*e*e},cy=function(e){function t(n){var i;return(i=e.call(this,n)||this).windX=1,i.airFrictionX=.05,i.airFrictionY=.01,i._lastRotaion=0,i.rotationRate=Math.random()+t.bonusRotationRate<.5?-1:1,i.scaleXNumber=i.getRandomFloat(.1,.2),i.scaleYNumber=i.scaleXNumber,i.scaleRate=-1,i.maxScale=i.getRandomFloat(.5,1),i.deltaAlpha=0,i.airFrictionX=.01*Math.random()+(t.bonusAirFrictionX||.007),i.airFrictionY=.004*Math.random()+(t.bonusAirFrictionY||.006),i.maxScale=Math.max(i.scaleXNumber,i.maxScale),i.alpha=0,(0,as.Z)(i)||(0,as.Z)(i)}(0,o.Z)(t,e);var n=t.prototype;return n.getRandomNumberBetween=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},n.getRandomFloat=function(e,t){return Math.random()*(t-e)+e},n.setValueAirFrictionX=function(e){t.bonusAirFrictionX=e,this.airFrictionX=.01*Math.random()+(t.bonusAirFrictionX||.007)},n.setValueAirFrictionY=function(e){t.bonusAirFrictionY=e},n.setValueRotationRate=function(e){t.bonusRotationRate=e},n.reset=function(){this.scaleXNumber=this.getRandomFloat(.3,.8),this.scaleYNumber=this.scaleXNumber,this.scaleRate=-1,this.alpha=0,this.deltaAlpha=0},n.update=function(t,n,i){for(var a=e.prototype.update.call(this,t,n,i),s=.5,r=t;r>16.67;)this.velocityX-=oy(this.velocityX,s,this.airFrictionX)/60,this.velocityY-=oy(this.velocityY,s,this.airFrictionY)/60,r-=16.67;if(this.velocityX-=oy(this.velocityX,s,this.airFrictionX)*r/1e3,this.velocityY-=oy(this.velocityY,s,this.airFrictionY)*r/1e3,this._lastRotaion=this.rotation,this.lifeCurrent>3*this.life/4)this.scaleX=this.maxScale,this.scaleY=this.maxScale,this.deltaAlpha+=t/(this.life/4),this.alpha=this.deltaAlpha;else if(this.lifeCurrent>0){var o=this.scaleRate>0?this.maxScale:1;this.scaleXNumber+=o*this.scaleRate*(t/(3*this.life/4)*3),this.scaleYNumber+=o*this.scaleRate*(t/(3*this.life/4)*3),this.scaleX=this.scaleXNumber,this.scaleY=this.scaleYNumber,this.alpha=this.deltaAlpha,this.scaleX<=0&&(this.scaleRate=1),this.scaleX>=this.maxScale&&(this.scaleRate=-1)}else this.reset();return a},t}(Phaser.GameObjects.Particles.Particle);cy.bonusAirFrictionX=0,cy.bonusAirFrictionY=0,cy.bonusRotationRate=0,cy.scaleXNumber=void 0,cy.scaleYNumber=void 0,cy.bonusAirFrictionX=0,cy.bonusAirFrictionY=0,cy.bonusRotationRate=0,cy.scaleXNumber=Math.random(),cy.scaleYNumber=Math.random();var hy=cy,ly=us.Z.EFFECTS,uy=ly.KEY,py=ly.FRAME,dy=function(e){function t(t){var n;return(n=e.call(this,t,uy)||this).position1={x:-70,y:-180},n.emitterStar1=void 0,n.circleImage1=void 0,n.tweenShowCircle1=void 0,n.tweenHideCircle1=void 0,n.position2={x:-20,y:190},n.emitterStar2=void 0,n.circleImage2=void 0,n.tweenShowCircle2=void 0,n.tweenHideCircle2=void 0,n.position3={x:90,y:0},n.emitterStar3=void 0,n.circleImage3=void 0,n.tweenShowCircle3=void 0,n.tweenHideCircle3=void 0,n.setDepth(ms.Z.ON_TOP+1),n.createEmitterStars(),n.createTweenCircle(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createEmitterStars=function(){var e=[py.GLARE_CROSS,py.DUST],t=[16777215,3304186];this.emitterStar1=this.createEmitter({name:"Emitter1",frame:e,tint:t,x:this.position1.x,y:this.position1.y,speed:{min:50,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:hy,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}}),this.emitterStar2=this.createEmitter({name:"Emitter1",frame:e,tint:t,x:this.position2.x,y:this.position2.y,speed:{min:100,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:hy,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}}),this.emitterStar3=this.createEmitter({name:"Emitter1",frame:e,tint:t,x:this.position3.x,y:this.position3.y,speed:{min:100,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:hy,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}})},n.createTweenCircle=function(){var e=this;this.circleImage1=this.scene.make.image({x:this.position1.x,y:this.position1.y,key:uy,frame:py.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle1=this.scene.add.tween({paused:!0,targets:this.circleImage1,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){e.tweenHideCircle1.play()}}),this.tweenHideCircle1=this.scene.add.tween({paused:!0,targets:this.circleImage1,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){e.circleImage1.setVisible(!1),e.emitterStar1.stop()}}),this.circleImage2=this.scene.make.image({x:this.position2.x,y:this.position2.y,key:uy,frame:py.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle2=this.scene.add.tween({paused:!0,targets:this.circleImage2,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){e.tweenHideCircle2.play()}}),this.tweenHideCircle2=this.scene.add.tween({paused:!0,targets:this.circleImage2,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){e.circleImage2.setVisible(!1),e.emitterStar2.stop()}}),this.circleImage3=this.scene.make.image({x:this.position3.x,y:this.position3.y,key:uy,frame:py.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle3=this.scene.add.tween({paused:!0,targets:this.circleImage3,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){e.tweenHideCircle3.play()}}),this.tweenHideCircle3=this.scene.add.tween({paused:!0,targets:this.circleImage3,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){e.circleImage3.setVisible(!1),e.emitterStar3.stop()}})},n.getImages=function(){return[this.circleImage1,this.circleImage2,this.circleImage3]},n.playConfettiAnimation=function(){var e=this;this.scene.time.addEvent({delay:300,callback:function(){e.emitterStar1.flow(1e4,30),e.circleImage1.setVisible(!0),e.tweenShowCircle1.play()},callbackScope:this}),this.scene.time.addEvent({delay:800,callback:function(){e.emitterStar2.flow(1e4,25),e.circleImage2.setVisible(!0),e.tweenShowCircle2.play()},callbackScope:this}),this.scene.time.addEvent({delay:1300,callback:function(){e.emitterStar3.flow(1e4,30),e.circleImage3.setVisible(!0),e.tweenShowCircle3.play()},callbackScope:this})},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),fy=dy,my=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.textScoreReached=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.starSuperTwinkle=void 0,s.open=function(t){e.prototype.open.call((0,as.Z)(s),t),s.scene.enableInput(),s.runPopupEntrancesAnimation(300,300),s.textScoreReached.restart(),s.scene.audio.playSound(ds.Z.SCORE_REACHED)},s.close=function(){e.prototype.close.call((0,as.Z)(s))},s.scene=t,s.setDepth(ps.Ks.POPUP),s.background.setAlpha(0),s.createContent(),s}(0,o.Z)(t,e);var n=t.prototype;return n.runPopupEntrancesAnimation=function(e,t){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:e,duration:t,onUpdate:function(e){var t=e.getValue();n.background.setAlpha(t)},onComplete:function(){n.textScoreReached.start(),n.starSuperTwinkle.playConfettiAnimation(),n.handleDelegate(),n.runAnim()}})),this.tweenBackground.play()},n.handleDelegate=function(){var e,t=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(e=this.closeTimerEvent)||e.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){t.visible&&t.scene.screen.close(t.name),s&&s()}}))},n.runAnim=function(){},n.createContent=function(){this.createText(),this.createAnim()},n.createText=function(){this.textScoreReached=new ay(this.scene,{text:"SCORE REACHED!",font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(64)}),this.add(this.textScoreReached),Phaser.Display.Align.In.Center(this.textScoreReached,this)},n.createAnim=function(){this.starSuperTwinkle=new fy(this.scene),this.add(this.starSuperTwinkle),this.add(this.starSuperTwinkle.getImages())},t}(GameCore.Screen),gy=us.Z.DEFAULT,vy=gy.KEY,yy=gy.FRAME,Sy=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).onClick=void 0,i.options=void 0,i.text=void 0,i.panel=void 0,i.icon=void 0,i.animOn=void 0,i.animOff=void 0,i.setSize(n.width,n.height),i.options=n,i.createPanel(),i.createIcon(),i.createAnimation(),i.updateStatus(i.options.enable),i.createInput(),i}(0,o.Z)(t,e);var n=t.prototype;return n.createInput=function(){var e=this;this.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){e.options.enable?e.animOff.play():e.animOn.play(),e.onClick&&e.onClick(!e.options.enable)}))},n.createPanel=function(){this.panel=this.scene.make.image({key:vy,frame:yy.BUTTON_TOGGLE_ON}),this.panel.setWorldSize(this.width,this.height),this.add(this.panel),Phaser.Display.Align.In.Center(this.panel,this)},n.createIcon=function(){this.icon=this.scene.make.image({key:vy,frame:yy.BUTTON_CIRCLE}),this.icon.setWorldSize(43,43),this.add(this.icon),Phaser.Display.Align.In.LeftCenter(this.icon,this,0,2.5)},n.createText=function(){this.text=this.scene.make.image({key:vy}),this.text.setWorldSize(30,17),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.panel)},n.createAnimation=function(){var e=this;this.animOn=this.scene.add.tween({targets:this.icon,duration:200,paused:!0,x:{from:-this.panel.width/2+this.icon.width/2,to:this.panel.width/2-this.icon.width/2+5.5},onComplete:function(){e.panel.setFrame(yy.BUTTON_TOGGLE_ON),e.panel.setWorldSize(e.width,e.height),e.options.enable=!0}}),this.animOff=this.scene.add.tween({targets:this.icon,duration:200,paused:!0,x:{from:this.panel.width/2-this.icon.width/2,to:-this.panel.width/2+this.icon.width/2-5.5},onComplete:function(){e.panel.setFrame(yy.BUTTON_TOGGLE_OFF),e.panel.setWorldSize(e.width,e.height),e.options.enable=!1}})},n.updateStatus=function(e){this.options.enable=e,e?this.animOn.play():this.animOff.play()},t}(Phaser.GameObjects.Container),Ey=Sy,Ay=us.Z.DEFAULT,by=Ay.KEY,Ty=Ay.FRAME,Cy=function(e){function t(t){var n;return(n=e.call(this,t,by,Ty.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Daily"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:by,frame:Ty.ICON_CALENDER_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),Py=Cy,wy=us.Z.DEFAULT,Iy=wy.KEY,ky=wy.FRAME,xy=function(e){function t(t){var n;return(n=e.call(this,t,Iy,ky.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Home"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Iy,frame:ky.ICON_HOME_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),_y=xy,Oy=us.Z.DEFAULT,Dy=Oy.KEY,Ry=Oy.FRAME,My=function(e){function t(t){var n;return(n=e.call(this,t,Dy,Ry.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Journey"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Dy,frame:Ry.ICON_DISCOVER_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(fs.Z),Ly=My,By=us.Z.DEFAULT,Ny=By.KEY,Fy=By.FRAME,Gy=function(e){function t(t){var n;return(n=e.call(this,t,Ny,Fy.BUTTON_LONG_BLUE)||this).button.setWorldSize(311,50),n.setName("Replay"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:Ny,frame:Fy.ICON_REPLAY});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,-26,1)},n.createText=function(){var e=this.scene.make.image({key:Ny,frame:Fy.TEXT_REPLAY});e.setWorldSize(54,16),this.add(e),Phaser.Display.Align.In.Center(e,this,26,1)},t}(fs.Z),Zy=Gy,Uy=us.Z.DEFAULT,Hy=Uy.KEY,Vy=Uy.FRAME,Wy=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.buttonReplay=void 0,s.buttonHome=void 0,s.buttonJourney=void 0,s.buttonDaily=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.handleSoundSetting=function(e){s.scene.player.setSetting("sound",e)},s.handleVibrateSetting=function(e){e&&kd(199),s.scene.player.setSetting("vibrate",e)},s.clickReplay=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.scene.screen.close(s.name),e.next=3,s.scene.storage.dispatch(Zl());case 3:th.emit(Lo.REPLAY);case 4:case"end":return e.stop()}}),e)}))))},s.clickButtonHome=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.scene.scene.switch(Ua.Co.DASHBOARD_SCENE);case 1:case"end":return e.stop()}}),e)}))))},s.clickButtonDaily=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.scene.scene.switch(Ua.Co.DAILY_SCENE);case 1:case"end":return e.stop()}}),e)}))))},s.createPopup(),s.createTitle(),s.createSwitchButtons(),s.createButtons(),s.addItem(),s.createInput(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.player.getPlayerSettings(),n=t.sound,i=t.vibrate;this.settingSound.updateStatus(n),this.settingVibrate.updateStatus(i),this.updateVibrateButton(),this.runOpenAnimation()},n.updateVibrateButton=function(){Pd()?this.settingVibrateContainer.revive():(this.settingVibrateContainer.kill(),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,-80))},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate.onClick=this.handleVibrateSetting},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,340),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:Hy,frame:Vy.TEXT_SETTING});e.setWorldSize(73,18),this.buttonClose=new fs.Z(this.scene,Hy,Vy.ICON_CLOSE,20,20),this.buttonClose.setName("Close"),this.title.add([e,this.buttonClose]),Phaser.Display.Align.In.Center(e,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,145,this.buttonClose.height/2),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createButtons=function(){this.createReplayButton(),this.createHomeButton(),this.createDailyButton(),this.createJourneyButton()},n.createReplayButton=function(){this.buttonReplay=new Zy(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,0,10)},n.createHomeButton=function(){this.buttonHome=new _y(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome,Phaser.Display.Align.In.Center(this.buttonHome,this.buttonReplay,-90,96)},n.createJourneyButton=function(){this.buttonJourney=new Ly(this.scene),this.popup.add(this.buttonJourney),this.buttonJourney.onClick=this.clickButtonJourney.bind(this),Phaser.Display.Align.In.Center(this.buttonJourney,this.buttonReplay,0,96)},n.clickButtonJourney=function(){var e=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.scene.scene.switch(Ua.Co.LEVEL_SCENE);case 1:case"end":return t.stop()}}),t)}))))},n.createDailyButton=function(){this.buttonDaily=new Py(this.scene),this.buttonDaily.onClick=this.clickButtonDaily,this.popup.add(this.buttonDaily),Phaser.Display.Align.In.Center(this.buttonDaily,this.buttonReplay,90,96)},n.createSwitchButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=e.vibrate;this.createSoundButton(t),this.createVibrateButton(n)},n.createVibrateButton=function(e){this.settingVibrateContainer=this.scene.make.container({});var t=this.scene.make.image({key:Hy,frame:Vy.ICON_VIBRATE});t.setWorldSize(32,32);var n=this.scene.make.image({key:Hy,frame:Vy.TEXT_VIBRATE});n.setWorldSize(50,11),this.settingVibrate=new Ey(this.scene,{enable:e,width:51,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([t,n,this.settingVibrate]),Phaser.Display.Align.In.Center(t,this.settingVibrateContainer,-135),Phaser.Display.Align.In.Center(n,t,50),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,127),this.popup.add(this.settingVibrateContainer),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this,0,-52)},n.createSoundButton=function(e){this.settingSoundContainer=this.scene.make.container({});var t=this.scene.make.image({key:Hy,frame:Vy.ICON_SOUND});t.setWorldSize(32,32);var n=this.scene.make.image({key:Hy,frame:Vy.TEXT_SOUND});n.setWorldSize(44,11),this.settingSound=new Ey(this.scene,{enable:e,width:51,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([t,n,this.settingSound]),Phaser.Display.Align.In.Center(t,this.settingSoundContainer,-135),Phaser.Display.Align.In.Center(n,t,50),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,127),this.popup.add(this.settingSoundContainer),Phaser.Display.Align.In.Center(this.settingSoundContainer,this,0,-102)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300),this.runPopupContentEntrancesAnimation(600,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),Yy=Wy,zy=us.Z.DEFAULT,Ky=zy.KEY,jy=zy.FRAME,Xy=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.playButton=void 0,s.textScore=void 0,s.titleFrame=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.closeTimer=void 0,s.handleClose=function(){var e;null==(e=s.closeTimer)||e.remove(),s.runCloseAnimation()},s.scene=t,s.createPopup(),s.createTitle(),s.createTextScore(),s.addItem(),s.createButtonPlay(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(t){var n=this;e.prototype.open.call(this,t);var i=this.scene.levelManager.getCurrentTargetScore();this.scene.levelManager.getCurrentIndex();this.textScore.setText(""+i);var a=this.getData(["duration"])[0];this.runOpenAnimation(),this.closeTimer=this.scene.time.delayedCall(a,(function(){n.handleClose()}))},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(160),text:"0",origin:{x:.5,y:.5}}),this.textScore.setTint(3552586),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.popup,0,0)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,280,{framePopupTop:jy.POPUP_TOP_1,framePopupMid:jy.POPUP_MID_1,framePopupBottom:jy.POPUP_BOTTOM_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.title.setSize(343,47),this.titleFrame=this.scene.make.image({key:Ky,frame:jy.TEXT_MISSION}),this.titleFrame.setWorldSize(71,15),this.title.add([this.titleFrame]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,0),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.createButtonPlay=function(){this.playButton=new fs.Z(this.scene,Ky,jy.BUTTON_LONG_BLUE,311,50),this.popup.add(this.playButton);var e=this.scene.make.image({key:Ky,frame:jy.TEXT_PLAY});this.playButton.add(e),this.playButton.onClick=this.handleClose,e.setWorldSize(33,16),Phaser.Display.Align.In.BottomCenter(this.playButton,this.popup,0,-20)},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300),this.runPopupContentEntrancesAnimation(600,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterTargetScoreScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),qy=Xy,Jy=GameCore.Configs,Qy=Jy.Match,$y=Jy.Network,eS=Jy.Tutorial,tS=Jy.Board,nS=Jy.Ads,iS=us.Z.GAMEPLAY_32.FRAME,aS=function(e){function t(){for(var t,n,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=e.call.apply(e,y()(t=[this]).call(t,s))||this).lastTimeInputEnabled=0,n.usedRescue=!1,n.levelManager=void 0,n.bestScoreGlareEffect=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.tutorialManager=void 0,n.effectManager=void 0,n.bestScore=0,n.isBestScoreScreenShowed=void 0,n.isGameOver=void 0,n.isShowedNextTargetScreen=void 0,n.piecesByFen=void 0,n.isGameError=void 0,n.gamePlayMode=void 0,n.isNextTarget=!1,n.run=function(){var e=n.storage.getState();if(null===dc(e)&&n.storage.dispatch(Bl(!1)),n.checkAndAddShortcut(),n.ads.showBannerAdAsync().catch(i.tO),n.tutorialManager.isValidForTutorial()||eS.ForceUseTutorial)return n.handleStartTutorial(),void n.player.incUserGuideDisplays();var t=n.player.getPlayerId(),a=Zc(e).playerId,s=Hc(e,{playerId:t}),r=Vc(e,{opponentId:a});s&&r?n.screen.open(ps.o4.GAME_OVER_SCREEN):n.startGame()},n.create=function(){e.prototype.create.call((0,as.Z)(n)),n.createBackground(Ia.Z.BACKGROUND.KEY);var t=n.player.getBestScore();n.bestScore=t,n.createLevelManager(),n.createMain(),n.createHeader(),n.createFooter(),n.createTutorialManager(),n.createEffectManager(),n.createScreens(),n.createBestScoreGlareEffect(),n.createInput(),n.listenEvents(),n.input.setTopOnly(!0),n.preLoadAds()},n.closeSettingScreen=function(){(0,as.Z)(n).screen.close(ps.o4.SETTINGS_SCREEN)},n.closeGameOverScreen=function(){(0,as.Z)(n).screen.close(ps.o4.GAME_OVER_SCREEN)},n.handlePauseGame=function(){n.isGameOver||n.checkReachTargetScore()||(0,as.Z)(n).screen.open(ps.o4.SETTINGS_SCREEN)},n.handleShowMidRollAd=function(){var e=(0,r.Z)(h().mark((function e(t){var a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!0),a=n.game.globalScene,e.prev=2,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){e.next=6;break}return e.abrupt("return");case 6:return a.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading ads...",duration:$y.Timeout,loading:!0}),e.next=9,n.ads.showMidRollAdAsync();case 9:n.analytics.showInterstitialAd(n.getSceneName()),e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return");case 15:return e.prev=15,t&&n.postSessionScore(),a.screen.close(ps.o4.NOTIFY_SCREEN),n.audio.playMusic(),n.ads.preloadMidRollAdAsync().catch(i.tO),e.finish(15);case 21:case"end":return e.stop()}}),e,null,[[2,12,15,21]])})));return function(t){return e.apply(this,arguments)}}(),n.rescued=function(){try{var e=n.getLevelLogInfo(),t=e.level,i=e.score,a=e.levelName;n.analytics.levelRescue(t,i,a),n.main.board.rescue(),n.nextLevel(),n.usedRescue=!0}catch(s){}},n.replay=function(){n.restartGame(),n.startGame()},n.setScoreLeaderBoard=(0,ga.D)((function(e){ic(n.player.getPlayerId(),e)}),2e3),n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.preLoadAds=function(){this.ads.preloadMidRollAdAsync().catch((function(e){})),this.ads.preloadRewardedVideoAsync().catch((function(e){}))},n.createHeader=function(){this.header=new Ed(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createLevelManager=function(){this.levelManager=new ru},n.createBestScoreGlareEffect=function(){this.bestScoreGlareEffect=new eu(this),Phaser.Display.Align.In.Center(this.bestScoreGlareEffect,this.gameZone)},n.createMain=function(){this.main=new jd(this)},n.createFooter=function(){this.footer=new kp(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createTutorialManager=function(){this.tutorialManager=new Mo(this)},n.createEffectManager=function(){this.effectManager=new vp(this)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.createScreens=function(){this.createSettingScreen(),this.createRescueScreen(),this.createGameOverScreen(),this.createScoreReachedScreen(),this.createNextTargetScoreScreen(),this.createBestScoreScreen(),this.createNoSpaceLeftScreen(),this.createTargetScoreScreen(),this.createMiniJourneyScreen()},n.createMiniJourneyScreen=function(){this.screen.add(ps.o4.MINI_JOURNEY_SCREEN,Zv)},n.createTargetScoreScreen=function(){this.screen.add(ps.o4.TARGET_SCORE_SCREEN,qy)},n.createNoSpaceLeftScreen=function(){this.screen.add(ps.o4.NO_SPACE_LEFT_SCREEN,jv)},n.createBestScoreScreen=function(){this.screen.add(ps.o4.BEST_SCORE_SCREEN,tf)},n.createNextTargetScoreScreen=function(){this.screen.add(ps.o4.NEXT_TARGET_SCORE_SCREEN,Wv)},n.createScoreReachedScreen=function(){this.screen.add(ps.o4.SCORE_REACHED_SCREEN,my)},n.createSettingScreen=function(){this.screen.add(ps.o4.SETTINGS_SCREEN,Yy)},n.startGame=function(){var e=this;try{this.isGameOver=!1,this.tutorialManager.skipTutorial(),this.closeSettingScreen(),this.closeGameOverScreen(),this.handleUsedRescue(),this.restartGame(),this.header.setVisible(!0),this.header.progressBar.reset(),this.handleGameModeUI(),this.updateCurrentBestScore(),this.updateLevelManager(),this.updateProgressBar(),this.header.buttonSetting.setDisabled(!0),this.time.delayedCall(300,(function(){e.header.buttonSetting.setDisabled(!1)})),this.openTargetScoreScreen(),this.handleGameModeChange()}catch(t){this.isGameError||(this.isGameError=!0,this.replay()),(0,i.R0)(new Error("Start game scene"),{error:t,scene:"GameScene"})}},n.handleGameModeChange=function(){var e=this,t=[{selector:hc,callback:function(t){t!==e.gamePlayMode&&e.handleGameModeUI()}}];this.handleStateChange(t)},n.handleGameModeUI=function(){var e,t=this.storage.getState();this.gamePlayMode=hc(t),this.gamePlayMode&&this.gamePlayMode!==xa&&xt()(e=[Oa,_a,Da]).call(e,this.gamePlayMode)>=0?this.handleStartGameFriendMode():this.handleStartGameSingleMode()},n.startGameAfterTargetScoreScreenClose=function(){var e,t=this.storage.getState(),n=hc(t),i=this.getLevelLogInfo(),a=i.level,s=i.score,r=i.levelName;this.analytics.levelStart(a,s,r),this.levelManager.getCurrentIndex()>=0&&this.main.board.handleTweenStartMission(),xt()(e=[Oa,_a,Da]).call(e,n)>=0?this.footer.pieces.showNewPieces():this.piecesByFen?this.footer.pieces.showAvailablePieces(this.piecesByFen):this.footer.pieces.showNewPieces()},n.openTargetScoreScreen=function(){var e=this;this.disableInput(),this.time.delayedCall(500,(function(){e.enableInput(),e.screen.open(ps.o4.TARGET_SCORE_SCREEN,{duration:2e3})}))},n.handleUsedRescue=function(){this.usedRescue&&this.storage.dispatch(Jl())},n.handleStartTutorial=function(){this.analytics.event(Ht._.TUTORIAL_BEGIN),this.tutorialManager.start(),this.header.setVisible(!1)},n.handleStartGameSingleMode=function(){try{var e,t,n=this.storage.getState(),i=(null==(e=Mc(n))?void 0:e.data)||{},a=(null==(t=Mc(n))?void 0:t.score)||0;if(!i)return;var s=i.fen,r=null;if(this.piecesByFen=null,s){var o=this.main.board.getBoardByFen(s);r=this.handleDynamicFenSize(o),this.piecesByFen=this.footer.pieces.getPiecesByFen(s),this.isFenGameOver(r,this.piecesByFen)&&(r=null,this.piecesByFen=null,this.storage.dispatch(Il()),n=this.storage.getState(),a=0,this.resetRescued())}this.main.board.clearBoard(),r&&this.main.board.startGame(r),this.footer.pieces.clearPieces(),this.header.showItemSingleMode(),this.header.mainScoreBlock.setScore(a),this.header.mainScoreBlock.setScoreText(a),this.main.praise.reset()}catch(c){}},n.handleStartGameFriendMode=function(){this.header.showItemPlayWithFriendsMode(),this.header.myScoreBlock.updateInfo(),this.header.opponentScoreBlock.updateInfo(),this.main.praise.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces()},n.listenEvents=function(){var e=this;th.on(Lo.START_GAME,(function(){e.startGame()})),th.on(Lo.RESCUE,this.rescued),th.on(Lo.REPLAY,this.replay),th.on(Lo.GAME_OVER,this.handleGameOver.bind(this)),th.on("handle_state_change",this.handleStateChange.bind(this))},n.postSessionScore=function(){var e=this.storage.getState(),t=Jc(e).score,n=void 0===t?0:t;this.storage.dispatch(Ic(n))},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.createRescueScreen=function(){this.screen.add(ps.o4.RESCUE_SCREEN,iy)},n.createGameOverScreen=function(){this.screen.add(ps.o4.GAME_OVER_SCREEN,Xf)},n.updateCurrentBestScore=function(){var e=this.player.getBestScore()||0,t=this.storage.getState(),n=Jc(t),i=n.score,a=void 0===i?0:i,s=n.bestScore,r=void 0===s?0:s,o=e>r?e:r;o=o>a?o:a,this.player.setBestScore(o),this.header.bestScoreBlock.setVisible(!1),this.header.bestScoreBlock.setScoreText(o)},n.updateLevelManager=function(){var e=this.getCurrentScoreByMode();this.levelManager.updateCurrentLevelByScore(e)},n.updateProgressBar=function(){var e=this.getCurrentScoreByMode(),t=this.levelManager.updateCurrentLevelByScore(e);this.header.progressBar.setTargetScore(t),this.header.progressBar.setPercent(e/t)},n.setIsGameOver=function(e){this.isGameOver=e},n.handleGameOver=function(){this.isGameOver=!0;var e=this.getLevelLogInfo(),t=e.level,n=e.score,i=e.levelName;this.analytics.levelFail(t,n,i),this.screen.open(ps.o4.GAME_OVER_SCREEN)},n.handleRequestFinishGame=function(){var e=this;this.isGameOver=!0;var t=this.storage.getState(),n=lc(t);n<Qy.MaxRescueCount&&this.ads.preloadRewardedVideoAsync().catch((function(e){})),this.screen.open(ps.o4.NO_SPACE_LEFT_SCREEN,{duration:3e3,onClose:function(){if(e.enableInput(),n<Qy.MaxRescueCount&&nS.Enabled)return e.screen.open(ps.o4.RESCUE_SCREEN),void(e.isGameOver=!1);e.usedRescue=!1,e.endGame()}})},n.checkAnimPlaying=function(){var e=this.tweens.getAllTweens();return!(!e||0===e.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(e){return e.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.restartGame=function(){var e;null==(e=this.header.mainScoreBlock.addScore)||e.stop().remove(),this.header.mainScoreBlock.setScore(0),this.header.mainScoreBlock.setScoreText(0),this.header.myScoreBlock.setScore(0),this.header.myScoreBlock.setScoreText(0),this.header.progressBar.hideProgressBar(),this.header.progressBar.setPercent(0),this.levelManager.restart(),this.main.praise.listScore=[]},n.endGame=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleShowMidRollAd(!1).catch(i.tO);case 2:this.storage.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,o,c,l,u,p,d,f,m,g,v,y,S,E,A,b,T,C,P,w,I,k,x;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=window.game,s=a.analytics,o=a.facebook,a.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),c=n(),l=hc(c),u=Jc(c),p=u.score,d=void 0===p?0:p,f=u.level,m=void 0===f?0:f,t(Ic(d)),t(zl(d)),e.next=10,t(Xl(l,{score:d}));case 10:if(c=n(),g=uc(c),v=pc(c),y=Math.floor((v-g)/1e3),s.event(Ht._.MATCH_END,{game_mode:GameCore.Utils.String.toUpperCamelCase(l),level:m,level_name:"level_"+m,time_played:y}),S=o.getContextID(),l===Oa&&S&&t(function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o,c,l,u,p,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=window.game.analytics,e.prev=1,s=FBInstant.context.getID(),Ph({contextId:s}),r=n(),o=Wc(r),c=o.playerId,l=o.score,u=Jc(r),p=u.score,!c||c===ka.playerId){e.next=25;break}if(!(p>l)){e.next=18;break}return e.next=13,Sh(r);case 13:return d=e.sent,e.next=16,Bh(d,r);case 16:e.next=23;break;case 18:return e.next=20,mh(r);case 20:return d=e.sent,e.next=23,Nh(d,r);case 23:e.next=30;break;case 25:return e.next=27,mh(r);case 27:return d=e.sent,e.next=30,Nh(d,r);case 30:Ih({imageShare:d}),a.event(Ht._.MESSAGE,{message_content_type:"InviteGroup",success:!0}),e.next=38;break;case 34:e.prev=34,e.t0=e.catch(1),a.event(Ht._.MESSAGE,{message_content_type:"InviteGroup",success:!0}),(0,i.tO)(e.t0);case 38:case"end":return e.stop()}}),e,null,[[1,34]])})));return function(t,n){return e.apply(this,arguments)}}()),!S||l!==_a){e.next=26;break}if(E=Zc(c),(A=E.playerId)&&A!==ka.playerId){e.next=21;break}return e.abrupt("return");case 21:b=qc(c),T=b[A]||{},C=T.score,P=void 0===C?0:C,w=Nc(c),I=w._id,k=w.whitePlayerFinish,x=w.blackPlayerFinish,t(k&&x?d>P?Mh(A,{matchId:I,contextId:S}):Rh(A,{matchId:I,contextId:S}):Lh(A,{matchId:I,contextId:S,score:d}));case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),(0,i.tO)(e.t0);case 31:return e.prev=31,Ml(300),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[0,28,31,34]])})));return function(t,n){return e.apply(this,arguments)}}()),this.resetRescued();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleUpdateScore=function(e){if(!this.tutorialManager.isRunning()){var t=this.getCurrentScoreByMode()+e;this.storage.dispatch(xl({score:t})),this.updateMatchData()}},n.handleAddScoreAnim=function(e){var t,n=this.storage.getState(),i=hc(n);this.tutorialManager.isRunning()?this.header.mainScoreBlock.animAddScore(e):i&&i!==xa&&xt()(t=[Oa,_a,Da]).call(t,i)>=0?this.header.myScoreBlock.animAddScore(e):this.header.mainScoreBlock.animAddScore(e)},n.getBestScore=function(){var e=this.storage.getState();return Jc(e).bestScore},n.bestScoreReached=function(){if(!this.isBestScoreScreenShowed&&!this.isGameOver){var e=this.getBestScore(),t=this.getCurrentScoreByMode();e||(this.player.setBestScore(t),this.isBestScoreScreenShowed=!0),!e||e>=t||(this.player.setBestScore(t),this.setScoreLeaderBoard(t),this.isBestScoreScreenShowed=!0,this.audio.playSound(ds.Z.CONGRATULATION),this.bestScoreGlareEffect.playEffect())}},n.updateProgressTargetScore=function(e){var t=e/this.header.progressBar.getTargetScore();this.header.progressBar.setPercent(t)},n.checkReachTargetScore=function(){return this.getCurrentScoreByMode()>=this.header.progressBar.getTargetScore()},n.handleNextTargetScore=function(){var e=this;if(!this.isGameOver&&(this.checkReachTargetScore()&&!this.isShowedNextTargetScreen)){this.isShowedNextTargetScreen=!0,this.disableInput();var t=this.getLevelLogInfo(),n=t.level,a=t.score,s=t.levelName;this.analytics.levelComplete(n,a,s),this.screen.open(ps.o4.SCORE_REACHED_SCREEN,{duration:4e3,onClose:function(){var t=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isShowedNextTargetScreen=!1,t.next=3,e.handleShowMidRollAd(!1).catch(i.tO);case 3:e.showNextTargetScreen();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})}},n.getCurrentScoreByMode=function(){var e,t=this.storage.getState(),n=hc(t);return n&&n!==xa&&xt()(e=[Oa,_a,Da]).call(e,n)>=0?this.header.myScoreBlock.score:this.header.mainScoreBlock.score},n.showNextTargetScreen=function(){var e=this.getCurrentScoreByMode();this.levelManager.updateCurrentLevelByScore(e);this.screen.open(ps.o4.NEXT_TARGET_SCORE_SCREEN,{duration:2e3})},n.updateMatchData=function(){if(!this.tutorialManager.isRunning()){var e=this.getFen(),t=this.storage.getState(),n=Mc(t).data||{},i=hc(t),a=lc(t);if(!i||i===xa){var r=Lc(t),o=Jc(t).score,c=void 0===o?0:o;this.storage.dispatch(hl(r,{score:c,rescued:a,data:(0,s.Z)({},n,{fen:e}),updateAt:Date.now()}))}}},n.clearMatchData=function(){if(!this.tutorialManager.isRunning()){var e=this.storage.getState(),t=hc(e),n=lc(e);if(!t||t===xa){var i=Lc(e),a=Jc(e).score,s=void 0===a?0:a;this.storage.dispatch(hl(i,{score:s,rescued:n,data:null,updateAt:Date.now()}))}}},n.nextLevel=function(){var e=this.getCurrentScoreByMode(),t=this.levelManager.updateCurrentLevelByScore(e);this.isNextTarget=!0,this.header.progressBar.hideProgressBar(),this.header.progressBar.setTargetScore(t),this.header.progressBar.setPercent(e/t);var n=this.getLevelLogInfo(),i=n.level,a=n.levelName;this.analytics.levelStart(i,e,a)},n.update=function(e){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=e:e-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=e)},n.isFenGameOver=function(e,t){for(var n=[],i=0;i<t.length;i++){var a=t[i],s=a.type,r=a.direction,o=a.isReverse;switch(s){case tr:case nr:case ir:n.push({data:qu.getData(s,r,o)});break;case ar:case sr:case rr:case or:n.push({data:Qu.getData(s,r)});break;case cr:case hr:case lr:n.push({data:ep.getData(s)});break;case pr:n.push({data:np.getData(r)});break;case dr:n.push({data:lp.getData(r)});break;case Sr:n.push({data:pp.getData(r)});break;case mr:case gr:case vr:case yr:n.push({data:ap.getData(s,r)});break;case ur:n.push({data:rp.getData(r)});break;case fr:n.push({data:cp.getData()})}}return Du(e,n)},n.handleDynamicFenSize=function(e){var t,n,i=0;if((n=e.length)&&(i=e[0].length),0===n||0===i)return e;var a=y()(t=[]).call(t,e);if(n>tS.rows)rs()(a).call(a,tS.rows,n-tS.rows);else if(i<tS.rows)for(var s=0;s<tS.rows-n;s++){var r;a.push(cs()(r=new Array(n)).call(r,{value:0,frame:iS.GEM_TRANSPARENT}))}return i>tS.cols?a.forEach((function(e){rs()(e).call(e,tS.cols,i-tS.cols)})):i<tS.cols&&a.forEach((function(e){for(var t=0;t<tS.cols-i;t++)e.push({value:0,frame:iS.GEM_TRANSPARENT})})),a},n.checkAndAddShortcut=function(){if(!this.game.player.getPlayer().isUserNew){var e=this.storage.getState();La(e)!=Da&&this.facebook.attemptToAddShortcut()}},n.getLevelName=function(){var e,t=this.levelManager.getCurrentIndex()+1;return"target_"+ls()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.getLevelLogInfo=function(){return{level:this.levelManager.getCurrentIndex()+1,score:this.getCurrentScoreByMode(),levelName:this.getLevelName()}},n.resetRescued=function(){this.storage.dispatch((function(e){e({type:On,payload:{}}),(0,Fh.vk)(_l.SingleMatchStore,{rescued:0})}))},t}(Ql.Z);var sS,rS=aS,oS=n(6359),cS=GameCore.Configs.Notification.ApiUrl,hS=function(){var e=(0,r.Z)(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.playerId,e.next=3,yt("players/"+n,t,{},cS,10);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lS=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LoadResourceFail",i.message=t||"Load resource fail",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),uS=[{id:"pass-levels",title:"Pass 10 Levels",require:{level:10},reward:{diamond:100}},{id:"collect-diamonds",title:"Collect 300 diamonds",require:{diamond:300},reward:{diamond:100}},{id:"invite-friends",title:"Invite 2 friends",require:{friend:2},reward:{diamond:200}},{id:"reach-score",title:"Reach Total Scores",require:{score:1e5},reward:{diamond:200}}],pS=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",uS);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),dS=(0,K.P1)([function(e){var t;return null==(t=e[Ri])?void 0:t.tasks}],(function(e){return e})),fS=(0,K.P1)([function(e){var t;return null==(t=e[Ri])?void 0:t.process}],(function(e){return e})),mS=(0,K.P1)([function(e){var t;return null==(t=e[Ri])?void 0:t.isRequesting}],(function(e){return e})),gS=((0,K.P1)([function(e){var t;return null==(t=e[Ri])?void 0:t.isNotice}],(function(e){return e})),GameCore.Configs.DailyTasks),vS=function(e){return function(t){t({type:Li,payload:{tasks:e}});var n=window.game.player.getCustomData("dailyTasks")||{},i=n.startedTime,a=void 0===i?0:i,s=n.logTasks,r=void 0===s?{}:s;t((Date.now()-a)/1e3>gS.Duration?yS(e):SS(r))}},yS=function(e){return function(t){var n={};e.forEach((function(e){var t=e.id,i=e.require;n[t]={},te()(i).forEach((function(e){var i;n[t]=((i={})[e]=0,i.rewarded=!1,i)}))})),window.game.player.setCustomData("dailyTasks",{logTasks:n,startedTime:Date.now()}),t(SS(n)),th.emit(Oc.EVENTS.TASKS_RESET)}},SS=function(e){return{type:Bi,payload:{process:e}}},ES=n(51679),AS=n.n(ES),bS=function(){var e=(window.game.player.getCustomData("dailyTasks")||{}).logTasks;return GameCore.Utils.Json.clone(e)},TS=function(){function e(e,t){var n=this;this.game=void 0,this.id=void 0,this.taskData=void 0,this.requireTypes=void 0,this.process=function(e){var t,i=e.type,a=e.value;if(!(a<1)&&(-1!==xt()(t=n.requireTypes).call(t,i)&&!n.isPassRequiredTarget(i)&&n.processMore(e))){i=e.type,a=e.value;var s=n.getCorrectValue(i,a);n.game.storage.dispatch(function(e,t,n){return function(i){var a=bS();if(GameCore.Utils.Valid.isObject(a)){var s=a;GameCore.Utils.Object.hasOwn(s,e)&&(s[e].rewarded||(s[e][t]+=n,window.game.player.setCustomData("dailyTasks",{logTasks:s}),i({type:Ni,payload:{id:e,type:t,value:n}})))}}}(n.id,i,s)),n.isTaskFinished(i)&&n.game.storage.dispatch(function(e){return function(t){t({type:Fi,payload:{id:e}}),th.emit(Oc.EVENTS.NOTICE_UPDATE)}}(n.id))}},this.game=e,this.id=t,this.init()}var t=e.prototype;return t.init=function(){var e=this,t=this.game.storage.getState(),n=dS(t)||[];if(!((null==n?void 0:n.length)<1)){var i=null==n?void 0:AS()(n).call(n,(function(t){return t.id===e.id}));i&&(this.taskData=i,this.requireTypes=te()(this.taskData.require),this.initEvents())}},t.getDataByType=function(e){var t=this.game.storage.getState(),n=fS(t),i={value:0,target:0};if(!n)return i;if(!GameCore.Utils.Object.hasOwn(n,this.taskData.id))return i;var a=n[this.taskData.id];if(GameCore.Utils.Valid.isObject(a)&&GameCore.Utils.Object.hasOwn(a,e)){var s=a[e];"number"===typeof s&&(i.value=s)}return i.target=this.taskData.require[e]||0,i},t.getCorrectValue=function(e,t){var n=this.getDataByType(e),i=n.value,a=n.target,s=t;return i+t>a&&(s=a-i),Math.round(s)},t.isPassRequiredTarget=function(e){var t=this.getDataByType(e);return t.value>=t.target},t.isTaskFinished=function(e){var t=this.getDataByType(e);return t.value>=t.target},e}(),CS=TS,PS=Oc.COLLECT_DIAMONDS,wS=PS.ID,IS=PS.EVENTS,kS=function(e){function t(t){return e.call(this,t,wS)||this}(0,o.Z)(t,e);var n=t.prototype;return n.initEvents=function(){th.off(IS.COLLECT_DIAMONDS,this.process),th.on(IS.COLLECT_DIAMONDS,this.process)},n.processMore=function(){return!0},t}(CS),xS=kS,_S=Oc.INVITE_FRIENDS,OS=_S.ID,DS=_S.EVENTS,RS=function(e){function t(t){var n;return(n=e.call(this,t,OS)||this).invitedFriends=void 0,n.resetData=function(){n.invitedFriends=[]},n.resetData(),n}(0,o.Z)(t,e);var n=t.prototype;return n.initEvents=function(){var e=this;th.off(DS.INVITED_FRIEND,this.process),th.on(DS.INVITED_FRIEND,this.process),th.on(Oc.EVENTS.TASKS_RESET,(function(){e.resetData()}))},n.processMore=function(e){var t,n=e.opponentId;return!!n&&(-1===xt()(t=this.invitedFriends).call(t,n)&&(this.invitedFriends.push(n),!0))},t}(CS),MS=RS,LS=Oc.PASS_LEVELS,BS=LS.ID,NS=LS.EVENTS,FS=function(e){function t(t){return e.call(this,t,BS)||this}(0,o.Z)(t,e);var n=t.prototype;return n.initEvents=function(){th.off(NS.PASS_LEVEL,this.process),th.on(NS.PASS_LEVEL,this.process)},n.processMore=function(){return!0},t}(CS),GS=FS,ZS=Oc.REACH_SCORE,US=ZS.ID,HS=ZS.EVENTS,VS=function(e){function t(t){var n;return(n=e.call(this,t,US)||this).totalScore=void 0,n.lastUpdate=void 0,n.totalScore=0,n.lastUpdate=Date.now(),n}(0,o.Z)(t,e);var n=t.prototype;return n.initEvents=function(){th.off(HS.ADD_SCORE,this.process),th.on(HS.ADD_SCORE,this.process)},n.processMore=function(e){var t=e.value,n=Date.now();return n-this.lastUpdate<3e3?(this.totalScore+=t,!1):(e.value+=this.totalScore,this.totalScore=0,this.lastUpdate=n,!0)},t}(CS),WS=VS,YS=function(){function e(e){var t=this;this.game=void 0,this.eventsListener=void 0,this.init=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.eventsListener={},e.next=3,t.initData();case 3:t.initEvents();case 4:case"end":return e.stop()}}),e)}))),this.initData=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.game.storage.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t,n){var i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!mS(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:Mi,payload:{}}),e.next=7,pS();case 7:a=e.sent,t(vS(a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),this.game=e,this.init()}var t=e.prototype;return t.getEventListener=function(e){return this.eventsListener[e]},t.initEvents=function(){this.eventsListener[Oc.PASS_LEVELS.ID]=new GS(this.game),this.eventsListener[Oc.REACH_SCORE.ID]=new WS(this.game),this.eventsListener[Oc.INVITE_FRIENDS.ID]=new MS(this.game),this.eventsListener[Oc.COLLECT_DIAMONDS.ID]=new xS(this.game)},e}(),zS=YS,KS=[{name:"collect-red-gems",id:"collect-gems",require:{red:5},reward:50},{name:"collect-blue-gems",id:"collect-gems",require:{blue:5},reward:50},{name:"collect-pink-gems",id:"collect-gems",require:{pink:5},reward:50},{name:"collect-green-gems",id:"collect-gems",require:{green:5},reward:50},{name:"collect-yellow-gems",id:"collect-gems",require:{yellow:5},reward:50},{name:"collect-red-blue-gems",id:"collect-gems",require:{red:5,blue:5},reward:120},{name:"collect-red-pink-gems",id:"collect-gems",require:{red:5,pink:5},reward:120},{name:"collect-red-green-gems",id:"collect-gems",require:{red:5,green:5},reward:120},{name:"collect-red-yellow-gems",id:"collect-gems",require:{red:5,yellow:5},reward:120},{name:"collect-blue-pink-gems",id:"collect-gems",require:{blue:5,pink:5},reward:120},{name:"collect-blue-green-gems",id:"collect-gems",require:{blue:5,green:5},reward:120},{name:"collect-blue-yellow-gems",id:"collect-gems",require:{blue:5,yellow:5},reward:120},{name:"collect-pink-green-gems",id:"collect-gems",require:{pink:5,green:5},reward:120},{name:"collect-pink-yellow-gems",id:"collect-gems",require:{pink:5,yellow:5},reward:120},{name:"collect-green-yellow-gems",id:"collect-gems",require:{green:5,yellow:5},reward:120},{name:"collect-red-blue-pink-gems",id:"collect-gems",require:{red:5,blue:5,pink:5},reward:210},{name:"collect-red-blue-green-gems",id:"collect-gems",require:{red:5,blue:5,green:5},reward:210},{name:"collect-red-blue-yellow-gems",id:"collect-gems",require:{red:5,blue:5,yellow:5},reward:210},{name:"collect-red-pink-green-gems",id:"collect-gems",require:{red:5,pink:5,green:5},reward:210},{name:"collect-red-pink-yellow-gems",id:"collect-gems",require:{red:5,pink:5,yellow:5},reward:210},{name:"collect-red-green-yellow-gems",id:"collect-gems",require:{red:5,green:5,yellow:5},reward:210},{name:"collect-blue-pink-green-gems",id:"collect-gems",require:{blue:5,pink:5,green:5},reward:210},{name:"collect-blue-pink-yellow-gems",id:"collect-gems",require:{blue:5,pink:5,yellow:5},reward:210},{name:"collect-blue-green-yellow-gems",id:"collect-gems",require:{blue:5,green:5,yellow:5},reward:210},{name:"collect-pink-green-yellow-gems",id:"collect-gems",require:{pink:5,green:5,yellow:5},reward:210}],jS=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",KS);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),XS=(0,K.P1)([function(e){var t;return null==(t=e[wi])?void 0:t.missions}],(function(e){return e})),qS=(0,K.P1)([function(e){var t;return null==(t=e[wi])?void 0:t.isRequesting}],(function(e){return e})),JS=((0,K.P1)([XS,function(e,t){return t.name}],(function(e,t){return e?"string"!==typeof t?null:GameCore.Utils.Object.hasOwn(e,t)?e[t]:null:null})),function(e){return{type:ki,payload:{missions:e}}}),QS={TYPES:{COLLECT_GEMS:"collect-gems",USE_ITEM:"use-item",COMBO:"combo"},EVENTS:{MISSION_START:"mission-start",MISSION_UPDATE:"mission-update",MISSION_FAILED:"mission-failed",MISSION_COMPLETED:"mission-completed"}},$S=(0,K.P1)([function(e){var t;return null==(t=e[wi])?void 0:t.mission}],(function(e){return e})),eE=((0,K.P1)([$S],(function(e){return e?e.name:null})),function(){function e(e,t,n){var i=this;this.game=void 0,this.id=void 0,this.name=void 0,this.reward=void 0,this.process=function(e){var t=e.id,n=e.type,a=e.value;a<1||i.id===t&&i.isTypeRequired(n)&&i.processMore(e)&&(i.game.storage.dispatch(function(e,t,n){return{type:xi,payload:{name:e,type:t,value:n}}}(i.name,n,a)),i.isMissionComplete()&&(th.emit(QS.EVENTS.MISSION_COMPLETED,{name:i.name,reward:i.reward}),i.game.storage.dispatch(function(e){return{type:_i,payload:{name:e}}}(i.name))))},this.id=t,this.name=n,this.game=e}var t=e.prototype;return t.start=function(){var e=this.game.storage.getState(),t=$S(e);t&&t.name===this.name&&(this.reward=t.reward,this.initEvents())},t.getMissionData=function(){var e=this.game.storage.getState(),t=$S(e);return t?t.name!==this.name?null:t:null},t.getDataByType=function(e){var t=this.getMissionData();if(!t)return null;var n=t.require[e];return{value:t.process[e],target:n}},t.isTypeRequired=function(e){var t=this.getDataByType(e);return!!t&&t.target>0},t.isMissionComplete=function(){var e=this.getMissionData();if(!e)return!0;var t=e.require,n=e.process,i=!0;return te()(t).forEach((function(e){if(i){var a=t[e];n[e]<a&&(i=!1)}})),i},e}()),tE=eE,nE=QS.EVENTS,iE=QS.TYPES,aE=function(e){function t(t,n){return e.call(this,t,iE.COLLECT_GEMS,n)||this}(0,o.Z)(t,e);var n=t.prototype;return n.initEvents=function(){th.off(nE.MISSION_UPDATE,this.process),th.on(nE.MISSION_UPDATE,this.process)},n.processMore=function(){return!0},t}(tE),sE=aE,rE=QS.EVENTS,oE=QS.TYPES,cE=function(e){function t(t,n){return e.call(this,t,oE.COMBO,n)||this}(0,o.Z)(t,e);var n=t.prototype;return n.initEvents=function(){th.off(rE.MISSION_UPDATE,this.process),th.on(rE.MISSION_UPDATE,this.process)},n.processMore=function(e){var t=this.getMissionData();if(!t)return!1;var n=e.type;return e.value>=t.require[n]},t}(tE),hE=cE,lE=QS.EVENTS,uE=QS.TYPES,pE=function(e){function t(t,n){return e.call(this,t,uE.USE_ITEM,n)||this}(0,o.Z)(t,e);var n=t.prototype;return n.initEvents=function(){th.off(lE.MISSION_UPDATE,this.process),th.on(lE.MISSION_UPDATE,this.process)},n.processMore=function(e){return!0},t}(tE),dE=pE,fE=function(){function e(e){var t=this;this.game=void 0,this.listener=void 0,this.init=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initData();case 2:t.initListeners(),t.initEvents();case 4:case"end":return e.stop()}}),e)}))),this.initData=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.game.storage.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t,n){var i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!qS(i)){e.next=4;break}return e.abrupt("return");case 4:return t({type:Ii,payload:{}}),e.next=7,jS();case 7:a=e.sent,t(JS(a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),this.startListener=function(e){t.listener[e]&&t.listener[e].start()},this.game=e,this.init()}var t=e.prototype;return t.initListeners=function(){var e=this;this.listener={};var t=this.game.storage.getState(),n=XS(t);n&&te()(n).forEach((function(t){switch(n[t].id){case QS.TYPES.COLLECT_GEMS:e.listener[t]=new sE(e.game,t);break;case QS.TYPES.COMBO:e.listener[t]=new hE(e.game,t);break;case QS.TYPES.USE_ITEM:e.listener[t]=new dE(e.game,t)}}))},t.initEvents=function(){th.off(QS.EVENTS.MISSION_START,this.startListener),th.on(QS.EVENTS.MISSION_START,this.startListener)},e}(),mE=fE,gE=(GameCore.Configs.Match,n(55481)),vE={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},EFFECTS:{KEY:"effects",FILE:"./assets/sounds/effects.mp3",JSON:"./assets/sounds/effects.json"}},yE=GameCore.Configs,SE=yE.AppId,EE=yE.Notification,AE=function(e){function t(){for(var t,n,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=e.call.apply(e,y()(t=[this]).call(t,s))||this).handleFBInstantGameStarted=function(){window.__fbGameReady=!0,n.player.requestConnectedPlayers(),setTimeout(n.subscribebot,500)},n.processAfterUpdatePlayerProfile=function(){EE.Enable&&(n.updatePlayerProfileToNotificationService(),EE.DisableSendNotification||n.sendNotificationForNewUser())},n.startGame=function(){n.analytics.event(Ht._.APP_READY),n.storage.dispatch((0,gE.I)(Ua.Co.LOAD_SCENE)),n.storage.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t,n){var a,s,r,o,c,l,u,p,d,f,m,g,v,y,S,E,A,b,T,C,P,w,I,k;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),s=Ma(a),r=La(a),o=window.game,c=o.player,l=o.analytics,u=o.facebook,p=o.globalScene,d=c.getPlayer(),f=s.contextId,m=s.entryPointData,v=(g=m||{}).type,y=g.matchId,S=g.opponentId,E=g.playerId,A=g.playerName,b=g.playerPhoto,T=g.playerScore,C=d.playerId===E,P=ka,C||"string"!==typeof E||"string"!==typeof A||(P={playerId:E,name:A,photo:"string"===typeof b?b:"",locale:"en_US"}),d.isUserNew&&l.event(Ht._.NEW_USER),r!==Da){e.next=25;break}return e.prev=12,e.next=15,u.getTournamentAsync();case 15:w=e.sent,I=w.getID().toString(),t(bc(I)),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(12),(0,i.tO)(e.t0);case 23:return t(Nl()),e.abrupt("return");case 25:if(r!==_a){e.next=34;break}if(v!==Ta){e.next=30;break}return C||c.updateConnectedPlayers([P]),t(Hl(f,P.playerId,!0)),e.abrupt("return");case 30:if(!(xt()(k=[S,E]).call(k,d.playerId)>=0)||v!==Pa){e.next=34;break}return t(Yl(y,C?S:E)),e.abrupt("return");case 34:if(r!==Oa){e.next=39;break}return t(kl(E,{score:T,level:0})),t(Wl(P)),e.abrupt("return");case 39:if(!d.isUserNew){e.next=42;break}return t(Fl()),e.abrupt("return");case 42:p.events.emit(Ua.K5.SWITCH,Ua.Co.DASHBOARD_SCENE);case 43:case"end":return e.stop()}}),e,null,[[12,20]])})));return function(t,n){return e.apply(this,arguments)}}())},n.subscribebot=function(){n.facebook.attemptToSubscribeBot()},n.handleLoadSoundCompleted=function(){n.audio.initSound(vE.EFFECTS.KEY)},n.handleLoadMusicCompleted=function(){n.audio.initMusic(vE.BACKGROUND.KEY),n.audio.playMusic()},n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(Ht._.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(t){e.facebook.progressLoading.onProgress(t)})),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(e){var t=new lS("Load resources at LoadScene failed.");(0,i.R0)(t,{file:null==e?void 0:e.url})})),this.load.multiatlas(us.Z.DEFAULT.KEY,us.Z.DEFAULT.JSON,us.Z.DEFAULT.URL),this.load.bitmapFont(gs.Z.FONT_WEIGHT_500.KEY,gs.Z.FONT_WEIGHT_500.TEXTURE,gs.Z.FONT_WEIGHT_500.DATA),this.load.bitmapFont(gs.Z.FONT_WEIGHT_600.KEY,gs.Z.FONT_WEIGHT_600.TEXTURE,gs.Z.FONT_WEIGHT_600.DATA),this.load.atlas({key:us.Z.EFFECTS.KEY,textureURL:us.Z.EFFECTS.PATH,atlasURL:us.Z.EFFECTS.JSON}),this.load.atlas({key:us.Z.GAMEPLAY_32.KEY,textureURL:us.Z.GAMEPLAY_32.TEXTURE,atlasURL:us.Z.GAMEPLAY_32.JSON}),this.load.atlas({key:us.Z.GAMEPLAY.KEY,textureURL:us.Z.GAMEPLAY.TEXTURE,atlasURL:us.Z.GAMEPLAY.JSON}),this.load.atlas({key:us.Z.TUTORIAL.KEY,textureURL:us.Z.TUTORIAL.TEXTURE,atlasURL:us.Z.TUTORIAL.JSON}),this.load.bitmapFont(gs.Z.NUMBER_DARK.KEY,gs.Z.NUMBER_DARK.TEXTURE,gs.Z.NUMBER_DARK.DATA),this.load.image(Ia.Z.BACKGROUND.KEY,Ia.Z.BACKGROUND.FILE),this.load.image(Ia.Z.AVATAR.KEY,Ia.Z.AVATAR.FILE),this.load.spine($l.BEST_SCORE.KEY,$l.BEST_SCORE.JSON,$l.BEST_SCORE.ATLAS),this.load.spine($l.LOGO.KEY,$l.LOGO.JSON,[$l.LOGO.ATLAS],!0),this.player.updateData().then(this.processAfterUpdatePlayerProfile).catch(i.tO)},n.create=function(){this.analytics.event(Ht._.LOAD_COMPLETE),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.initModules(),this.setupGlobalScene(),this.lazyLoadResource(),this.startGame()},n.updatePlayerProfileToNotificationService=function(){var e=this.player.getPlayer(),t=e.playerId,n=e.name,i=e.photo,a=e.locale,s=e.ASID;hS({appId:SE,playerId:t,name:n,photo:i,locale:a,ASID:s})},n.sendNotificationForNewUser=function(){var e=(0,r.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.player.getPlayerIsNew()){e.next=4;break}return e.abrupt("return");case 4:if(t=this.player.getPlayerASID()){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,FBInstant.player.getDataAsync(["isNotificationFirstSent"]);case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0={};case 12:if(n=e.t0,!0!==n.isNotificationFirstSent){e.next=16;break}return e.abrupt("return");case 16:this.facebook.sendNotificationAsync({message:"Hi @["+t+"] your friends are waiting to play with you, play now!",delayTime:3600}),FBInstant.player.setDataAsync({isNotificationFirstSent:!0}),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(0);case 23:case"end":return e.stop()}}),e,this,[[0,20]])})));return function(){return e.apply(this,arguments)}}(),n.setupGlobalScene=function(){var e=this.scene.get(Ua.Co.GLOBAL_SCENE);e instanceof oS.Z&&e.setup()},n.initModules=function(){new mE(this.game),new zS(this.game)},n.lazyLoadResource=function(){var e=this;setTimeout((function(){e.scene.wake(),e.loadSounds(),e.lazyLoadLevel(),e.lazyLoadLives(),e.load.once(Phaser.Loader.Events.COMPLETE,(function(){e.scene.sleep()}))}),1500)},n.lazyLoadLevel=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.storage.getState(),!Kc(t)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.storage.dispatch(Tl());case 7:this.loadLevelConfig(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,i.tO)(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),n.lazyLoadLives=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.storage.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t){var n,i,a,s,r,o,c,l,u,p;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game.player,i=n.getPlayer(),a=i.playerId,e.prev=2,t({type:qi,payload:{}}),e.next=6,null==(s=window.FBInstant.player.getDataAsync(["lives"]))?void 0:s.lives;case 6:return r=e.sent,o=(0,Fh.Th)(rm.LivesStore+"-"+a)||{},c=o.lives,l=void 0===c?om.livesCapacity:c,u=o.lastBonusLifeTime,p=void 0===u?0:u,r&&(l=r.lives||0,p=r.lastBonusLifeTime||0),t({type:Ji,payload:{data:{lives:l,lastBonusLifeTime:p}}}),t((function(e,t){e(lm());var n=t(),i=60*om.bonusDurationMins*1e3,a=(new Date).getTime(),s=im(n);e(a-s<i?cm(i-(a-s)):hm())})),e.next=15,t(dm());case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),t({type:Qi,payload:{}});case 20:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),(0,i.tO)(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),n.loadLevelConfig=function(){try{var e=this.storage.getState(),t=Kc(e),n=em[t];n||(n=em[em.length-1]);var a=n,s=a.key,r=a.mapJson;if(this.cache.tilemap.exists(s))return;this.load.tilemapTiledJSON(s,r),this.load.start()}catch(o){(0,i.tO)(o)}},n.loadSounds=function(){var e=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(e+"audio-"+vE.EFFECTS.KEY,this.handleLoadSoundCompleted),this.load.audioSprite(vE.EFFECTS.KEY,vE.EFFECTS.JSON,vE.EFFECTS.FILE),this.load.start()},n.loadWideframesResource=function(){this.frameCapture.preload({"wide-frame-share":"./assets/wideframes/wide-frame-share.png","wide-frame-message-win":"./assets/wideframes/wide-frame-message-win.png","wide-frame-game-result":"./assets/wideframes/wide-frame-game-result.png"})},t}(Phaser.Scene),bE=AE,TE=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).isVisible=!0,n.browserPrefixes=["moz","ms","o","","webkit"],n.visibleCallbacks=[],n.hiddenCallbacks=[],n.handleVisibilityChange=function(e){if("boolean"===typeof e)return e?n.onVisibleEvent():n.onHiddenEvent();var t=n.getBrowserPrefix(),i=n.getHiddenPropertyName(t);return document[i]?n.onHiddenEvent():n.onVisibleEvent()},n}(0,o.Z)(t,e);var n=t.prototype;return n.configure=function(){var e=this,t=this.getBrowserPrefix(),n=this.getVisibilityEvent(t);document.addEventListener(n,this.handleVisibilityChange,!1),document.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),document.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1),window.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),window.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1)},n.addEventVisible=function(e){this.visibleCallbacks.push(e)},n.addEventHidden=function(e){this.hiddenCallbacks.push(e)},n.isGameVisible=function(){return this.isVisible},n.getHiddenPropertyName=function(e){return e?e+"Hidden":"hidden"},n.getVisibilityEvent=function(e){return(e||"")+"visibilitychange"},n.getBrowserPrefix=function(){for(var e=0;e<this.browserPrefixes.length;e++)if(this.getHiddenPropertyName(this.browserPrefixes[e])in document)return this.browserPrefixes[e];return""},n.onVisibleEvent=function(){this.isVisible||(this.isVisible=!0,this.visibleCallbacks.forEach((function(e){e()})))},n.onHiddenEvent=function(){this.isVisible&&(this.isVisible=!1,this.hiddenCallbacks.forEach((function(e){e()})))},t}(Phaser.Plugins.BasePlugin),CE=TE,PE=n(1998),wE=us.Z.DEFAULT,IE=wE.KEY,kE=wE.FRAME,xE=function(e){function t(t){var n;return(n=e.call(this,t,IE,kE.BLANK)||this).icon=void 0,n.text=void 0,n.button.setVisible(!1),n.hitZone.setPosition(n.hitZone.x-5,n.hitZone.y+10),n.hitZone.setDisplaySize(90,80),n.setName("Journey"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.updateSizeHitZone=function(){this.hitZone.setDisplaySize(90,80)},n.createIcon=function(){this.icon=this.scene.make.image({key:IE,frame:kE.ICON_DISCOVER}),this.icon.setWorldSize(24,24),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,0,0)},n.createText=function(){this.text=this.scene.make.image({key:IE,frame:kE.TEXT_JOURNEY}),this.text.setWorldSize(40,10),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,28.5)},n.onActive=function(){this.icon.setFrame(kE.ICON_DISCOVER_BLUE),this.text.setFrame(kE.TEXT_JOURNEY_BLUE)},n.onDeActive=function(){this.icon.setFrame(kE.ICON_DISCOVER),this.text.setFrame(kE.TEXT_JOURNEY)},t}(fs.Z),_E=xE,OE=us.Z.DEFAULT,DE=OE.KEY,RE=OE.FRAME,ME=GameCore.Configs.Match,LE=function(e){function t(t){var n;return(n=e.call(this,t,DE,RE.BLANK)||this).suggestDailyMode=void 0,n.icon=void 0,n.text=void 0,n.button.setVisible(!1),n.hitZone.setPosition(n.hitZone.x+5,n.hitZone.y+10),n.hitZone.setDisplaySize(90,80),n.setName("DailyChallenge"),n.createIcon(),n.createText(),n.createSuggestDailyMode(),n}(0,o.Z)(t,e);var n=t.prototype;return n.updateSizeHitZone=function(){this.hitZone.setDisplaySize(90,80)},n.createIcon=function(){this.icon=this.scene.make.image({key:DE,frame:RE.ICON_CALENDER}),this.icon.setWorldSize(24,24),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,0,0)},n.createText=function(){this.text=this.scene.make.image({key:DE,frame:RE.TEXT_DAILY_CHALLENGE}),this.text.setWorldSize(75,10.5),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,28)},n.createSuggestDailyMode=function(){this.suggestDailyMode=this.scene.make.image({key:DE,frame:RE.BLANK}),this.suggestDailyMode.setWorldSize(17,17),this.suggestDailyMode.setVisible(!1),this.add(this.suggestDailyMode),Phaser.Display.Align.In.Center(this.suggestDailyMode,this,28,-25)},n.checkSuggestDailyMode=function(){var e=window.game.player.getPlayer().playerId,t=(0,Fh.Th)(ME.JourneyMatchStore+"-"+e)||{},n=Object(t).updateAt||0;(0,ht.Gm)(n)?this.suggestDailyMode.setVisible(!1):this.suggestDailyMode.setVisible(!0)},n.onActive=function(){this.icon.setFrame(RE.ICON_CALENDER_BLUE),this.text.setFrame(RE.TEXT_DAILY_CHALLENGE_BLUE)},n.onDeActive=function(){this.icon.setFrame(RE.ICON_CALENDER),this.text.setFrame(RE.TEXT_DAILY_CHALLENGE)},t}(fs.Z),BE=LE,NE=us.Z.DEFAULT,FE=NE.KEY,GE=NE.FRAME,ZE=function(e){function t(t){var n;return(n=e.call(this,t,FE,GE.BLANK)||this).icon=void 0,n.text=void 0,n.button.setVisible(!1),n.hitZone.setY(n.hitZone.y+10),n.hitZone.setDisplaySize(90,80),n.setName("Home"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.updateSizeHitZone=function(){this.hitZone.setDisplaySize(90,80)},n.createIcon=function(){this.icon=this.scene.make.image({key:FE,frame:GE.ICON_HOME}),this.icon.setWorldSize(24,24),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,0,0)},n.createText=function(){this.text=this.scene.make.image({key:FE,frame:GE.TEXT_HOME}),this.text.setWorldSize(31,8),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,27)},n.onActive=function(){this.icon.setFrame(GE.ICON_HOME_BLUE),this.text.setFrame(GE.TEXT_HOME_BLUE)},n.onDeActive=function(){this.icon.setFrame(GE.ICON_HOME),this.text.setFrame(GE.TEXT_HOME)},t}(fs.Z),UE=ZE,HE=us.Z.DEFAULT,VE=HE.KEY,WE=HE.FRAME,YE=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.homeButton=void 0,n.dailyChallengeButton=void 0,n.journeyButton=void 0,n.tabActive=1,n.mapStateChange(),n.createBackground(),n.createHomeButton(),n.createDailyChallengeButton(),n.createJourneyButton(),n.setTabActive(n.tabActive),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.mapStateChange=function(){var e=this,t=[{selector:xp.$,callback:function(t){var n=1;switch(t){case Ua.Co.DASHBOARD_SCENE:n=1;break;case Ua.Co.DAILY_SCENE:n=2;break;case Ua.Co.LEVEL_SCENE:n=3}e.setTabActive(n)}}];this.handleStateChange(t)},n.handleStateChange=function(e){var t=this;e.forEach((function(e){var n=e.selector,i=e.callback;t.scene.storage.watch(n,i)}))},n.createBackground=function(){var e=this.scene.ads.getBannerHeight();this.background=this.scene.make.image({key:VE,frame:WE.FOOTER,origin:{x:.5,y:1}}),this.background.setWorldSize(375,80+e),this.add(this.background)},n.createHomeButton=function(){var e=this.scene.ads.getBannerHeight();this.homeButton=new UE(this.scene),this.homeButton.onClick=this.clickHomeButton.bind(this),this.add(this.homeButton),Phaser.Display.Align.In.BottomCenter(this.homeButton,this,-90,-e-1)},n.createDailyChallengeButton=function(){var e=this.scene.ads.getBannerHeight();this.dailyChallengeButton=new BE(this.scene),this.dailyChallengeButton.onClick=this.clickDailyButton.bind(this),this.add(this.dailyChallengeButton),Phaser.Display.Align.In.BottomCenter(this.dailyChallengeButton,this,0,-e-1)},n.createJourneyButton=function(){var e=this.scene.ads.getBannerHeight();this.journeyButton=new _E(this.scene),this.journeyButton.onClick=this.clickJourneyButton.bind(this),this.add(this.journeyButton),Phaser.Display.Align.In.BottomCenter(this.journeyButton,this,90,-e-1)},n.clickHomeButton=function(){this.homeButton.updateSizeHitZone(),this.scene.scene.switch(Ua.Co.DASHBOARD_SCENE)},n.clickDailyButton=function(){this.dailyChallengeButton.updateSizeHitZone(),this.scene.scene.switch(Ua.Co.DAILY_SCENE)},n.clickJourneyButton=function(){this.journeyButton.updateSizeHitZone(),this.scene.scene.switch(Ua.Co.LEVEL_SCENE)},n.setTabActive=function(e){switch(this.tabActive=e,e){case 1:this.homeButton.onActive(),this.dailyChallengeButton.onDeActive(),this.journeyButton.onDeActive();break;case 2:this.homeButton.onDeActive(),this.dailyChallengeButton.onActive(),this.journeyButton.onDeActive();break;case 3:this.homeButton.onDeActive(),this.dailyChallengeButton.onDeActive(),this.journeyButton.onActive()}},t}(Phaser.GameObjects.Container),zE=YE,KE=n(73431),jE={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n.n(KE)()(.55,.47,.43,.91),easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},XE=function(e){function t(t){return e.call(this,jE,t)||this}return(0,o.Z)(t,e),t}(Zf.Z),qE=us.Z.DEFAULT,JE=qE.KEY,QE=qE.FRAME,$E=GameCore.Configs.Lives,eA=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.circle=void 0,n.icon=void 0,n.textLives=void 0,n.textTimer=void 0,n.groupHeartBeat=void 0,n.heartBeat=void 0,n.textLivesBeat=void 0,n.iconBeat=void 0,n.intervalTimer=void 0,n.scene.add.existing((0,as.Z)(n)),n.createBackgroundLives(),n.createTextLives(),n.createIconPlus(),n.createHeartBeatAnimation(),n.setSize(140,27),n.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){n.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN)})),n}(0,o.Z)(t,e);var n=t.prototype;return n.createBackgroundLives=function(){this.background=this.scene.make.image({key:JE,frame:QE.LIVES_TIME_BLOCK_2}),this.background.setWorldSize(155,66),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createIconPlus=function(){this.icon=this.scene.make.image({key:JE,frame:QE.ICON_PLUS}),this.icon.setWorldSize(14,14),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,-62,11)},n.createTextLives=function(){this.circle=this.scene.make.image({key:JE,frame:QE.LIVES_HEART}),this.circle.setWorldSize(40,40),this.add(this.circle),Phaser.Display.Align.In.Center(this.circle,this.background,-30,0);var e=this.scene.storage.getState(),t=nm(e);this.textLives=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(40),text:"x"+t,origin:{x:.2,y:.5}}),this.textLives.setTint(262685),this.add(this.textLives),Phaser.Display.Align.In.Center(this.textLives,this.background,20)},n.createTextTimer=function(){this.textTimer=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(40),text:"00:00",origin:{x:.2,y:.5}}),this.add(this.textTimer),Phaser.Display.Align.In.Center(this.textTimer,this,8,2)},n.updateTextLives=function(){var e=this.scene.storage.getState(),t=nm(e);this.textLives.setText("x"+t)},n.startIntervalTimer=function(){var e=this;this.runHeartBeatAnimation(),this.intervalTimer=setInterval((function(){var t=e.scene.storage.getState(),n=nm(t)||0;n!==$E.livesCapacity?parseInt(e.textLives.text)!==n&&e.updateTextLives():e.textLives.setText("x"+$E.livesCapacity)}),1e3)},n.stopIntervalTimer=function(){clearInterval(this.intervalTimer)},n.setLives=function(e){this.textLives.setText(String(e))},n.runHeartBeatAnimation=function(){this.heartBeat.play(),this.textLivesBeat.play(),this.iconBeat.play()},n.createHeartBeatAnimation=function(){this.heartBeat=new XE({targets:[this.circle],props:{scale:"+=0.005"}}),this.textLivesBeat=new XE({targets:[this.textLives],props:{scale:"+=0.05"}}),this.iconBeat=new XE({targets:[this.icon],props:{scale:"+=0.025"}})},t}(Phaser.GameObjects.Container),tA=eA,nA=us.Z.DEFAULT,iA=nA.KEY,aA=nA.FRAME,sA=function(e){function t(t){var n;return(n=e.call(this,t,iA,aA.BUTTON_LONG_MINOR_WHITE)||this).button.setWorldSize(311,50),n.setName("Continue"),n.createText(),n.createIcon(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createText=function(){var e=this.scene.make.image({key:iA,frame:aA.TEXT_CONTINUE_BLUE});e.setWorldSize(73,13),this.add(e),Phaser.Display.Align.In.Center(e,this,20,0)},n.createIcon=function(){var e=this.scene.make.image({key:iA,frame:aA.ICON_PLAY_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,-43,1)},t}(fs.Z),rA=sA,oA=us.Z.DEFAULT,cA=oA.KEY,hA=oA.FRAME,lA=GameCore.Configs.Lives,uA=function(e){function t(t){var n;return(n=e.call(this,t,cA,hA.BUTTON_LONG_BLUE)||this).heart=void 0,n.textLives=void 0,n.groupHeartBeat=void 0,n.heartBeat=void 0,n.textLivesBeat=void 0,n.button.setWorldSize(311,50),n.setName("RefillLives"),n.createText(),n.createIcon(),n.createHeart(),n.createHeartBeatAnimation(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createText=function(){var e=this.scene.make.image({key:cA,frame:hA.TEXT_REFILL_LIVES});e.setWorldSize(72,13),this.add(e),Phaser.Display.Align.In.Center(e,this,20,0)},n.createIcon=function(){var e=this.scene.make.image({key:cA,frame:hA.ICON_VIDEO_PLAY});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,-43,1)},n.createHeart=function(){this.heart=this.scene.make.image({key:cA,frame:hA.LIVES_HEART}),this.heart.setAngle(15),this.heart.setWorldSize(56,56),this.add(this.heart),Phaser.Display.Align.In.Center(this.heart,this,112,-20),this.textLives=this.scene.make.text({text:"+"+lA.livesCapacity,style:{fontFamily:gs.Z.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(45)+"px",fontStyle:"500"},origin:{x:.5,y:.5}}),this.textLives.setAngle(15),this.add(this.textLives),Phaser.Display.Align.In.Center(this.textLives,this.heart,0,-4)},n.runHeartBeatAnimation=function(){this.heartBeat.play(),this.textLivesBeat.play()},n.createHeartBeatAnimation=function(){this.heartBeat=new XE({targets:[this.heart],props:{scale:"+=0.005"}}),this.textLivesBeat=new XE({targets:[this.textLives],props:{scale:"+=0.025"}})},t}(fs.Z),pA=uA,dA=us.Z.DEFAULT,fA=dA.KEY,mA=dA.FRAME,gA=GameCore.Configs,vA=gA.Network,yA=gA.Lives,SA=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.backgroundContent=void 0,s.currentScreen=void 0,s.refillLivesButton=void 0,s.continueButton=void 0,s.textTitle=void 0,s.livesContent=void 0,s.textContent=void 0,s.adsTimer=void 0,s.yContinueButton=void 0,s.livesTimer=void 0,s.intervalTimer=void 0,s.textBlock=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.clickPlayWithFriend=function(){s.scene.storage.dispatch(Hl()),s.currentScreen&&s.currentScreen.setVisible(!1),s.close()},s.handleShowRewardedVideoAd=(0,r.Z)(h().mark((function e(){var t,n,i,a,o,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.scene.game,n=t.globalScene,i=t.audio,e.prev=2,t.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading ads...",duration:vA.Timeout,loading:!0}),i.pauseMusic(),e.next=7,new(ie())((function(e,t){var n;null==(n=s.adsTimer)||n.remove(),s.adsTimer=s.scene.time.delayedCall(vA.Timeout,t),s.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?s.scene.ads.events.once(GameCore.Ads.Events.LOADED,e):s.scene.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 7:return e.next=9,s.scene.ads.showRewardedVideoAsync();case 9:s.scene.audio.playSound(ds.Z.DAILY_REWARD),s.scene.analytics.showRewardedVideoAd(s.getScreenName()),s.scene.storage.dispatch(function(){var e=(0,r.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={lives:om.livesCapacity,lastBonusLifeTime:(new Date).getTime()},e.next=4,t(fm(n));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()),s.close(),n.screen.close(ps.o4.NOTIFY_SCREEN),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),s.scene.analytics.showAdFail(GameCore.Ads.Types.REWARDED,s.getScreenName(),e.t0),s.showNotifySkipAds();case 20:return e.prev=20,null==(a=s.adsTimer)||a.destroy(),s.scene.audio.playMusic(),s.scene.ads.preloadRewardedVideoAsync().catch((function(e){})),o=s.getData(["onClose"]),(c=o[0])&&c(),e.finish(20);case 27:case"end":return e.stop()}}),e,null,[[2,16,20,27]])}))),s.showNotifyNoAds=function(e){if(!e||e.name===ps.o4.NOTIFY_SCREEN){var t=s.scene.game.globalScene;t.screen.events.off(GameCore.Screens.Events.CLOSE),t.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),t.screen.open(ps.o4.NOTIFY_SCREEN,{message:"No ads to display!",duration:2e3,loading:!1})}},s.showNotifySkipAds=function(){var e=s.scene.game.globalScene;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),e.screen.open(ps.o4.NOTIFY_SCREEN,{message:"There was an error...",duration:3e3,loading:!1})},s.showGameOver=function(e){e&&e.name!==ps.o4.NOTIFY_SCREEN||s.scene.screen.close(s.name)},s.createPopup(),s.createLivesTimer(),s.createTitle(),s.createContentBackground(),s.createLiveContent(),s.createButtons(),s.createTextContent(),s.addItem(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t),this.updateIntervalTimer(),this.startIntervalTimer(),this.runOpenAnimation(),null!=t&&t.currentScreen&&(this.currentScreen=t.currentScreen),this.showLivesTimer()},n.showLivesTimer=function(){var e=this.getData(["showLivesTimer"])[0];this.livesTimer.setVisible(e),e&&this.livesTimer.startIntervalTimer()},n.createLivesTimer=function(){this.livesTimer=new tA(this.scene),this.popup.add(this.livesTimer),Phaser.Display.Align.In.Center(this.livesTimer,this.popup,0,-270)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:fA,frame:mA.LIVES_HEART}),this.backgroundContent.setWorldSize(124,124),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createLiveContent=function(){var e=this.scene.storage.getState(),t=nm(e);this.livesContent=this.scene.make.text({text:""+t,style:{fontFamily:gs.Z.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(150)+"px",fontStyle:"700",align:"center"}}),this.livesContent.setTint(16777215),this.popup.add(this.livesContent),Phaser.Display.Align.In.Center(this.livesContent,this.backgroundContent,0,0)},n.createTextContent=function(){this.textContent=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.popup.add(this.textContent),Phaser.Display.Align.In.Center(this.textContent,this.refillLivesButton,0,-70)},n.startIntervalTimer=function(){var e=this;this.intervalTimer=setInterval((function(){e.updateIntervalTimer()}),1e3)},n.updateIntervalTimer=function(){var e,t,n=60*yA.bonusDurationMins*1e3,i=this.scene.storage.getState(),a=nm(i),s=am(i),r=im(i),o=(new Date).getTime();o-r<n&&(s=r);var c=(0,ht.ne)(n-(o-s)),h=Ne()(e="0"+c.minutes).call(e,-2),l=Ne()(t="0"+c.seconds).call(t,-2);this.setTextContent("Next life: "+h+"m "+l+"s"),a>0?(this.textTitle.setFrame(mA.TEXT_KEEP_PLAYING),this.textTitle.setWorldSize(118,19)):(this.textTitle.setFrame(mA.TEXT_OUT_OF_LIVES),this.textTitle.setWorldSize(236,26)),parseInt(this.livesContent.text)!=a&&(this.livesContent.setText(""+a),Phaser.Display.Align.In.Center(this.livesContent,this.backgroundContent,0,0)),a===yA.livesCapacity?(this.setTextContent("Full"),this.refillLivesButton.setVisible(!1),this.continueButton.setY(this.yContinueButton-40)):(this.refillLivesButton.setVisible(!0),this.refillLivesButton.runHeartBeatAnimation(),this.continueButton.setY(this.yContinueButton))},n.stopIntervalTimer=function(){clearInterval(this.intervalTimer)},n.setTextContent=function(e){this.textContent.setText(e),this.textContent.setVisible(!1),Phaser.Display.Align.In.Center(this.textContent,this.refillLivesButton,0,-70)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,-30,343,345,{forceHeightTop:47,framePopupTop:mA.POPUP_TOP_1,framePopupMid:mA.POPUP_MID_1,framePopupBottom:mA.POPUP_BOTTOM_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-30)},n.createTitle=function(){this.title=this.scene.add.container(),this.textTitle=this.scene.make.image({key:fA,frame:mA.TEXT_KEEP_PLAYING}),this.textTitle.setWorldSize(186,22),this.buttonClose=new fs.Z(this.scene,fA,mA.ICON_CLOSE,20,20),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.handleClose,this.buttonClose.setVisible(!1),this.title.add([this.textTitle,this.buttonClose]),this.popup.add([this.title]),Phaser.Display.Align.In.Center(this.textTitle,this.title,0,19),Phaser.Display.Align.In.Center(this.buttonClose,this.title,145,this.buttonClose.height/2),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createButtons=function(){this.createRefillLivesButton(),this.createContinueButton()},n.createRefillLivesButton=function(){this.refillLivesButton=new pA(this.scene),this.popup.add(this.refillLivesButton),this.refillLivesButton.onClick=this.handleShowRewardedVideoAd,Phaser.Display.Align.In.BottomCenter(this.refillLivesButton,this.popup,0,-99)},n.createContinueButton=function(){this.continueButton=new rA(this.scene),this.popup.add(this.continueButton),this.continueButton.onClick=this.handleClose,Phaser.Display.Align.In.BottomCenter(this.continueButton,this.popup,0,-38),this.yContinueButton=this.continueButton.y},n.addItem=function(){this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.stopIntervalTimer(),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){var n=this;if(!this.popupFadeOutMaskAnimation){var i=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:i,from:i,to:0}},onComplete:function(){var e=n.getData(["onClose"])[0];e&&e()}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),EA=SA,AA=us.Z.DEFAULT,bA=AA.KEY,TA=AA.FRAME,CA=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.contents=void 0,s.textTargetScore=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.startOver=function(){(0,s.getData(["onConfirm"])[0])(),s.handleClose()},s.createPopup(),s.createTextTargetScore(),s.createButtons(),s.addItem(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t),this.runOpenAnimation()},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),text:"Are you sure to start over?",origin:{x:.5,y:.5}}),this.textTargetScore.setTint(3552586),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.popup,0,-30)},n.createButtons=function(){var e=new fs.Z(this.scene,bA,TA.BUTTON_BLUE_NORMAL,150,56),t=new fs.Z(this.scene,bA,TA.BUTTON_MINOR_NORMAL,150,56),n=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(30),text:"OK",origin:{x:.5,y:.5}});e.add(n);var i=this.scene.make.image({key:bA,frame:TA.TEXT_CANCEL});i.setWorldSize(56,12),t.add(i),this.popup.add([e,t]),e.onClick=this.startOver,t.onClick=this.handleClose,Phaser.Display.Align.In.BottomCenter(e,this.popup,80,-40),Phaser.Display.Align.In.BottomCenter(t,this.popup,-80,-40)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,240,{framePopupTop:TA.POPUP_TOP_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(50),text:"CONFIRM START OVER",origin:{x:.5,y:.5}});this.title.add([e]),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title,0,-5),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),PA=CA,wA=us.Z.DEFAULT,IA=wA.KEY,kA=wA.FRAME,xA=function(e){function t(t){var n;return(n=e.call(this,t,IA,kA.BUTTON_LONG_BLUE)||this).textStartOver=void 0,n.button.setWorldSize(343,56),n.setName("Play Level"),n.createText(),n}return(0,o.Z)(t,e),t.prototype.createText=function(){this.textStartOver=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),text:"START OVER",origin:{x:.5,y:.5}}),this.add(this.textStartOver),Phaser.Display.Align.In.Center(this.textStartOver,this,0,0)},t}(fs.Z),_A=xA,OA=us.Z.DEFAULT,DA=OA.KEY,RA=OA.FRAME,MA=function(e){function t(t){var n;return(n=e.call(this,t,DA,RA.BUTTON_LONG_BLUE)||this).text=void 0,n.button.setWorldSize(343,56),n.setName("Start"),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createText=function(){this.text=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.text.setTint(16777215),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,0)},n.setText=function(e){this.text.setText("Start level "+e)},t}(fs.Z),LA=MA,BA=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.buttonStart=void 0,n.buttonStartOver=void 0,n.scene=t,n.init(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createButton()},n.createButton=function(){this.createButtonPlay(),this.createButtonStartOver()},n.createButtonPlay=function(){this.buttonStart=new LA(this.scene),this.buttonStart.setVisible(!1),this.add(this.buttonStart),Phaser.Display.Align.In.Center(this.buttonStart,this,0,-18)},n.createButtonStartOver=function(){this.buttonStartOver=new _A(this.scene),this.buttonStartOver.setVisible(!1),this.add(this.buttonStartOver),Phaser.Display.Align.In.Center(this.buttonStartOver,this,0,-18)},n.updateTextButtonPlay=function(){var e=this.scene.storage.getState(),t=Kc(e);this.buttonStart.setText(""+t)},t}(Phaser.GameObjects.Container),NA=BA,FA=n(26108),GA=(function(e){function t(t){var n;return(n=e.call(this,t,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,o.Z)(t,e)}(Phaser.GameObjects.GameObject),function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,o.Z)(t,e);var n=t.prototype;return n.reset=function(){e.prototype.reset.call(this),this.killAndHideAll()},n.getChildren=function(){var e;return E()(e=this.listObjects).call(e,(function(e){return void 0!=e&&e.active}))},n.updateConfig=function(e){var t;this.reset(),this.listConfigs=e,this.listObjects=cs()(t=new Array(e.length)).call(t,void 0),this.addObjectIndex(0,0);var n=this.getEndObjectIndex();this.addObjectIndex(1,n),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.killAndHideAll=function(){var e,t=this;this.listObjects instanceof Array&&(b()(e=this.listObjects).call(e,(function(e){void 0!==e&&t.objects.killAndHide(e)})),this.objects.getChildren().forEach((function(e){return t.objects.killAndHide(e)})))},n.setItemPosition=function(e,t){var n=e.height;e.setPosition(0,n/2+(n+this.padding)*t-this.height/2)},n.updateMaxHeight=function(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.updateObject=function(e){this.objects.incY(e);var t=this.getStartObjectIndex(),n=this.getEndObjectIndex();t!=this.startObjectIndex&&(t>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,t-1):this.addObjectIndex(t,this.startObjectIndex-1),this.startObjectIndex=t),n!=this.endObjectIndex&&(n<this.endObjectIndex?this.killObjectIndex(n+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,n),this.endObjectIndex=n)},n.killObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;var s=this.objects.getFirstDead(!0),r=s.height,o=r/2+(r+i)*n+this.value-this.height/2;s.updateInfo(a[n]),s.setPosition(0,o),s.setActive(!0),s.setVisible(!0),this.addAt(s),this.listObjects[n]=s}},n.getStartObjectIndex=function(){var e=this.objHeight,t=this.padding;return Math.max(Math.floor((0-this.value)/(e+t)),0)},n.getEndObjectIndex=function(){var e=this.objHeight,t=this.padding,n=this.listConfigs,i=e+t;return Math.min(Math.floor((this.height-this.value)/i),n.length)},(0,V.Z)(t,[{key:"objHeight",get:function(){var e=this.objects.getChildren();return 0==e.length?this.maxHeight=0:e[0].height}}]),t}(FA.Z)),ZA=us.Z.DEFAULT,UA=ZA.KEY,HA=ZA.FRAME,VA=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).background=void 0,i.text=void 0,i.flag=void 0,i.payload=void 0,i.createBackground(),i.createText(),i.createFlag(),n&&(i.payload=(0,s.Z)({},n),i.updateInfo(n)),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:UA,frame:HA.LEVEL_LOCKED}),this.background.setWorldSize(50,50),this.add(this.background)},n.createText=function(){this.text=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.1}}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.background,0,1.5)},n.createFlag=function(){this.flag=this.scene.make.image({key:UA,frame:HA.ICON_FLAG}),this.flag.setWorldSize(24,24),this.flag.setVisible(!1),this.add(this.flag),Phaser.Display.Align.In.Center(this.flag,this.background,5.5,-37)},n.setBackground=function(e){this.background.setFrame(e)},n.setText=function(e){this.text.setText(""+e)},n.updateInfo=function(e){this.payload=(0,s.Z)({},e),this.updateText()},n.updateText=function(){this.text.setVisible(!0),Phaser.Display.Align.In.Center(this.text,this.background,-1,1.5)},n.hideText=function(){this.text.setVisible(!1)},n.activeFlag=function(){this.flag.setVisible(!0)},n.inactiveFlag=function(){this.flag.setVisible(!1)},t}(Phaser.GameObjects.Container),WA=VA,YA=us.Z.DEFAULT,zA=YA.KEY,KA=YA.FRAME,jA=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).background=void 0,i.levelItem1=void 0,i.levelItem2=void 0,i.levelItem3=void 0,i.payload=void 0,i.init(),n&&i.updateInfo(n),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createBackground(),this.updateSize(),this.createLevelItem()},n.createBackground=function(){this.background=this.scene.make.image({key:zA,frame:KA.ROAD_1}),this.background.setWorldSize(265,347),this.add(this.background)},n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n)},n.updateInfo=function(e){this.payload=(0,s.Z)({},e),this.updateLevelItem()},n.createLevelItem=function(){this.levelItem1=new WA(this.scene,{text:1,frame:KA.LEVEL_LOCKED}),this.add(this.levelItem1),Phaser.Display.Align.In.Center(this.levelItem1,this.background,0,110),this.levelItem2=new WA(this.scene,{text:2,frame:KA.LEVEL_LOCKED}),this.add(this.levelItem2),Phaser.Display.Align.In.Center(this.levelItem2,this,131,-25),this.levelItem3=new WA(this.scene,{text:3,frame:KA.LEVEL_LOCKED}),this.add(this.levelItem3),Phaser.Display.Align.In.Center(this.levelItem3,this,0,-102)},n.updateLevelItem=function(){this.levelItem1.setBackground(this.payload.levelItem1.frame),this.payload.levelItem1.frame===KA.LEVEL_LOCKED?this.levelItem1.hideText():(this.levelItem1.setText(this.payload.levelItem1.text),this.levelItem1.updateText()),this.levelItem2.setBackground(this.payload.levelItem2.frame),this.payload.levelItem2.frame===KA.LEVEL_LOCKED?this.levelItem2.hideText():(this.levelItem2.setText(this.payload.levelItem2.text),this.levelItem2.updateText()),this.levelItem3.setBackground(this.payload.levelItem3.frame),this.payload.levelItem3.frame===KA.LEVEL_LOCKED?this.levelItem3.hideText():(this.levelItem3.setText(this.payload.levelItem3.text),this.levelItem3.updateText())},t}(Phaser.GameObjects.Container),XA=us.Z.DEFAULT,qA=XA.KEY,JA=XA.FRAME,QA=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).background=void 0,i.levelItem1=void 0,i.levelItem2=void 0,i.levelItem3=void 0,i.levelItem4=void 0,i.payload=void 0,i.init(),n&&i.updateInfo(n),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createBackground(),this.updateSize(),this.createLevelItem()},n.createBackground=function(){this.background=this.scene.make.image({key:qA,frame:JA.ROAD_2}),this.background.setWorldSize(265,347),this.add(this.background)},n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n)},n.updateInfo=function(e){this.payload=(0,s.Z)({frame:JA.ROAD_2},e),this.updateLevelItem(),this.updateBackground()},n.createLevelItem=function(){this.levelItem1=new WA(this.scene,{text:1,frame:JA.LEVEL_LOCKED}),this.add(this.levelItem1),Phaser.Display.Align.In.Center(this.levelItem1,this.background,0,85),this.levelItem2=new WA(this.scene,{text:2,frame:JA.LEVEL_LOCKED}),this.add(this.levelItem2),Phaser.Display.Align.In.Center(this.levelItem2,this.background,131,-12),this.levelItem3=new WA(this.scene,{text:3,frame:JA.LEVEL_LOCKED}),this.add(this.levelItem3),Phaser.Display.Align.In.Center(this.levelItem3,this.background,0,-92),this.levelItem4=new WA(this.scene,{text:4,frame:JA.LEVEL_LOCKED}),this.add(this.levelItem4),Phaser.Display.Align.In.Center(this.levelItem4,this.background,-131,160)},n.updateLevelItem=function(){this.checkLevelItem(this.levelItem1,this.payload.levelItem1),this.checkLevelItem(this.levelItem2,this.payload.levelItem2),this.checkLevelItem(this.levelItem3,this.payload.levelItem3),this.checkLevelItem(this.levelItem4,this.payload.levelItem4)},n.checkLevelItem=function(e,t){e.setBackground(t.frame),t.frame===JA.LEVEL_PLAYING?e.activeFlag():e.inactiveFlag(),t.frame===JA.LEVEL_LOCKED?e.hideText():(e.setText(t.text),e.updateText())},n.updateBackground=function(){this.payload.frame===JA.ROAD_1?(this.background.setFrame(this.payload.frame),this.levelItem4.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem1,this.background,0,123),Phaser.Display.Align.In.Center(this.levelItem2,this.background,131,-32),Phaser.Display.Align.In.Center(this.levelItem3,this.background,0,-125)):(this.background.setFrame(JA.ROAD_2),this.levelItem4.setVisible(!0),Phaser.Display.Align.In.Center(this.levelItem1,this.background,0,85),Phaser.Display.Align.In.Center(this.levelItem2,this.background,131,-12),Phaser.Display.Align.In.Center(this.levelItem3,this.background,0,-92))},t}(Phaser.GameObjects.Container),$A=GameCore.Configs.Network,eb=us.Z.DEFAULT,tb=(eb.KEY,eb.FRAME),nb=function(e){function t(t){var n;return(n=e.call(this,t)||this).road1=void 0,n.road2=void 0,n.scroller=void 0,n.setSizeContainer(),n.createReuseScroller(),n.showLoadingScreen(),n.mapStateChange(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.setSizeContainer=function(){var e=this.scene.ads.getBannerHeight(),t=this.scene.world.getWorldSize(),n=t.width,i=t.height-e;this.setSize(n,i)},n.createReuseScroller=function(){this.scroller=new GA(this.scene,{classType:QA||jA,listConfigs:[],width:325,height:385,padding:0,marginTop:0,marginBottom:0,maxScrollOver:.3,scrollingBackRate:5,useMask:!1}),this.scroller.setVisible(!1),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(us.Z.DEFAULT.KEY,us.Z.DEFAULT.FRAME.BLANK,40,1528359),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)},n.updateData=function(){for(var e=this.scene.storage.getState(),t=Kc(e),n=[],i={levelItem1:{text:0,frame:""},levelItem2:{text:0,frame:""},levelItem3:{text:0,frame:""},levelItem4:{text:0,frame:""}},a=em.length;a>0;a--){var r="";r=a>t?tb.LEVEL_LOCKED:a<t?tb.LEVEL_PLAYED:tb.LEVEL_PLAYING;var o="";switch(a%4){case 1:o="levelItem1";break;case 2:o="levelItem2";break;case 3:o="levelItem3";break;case 0:o="levelItem4"}i[o]={text:a,frame:r},1===a&&n.push((0,s.Z)({frame:tb.ROAD_1},i)),a%4===0&&n.push((0,s.Z)({},i))}this.scroller.updateConfig(n);var c=this.scroller.getChildren()[0].height;this.scroller.value=-c*this.showDefaultLevel(em.length-t),this.showLeaders()},n.showDefaultLevel=function(e){var t=Math.floor((e-1)/4);return t<3?1:t+1},n.removeLevelItems=function(){this.scroller.updateConfig([])},n.getLevelItems=function(){return this.scroller.getChildren()},n.showLeaders=function(){var e=this.getLevelItems();if(!(e.length<1)){for(var t=e.length>8?8:e.length,n=0;n<t;n++){var i=e[n];if(!i)return;i.setVisible(!0)}this.scroller.setEnable(!0)}},n.createRoadLevel=function(){this.road1=new jA(this.scene,{levelItem1:{text:1,frame:tb.LEVEL_PLAYED},levelItem2:{text:2,frame:tb.LEVEL_PLAYING},levelItem3:{text:3,frame:tb.LEVEL_LOCKED}}),this.road1.setVisible(!1),this.add(this.road1),Phaser.Display.Align.In.Center(this.road1,this,0,25),this.road2=new QA(this.scene,{levelItem1:{text:4,frame:tb.LEVEL_PLAYED},levelItem2:{text:5,frame:tb.LEVEL_PLAYING},levelItem3:{text:6,frame:tb.LEVEL_LOCKED},levelItem4:{text:7,frame:tb.LEVEL_LOCKED}}),this.add(this.road2),Phaser.Display.Align.In.Center(this.road2,this,0,-150)},n.loadLevelConfig=function(){try{var e=this.scene.storage.getState(),t=Kc(e);0===t&&(t=1);var n=em[t];n||(n=em[em.length-1]);var a=n,s=a.key,r=a.mapJson;if(this.scene.cache.tilemap.exists(s))return;this.scene.load.tilemapTiledJSON(s,r),this.scene.load.start()}catch(o){(0,i.tO)(o)}},n.mapStateChange=function(){var e=this,t=[{selector:Rc,callback:function(t){t||(e.hideLoadingScreen(),e.loadLevelConfig())}},{selector:Kc,callback:function(e){}}];this.handleStateChange(t)},n.handleStateChange=function(e){var t=this;e.forEach((function(e){var n=e.selector,i=e.callback;t.scene.storage.watch(n,i)}))},n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading level...",duration:$A.Timeout,loading:!0})},n.hideLoadingScreen=function(){var e;(null==(e=this.scene)?void 0:e.game).globalScene.screen.close(ps.o4.NOTIFY_SCREEN)},n.handlePlay=function(){var e=this.scene.storage.getState();if(nm(e)<1)this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN);else{this.scene.storage.dispatch(pm());var t=Kc(e);this.scene.storage.dispatch(Pl()),this.scene.analytics.levelStart(t,void 0,this.getLevelName(t)),this.scene.storage.dispatch(Gl())}},n.getLevelName=function(e){var t;return"journey_"+ls()(t=GameCore.Utils.Number).call(t,e,4,"0")},t}(Phaser.GameObjects.Container),ib=nb,ab=GameCore.Configs.Network,sb=us.Z.DEFAULT,rb=sb.KEY,ob=sb.FRAME,cb=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).journeyMain=void 0,n.footer=void 0,n.menu=void 0,n.run=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.checkReceiveLevelFromFb();case 2:n.loadLevelConfig();case 3:case"end":return e.stop()}}),e)}))),n.create=function(){e.prototype.create.call((0,as.Z)(n)),n.createBackground(Ia.Z.BACKGROUND.KEY),n.createDecorate(),n.createJourneyMain(),n.createFooter(),n.createMenu(),n.createClaimHeartScreen(),n.createStartOverScreen()},n.onConfirm=function(){FBInstant.player.setDataAsync({level:1}),n.storage.dispatch(wl(1)),n.loadLevelConfig(),n.journeyMain.updateData()},n.handleClickStartOver=function(){n.screen.open(ps.o4.START_OVER_SCREEN,{onConfirm:n.onConfirm})},n.checkFinishAllLevel=function(){var e=n.storage.getState();if(Kc(e)>=em.length)return n.footer.buttonStart.setVisible(!1),void n.footer.buttonStartOver.setVisible(!0);n.footer.buttonStart.setVisible(!0),n.footer.buttonStartOver.setVisible(!1)},n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.startGame=function(){this.journeyMain.updateData(),this.journeyMain.scroller.setVisible(!0),this.checkFinishAllLevel(),this.footer.updateTextButtonPlay()},n.createClaimHeartScreen=function(){this.screen.add(ps.o4.CLAIM_HEART_SCREEN,EA)},n.createStartOverScreen=function(){this.screen.add(ps.o4.START_OVER_SCREEN,PA)},n.createDecorate=function(){var e=this.world.getWorldSize(),t=(e.width,e.height,this.make.image({key:rb,frame:ob.D_BAG}));t.setWorldSize(63,96),t.setAlpha(.5),Phaser.Display.Align.In.RightCenter(t,this.gameZone,0,-100);var n=this.make.image({key:rb,frame:ob.D_BOOK});n.setWorldSize(44,64),n.setAlpha(.5),Phaser.Display.Align.In.TopRight(n,this.gameZone,0,-24);var i=this.make.image({key:rb,frame:ob.D_PLANE});i.setWorldSize(95,65),i.setAlpha(.5),Phaser.Display.Align.In.TopLeft(i,this.gameZone,0,-24);var a=this.make.image({key:rb,frame:ob.D_MAP});a.setWorldSize(121,121),a.setAlpha(.5),Phaser.Display.Align.In.LeftCenter(a,this.gameZone,0,-44);var s=this.make.image({key:rb,frame:ob.D_CLOCK});s.setWorldSize(43,47),s.setAlpha(.5),Phaser.Display.Align.In.Center(s,this.gameZone,-30,-120);var r=this.make.image({key:rb,frame:ob.D_CAMERA});r.setWorldSize(79,66),r.setAlpha(.5),Phaser.Display.Align.In.RightCenter(r,this.gameZone,-30,80)},n.createJourneyMain=function(){this.journeyMain=new ib(this),Phaser.Display.Align.In.Center(this.journeyMain,this.gameZone,0,-70)},n.createFooter=function(){this.footer=new NA(this);var e=this.ads.getBannerHeight();Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone,0,-120-e),this.footer.buttonStart.onClick=this.handlePlay.bind(this),this.footer.buttonStartOver.onClick=this.handleClickStartOver},n.createMenu=function(){this.menu=new zE(this),Phaser.Display.Align.In.BottomCenter(this.menu,this.gameZone,0,0)},n.handlePlay=function(){var e=(0,r.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.storage.getState(),!(nm(t)<1)){e.next=5;break}return this.screen.open(ps.o4.CLAIM_HEART_SCREEN),e.abrupt("return");case 5:this.storage.dispatch(pm()),n=Kc(t),this.storage.dispatch(Pl()),this.analytics.levelStart(n,void 0,this.getLevelName(n)),this.storage.dispatch(Gl());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.checkReceiveLevelFromFb=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.storage.getState(),!Kc(t)){e.next=5;break}return e.abrupt("return");case 5:return this.showLoadingScreen(),e.next=8,this.storage.dispatch(Tl());case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,i.tO)(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading level...",duration:ab.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.game.globalScene.screen.close(ps.o4.NOTIFY_SCREEN)},n.loadLevelConfig=function(){try{var e=this.storage.getState(),t=Kc(e);0===t&&(t=1);var n=em[t];n||(n=em[em.length-1]);var a=n,s=a.key,r=a.mapJson;if(this.cache.tilemap.exists(s))return void this.handleLoadCurrentMapComplete();this.load.tilemapTiledJSON(s,r),this.load.start(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(o){(0,i.tO)(o)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.getLevelName=function(e){var t;return"journey_"+ls()(t=GameCore.Utils.Number).call(t,e,4,"0")},t}(Ql.Z),hb=cb;null==(sS=void 0)||sS.accept(GameCore.LiveUpdate.Scene(Ua.Co.LEVEL_SCENE));for(var lb=hb,ub=us.Z.GAMEPLAY_32,pb=ub.KEY,db=ub.FRAME,fb=function(e){function t(t,n){var i;return(i=e.call(this,t,n.x+(n.padding||0),n.y+(n.padding||0),pb,db.GEM)||this).scene=void 0,i.canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.imageBreak=void 0,i.imageCollection=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenStartMission=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenFadeOut=void 0,i.setWorldSize(n.width,n.height),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.alpha0=i.alpha,i.scene=t,i.createTweenFadeOut(),i.createImageGameStart(),i.createImageBreak(),i.createImageCollection(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),t.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.createTweenFadeOut=function(){this.tweenFadeOut=this.scene.add.tween({targets:[this],duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:this.alpha,to:0},scale:{from:this.scale,to:0},paused:!0})},n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:pb,frame:db.GEM_WHITE}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageCollection=function(){this.imageCollection=this.scene.make.image({key:pb,frame:db.GEM_WHITE}),this.imageCollection.setVisible(!1),this.imageCollection.setScale(this.scale0),this.imageCollection.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:pb,frame:db.GEM_SILVER}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:pb,frame:db.GEM_GLARE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:1200,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:pb,frame:db.GEM_LIGHT}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var e=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:e,to:0,start:e},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:150,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:.2,to:.68},paused:!0})},n.showImageHighlight=function(){var e=this.frame.name+"_light";this.imageHighlight.setFrame(e),this.imageHighlight.setVisible(!0).setAlpha(1)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(e){this.rateShaking=e},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageCollection=function(){this.imageCollection.x=this.x0,this.imageCollection.y=this.y0,this.imageCollection.rotation=0,this.imageCollection.scale=this.scale0,this.imageCollection.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.x=this.x0,this.imageGameOver.y=this.y0,this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(){this.resetImageBreak(),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play(),this.tweenScaleDown.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var e=this.alpha0<90?1:-1;this.t0+=3e3/1900;var t=.016*this.t0,n=pu(this.v0,this.alpha0,t),i=du(this.v0,this.alpha0,t);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,this.imageBreak.rotation+=.04*e,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,s=a.width,r=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>s||this.imageBreak.y-this.imageBreak.displayHeight/2>r)&&(this.status="")},n.playAnimFadeOut=function(){this.tweenFadeOut.play()},t}(Phaser.GameObjects.Image),mb=fb,gb=n(87922),vb=n(66573),yb=function(){function e(e){this.scene=void 0,this.tweenScaleUp=void 0,this.tweenScaleDown=void 0,this.tweenMoveTo=void 0,this.target=void 0,this.handleOnComplete=void 0,this.playing=void 0,this.path=void 0,this.scene=e,this.path=new Phaser.Curves.Path}var t=e.prototype;return t.runScaleUpAnimation=function(e,t){var n;null==(n=this.tweenScaleUp)||n.remove(),this.tweenScaleUp||(this.tweenScaleUp=new gb.Z({targets:[this.target],delay:e,duration:t,props:{scale:"+=0.05"}})),this.tweenScaleUp.play()},t.runScaleDownAnimation=function(e,t){var n;null==(n=this.tweenScaleDown)||n.remove(),this.tweenScaleDown||(this.tweenScaleDown=new vb.Z({targets:[this.target],delay:e,duration:t,props:{scale:"-=0.15"}})),this.tweenScaleDown.play()},t.runAnimMoveToPosition=function(e,t,n,i){var a=this;this.playing=!0,this.target.setDepth(ms.Z.ON_TOP);var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=Math.abs(n-s)/2,c=Math.abs(i-r),h=Phaser.Math.Between(1,2),l=[],u=1;u<4;u++){var p=-1;u%2==0&&(p=1);var d=(o-p*Phaser.Math.Between(o/4,o/3))*h,f=r-u*(c/4);l.push(new Phaser.Math.Vector2(d,f))}l.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(l),this.path.lineTo(n,i);var m=new Phaser.Curves.Spline(l);this.tweenMoveTo=this.scene.add.tween({delay:e,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:t,onUpdate:function(e){var t=e.getValue(0),n=m.getPoint(t);a.target.setPosition(n.x,n.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}})},t.runGemMoveToPosition=function(e,t,n,i){var a=this;this.playing=!0;var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=this.scene.gameZone.width/2,c=Math.abs(n-s)+o-50,h=Math.abs(i-r),l=[],u=1;u<4;u++){var p=-1;u%2==0&&(p=1);var d=1.5*(c-p*Phaser.Math.Between(c/8,c/7)),f=r-u*(h/4);l.push(new Phaser.Math.Vector2(d,f))}l.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(l),this.path.lineTo(n,i);var m=new Phaser.Curves.Spline(l);return this.tweenMoveTo=this.scene.add.tween({delay:e,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:t,onUpdate:function(e){var t=e.getValue(0),n=1-t+.1,i=m.getPoint(t);a.target.setAlpha(n),a.target.setPosition(i.x,i.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}}),this.tweenMoveTo},t.setTarget=function(e){this.target=e},(0,V.Z)(e,[{key:"onComplete",set:function(e){this.handleOnComplete=e}},{key:"isPlaying",get:function(){return this.playing}}]),e}(),Sb=function(){function e(e){this.scene=void 0,this.listAnimCollectionItem=[],this.scene=e}var t=e.prototype;return t.handleShowEffect=function(e){var t=this;if(e&&0!==e.length){for(var n=this.scene.header.collectItems.getTargetKeys(),i=this.scene.header.collectItems.getJsonAmount(),a=this.scene.header.collectItems.getJsonTarget(),s=0,r=function(){var r=n[o],c=E()(e).call(e,(function(e){return e.frame===r}));i[r]+c.length>=a[r]&&s++,t.showEffect(c)},o=0;o<n.length;o++)r();s===te()(a).length&&this.scene.setLevelCompleted(!0),this.scene.time.delayedCall(2e3,(function(){t.scene.handleCollectionItemsComplete()}))}},t.showEffect=function(e){for(var t=this,n=e.length,i=this.scene.main.board.dataBoard,a=function(){var a=e[s],r=a.x,o=a.y,c=a.frame,h=i[o][r].cell,l=h.imageCollection,u=t.scene.gameZone.width/2,p=t.scene.header.collectItems.getPositionCollectionItem(c),d=u+p.x,f=p.y-33,m=t.getFreeAnim();h.resetImageCollection(),l.setVisible(!0),l.setFrame(ov[c]),m.setTarget(l),m.onComplete=function(){(n--,l.setVisible(!1),l.setPosition(h.x,h.y),t.scene.header.collectItems.collectItem(c),n<=0)&&(t.scene.header.collectItems.getCollectItemByKey(c).runAnimCollectionItem(),t.scene.updateMatchData())},m.runScaleUpAnimation(0,300),m.runScaleDownAnimation(450,400),m.runAnimMoveToPosition(700,Phaser.Math.Between(500,1e3),d,f)},s=0;s<e.length;s++)a()},t.getFreeAnim=function(){var e=new yb(this.scene);return this.listAnimCollectionItem.push(e),e},e}(),Eb=Sb,Ab=function(){function e(e){this.angle=void 0,this.scene=void 0,this.scaleUpTween=void 0,this.breakingTween=void 0,this.breakingDelay=0,this.captureCells=void 0,this.timerEventRemoveCaptureCells=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){this.createTweenBreaking()},t.handleShowEffect=function(e){var t=this;e&&0!==e.length&&(this.removeCaptureCell(),this.captureCells=e,this.setValueCaptureCell(),this.breakingTween.resetTweenData(!1),this.breakingTween.restart(),this.timerEventRemoveCaptureCells&&this.timerEventRemoveCaptureCells.remove(),this.timerEventRemoveCaptureCells=this.scene.time.addEvent({delay:500,callback:function(){t.breakingTween.isPlaying()||t.removeCaptureCell()}}))},t.onCaptureCellComplete=function(){if(this.captureCells&&this.scene.main&&this.scene.main.board)for(var e=this.scene.main.board.dataBoard,t=0;t<this.captureCells.length;t++){var n=this.captureCells[t],i=n.x;e[n.y][i].cell.resetImageBreak()}},t.removeCaptureCell=function(){var e=this.scene.main.board.dataBoard;if(this.captureCells)for(var t=0;t<this.captureCells.length;t++){var n=this.captureCells[t],i=n.x;e[n.y][i].cell.resetImageBreak()}},t.setValueCaptureCell=function(){for(var e=this.scene.main.board.dataBoard,t=Math.round(68.25),n=0;n<this.captureCells.length;n++){var i=Phaser.Math.Between(50,t),a=Phaser.Math.Between(82,98)*Math.PI/180,s=Phaser.Math.Between(3,10)/1e3,r=this.captureCells[n],o=r.x,c=e[r.y][o].cell;c.maxScale0=Phaser.Math.FloatBetween(2.5,4)/10,c.imageBreak.setVisible(!0),c.imageBreak.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM),c.v0=i,c.alpha0=a,c.scaleRate0=s}},t.createTweenBreaking=function(){var e=this;this.breakingTween=this.scene.tweens.addCounter({from:0,to:1900,onUpdate:function(t){if(e.captureCells)for(var n=e.scene.main.board.dataBoard,i=0;i<e.captureCells.length;i++){e.angle=Phaser.Math.Between(-15,15);var a=e.captureCells[i],s=a.x,r=n[a.y][s].cell,o=r.imageBreak,c=r.maxScale0,h=r.alpha0<1.57?1:-1,l=.016*t.getValue(),u=pu(r.v0,r.alpha0,l),p=du(r.v0,r.alpha0,l);o.setVisible(!0),o.x=r.x0+u,o.y=r.y0+-p,o.rotation+=.04*h,o.scale>c?o.scale-=r.scaleRate0:o.scale=c}},onComplete:function(){e.onCaptureCellComplete()},delay:this.breakingDelay,duration:2500}).stop()},e}(),bb=Ab,Tb="score",Cb="collect",Pb=us.Z.GAMEPLAY,wb=Pb.KEY,Ib=Pb.FRAME,kb=us.Z.GAMEPLAY_32,xb=kb.KEY,_b=kb.FRAME,Ob=GameCore.Configs.Board,Db=Ob.cols,Rb=Ob.rows,Mb=(us.Z.DEFAULT.FRAME,GameCore.Configs.Gameplay.VibrateValue),Lb=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.suggestCells=[],a.pX=void 0,a.pY=void 0,a.borderLeftSize=.1,a.borderTopSize=.1,a.cellSize=void 0,a.cellPadding=void 0,a.diceSize=void 0,a.dataBoard=[],a.cellsHighlight=[],a.cellSharking=[],a.boardFrame=void 0,a.woodenEffect=void 0,a.collectionEffect=void 0,a.canCaptureLines=function(e,t){void 0===t&&(t=5);for(var n=e.length,i=e[0].length,a=[],r=[],o=[],c=0;c<n;c++){for(var h=0,l={x:-1,y:-1},u=0;u<i;u++)0===c&&(o[u]={count:0,x:-1,y:-1}),1===e[c][u].value?(o[u].count++,h++):(l.x=u,l.y=c,o[u].x=u,o[u].y=c);if(h===i-1&&r.push((0,s.Z)({row:c},l)),c===n-1)for(var p=0;p<i;p++)o[p].count===n-1&&a.push((0,s.Z)({col:p},o[p]))}if(r.length>=t)for(var d=0,f={x:-1,y:-1},m=0;m<r.length;m++)if(0!==m){if(r[m].x===f.x&&r[m].y===f.y+1?(f.x=r[m].x,f.y=r[m].y,d++):d=1,d>=t)return{isCapture:!0,direction:"vertical",minLine:t}}else f.x=r[m].x,f.y=r[m].y,d++;if(a.length>=t)for(var g=0,v={x:-1,y:-1},y=0;y<a.length;y++)if(0!==y){if(a[y].x===v.x+1&&a[y].y===v.y?(v.x=a[y].x,v.y=a[y].y,g++):g=1,g>=t)return{isCapture:!0,direction:"horizontal",minLine:t}}else v.x=a[y].x,v.y=a[y].y,g++;return{isCapture:!1,direction:"",minLine:t}},a.scene=t,a.setSize(n,i),a.woodenEffect=new bb(a.scene),a.collectionEffect=new Eb(a.scene),a.init(),a}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createBoard(),this.calcCellLength(),this.initDataBoard()},n.createBoard=function(){var e=this.scene.gameZone,t=e.width/2,n=e.height/2-9;this.boardFrame=this.scene.make.image({x:t,y:n,key:wb,frame:Ib.BOARD}),this.boardFrame.setWorldSize(this.width,this.height)},n.calcCellLength=function(){this.cellPadding=0,this.cellSize=(this.width-2*this.borderLeftSize-this.cellPadding*(Db+1))/Db},n.initDataBoard=function(){for(var e=this.boardFrame.x-this.boardFrame.displayWidth/2+this.cellSize/2+this.borderLeftSize,t=this.boardFrame.y-this.boardFrame.displayHeight/2+this.cellSize/2+this.borderTopSize,n=0;n<Rb;n++){this.dataBoard[n]=[];for(var i=0;i<Db;i++){var a=e+i*this.cellSize+this.cellPadding*i,s=t+n*this.cellSize+this.cellPadding*n,r={x:a,y:s,width:this.cellSize,height:this.cellSize,texture:xb,frame:_b.GEM_TRANSPARENT,depth:ms.Z.PIECE-.1,padding:this.cellPadding,isWoodenEffect:!0},o=new mb(this.scene,r);o.setVisible(!1),this.dataBoard[n][i]={x:a,y:s,width:this.cellSize,height:this.cellSize,frame:_b.GEM_TRANSPARENT,value:0,cell:o}}}},n.handleHighlight=function(e,t){this.cellsHighlight=e;for(var n=0;n<e.length;n++){var i=e[n],a=i.x,s=i.y,r=i.frame;if(this.dataBoard[s]&&this.dataBoard[s][a]&&0===this.dataBoard[s][a].value){var o=this.dataBoard[s][a].cell;this.dataBoard[s][a].frame=r||_b.GEM,o.setVisible(!0),o.setFrame(r||_b.GEM),o.setAlpha(.3)}}this.canCaptureCells(e,t)},n.handleTweenStartMission=function(){for(var e=this,t=100,n=0;n<Rb;n++)for(var i=function(){var i=e.dataBoard[n][a].cell,s=0;s=4==n&&4==a?t:n>=3&&n<=5&&a>=3&&a<=5?200:n>=2&&n<=6&&a>=2&&a<=6?300:n>=1&&n<=7&&a>=1&&a<=7?400:500,e.scene.time.delayedCall(s,(function(){i.playTweenStartMission()}))},a=0;a<Db;a++)i()},n.handleCapturePiece=function(e){var t=this;try{if(!e||e.length<=0)throw Av=0,new Error("Invalid Capture");var n=E()(e).call(e,(function(e){return e.frame!==_b.GEM}));this.collectionEffect.handleShowEffect(n);for(var i=0,a=300,s=gv(this.dataBoard),r=vv(this.dataBoard),o=uv(),c=Tv(),h=function(){var n=e[l],h=n.x,u=n.y,p=t.dataBoard[u][h].cell,d=0,f=0,m=0;if(m=u,s.length>0&&r.length>0){var g=0,v=0;i=a/Db,-1!==xt()(s).call(s,u)&&-1===xt()(r).call(r,h)&&(g=i*h,v=0,f=xt()(s).call(s,u)),-1===xt()(s).call(s,u)&&-1!==xt()(r).call(r,h)&&(g=0,v=i*u,f=xt()(r).call(r,h)),-1!==xt()(s).call(s,u)&&-1!==xt()(r).call(r,h)&&(g=i*h,v=i*u,f=Math.max(xt()(r).call(r,h),xt()(s).call(s,u),0)),-1===xt()(s).call(s,u)&&-1===xt()(r).call(r,h)&&(g=i*h,v=i*u),d=Math.max(g,v,0)}else if(r.length>0)d=(i=a/Db)*u,f=xt()(r).call(r,h),m=u,-1===f&&(f=h-r[0]);else if(s.length>0)d=(i=a/Rb)*h,f=xt()(s).call(s,u),m=h,-1===f&&(f=u-s[0]);else{i=100;var y=e[0].x;d=i*(h-y),(f=e[l].x-y)<0&&(m=0)}p.hideImageHighlight(),t.scene.time.delayedCall(d,(function(){p.resetImageBreak();var e="";o>2||c>2?(e=Td[m]||Td[0],p.imageBreak.setFrame(e)):(e=bd[f]||bd[0],p.imageBreak.setFrame(e)),p.playTweenScaleDown(),0==t.dataBoard[u][h].value&&p.setVisible(!1)})),t.dataBoard[u][h].frame=_b.GEM_TRANSPARENT,t.dataBoard[u][h].value=0},l=0;l<e.length;l++)h()}catch(u){}},n.checkPositionCellOnCaptureCell=function(e,t){var n=E()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return n&&n.length>0},n.handlePraise=function(e,t){if(t&&0!==t.length){var n=bv(),i=uv();i>1&&(n=18*lv+10*(Tv()-1));for(var a=[],s=0;s<e.length;s++){var r=e[s];this.checkPositionCellOnCaptureCell(r,t)&&a.push(r)}if(0!==a.length){for(var o=a[0].pX,c=0,h=a[0].pY,l=0,u=0;u<a.length;u++){var p=a[u];p.pX<o&&(o=p.pX),p.pX>c&&(c=p.pX),p.pY<h&&(h=p.pY),p.pY>l&&(l=p.pY)}var d=o+(c-o)/2,f=h+(l-h)/2;this.scene.main.praise.handlePraise(d,f,n,i),this.handleStreakBreak(d,f),this.playEatSound(i)}}},n.handleStreakBreak=function(e,t){if(this.scene.targetMissionManager.getTargetType()===Tb){var n=uv(),i=Tv()-1;if(e-75<0&&(e=75),e+75>375&&(e=300),!(i<2||n>=2)){var a=i>6?6:i,s=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&kd(s),this.playEatSound(a),this.scene.effectManager.runEffectBubbleDrop(i,e,t-20)}}},n.getVibrateByLevel=function(e){return Mb[e]||0},n.playEatSound=function(e){switch(this.scene.audio.playSound(ds.Z.EAT_BLOCK),e){case 1:default:break;case 2:this.scene.audio.playSound(ds.Z.GOOD);break;case 3:this.scene.audio.playSound(ds.Z.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(ds.Z.EXCELLENT)}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var e=0;e<this.cellsHighlight.length;e++){var t=this.cellsHighlight[e],n=t.x,i=t.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=_b.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(_b.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(s){}},n.canCaptureCells=function(e,t){for(var n=this,i=this.dataBoard,a=[],r=0;r<i.length;r++){a[r]=[];for(var o=0;o<i[r].length;o++)a[r][o]=(0,s.Z)({},i[r][o])}for(var c=0;c<e.length;c++){var h=e[c],l=h.x;a[h.y][l].value=1}this.removeAnimCanCaptureCells(a,e);var u=pv(a,e);if(!u||u.length<=0)return!1;for(var p=function(){var t=u[d],i=t.x,a=t.y;e.some((function(e){return e.x===i&&e.y===a}))||n.cellSharking.push((0,s.Z)({},u[d]))},d=0;d<u.length;d++)p();for(var f=0;f<this.cellSharking.length;f++){var m=this.cellSharking[f],g=m.x,v=m.y,y=this.dataBoard[v][g].cell;y.isHighlight()||y.showImageHighlight()}t(gv(a),vv(a),mv(a,e),e)},n.removeAnimCanCaptureCells=function(e,t){var n=this;if(0!==this.cellSharking.length){for(var i=gv(e),a=vv(e),s=mv(e,t),r=function(){var e=n.cellSharking[o],t=e.x,r=e.y,c=n.dataBoard[r][t].cell;if(-1!==xt()(i).call(i,r)||-1!==xt()(a).call(a,t)||s.some((function(e){return e.x===t&&e.y===r})))return"continue";c.hideImageHighlight()},o=0;o<this.cellSharking.length;o++)r();this.cellSharking=[]}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var e=0;e<this.cellSharking.length;e++){var t=this.cellSharking[e],n=t.x,i=t.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleSuggestMove=function(e){try{this.suggestCells=e;for(var t=0;t<e.length;t++){var n=e[t],i=n.x,a=n.y,s=this.dataBoard[a][i].cell;s.setFrame(_b.GEM_HIGHT_LIGHT),s.setVisible(!0),s.setAlpha(1)}}catch(r){}},n.handleRemoveSuggestMove=function(){try{for(var e=0;e<this.suggestCells.length;e++){var t=this.suggestCells[e],n=t.x,i=t.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(_b.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(s){}},n.handleMove=function(e,t){try{for(var n=0;n<e.length;n++){var i=e[n],a=i.x,s=i.y,r=i.frame,o=void 0===r?_b.GEM:r;if(this.dataBoard[s]&&this.dataBoard[s][a]){this.dataBoard[s][a].frame=o,this.dataBoard[s][a].value=1;var c=this.dataBoard[s][a].cell;c.setVisible(!0),c.setFrame(o),c.setAlpha(1)}}var h=pv(this.dataBoard,e);this.handleCapturePiece(h),this.handlePraise(e,h),t&&t(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(l){}},n.handleResetFrameBoard=function(){for(var e=0;e<Rb;e++)for(var t=0;t<Db;t++)if(this.dataBoard[e]&&this.dataBoard[e][t]&&1===this.dataBoard[e][t].value){var n=this.dataBoard[e][t],a=n.frame,s=n.cell;s.visible||(0,i.tO)(new Error("Cell is invisible")),s.frame.name!==a&&(0,i.tO)(new Error("Cell is frame not true")),s.setVisible(!0).setFrame(a)}},n.handleGameOver=function(){if(!this.scene.isLevelComplete){for(var e=[],t=this.scene.footer.pieces.piecesActive,n=this.scene.footer.pieces.allPieces,i=0;i<t.length;i++){var a=t[i],s=a.position;if(!a.used){var r=n[s].piece;e.push({data:r.data,type:r.type,direction:r.direction,isReverse:r.isReverse,frame:r.frame})}}yv(this.dataBoard,e)&&(this.scene.disableInput(),this.runAnimationGameOver())}},n.runAnimationGameOver=function(){var e=this;try{this.scene.audio.playSound(ds.Z.BOARD_GAME_OVER);for(var t=[],n=function(n){for(var i=function(i){if(e.dataBoard[n]&&e.dataBoard[n][i]&&1===e.dataBoard[n][i].value){var a=Math.floor(100*(n+1));t.push({delay:a,x:i,y:n}),e.scene.time.delayedCall(a,(function(){e.dataBoard[n][i].cell.playAnimImageGameOver()}))}},a=0;a<Db;a++)i(a)},i=0;i<Rb;i++)n(i);this.scene.time.addEvent({delay:t[t.length-1].delay+300,callback:function(){e.scene.handleRequestFinishGame()}})}catch(a){}},n.hasPieceL5=function(){var e=this.scene.footer.pieces.piecesActive;return E()(e).call(e,(function(e){return e.type===Km})).length>0},n.hasPieceCross5=function(){var e=this.scene.footer.pieces.piecesActive;return E()(e).call(e,(function(e){return e.type===ag})).length>0},n.getBoardByFen=function(e){var t=[],n=e.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,s=0;s<a;s++){t[s]=[];for(var r=wv(i[s]),o=0;o<r.length;o++)t[s][o]=r[o]}return t},n.getFenByBoard=function(){for(var e="",t=0;t<Rb;t++){for(var n="",i=0;i<Db;i++){var a=this.dataBoard[t][i],s=a.value,r=a.frame,o=Cv(r)||"g";switch(s){case 0:n+=",x";break;case 1:n+=","+o}}e+="/"+(n=n.substring(1))}return e.substring(1)},n.startGame=function(e,t){if(e){for(var n=0;n<e.length;n++)for(var a=0;a<e[n].length;a++){var s=e[n][a].frame,r=e[n][a].value,o=this.dataBoard[n][a];1===r&&(s&&s!==_b.GEM_TRANSPARENT||((0,i.R0)(new Error("MapByBoardError"),{level:this.scene.levelManager.getLevel(),row:n,col:a,frame:s,fen:t}),s=_b.GEM),o.value=1,o.frame=s,o.cell.setFrame(s),o.cell.setVisible(!0),o.cell.setWorldSize(this.cellSize,this.cellSize),o.cell.setAlpha(0),o.cell.setScale(0))}this.fadeIn()}},n.clearBoard=function(){for(var e=0;e<Rb;e++)for(var t=0;t<Db;t++){var n=this.dataBoard[e][t];n.value=0,n.frame=_b.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(_b.GEM_TRANSPARENT),n.cell.setVisible(!1),n.cell.resetImageGameOver()}},n.isCellHighlight=function(e){var t,n=E()(t=this.cellsHighlight).call(t,(function(t){return t.x===e.x&&t.y&&e.y}));return!!(n&&n.length>0)},n.setFrameBoardByIndex=function(e,t,n){var i=this.dataBoard[e][t],a=i.cell;a.setFrame(n),a.setVisible(!0),i.frame=n,i.value=1,a.setScale(0),a.setAlpha(0)},n.getFrameByMapItemIndex=function(e){return rv[e]},n.fadeOut=function(){for(var e=[],t=0;t<Rb;t++)for(var n=0;n<Db;n++){var i=this.dataBoard[t][n];i.value&&e.push(i.cell)}if(!e||0===e.length)return null;var a=this.scene.add.tween({targets:e,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:1,to:0},scale:{from:e[0].scale,to:0},paused:!0});return a.play(),a},n.fadeIn=function(){for(var e=[],t=0;t<Rb;t++)for(var n=0;n<Db;n++){var i=this.dataBoard[t][n];i.value&&e.push(i.cell)}e&&0!==e.length&&this.scene.add.tween({targets:e,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:e[0].alpha0},scale:{from:0,to:e[0].scale0},paused:!0}).play()},t}(Phaser.GameObjects.Container),Bb=GameCore.Configs.Gameplay.VibrateValue,Nb=us.Z.EFFECTS,Fb=Nb.KEY,Gb=Nb.FRAME,Zb=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenMoveDownScoreText=void 0,n.tweenMoveUpScoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=t,t.add.existing((0,as.Z)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(Fb),this.particle.setDepth(ms.Z.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:Gb.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(50),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setTint(3049197),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(ms.Z.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var e=this;this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},delay:650,duration:185,onComplete:function(){e.tweenMoveDownScoreText=e.scene.tweens.add({targets:e.scoreText,y:"+=5",duration:170,delay:170,onComplete:function(){e.tweenMoveUpScoreText=e.scene.tweens.add({targets:e.scoreText,y:"-=21",duration:340,onComplete:function(){e.tweenHideScoreText=e.scene.tweens.add({targets:e.scoreText,y:"-=6",alpha:{from:1,to:0},duration:185,onComplete:function(){e.scoreText.setVisible(!1),e.scoreText.setAlpha(0),e.scoreText.setScale(0),e.scene.handleAddScoreAnim(e.score||0)}})}})}})}})},n.playAnimShowScoreText=function(){var e,t;if(null==(e=this.tweenMoveDownScoreText)||e.stop(),null==(t=this.tweenMoveUpScoreText)||t.stop(),this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var n=this.scene.storage.getState(),i=0;hc(n)===xa&&(i=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(i+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(i+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:Fb}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(ms.Z.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var e=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var t=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:t},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){e.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:t,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){e.praiseFrame.setScale(0),e.praiseFrame.setAlpha(0),e.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(ms.Z.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(e,t,n,i){this.startX=e,this.startY=t+15,this.listScore.push(n);var a=e-10,s=this.scene.targetMissionManager.getTargetType()===Tb;this.scoreText.setPosition(a,t+15),this.scoreText.setText("+"+n),this.scoreText.setVisible(s),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,t+15)),s&&(this.playAnimShowScoreText(),this.handlePraiseFrameText(e,t,i));var r=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&kd(r),i<=1||this.changeExplode(a,t,i)},n.getVibrateByLevel=function(e){return Bb[e]||0},n.changeExplode=function(e,t,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,e,t)},n.handlePraiseFrameText=function(e,t,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,s=0,r=this.scene.targetMissionManager.getTargetType()===Tb?-40:0;switch(i){case Gb.TEXT_COOL:a=84,s=30;break;case Gb.TEXT_GOOD:a=115.5,s=30;break;case Gb.TEXT_EXCELLENT:a=207,s=30}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,s),this.praiseFrame.setPosition(e-a/2<0?a/2:e,t+r),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(e){return Zm[e-1]||Zm[0]||null},n.getMainFrameByLevel=function(e){var t=Gm[e-1]||Gm[0];return Phaser.Utils.Array.GetRandom(t.frames)},n.reset=function(){this.createTweenScoreText()},t}(Phaser.GameObjects.Container),Ub=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.board=void 0,n.praise=void 0,n.scene=t,t.add.existing((0,as.Z)(n)),n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createBoard(),this.createPraise()},n.createBoard=function(){this.board=new Lb(this.scene,306,306)},n.createPraise=function(){this.praise=new Zb(this.scene)},t}(Phaser.GameObjects.Container),Hb=Ub,Vb=us.Z.GAMEPLAY,Wb=Vb.KEY,Yb=Vb.FRAME,zb=function(e){function t(t){var n;return(n=e.call(this,t,Wb,Yb.BLANK)||this).button.setVisible(!1),n.setName("Back"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Wb,frame:Yb.ICON_BACK});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(fs.Z),Kb=zb,jb=us.Z.GAMEPLAY,Xb=jb.KEY,qb=jb.FRAME,Jb=us.Z.GAMEPLAY_32,Qb=Jb.KEY,$b=Jb.FRAME,eT=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.imageGem=void 0,n.imageCheck=void 0,n.text=void 0,n.particle=void 0,n.emitter=void 0,n.currentPosition=void 0,n.imageGlow=void 0,n.tweenGlow=void 0,n.imageGlowCrop=void 0,n.tweenCropMaskTopDown=void 0,n.tweenCropMaskDownBottom=void 0,n.imageStar=void 0,n.tweenShowStar=void 0,n.tweenHideStar=void 0,n.tweenShowMe=void 0,n.scene=t,n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createImageGem(),this.createImageCheck(),this.createText(),this.createParticle(),this.createEmitter(),this.createGlow(),this.createTweenGlow(),this.createGlowCrop(),this.createStar(),this.createTweenStar(),this.createTweenShowMe()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:Qb,frame:$b.ICON_STAR_1}),this.imageGem.setWorldSize(22,22),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,0)},n.createImageCheck=function(){this.imageCheck=this.scene.make.image({key:Xb,frame:qb.ICON_CHECK}),this.imageCheck.setWorldSize(11,8),this.imageCheck.setVisible(!1),this.add(this.imageCheck),Phaser.Display.Align.In.Center(this.imageCheck,this.imageGem,20)},n.createText=function(){this.text=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5}}),this.text.setTint(262685),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.imageGem,22,2)},n.createParticle=function(){this.particle=this.scene.add.particles(Xb).setDepth(ms.Z.ON_TOP)},n.createEmitter=function(){var e=1.5/this.scene.world.getPixelRatio();this.emitter=this.particle.createEmitter({on:!1,angle:{start:0,end:360,steps:8},frame:[qb.DUST],lifespan:1e3,quantity:1,scale:{start:e,end:0,ease:"Quart.easeIn"},speed:50})},n.createGlow=function(){this.imageGlow=this.scene.make.image({key:Xb,frame:qb.VIOLET_GLOW}),this.imageGlow.setVisible(!1).setScale(0).setAlpha(0),this.add(this.imageGlow),Phaser.Display.Align.In.Center(this.imageGlow,this.imageGem)},n.createTweenGlow=function(){var e=this;this.tweenGlow=this.scene.tweens.add({targets:[this.imageGlow],paused:!0,scale:{from:0,to:.6},alpha:{from:0,to:1},delay:100,duration:600,onComplete:function(){e.imageGlow.setVisible(!1).setScale(0).setAlpha(0),e.playAnimMaskCrop(),e.playAnimStar()}})},n.createGlowCrop=function(){this.imageGlowCrop=this.scene.make.image({key:Xb,frame:qb.MASK}),this.imageGlowCrop.setVisible(!1),this.imageGlowCrop.setWorldSize(this.imageGem.displayWidth,this.imageGem.displayHeight),this.add(this.imageGlowCrop),Phaser.Display.Align.In.Center(this.imageGlowCrop,this.imageGem)},n.createStar=function(){this.imageStar=this.scene.make.image({key:Xb,frame:qb.ICON_STAR_1}),this.imageStar.setVisible(!1).setScale(0).setAlpha(0),this.imageStar.setWorldSize(27,26),this.add(this.imageStar),Phaser.Display.Align.In.Center(this.imageStar,this.imageGem,-10,-10)},n.createTweenStar=function(){var e=this;this.tweenHideStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:1,to:0},alpha:{from:1,to:0},delay:100,duration:500,onComplete:function(){e.imageStar.setVisible(!1).setScale(0).setAlpha(0)}}),this.tweenShowStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:0,to:1},alpha:{from:0,to:1},delay:100,duration:500,onComplete:function(){e.tweenHideStar.play()}})},n.createTweenShowMe=function(){this.tweenShowMe=this.scene.add.tween({paused:!0,targets:[this],alpha:{from:0,to:1},duration:200})},n.cropTopDownImageGlow=function(){var e=this;if(!this.tweenCropMaskTopDown){var t=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskTopDown=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*t;e.imageGlowCrop.setCrop(0,0,n/i,r/a)},onComplete:function(){e.cropDownBottomImageGlow()}})}this.tweenCropMaskTopDown.play()},n.cropDownBottomImageGlow=function(){var e=this;if(!this.tweenCropMaskDownBottom){var t=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskDownBottom=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*t;e.imageGlowCrop.setCrop(0,r/a,n/i,t/a)}})}this.tweenCropMaskDownBottom.play()},n.playAnimStar=function(){this.imageStar.setVisible(!0),this.tweenShowStar.play()},n.playAnimMaskCrop=function(){this.imageGlowCrop.setVisible(!0).setCrop(0,0,0,0),this.cropTopDownImageGlow()},n.setFrame=function(e){this.imageGem.setFrame(e)},n.getFrame=function(){return this.imageGem.frame.name},n.setText=function(e,t){var n=t-e;n<0&&(n=0),this.text.setText("x"+n)},n.completeMission=function(){this.imageGem.setAlpha(.3),this.text.setAlpha(.3),this.text.setVisible(!1),this.imageCheck.setVisible(!0)},n.reset=function(){this.imageGem.setAlpha(1),this.text.setAlpha(1),this.imageCheck.setVisible(!1),this.text.setVisible(!0)},n.updateCurrentPosition=function(e){this.currentPosition=e},n.runAnimCollectionItem=function(){var e=this.scene.gameZone.width/2;this.tweenGlow.play(),this.emitter.explode(8,e+this.currentPosition.x,this.currentPosition.y-33)},n.playAnimShowMe=function(){this.setVisible(!0).setAlpha(0),this.tweenShowMe.play()},t}(Phaser.GameObjects.Container),tT=us.Z.GAMEPLAY,nT=(tT.KEY,tT.FRAME,function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.target=void 0,n.targetKeys=[],n.jsonPosition={},n.jsonAmount={},n.jsonTarget={},n.jsonCollectItem={},n.textMission=void 0,n.listCollectItems=[],n.scene=t,n}(0,o.Z)(t,e);var n=t.prototype;return n.calcPosition=function(e){for(var t=[],n=250/(e+1),i=n*(e-1)/2,a=0;a<e;a++)t.push(n*a-i);return t},n.parseTargetToJson=function(){if(!(0,mm.isObject)(this.target)){for(var e=JSON.parse(this.target),t=te()(e),n=[],i=0;i<t.length;i++){var a=t[i],s=rv[a];ce()(n).call(n,s)||n.push(s)}for(var r=this.calcPosition(n.length),o=0;o<t.length;o++){var c,h=t[o],l=rv[h];if(!ce()(c=this.targetKeys).call(c,l)){this.targetKeys.push(l),this.jsonAmount[l]=0,this.jsonTarget[l]=e[h],this.jsonPosition[l]={x:r[o],y:68};var u=this.listCollectItems[o];u||(u=new eT(this.scene),this.add(u),this.listCollectItems.push(u)),u.updateCurrentPosition(this.jsonPosition[l]),u.setVisible(!0),u.setX(r[o]),u.setFrame(ov[l]),u.setText(0,e[h]),this.jsonCollectItem[l]=u}}}},n.hideListCollectItems=function(){this.listCollectItems.forEach((function(e){e.setVisible(!1),e.reset()}))},n.showListCollectItems=function(){this.listCollectItems.forEach((function(e){e.reset(),e.playAnimShowMe()}))},n.showCollectItemByKey=function(e){var t,n=E()(t=this.listCollectItems).call(t,(function(t){return t.getFrame()===ov[e]}));n&&0!==n.length&&(this.jsonAmount[e]>=this.jsonTarget[e]?n[0].completeMission():n[0].reset(),n[0].playAnimShowMe())},n.start=function(){this.parseTargetToJson()},n.setTargets=function(e){for(var t,n,i=Jf()(t=Jf()(n=Jf()(e).call(e,"{",'{"')).call(n,", ",', "')).call(t,":",'":'),a=JSON.parse(i),s=te()(a),r={},o={},c=0;c<s.length;c++){var h=s[c],l=rv[h];r[l]||(r[l]=!0,o[h]=a[h])}this.target=rt()(o)},n.collectItem=function(e){if(e in this.jsonAmount){this.jsonAmount[e]++;var t=this.jsonAmount[e],n=this.jsonTarget[e];t===n&&this.jsonCollectItem[e].completeMission(),this.jsonCollectItem[e].setText(t,n)}},n.checkCompleteMission=function(){for(var e=te()(this.jsonTarget),t=0;t<e.length;t++){var n=e[t];if(this.jsonTarget[n]>this.jsonAmount[n])return!1}return!0},n.reset=function(){this.hideListCollectItems(),this.targetKeys=[],this.jsonAmount={},this.jsonTarget={},this.jsonCollectItem={},this.jsonPosition={}},n.getPositionCollectionItem=function(e){return this.jsonPosition[e]},n.getTargetKeys=function(){return this.targetKeys},n.getJsonAmount=function(){return this.jsonAmount},n.getJsonTarget=function(){return this.jsonTarget},n.getCollectItemByKey=function(e){return this.jsonCollectItem[e]},n.updateJsonAmountByFen=function(e){this.jsonAmount=JSON.parse(rt()(e));for(var t=te()(this.jsonTarget),n=0;n<t.length;n++){var i=t[n],a=this.jsonCollectItem[i];this.jsonTarget[i]>this.jsonAmount[i]?a.reset():a.completeMission(),a.setText(this.jsonAmount[i],this.jsonTarget[i])}},n.resetTextAmount=function(){for(var e=te()(this.jsonTarget),t=0;t<e.length;t++){var n=e[t],i=this.listCollectItems[t];i&&i.setText(0,this.jsonTarget[n])}},t}(Phaser.GameObjects.Container)),iT=us.Z.GAMEPLAY,aT=(iT.KEY,iT.FRAME,function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scoreText=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=0,n.scene=t,n.scene.add.existing((0,as.Z)(n)),n.createScoreText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(52),text:"0",origin:{x:.5,y:.5}}),this.scoreText.setTint(3304186),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this)},n.setScore=function(e){this.score=e},n.setScoreText=function(e){this.scoreText.setText(String(e))},n.animAddScore=function(e){var t=this;if(this.addScore&&this.addScore.isPlaying()){this.addScore.stop();var n=this.score+e;this.setScore(n),this.setScoreText(n)}this.addScore=this.scene.tweens.addCounter({from:0,to:e,duration:100,onUpdate:function(e){var n=t.score+Math.floor(e.getValue());t.setScoreText(n),t.scene.updateProgressTargetScore(n)},onComplete:function(){var n=t.score+e;t.setScore(n),t.setScoreText(n),t.scene.handleCompleteScoreMission()}})},n.reset=function(){this.setScore(0),this.setScoreText(0)},t}(Phaser.GameObjects.Container)),sT=aT,rT=us.Z.GAMEPLAY,oT=rT.KEY,cT=rT.FRAME,hT=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.titleTargetScore=void 0,a.iconCup=void 0,a.glareCup=void 0,a.textTargetScore=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.setSize(n,i),a.scene=t,a.init(),a}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createGlareCup(),this.createParticle(),this.createEmitter(),this.createTweenGlare(),this.createTitleTargetScore(),this.createTextTargetScore(),this.createIconCup()},n.initBg=function(){this.leftBg=this.scene.make.image({key:oT,frame:cT.PROGRESS_BG_LEFT}),this.midBg=this.scene.make.image({key:oT,frame:cT.PROGRESS_BG_MID}),this.rightBg=this.scene.make.image({key:oT,frame:cT.PROGRESS_BG_RIGHT});var e=this.leftBg,t=e.width,n=e.height,i=t*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,s=a.width,r=a.height,o=s*this.height/r;this.rightBg.setWorldSize(o,this.height);var c=this.width-(i+o);this.midBg.setWorldSize(c,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:oT,frame:cT.PROGRESS_BAR_LEFT}),this.midProgress=this.scene.make.image({key:oT,frame:cT.PROGRESS_BAR_MID}),this.rightProgress=this.scene.make.image({key:oT,frame:cT.PROGRESS_BAR_RIGHT});var e=this.leftProgress,t=e.width,n=e.height,i=t*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,s=a.width,r=a.height,o=s*this.height/r;this.rightProgress.setWorldSize(o,this.height);var c=this.width-(i+o)+2;this.midProgress.setWorldSize(c,this.height),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createTitleTargetScore=function(){this.titleTargetScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(15),text:"TARGET SCORE"}),this.titleTargetScore.setTint(10526880),this.add(this.titleTargetScore),Phaser.Display.Align.In.RightCenter(this.titleTargetScore,this,0,20)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:oT,frame:cT.ICON_CUP_GREY}),this.iconCup.setWorldSize(12,12),this.add(this.iconCup)},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(27),text:"0"}),this.textTargetScore.setTint(6842231),this.textTargetScore.setOrigin(1,.5),this.add(this.textTargetScore),Phaser.Display.Align.In.RightCenter(this.textTargetScore,this,0,37)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:oT,frame:cT.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new td.Z({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(oT),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.2,max:.5},speed:{min:10,max:20},lifespan:{min:300,max:700},quantity:1,on:!1,frame:cT.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-72,34)},n.createMilestoneFrame=function(){var e=this.scene.make.image({key:oT,frame:cT.BLANK});return e.setWorldSize(16,22),e},n.getMilestoneFrame=function(){var e,t=E()(e=this.listPoolMilestoneFrame).call(e,(function(e){return!e.visible}));if(!t||0===t.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return t[0]},n.handleSetAlphaListMilestone=function(e){this.listMilestoneFrame.forEach((function(t){t.score<=e?t.frame.setAlpha(1):t.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(e){e>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(e){e.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(e){this.targetScore=e,this.textTargetScore.setText(""+e),Phaser.Display.Align.In.LeftCenter(this.iconCup,this.textTargetScore,18,-2),Phaser.Display.Align.In.Center(this.glareCup,this.iconCup,0,0)},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(e){var t=e*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth;if(e>=1){if(this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}return this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,t<n?(this.leftProgress.setVisible(!0),void this.leftProgress.setCrop(0,0,t/this.leftProgress.scaleX,2*this.height)):t>n+i?(this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),void this.rightProgress.setCrop(0,0,(t-(n+i-2))/this.rightProgress.scaleX,2*this.height)):(this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),void this.midProgress.setCrop(0,0,(t-n)/this.midProgress.scaleX,2*this.height))},t}(Phaser.GameObjects.Container),lT=us.Z.GAMEPLAY,uT=lT.KEY,pT=lT.FRAME,dT=function(e){function t(t){var n;return(n=e.call(this,t,uT,pT.BLANK)||this).button.setVisible(!1),n.setName("Setting"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:uT,frame:pT.ICON_SETTING});e.setWorldSize(19,21),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(fs.Z),fT=dT,mT=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.buttonBack=void 0,n.buttonSetting=void 0,n.mainScoreBlock=void 0,n.progressBar=void 0,n.collectItems=void 0,n.scene=t,n.setSize(n.scene.gameZone.width,0),t.add.existing((0,as.Z)(n)),n.createBackButton(),n.createSettingButton(),n.createMainScoreBlock(),n.createProgressBar(),n.createCollectItems(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createMainScoreBlock=function(){this.mainScoreBlock=new sT(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,44)},n.createBackButton=function(){this.buttonBack=new Kb(this.scene),this.buttonBack.onClick=this.handleBack.bind(this),this.add(this.buttonBack),Phaser.Display.Align.In.Center(this.buttonBack,this,-159,41)},n.handleBack=function(){var e=this.scene.storage.getState(),t=(0,xp.V)(e);this.scene.scene.switch(t)},n.createSettingButton=function(){this.buttonSetting=new fT(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,159,41)},n.createProgressBar=function(){this.progressBar=new hT(this.scene,306,8),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,0,92),this.progressBar.setVisible(!1)},n.createCollectItems=function(){this.collectItems=new nT(this.scene),this.add(this.collectItems),Phaser.Display.Align.In.Center(this.collectItems,this,0,36),this.collectItems.setVisible(!1)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1)},n.start=function(){switch(this.scene.targetMissionManager.getTargetType()){case Tb:this.targetScore();break;case Cb:this.targetCollect()}},n.targetScore=function(){var e=parseInt(this.scene.targetMissionManager.getTargetValue()),t=this.scene.storage.getState(),n=Xc(t)||0;(0,mm.isArray)(e)||(this.progressBar.reset(),this.progressBar.setVisible(!0),this.progressBar.setTargetScore(e),this.progressBar.setPercent(n/e),this.scene.header.mainScoreBlock.reset(),this.scene.header.mainScoreBlock.setVisible(!0),this.scene.header.mainScoreBlock.setScore(n),this.scene.header.mainScoreBlock.setScoreText(n),this.collectItems.setVisible(!1))},n.targetCollect=function(){this.collectItems.reset(),this.mainScoreBlock.setVisible(!1),this.progressBar.setVisible(!1);var e=this.scene.targetMissionManager.getTargetValue();this.collectItems.setTargets(e),this.collectItems.setVisible(!0),this.collectItems.start()},t}(Phaser.GameObjects.Container),gT=mT,vT=n(10793),yT=us.Z.GAMEPLAY_32,ST=yT.KEY,ET=yT.FRAME,AT=GameCore.Configs.Board,bT=AT.cols,TT=AT.rows,CT=function(e){function t(n,i,a){var s;return(s=e.call(this,n)||this).scene=void 0,s.type=void 0,s.direction=void 0,s.isReverse=!1,s.data=[],s.matrixData=void 0,s.texture=void 0,s.frame=void 0,s.maxHeight=void 0,s.cellItems=[],s.originalData=void 0,s.isSetDrag=!1,s.isCreateCell=!1,s.wrap=void 0,s.wrapPiece=void 0,s.isDragEnd=!1,s.isActive=!0,s.isVisible=!0,s.pointerY=void 0,s.parentHeight=void 0,s.index=void 0,s.props=void 0,s.cells=[],s.parent=void 0,s.moveTopNumber=30,s.backupPx=void 0,s.backupPy=void 0,s.animMoveTopAndScaleUp=void 0,s.animMoveDownAndScaleDown=void 0,s.animScaleUp=void 0,s.animScaleDown=void 0,s.distancePY=void 0,s.isCanMove=void 0,s.correctAlpha=1,s.props=a,s.type=a.type,s.matrixData=a.matrixData,s.data=t.buildData(s.matrixData),s.direction=a.direction||null,s.parentHeight=a.parentHeight||0,s.isReverse=a.isReverse||!1,s.parent=i,s.scene=n,s.scene.add.existing((0,as.Z)(s)),s.createWrapPiece(),s.listenEvents(),s}(0,o.Z)(t,e);var n=t.prototype;return n.createWrapPiece=function(){var e=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:ST,frame:ET.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(e,e)},n.updatePosition=function(e,t){var n=this.getContainerSize(),i=n.width,a=n.height,s=this.parent.cellSize,r=this.scene.gameZone.width;this.setPosition(e+r/6-i/2+s/2,t-a/2+s/2),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(e,t){this.wrapPiece.setPosition(e+this.wrapPiece.displayWidth/2,t-20)},n.listenEvents=function(){var e=this;this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,(function(){e.parent.playTweenToEnableMaxFps()})),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,(function(t){e.handleDragStart(t)})),this.wrapPiece.on(Phaser.Input.Events.DRAG,(function(t){e.handleDrag(t)})),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,(function(){e.handleDragEnd(),e.parent.stopTweenToEnableMaxFps()}))},n.setIndex=function(e){this.index=e},n.updateDataPiece=function(e){this.data=e},n.setInteractiveContainer=function(){var e=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,e/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.handleDragStart=function(e){var t,n,i=this;if(!this.scene.isGameOver&&!this.scene.isLevelComplete&&this.isCanMove){if(this.scene.tutorialManager.isRunning()){if(!this.scene.tutorialManager.validStep(this.index))return;this.scene.tutorialManager.stopAnimHand()}null==(t=this.animScaleUp)||t.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(ms.Z.PIECE+1),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.audio.playSound(ds.Z.PIECE_PICK);var a=this.scene.main.board.cellSize/this.parent.cellSize,s=this.getContainerSize(),r=s.width,o=s.height,c=e.worldX+this.parent.cellSize*a/2-r*a/2,h=0;if(hu())h=e.worldY+this.parent.cellSize*a/2-o*a;else{var l=this.scene.gameZone.height/2+this.scene.main.board.width/2-2*this.parent.cellSize+this.moveTopNumber,u=this.y+o*a-l+o;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?44+o*a:53+o*a,h=e.worldY-u}this.distancePY=e.worldY-h;this.scene.main.board.cellPadding;this.updateCellsWithPadding(.5),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:c,y:h,scale:a,duration:150,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){if(!i.isDragEnd){i.setPosition(c,h);var e=i.getCellsHighlight();i.scene.main.board.handleRemoveHighlight(),i.scene.main.board.handleHighlight(e,i.highlightCellCanCapture.bind(i))}}}),this.drawSuggestCells()}},n.handleDrag=function(e){if(!this.scene.isGameOver&&!this.scene.isLevelComplete&&this.isCanMove&&this.isSetDrag)try{if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying()){var t=this.scene.main.board.cellSize/this.parent.cellSize;this.animMoveTopAndScaleUp.complete(),this.animMoveTopAndScaleUp.stop(),this.setScale(t)}this.resetCellItems(),this.scene.game.updateFps(ou.Z.max);var n=this.getContainerSize().width,i=e.worldX+this.parent.cellSize*this.scale/2-n/2,a=e.worldY-this.distancePY;this.setPosition(i,a),this.canMove();var s=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(s,this.highlightCellCanCapture.bind(this))}catch(r){this.handleDragPieceInvalidMove()}},n.highlightCellCanCapture=function(e,t,n,i){for(var a=this,s=bT,r=TT,o=[],c=0;c<i.length;c++){var h=i[c],l=h.x,u=h.y;s>l&&(s=l),r>u&&(r=u)}for(var p=function(){var t=e[d],n=E()(i).call(i,(function(e){return e.y===t}));if(!n||0===n.length)return"continue";for(var s=0;s<n.length;s++){var r=n[s];a.checkItemInArray(o,r)||o.push(r)}},d=0;d<e.length;d++)p();for(var f=function(){var e=t[m],n=E()(i).call(i,(function(t){return t.x===e}));if(!n||0===n.length)return"continue";for(var s=0;s<n.length;s++){var r=n[s];a.checkItemInArray(o,r)||o.push(r)}},m=0;m<t.length;m++)f();for(var g=function(){var e=n[v],t=E()(i).call(i,(function(t){return t.x===e.x&&t.y===e.y}));if(!t||0===t.length)return"continue";var s=t[0];a.checkItemInArray(o,s)||o.push(s)},v=0;v<n.length;v++)g();for(var y=function(){var e,t=o[S],n=t.x,i=t.y,c=E()(e=a.cellItems).call(e,(function(e){return e.x===n-s&&e.y===i-r}));if(!c||0===c.length)return"continue";var h=a.getFrameLight(c[0].cell.frame.name);c[0].cell.setFrame(h)},S=0;S<o.length;S++)y()},n.getFrameLight=function(e){var t=e;switch(e){case ET.GEM:t=ET.GEM_X_LIGHT;break;case ET.GEM_DIAMOND_10:t=ET.GEM_DIAMOND_10_LIGHT;break;case ET.GEM_DIAMOND_11:t=ET.GEM_DIAMOND_11_LIGHT;break;case ET.GEM_DIAMOND_12:t=ET.GEM_DIAMOND_12_LIGHT;break;case ET.GEM_DIAMOND_13:t=ET.GEM_DIAMOND_13_LIGHT;break;case ET.GEM_DIAMOND_14:t=ET.GEM_DIAMOND_14_LIGHT;break;case ET.GEM_DIAMOND_15:t=ET.GEM_DIAMOND_15_LIGHT}return t},n.getFrameNormal=function(e){var t=e;switch(e){case ET.GEM_X_LIGHT:t=ET.GEM;break;case ET.GEM_DIAMOND_10_LIGHT:t=ET.GEM_DIAMOND_10;break;case ET.GEM_DIAMOND_11_LIGHT:t=ET.GEM_DIAMOND_11;break;case ET.GEM_DIAMOND_12_LIGHT:t=ET.GEM_DIAMOND_12;break;case ET.GEM_DIAMOND_13_LIGHT:t=ET.GEM_DIAMOND_13;break;case ET.GEM_DIAMOND_14_LIGHT:t=ET.GEM_DIAMOND_14;break;case ET.GEM_DIAMOND_15_LIGHT:t=ET.GEM_DIAMOND_15}return t},n.resetCellItems=function(){for(var e=0;e<this.cellItems.length;e++){var t=this.cellItems[e].cell,n=this.getFrameNormal(t.frame.name);this.cellItems[e].cell.setFrame(n)}},n.checkItemInArray=function(e,t){var n=E()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return!(!n||0===n.length)},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag&&this.isCanMove&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(ms.Z.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),!this.scene.isGameOver&&!this.scene.isLevelComplete)){this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(ds.Z.PIECE_DROP),this.handleBoardMoveCompleted(),this.scene.updateMatchData(),this.wrapPiece.disableInteractive()}catch(e){this.handleInvalidMove()}}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(ms.Z.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.calculatePY=function(e,t){return 15==e?this.parent.cellSize*t*-2:30==e?0:45==e?this.parent.cellSize*t*2:60==e?this.parent.cellSize*t*4:75==e?this.parent.cellSize*t*6:e},n.handleBoardMoveCompleted=function(){var e=this,t=this.getPositionTopLeftInBoard();if(t){if(this.scene.targetMissionManager.getTargetType()===Tb){var n=this.calcScore();this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0)}var i=t.x,a=t.y,s=this.scene.main.board.dataBoard[a][i],r=s.x+this.scene.main.board.cellPadding,o=s.y+this.scene.main.board.cellPadding,c=this.getCellsHighlight();this.scene.add.tween({targets:this,x:r,y:o,duration:50,onComplete:function(){e.updateCellsWithPadding(.5),e.scene.main.board.handleRemoveHighlight(),e.hide(),e.setScale(1),e.parent.removeActivePiece(e.index),e.scene.main.board.handleMove(c,e.onBoardHandleMoveCompleted.bind(e))}})}else this.scene.main.board.handleRemoveHighlight()},n.calcScore=function(){var e;if(!this.matrixData)return 0;var t=this.matrixData.length||0;if(0===t)return 0;for(var n=(null==(e=this.matrixData[0])?void 0:e.length)||0,i=0,a=0;a<t;a++)for(var s=0;s<n;s++)1===this.matrixData[a][s]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.nextStep()},n.drawSuggestCells=function(){var e=function(e,t){for(var n=e.length,i=e[0].length,a=0,s=0,r=0,o=0;o<n;o++)for(var c=0;c<i;c++)if(Sv(e,c,o,t)&&(s=c,r=o,++a>1))return null;if(0===a)return null;for(var h=[],l=0;l<t.data.length;l++)for(var u=0;u<t.data[l].length;u++)t.data[l][u].texture&&h.push({x:s+u,y:r+l});return h&&h.length>0?h:null}(this.scene.main.board.dataBoard,{data:this.data});e&&this.scene.main.board.handleSuggestMove(e)},n.getPositionFirstCellHighlight=function(){var e=this.scene.main.board.dataBoard,t=this.getPositionTopLeftInBoard();if(!t)return{x:0,y:0};var n=t.x,i=t.y;return t?{x:e[i][n].x,y:-(this.scene.scale.height-this.parentHeight-e[i][n].y)}:{x:0,y:0}},n.handleInvalidMove=function(){var e=this;this.scene.audio.playSound(ds.Z.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){e.updateCellsWithPadding(.5)}}),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.handleStep()},n.canMove=function(){var e=this.scene.main.board.dataBoard,t=this.getCellsHighlight();if(0===t.length)throw new Error("Invalid Move");for(var n=!0,i=0;i<t.length;i++){var a=t[i],s=a.x,r=a.y;if(!e[r]||!e[r][s]||0!==e[r][s].value){n=!1;break}}if(!n||0===t.length)throw new Error("Invalid Move");return n},n.getCellsHighlight=function(){var e=this.scene.main.board.dataBoard,t=[],n=this.getPositionTopLeftInBoard();if(null===n)return t;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return t;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var s=a+n.x,r=i+n.y,o=e[r]&&e[r][s]?e[r][s].x:0,c=e[r]&&e[r][s]?e[r][s].y:0;if(r>=TT||s>=bT||!e[r][s]||1===e[r][s].value)return[];t.push({x:s,y:r,pX:o,pY:c,frame:this.data[i][a].texture})}return t},n.getPositionTopLeftInBoard=function(){for(var e=this.scene.main.board.dataBoard,t=this.x+this.parent.cellSize*this.scale/2,n=this.y+this.parent.cellSize*this.scale/2,i=this.scene.main.board.cellPadding,a=-1,s=-1,r=0;r<TT;r++)for(var o=0;o<bT;o++)if(e[r][o].x-i/2<=t&&e[r][o].x+e[r][o].width+i/2>=t&&e[r][o].y-i/2<=n&&e[r][o].y+e[r][o].height+i/2>=n){a=o,s=r;break}return a<0||a>bT-1||s<0||s>TT-1?null:{x:a,y:s}},t.buildData=function(e){for(var t=[],n=0;n<e.length;n++){t[n]=[];for(var i=0;i<e[n].length;i++){var a=1===e[n][i]?ET.GEM:null;t[n][i]={x:i,y:n,texture:a}}}return t},n.getPaddingCell=function(){return this.height/this.data.length/40},n.drawPiece=function(){return this.isCreateCell?this.updateCells():this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.createAnimShow=function(){var e=this,t=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:t,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Linear,onComplete:function(){e.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Linear})},n.createCells=function(e){for(var t=this.parent.cellSize,n=0;n<this.data.length;n++){this.cells[n]=[];for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture&&"x"!==this.data[n][i].texture){var a={x:0+i*t+e,y:0+n*t+e,width:t-2*e,height:t-2*e},s=new mb(this.scene,a);s.setFrame(this.data[n][i].texture),s.setVisible(!0),this.cells[n][i]=s,this.cellItems.push({x:i,y:n,cell:s}),this.add(s)}}this.isCreateCell=!0},n.updateCells=function(){for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++)if(this.data[e][t].texture&&"x"!==this.data[e][t].texture){var n=this.cells[e][t];n.setFrame(this.data[e][t].texture),n.setVisible(!0),this.cells[e][t]=n}},n.updateCellsWithPadding=function(e){for(var t=this.parent.cellSize-1,n=t-2*e,i=t-2*e,a=0;a<this.data.length;a++)for(var s=0;s<this.data[a].length;s++)if(this.data[a][s].texture){var r=this.cells[a][s],o=s*t+e,c=a*t+e;r.setWorldSize(n,i),r.setPosition(o,c)}},n.getContainerSize=function(){for(var e=0,t=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>e&&(e=this.data[n].length);var i=this.parent.cellSize;return{width:e*i*this.scale,height:t*i*this.scale}},n.setCanMove=function(e){this.isCanMove=e,this.correctAlpha=e?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive(),this.data=t.buildData(this.matrixData)},n.getScore=function(){if(!this.matrixData)return 0;for(var e=0,t=0;t<this.matrixData.length;t++)for(var n=0;n<this.matrixData[0].length;n++)1===this.matrixData[t][n]&&e++;return e},t}(Phaser.GameObjects.Container),PT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.type,a.direction,a.isReverse)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e,t,n){void 0===n&&(n=!1);var i=[];switch(t){case Sm:n?i=Ag:(i=Eg,e===Hm&&(i=bg),e===Vm&&(i=Tg));break;case Em:n?i=dg:(i=pg,e===Hm&&(i=fg),e===Vm&&(i=mg));break;case Am:if(n){i=hg;break}i=cg,e===Hm&&(i=lg),e===Vm&&(i=ug);break;case bm:n?i=vg:(i=gg,e===Hm&&(i=yg),e===Vm&&(i=Sg))}return i},t.getData=function(e,n,i){return void 0===i&&(i=!1),t.buildData(t.getMatrixData(e,n,i))},t}(CT),wT=PT,IT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.type,a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e,t){var n=[];switch(e){case Km:n=t===vm?_g:Og;break;case zm:n=t===vm?kg:xg;break;case Wm:n=t===vm?Cg:Pg;break;case Ym:n=t===vm?wg:Ig}return n},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(CT),kT=IT,xT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.type)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case jm:t=Dg;break;case Xm:t=Rg;break;case qm:t=Mg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(CT),_T=xT,OT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case Sm:t=Gg;break;case Em:t=Zg;break;case Am:t=Ug;break;case bm:t=Hg;break;default:t=Gg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(CT),DT=OT,RT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case Tm:t=Lg;break;case Cm:t=Bg;break;case wm:t=Fg;break;case Pm:t=Ng;break;default:t=Lg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(CT),MT=RT,LT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case Sm:t=Vg;break;case Em:t=Wg;break;case Am:t=Yg;break;case bm:t=zg;break;default:t=Vg}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(CT),BT=LT,NT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData()}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(){return Kg},t.getData=function(){return t.buildData(t.getMatrixData())},t}(CT),FT=NT,GT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.type,a.direction)}))||this}return(0,o.Z)(t,e),t.getDataByDirectionCross2=function(e){var t=[];switch(e){case Sm:t=jg;break;case Em:t=Xg;break;default:t=jg}return t},t.getDataByDirectionCross3=function(e){var t=[];switch(e){case Sm:t=qg;break;case Em:t=Jg;break;default:t=qg}return t},t.getDataByDirectionCross4=function(e){var t=[];switch(e){case Sm:t=Qg;break;case Em:t=$g;break;default:t=Qg}return t},t.getDataByDirectionCross5=function(e){var t=[];switch(e){case Sm:t=ev;break;case Em:t=tv;break;default:t=ev}return t},t.getMatrixData=function(e,n){var i=[];switch(e){case tg:i=t.getDataByDirectionCross2(n);break;case ng:i=t.getDataByDirectionCross3(n);break;case ig:i=t.getDataByDirectionCross4(n);break;case ag:i=t.getDataByDirectionCross5(n)}return i},t.getData=function(e,n){return t.buildData(t.getMatrixData(e,n))},t}(CT),ZT=GT,UT=function(e){function t(n,i,a){return e.call(this,n,i,(0,s.Z)({},a,{matrixData:t.getMatrixData(a.direction)}))||this}return(0,o.Z)(t,e),t.getMatrixData=function(e){var t=[];switch(e){case Sm:t=nv;break;case Em:t=iv;break;case Am:t=av;break;case bm:t=sv;break;default:t=nv}return t},t.getData=function(e){return t.buildData(t.getMatrixData(e))},t}(CT),HT=UT,VT=function(){function e(){}return e.create=function(e,t,n){var i;switch(n.type){case Um:case Hm:case Vm:i=new wT(e,t,n);break;case Wm:case Ym:case zm:case Km:i=new kT(e,t,n);break;case jm:case Xm:case qm:i=new _T(e,t,n);break;case Qm:i=new DT(e,t,n);break;case $m:i=new BT(e,t,n);break;case sg:i=new HT(e,t,n);break;case eg:i=new FT(e,t,n);break;case tg:case ng:case ig:case ag:i=new ZT(e,t,n);break;case Jm:i=new MT(e,t,n);break;default:i=new _T(e,t,n)}return i},e}(),WT=VT,YT=us.Z.GAMEPLAY_32,zT=YT.KEY,KT=YT.FRAME,jT=vT.Z.Configs,XT=jT.Gameplay,qT=jT.Match,JT=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],n.listPieceMap=[],n.amountPieceContainGem=0,n.hasPieceContainGem=void 0,n.segmentAmountPiece1Min=0,n.segmentAmountPiece1Max=0,n.segmentAmountPiece1Cur=0,n.segmentAmountPiece5Min=0,n.segmentAmountPiece5Max=0,n.segmentAmountPiece5Cur=0,n.segmentAvgScore=0,n.segmentTotalPieceScore=0,n.segmentTotalPiece=0,n.segmentTotalScore=0,n.segmentPieceDistancePerGem=0,n.segmentPieceRandomGem=!1,t.add.existing((0,as.Z)(n)),n.scene=t,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps(),this.addDebuggerBtnRandomPieces()},n.initCellSize=function(){this.cellSize=41*this.scene.main.board.cellSize/100},n.setContentPosition=function(e,t){this.setPosition(e,t)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(e){if([jm,Xm,qm].some((function(t){return t===e})))return[];var t=[];switch(e){case Um:case Hm:case Vm:t=[Am,Sm,Em,bm];break;case Wm:case Ym:case zm:case Km:t=[vm,ym];break;case Qm:t=[Am,Sm,Em,bm];break;case Jm:t=[Tm,Cm,Pm,wm];break;case $m:case sg:t=[Am,Sm,Em,bm];break;case eg:t=[];break;case tg:case ng:case ig:case ag:t=[Sm,Em]}return t},n.createAllPieces=function(){for(var e=this.cellSize,t=[],n=0;n<rg.length;n++){var i=this.getDirectionsByType(rg[n]);if(i.length<=0)t.push({type:rg[n]});else{for(var a=0;a<i.length;a++)t.push({type:rg[n],direction:i[a]});if(Um===rg[n])for(var r=0;r<i.length;r++)t.push({type:rg[n],direction:i[r],isReverse:!0})}}for(var o=0;o<t.length;o++){var c=(0,s.Z)({},t[o],{texture:zT,frame:KT.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2),cellLength:Math.floor(e/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(e/2),height:Math.floor(e/2)}}),h=WT.create(this.scene,this,c);h.hide(),this.allPieces.push({piece:h,isUsed:!1})}},n.createAllPiecesGroup=function(){for(var e=0;e<this.allPieces.length;e++){var t=this.allPieces[e].piece;this.allPiecesGroup[t.type]||(this.allPiecesGroup[t.type]=[]),this.allPiecesGroup[t.type].push(e)}},n.randomPieces=function(){var e=this;this.scene.game.updateFps(ou.Z.max);for(var t=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*t.length),a=t[i];if(!e.allPiecesGroup[a])return"continue";var s=Math.floor(Math.random()*e.allPiecesGroup[a].length),r=e.allPiecesGroup[a][s],o=[zm,Km].some((function(e){return e===a}));if(e.canCaptureLines.isCapture&&o){for(var c=0;c<e.allPiecesGroup[a].length;c++){var h=e.allPiecesGroup[a][c],l=e.allPieces[h].piece;if(l&&l.direction===e.canCaptureLines.direction){r=h;break}}t=e.buildPieceRates(!1)}n.some((function(e){return e.index===r}))||n.push({index:r,type:a})};n.length<3;)i();for(var a=[],s=0;s<n.length;s++){var r=n[s].index,o=this.allPieces[r].piece;a.push({position:r,texture:zT,frame:KT.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<og.length;n++)t.push((0,s.Z)({},og[n]));if(e){var i=this.scene.main.board.dataBoard,a=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var r=0;r<t.length;r++)t[r].type===Km&&(t[r].rate=8);else if(a=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var o=0;o<t.length;o++)t[o].type===zm&&(t[o].rate=8)}for(var c=[],h=0;h<t.length;h++)for(var l=t[h],u=l.type,p=l.rate,d=0;d<p;d++)c.push(u);return c},n.drawPieces=function(){for(var e=this.scene.gameZone,t=e.width,n=e.height,i=[20,t/3,2*t/3-20],a=n/2+176-13,s=a+(n-85-a)/2,r=0;r<this.piecesActive.length;r++){var o=this.piecesActive[r],c=o.position,h=o.fenPiece,l=this.allPieces[c].piece,u=i[r];if(h){var p=this.convertFenPiecesToData(h);p&&l.updateDataPiece(p)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var d=this.getRandomPieceData(l.data);d&&l.updateDataPiece(d)}}l.updatePosition(u,s),l.updatePositionWrapPiece(u+20*(r-1),s),l.setIndex(r),l.drawPiece(),this.allPieces[c]={piece:l,isUsed:!0}}},n.isPieceContainGem=function(){if(1===Phaser.Math.Between(0,1)&&!this.hasPieceContainGem)return this.amountPieceContainGem++,this.hasPieceContainGem=!0,!0;if(this.amountPieceContainGem<XT.RatePieceContainGem)return this.amountPieceContainGem++,!1;if(this.amountPieceContainGem>=XT.RatePieceContainGem){var e=this.hasPieceContainGem;return this.amountPieceContainGem=0,this.hasPieceContainGem=!1,!e}return!1},n.convertFenPiecesToData=function(e){if(!e)return null;var t=e.split("/");if(0===t.length)return null;for(var n=[],i=0;i<t.length;i++){var a=t[i].split(",");n[i]=[];for(var s=0;s<a.length;s++){var r=Pv(a[s]);"null"!==a[s]&&"x"!==a[s]||(r=null),n[i].push({x:i,y:s,texture:r})}}return n},n.getRandomPieceData=function(e){var t=this.scene.header.collectItems.getTargetKeys();if(!t||0===t.length)return null;for(var n=0,i=e.length,a=e[0].length,s=0;s<i;s++)for(var r=0;r<a;r++)if(e[s][r].texture&&Phaser.Math.Between(0,1)){var o=KT.GEM;if(n<XT.MaxGemInPiece)o=t[Phaser.Math.Between(0,t.length-1)];e[s][r]={x:s,y:r,texture:o},n++}return e},n.removeActivePiece=function(e){this.piecesActive[e].used=!0},n.existPiecesActive=function(){var e,t=E()(e=this.piecesActive).call(e,(function(e){return!e.used}));return t&&t.length>0},n.showNewPieces=function(){this.resetAllPieces(),this.listPieceMap.length>0?this.showListPieceMap():(this.randomPieces(),this.setActivePieces(),this.drawPieces())},n.setActivePieces=function(){for(var e=this.scene.main.board.dataBoard,t=0;t<this.piecesActive.length;t++){var n=this.piecesActive[t].position,i=this.allPieces[n].piece,a=Ev(e,i);i.setCanMove(a)}},n.getPiecesByFen=function(e){var t=[],n=e.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=rs()(n).call(n,2),a=0;a<i.length;a++){var s,r;if("l"!==Eu()(s=i[a]).call(s)){var o=Iv(Eu()(r=i[a]).call(r));t.push(o)}}return t},n.getFenByPieces=function(){for(var e="l",t=0;t<this.piecesActive.length;t++){var n=this.piecesActive[t],i=n.type,a=n.direction,s=n.isReverse,r=n.used,o=n.position;if(!r){var c=Cv(i);a&&""!==a&&(c+="-"+Cv(a)),s&&(c+="-r");var h=this.allPieces[o].piece;e+=" "+c+"|"+this.getFenDataPiece(h)}}return e},n.getFenDataPiece=function(e){for(var t=e.data,n=t.length,i=t[0].length,a="",s=0;s<n;s++){for(var r="",o=0;o<i;o++)r+=","+Cv(t[s][o].texture);a+="/"+r.substring(1)}return a.substring(1)},n.clearPieces=function(){for(var e=0;e<this.piecesActive.length;e++){var t=this.piecesActive[e].position;this.allPieces[t].isUsed=!1,this.allPieces[t].piece.hide()}this.piecesActive=[],this.listPieceMap=[]},n.resetAllPieces=function(){for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].isUsed=!1,this.allPieces[e].piece.reset()},n.showAvailablePieces=function(e){if(e&&!(e.length<=0)){this.resetAllPieces();for(var t=[],n=0;n<e.length;n++){for(var i=e[n],a=i.type,s=i.direction,r=i.isReverse,o=i.frame,c=!1,h=0;h<this.allPieces.length;h++){var l=this.allPieces[h],u=l.piece,p=l.isUsed;if(a===u.type&&s===u.direction&&r===u.isReverse){if(p){c=!0;continue}c=!1,t.push({position:h,texture:zT,frame:o,type:u.type,direction:u.direction,isReverse:u.isReverse,fenPiece:e[n].fenPiece}),this.allPieces[h].isUsed=!0;break}}if(c){var d=this.spawnPiece(a,s,r),f=d.piece,m=d.index;t.push({position:m,texture:zT,frame:o,type:f.type,direction:f.direction,isReverse:f.isReverse,fenPiece:e[n].fenPiece})}}this.piecesActive=t,this.setActivePieces(),this.drawPieces()}},n.spawnPiece=function(e,t,n){var i=this.cellSize,a={type:e,direction:t,isReverse:n,texture:zT,frame:KT.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2),cellLength:Math.floor(i/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2)}},s=WT.create(this.scene,this,a);return s.hide(),this.allPieces.push({piece:s,isUsed:!0}),{piece:s,index:this.allPieces.length-1}},n.showListPieceMap=function(){var e;if(this.piecesActive=rs()(e=this.listPieceMap).call(e,0,3),this.showAvailablePieces(this.piecesActive),this.scene.footer.textExist){var t=this.listPieceMap.length<=0?"Done":"Exits";this.scene.footer.textExist.setText(t)}},n.validItemsPieceMap=function(e){for(var t,n=!0,i=y()(t=[]).call(t,e),a=function(){var e=i.shift(),t=E()(i).call(i,(function(t){return t.type===(null==e?void 0:e.type)&&t.direction===e.direction&&t.isReverse===e.isReverse}));t&&t.length>0&&(n=!1)};i.length>1;)a();return n},n.getPieceDataByType=function(e){return cv[e]},n.addItemPieceMap=function(e){if(e.properties){var t=this.getFenPieceForPropertiesPieceMap(e);t&&(e=(0,s.Z)({},e,{fenPiece:t}))}this.listPieceMap.push(e)},n.getFenPieceForPropertiesPieceMap=function(e){var t,n;if(!e.properties)return"";var i="",a=null==(t=E()(n=this.allPieces).call(n,(function(t){var n=t.piece;return n.direction===e.direction&&n.isReverse===e.isReverse&&n.type===e.type}))[0])?void 0:t.piece,s=e.properties[0].value.split(","),r=e.properties[1].value.split(","),o=0;if(!a)return i;for(var c=a.data,h=c.length,l=c[0].length,u=0;u<h;u++){for(var p="",d=0;d<l;d++){var f=c[u][d].texture,m=f,g=xt()(r).call(r,String(o));f&&(-1!==g&&(m=rv[s[g]]),o++);var v=null;m&&(v=Cv(m)),p+=","+v}i+="/"+p.substring(1)}return i.substring(1)},n.start=function(){0!==this.listPieceMap.length?this.showListPieceMap():this.showNewPieces()},n.getListPieceMap=function(){return this.listPieceMap},n.setListPieceMap=function(e){var t;this.listPieceMap=y()(t=[]).call(t,e)},n.buildPiecesByMap=function(){var e=this.scene.mapManager.getTileMap().layers[0].properties;if(e&&!(e.length<=0))for(var t=0;t<e.length;t++){var n=e[t].value;if(n){var i=n.avgScore,a=n.score,s=n.pieceDistancePerGem,r=n.piece1,o=n.piece5;r=r.replace("min",'"min"').replace("max",'"max"'),o=o.replace("min",'"min"').replace("max",'"max"');var c=JSON.parse(r),h=JSON.parse(o);this.segmentAvgScore=i,this.segmentAmountPiece1Min=c.min,this.segmentAmountPiece1Max=c.max,this.segmentAmountPiece5Min=h.min,this.segmentAmountPiece5Max=h.max,this.segmentTotalScore=a,this.segmentPieceDistancePerGem=s,this.segmentTotalPieceScore=0,this.segmentTotalPiece=0,this.listPieceMap=[],this.buildObjectPieces()}}},n.buildObjectPieces=function(){for(;this.checkAverageScore();)this.buildObjectPiece()},n.checkAverageScore=function(){return 0===this.segmentTotalPiece||0===this.segmentTotalPieceScore||!(this.segmentTotalPiece>qT.PieceRandoms.maxPiece)&&!(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore+qT.PieceRandoms.measureError&&this.segmentTotalPieceScore/this.segmentTotalPiece>=this.segmentAvgScore-qT.PieceRandoms.measureError&&this.segmentTotalPieceScore>=this.segmentTotalScore)},n.buildObjectPiece=function(){var e=this.getPieceByAvgScore();if(e)if(this.checkPieceMaxAmountConfig(e)){var t="";if(Math.floor((this.segmentTotalPiece-1)/3)%this.segmentPieceDistancePerGem===0){if(Phaser.Math.Between(0,1)&&!this.segmentPieceRandomGem||!this.segmentPieceRandomGem&&this.segmentTotalPiece%3===2){var n=this.getRandomPieceData(e.data);n&&(e.updateDataPiece(n),t=this.getFenDataPiece(e)),this.segmentPieceRandomGem=!0}}else this.segmentPieceRandomGem=!1;this.listPieceMap.push({type:e.type,direction:e.direction,isReverse:e.isReverse,fenPiece:t})}else this.buildObjectPiece()},n.checkPieceMaxAmountConfig=function(e){var t=e.getScore();switch(t){case 1:if(this.segmentAmountPiece1Max<=this.segmentAmountPiece1Cur)return!1;this.segmentAmountPiece1Cur++;break;case 5:if(this.segmentAmountPiece5Max<=this.segmentAmountPiece5Cur)return!1;this.segmentAmountPiece5Cur++}return this.segmentTotalPiece++,this.segmentTotalPieceScore+=t,!0},n.getPieceByAvgScore=function(){var e=this;if(this.segmentTotalPieceScore<this.segmentTotalScore){var t=this.buildPieceRates(!1),n=t[Math.floor(Math.random()*t.length)];if(!this.allPiecesGroup[n])return null;var i=Math.floor(Math.random()*this.allPiecesGroup[n].length),a=this.allPiecesGroup[n][i];return this.allPieces[a].piece}if(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore){var s,r=E()(s=this.allPieces).call(s,(function(t){return t.piece.getScore()<=e.segmentAvgScore}));return r&&0!==r.length?r[Phaser.Math.Between(0,r.length-1)].piece:null}if(this.segmentTotalPieceScore/this.segmentTotalPiece>this.segmentAvgScore){var o,c=E()(o=this.allPieces).call(o,(function(t){return t.piece.getScore()>e.segmentAvgScore}));return c&&0!==c.length?c[Phaser.Math.Between(0,c.length-1)].piece:null}return null},n.debuggerNextPieces=function(){for(var e=0;e<this.piecesActive.length;e++)this.removeActivePiece(e);for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].piece.wrapPiece.setVisible(!1);this.showNewPieces()},n.addDebuggerBtnRandomPieces=function(){var e=this;if(vT.Z.Utils.Valid.isDebugger())for(var t=[80,187.5,295],n=this.scene.gameZone.height,i=function(i){var a=new fs.Z(e.scene,zT,KT.GEM,50,30);e.add(a),a.onClick=function(){e.debuggerNewPieces(i)},a.setPosition(t[i],n)},a=0;a<3;a++)i(a)},n.debuggerNewPieces=function(e){this.removeActivePiece(e);var t=this.piecesActive[e],n=this.allPieces[t.position].piece;n.setVisible(!1);var i=Phaser.Math.Between(0,this.allPieces.length-1);this.piecesActive[e]={position:i,texture:zT,frame:KT.GEM,type:n.type,direction:n.direction,isReverse:n.isReverse};var a=this.scene.gameZone,s=a.width,r=a.height,o=[20,s/3,2*s/3-20],c=r/2+176-13,h=c+(r-85-c)/2,l=this.piecesActive[e],u=l.position,p=l.fenPiece,d=this.allPieces[u].piece,f=o[e];if(p){var m=this.convertFenPiecesToData(p);m&&d.updateDataPiece(m)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var g=this.getRandomPieceData(d.data);g&&d.updateDataPiece(g)}}d.updatePosition(f,h),d.updatePositionWrapPiece(f+20*(e-1),h),d.setIndex(e),d.drawPiece()},t}(Phaser.GameObjects.Container),QT=us.Z.DEFAULT,$T=QT.KEY,eC=QT.FRAME,tC=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.textExist=void 0,n.scene=t,n.setSize(n.scene.gameZone.width,85),t.add.existing((0,as.Z)(n)),n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createPieces(),this.createDebugButton()},n.createPieces=function(){this.pieces=new JT(this.scene)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new fs.Z(this.scene,$T,eC.BUTTON_BLUE_SMALL_TALL,100,40),this.debugButton.setName("Debug");var e=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([e]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},t}(Phaser.GameObjects.Container),nC=tC,iC=[{key:"daily-level-0",mapJson:"./assets/json/daily-levels/level-0.json"}],aC=1;aC<=57;aC++)iC.push({key:"daily-level-"+aC,mapJson:"./assets/json/daily-levels/level-"+aC+".json"});var sC=function(){var e=new Date("01/01/2022"),t=(new Date).getTime()-e.getTime();return Math.floor(t/864e5)%iC.length},rC=function(){var e=sC();return iC[e]},oC=function(){function e(e){this.scene=void 0,this.currentLevel=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){var e=this.scene.storage.getState(),t=Kc(e)||1;this.currentLevel=t},t.setLevel=function(e){this.currentLevel=e},t.getLevel=function(){return this.currentLevel},t.getLevelConfig=function(){var e=this.scene.storage.getState();return jc(e)?rC():em[this.currentLevel]},t.getNextLevel=function(){return this.currentLevel+1},t.getNextLevelConfig=function(){return em[this.currentLevel+1]},t.increaseLevel=function(){this.currentLevel++},e}(),cC=function(){function e(e){this.scene=void 0,this.map=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){this.initMap()},t.initMap=function(){var e=this.scene.levelManager.getLevelConfig();this.map=this.scene.make.tilemap({key:e.key})},t.getTileMap=function(){return b()(this)},t.reloadMap=function(){var e,t=this.scene.storage.getState();0===Kc(t)&&this.scene.levelManager.setLevel(1);var n=this.scene.levelManager.getLevelConfig();null==(e=b()(this))||e.destroy(),this.map=this.scene.make.tilemap({key:n.key})},e}(),hC=function(){function e(){this.targetType=void 0,this.targetValue=void 0,this.init()}var t=e.prototype;return t.init=function(){},t.setTargetType=function(e){this.targetType=e},t.setTargetValue=function(e){this.targetValue=e},t.getTargetType=function(){return this.targetType},t.getTargetValue=function(){return this.targetValue},e}(),lC=us.Z.GAMEPLAY_32.KEY,uC=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.textWellDone=void 0,s.listTargetFrame=[],s.listAnim=[],s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.open=function(t){e.prototype.open.call((0,as.Z)(s),t),s.runPopupEntrancesAnimation(0,300)},s.close=function(){e.prototype.close.call((0,as.Z)(s))},s.scene=t,s.setDepth(ps.Ks.POPUP),s.background.setAlpha(0),s.createContent(),s}(0,o.Z)(t,e);var n=t.prototype;return n.handleDelegate=function(){var e,t=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(e=this.closeTimerEvent)||e.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){t.visible&&t.scene.screen.close(t.name),s&&s()}}))},n.runAnim=function(){},n.createContent=function(){this.createText()},n.createText=function(){this.textWellDone=new ay(this.scene,{text:"WELL  DONE!",font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(80)}),this.add(this.textWellDone),Phaser.Display.Align.In.Center(this.textWellDone,this)},n.createTargetItems=function(){var e=this.scene.header.collectItems.getTargetKeys();if(e&&0!==e.length){for(var t=0;t<3;t++){var n=this.scene.make.image({key:lC});n.setWorldSize(30,30),n.setFrame(e[t]||e[0]),n.setVisible(!1).setAlpha(0),this.listTargetFrame.push(n)}this.add(this.listTargetFrame)}},n.updateTargetItems=function(){var e=this.scene.header.collectItems.getTargetKeys();if(e&&0!==e.length)for(var t=0;t<3;t++){var n=this.listTargetFrame[t];n.setWorldSize(30,30),n.setFrame(e[t]||e[0]),n.setVisible(!1).setAlpha(0)}},n.createAnimTargetItems=function(){for(var e=[100,500,700],t=[-120,0,120],n=[-100,-150,-100],i=[.7,1,.7],a=0;a<3;a++){this.listTargetFrame[a].setAlpha(0).setVisible(!0);var s=this.scene.add.tween({targets:this.listTargetFrame[a],delay:e[a],x:{from:0,to:t[a]},y:{from:300,to:n[a]},alpha:{from:0,to:1},scale:{from:0,to:i[a]},rotation:{from:-180,to:0},duration:500});this.listAnim.push(s)}},n.playAnimTargetItems=function(){for(var e=0;e<3;e++){this.listTargetFrame[e].setAlpha(0).setVisible(!0),this.listAnim[e].play()}},n.runPopupEntrancesAnimation=function(e,t){var n=this;this.listTargetFrame.forEach((function(e){e.setAlpha(0)})),this.textWellDone.restart(),this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:e,duration:t,onUpdate:function(e){var t=e.getValue();n.background.setAlpha(t)},onComplete:function(){n.textWellDone.start(),0===n.listTargetFrame.length?(n.createTargetItems(),n.createAnimTargetItems()):(n.updateTargetItems(),n.playAnimTargetItems()),n.handleDelegate(),n.runAnim()}})),this.background.setAlpha(0),this.tweenBackground.play()},t}(GameCore.Screen),pC=us.Z.DEFAULT,dC=pC.KEY,fC=pC.FRAME,mC=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonContinue=void 0,s.contents=void 0,s.textLevel=void 0,s.textNextLevel=void 0,s.textLevelComplete=void 0,s.backgroundContent=void 0,s.listTargets=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonClose=void 0,s.checkFinishAllLevel=function(){var e=s.scene.storage.getState();return Kc(e)>=em.length},s.scene=t,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.updateInfo(),this.runOpenAnimation()},n.updateInfo=function(){var e=this.scene.levelManager.getLevel();this.textLevel.setText("Level "+e)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,310,300),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:dC,frame:fC.POPUP_MID_1}),this.backgroundContent.setWorldSize(280,200),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:dC,frame:fC.TEXT_CONGRATULATION});e.setWorldSize(236,20),this.buttonClose=new fs.Z(this.scene,dC,fC.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([e,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,150,-15),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.clickButtonClose=function(){var e=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.header.progressBar.reset(),e.scene.clearFen(),e.scene.scene.switch(Ua.Co.LEVEL_SCENE)}))},n.createTexts=function(){this.createTextLevel(),this.createTextLevelComplete()},n.createTextLevel=function(){this.textLevel=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(50),text:"Level 1",origin:{x:.5,y:.5}}),this.textLevel.setTint(3552586),this.popup.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this.popup,0,-60)},n.createTextLevelComplete=function(){this.textLevelComplete=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(60),text:"COMPLETED",origin:{x:.5,y:.5}}),this.textLevelComplete.setTint(3552586),this.popup.add(this.textLevelComplete),Phaser.Display.Align.In.Center(this.textLevelComplete,this.popup,0,-20)},n.createTargetItems=function(){var e=this.scene.header.collectItems.getTargetKeys();if(e&&0!==e.length){for(var t=this.calcPosition(e.length),n=0;n<e.length;n++){var i=this.scene.make.image({key:us.Z.GAMEPLAY.KEY});i.setWorldSize(50,50),i.setFrame(e[n]||e[0]),i.setX(t[n]),this.listTargets.push(i)}this.popup.add(this.listTargets)}},n.updateTargetItems=function(){var e=this.scene.header.collectItems.getTargetKeys();if(e&&0!==e.length){this.popup.remove(this.listTargets);for(var t=this.calcPosition(e.length),n=0;n<e.length;n++){var i=this.listTargets[n];i||(i=this.scene.make.image({key:us.Z.GAMEPLAY.KEY}),this.listTargets.push(i)),i.setWorldSize(50,50),i.setFrame(e[n]||e[0]),i.setX(t[n])}this.popup.add(this.listTargets)}},n.calcPosition=function(e){for(var t=[],n=310/(e+1),i=n*(e-1)/2,a=0;a<e;a++)t.push(n*a-i);return t},n.createButtons=function(){this.createButtonBack(),this.createButtonContinue()},n.createButtonBack=function(){var e=this.scene.make.image({key:dC,frame:fC.ICON_ARROW_LEFT});e.setWorldSize(30,30),this.buttonBack=new fs.Z(this.scene,dC,fC.BUTTON_MINOR,70,54),this.buttonBack.setName("Back"),this.buttonBack.add(e),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-88,55)},n.clickButtonBack=function(){var e=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.header.progressBar.reset(),e.scene.clearFen(),e.scene.scene.switch(Ua.Co.LEVEL_SCENE)}))},n.createButtonContinue=function(){this.textNextLevel=this.scene.make.image({key:dC,frame:fC.TEXT_PLAY}),this.textNextLevel.setWorldSize(50,15),this.checkFinishAllLevel()||(this.textNextLevel.setFrame(fC.BLANK),this.textNextLevel.setWorldSize(114,15)),this.buttonContinue=new fs.Z(this.scene,dC,fC.BUTTON_BLUE_NORMAL,172,64),this.buttonContinue.setName("Continue"),this.buttonContinue.add(this.textNextLevel),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,37,55)},n.clickButtonContinue=function(){var e=this,t=this.scene.storage.getState();if(nm(t)<1)return this.setVisible(!1),void this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN);Kc(t)>=em.length-1?this.scene.handleClickStartOver():(this.scene.storage.dispatch(pm()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.clearFen(),e.scene.startGame()})))},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),gC=us.Z.DEFAULT,vC=gC.KEY,yC=gC.FRAME,SC=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonContinue=void 0,s.contents=void 0,s.backgroundContent=void 0,s.textNextLevel=void 0,s.textStartOver=void 0,s.livesTimer=void 0,s.listTargets=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonClose=void 0,s.scene=t,s.createPopup(),s.createEmoji(),s.createTitle(),s.createTexts(),s.createButtons(),s.createLivesTimer(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.updateInfo(),this.runOpenAnimation()},n.updateInfo=function(){var e=this.scene.levelManager.getLevel();e>em.length-1&&(e=em.length-1),this.textNextLevel.setText("Next level "+e),this.updateTextNextLevel()},n.updateTextNextLevel=function(){if(this.scene.levelManager.getLevel()>em.length-1)return this.textNextLevel.setVisible(!1),void this.textStartOver.setVisible(!0);this.textNextLevel.setVisible(!0),this.textStartOver.setVisible(!1)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,355,{framePopupTop:yC.POPUP_TOP_1,framePopupMid:yC.POPUP_MID_1,framePopupBottom:yC.POPUP_BOTTOM_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,0)},n.createEmoji=function(){var e=this.scene.make.image({key:vC,frame:yC.EMOJI_WIN});e.setWorldSize(200,192),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,-90)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:vC,frame:yC.TEXT_CONGRATULATION});e.setWorldSize(126,17),this.title.add(e),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title,0,215),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createButtonClose=function(){this.buttonClose=new fs.Z(this.scene,vC,yC.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add(this.buttonClose),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,5)},n.createTexts=function(){this.createTextLevelComplete()},n.createTextLevelComplete=function(){var e=this.scene.make.image({key:vC,frame:yC.TEXT_LEVEL_COMPLETE});e.setWorldSize(174,15),this.popup.add(e),Phaser.Display.Align.In.BottomCenter(e,this.popup,0,-107)},n.createTargetItems=function(){var e=this.scene.header.collectItems.getTargetKeys();if(e&&0!==e.length){for(var t=this.calcPosition(e.length),n=0;n<e.length;n++){var i=this.scene.make.image({key:us.Z.GAMEPLAY.KEY});i.setWorldSize(50,50),i.setFrame(e[n]||e[0]),i.setX(t[n]),this.listTargets.push(i)}this.popup.add(this.listTargets)}},n.clickButtonClose=function(){var e=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.header.progressBar.reset(),e.scene.clearFen(),e.scene.scene.switch(Ua.Co.LEVEL_SCENE)}))},n.updateTargetItems=function(){var e=this.scene.header.collectItems.getTargetKeys();if(e&&0!==e.length){this.popup.remove(this.listTargets);for(var t=this.calcPosition(e.length),n=0;n<e.length;n++){var i=this.listTargets[n];i||(i=this.scene.make.image({key:us.Z.GAMEPLAY.KEY}),this.listTargets.push(i)),i.setWorldSize(50,50),i.setFrame(e[n]||e[0]),i.setX(t[n])}this.popup.add(this.listTargets)}},n.calcPosition=function(e){for(var t=[],n=310/(e+1),i=n*(e-1)/2,a=0;a<e;a++)t.push(n*a-i);return t},n.createButtons=function(){this.createButtonBack(),this.createButtonContinue()},n.createButtonBack=function(){var e=this.scene.make.image({key:vC,frame:yC.ICON_DISCOVER_BLUE});e.setWorldSize(24,24),this.buttonBack=new fs.Z(this.scene,vC,yC.BUTTON_MINOR,56,56),this.buttonBack.setName("Back"),this.buttonBack.add(e),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.BottomCenter(this.buttonBack,this.popup,-127,-32)},n.clickButtonBack=function(){var e=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.header.progressBar.reset(),e.scene.clearFen(),e.scene.scene.switch(Ua.Co.LEVEL_SCENE)}))},n.createButtonContinue=function(){this.buttonContinue=new fs.Z(this.scene,vC,yC.BUTTON_BLUE_SMALL,237,56),this.buttonContinue.setName("Continue"),this.textNextLevel=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.buttonContinue.add(this.textNextLevel),this.textStartOver=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),text:"START OVER",origin:{x:.5,y:.5}}),this.buttonContinue.add(this.textStartOver),this.textStartOver.setVisible(!1),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.BottomCenter(this.buttonContinue,this.popup,33,-32)},n.clickButtonContinue=function(){var e=this,t=this.scene.storage.getState();if(nm(t)<1)return this.runCloseAnimation(),void this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN,{onClose:function(){e.scene.screen.open(ps.o4.MISSION_COLLECTION_COMPLETE_SCREEN)}});Kc(t)>=em.length-1?this.scene.handleClickStartOver():(this.scene.storage.dispatch(pm()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.analytics.levelStart(e.scene.levelManager.getLevel(),void 0,e.scene.getLevelName());var t=e.scene.main.board.fadeOut();t?t.on("complete",(function(){e.scene.header.progressBar.reset(),e.scene.clearFen(),e.scene.startGame()})):(e.scene.header.progressBar.reset(),e.scene.clearFen(),e.scene.startGame())})))},n.createLivesTimer=function(){this.livesTimer=new tA(this.scene),this.livesTimer.setVisible(!1),this.add(this.livesTimer),Phaser.Display.Align.In.TopCenter(this.livesTimer,this,0,-62)},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.livesTimer.startIntervalTimer(),this.runPopupEntrancesAnimation(400,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.livesTimer.stopIntervalTimer(),this.livesTimer.setVisible(!1),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){var n=this;if(!this.popupShowUpAnimation){var i=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.livesTimer.setVisible(!0)}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),EC=us.Z.GAMEPLAY,AC=(EC.KEY,EC.FRAME,function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.textNoSpaceLeft=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.open=function(t){e.prototype.open.call((0,as.Z)(s),t),s.runPopupEntrancesAnimation(300,300),s.handleDelegate()},s.close=function(){e.prototype.close.call((0,as.Z)(s))},s.scene=t,s.setDepth(ps.Ks.POPUP),s.background.setAlpha(0),s.createContent(),s}(0,o.Z)(t,e);var n=t.prototype;return n.handleDelegate=function(){var e,t=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(e=this.closeTimerEvent)||e.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){t.textNoSpaceLeft.setVisible(!1),t.textNoSpaceLeft.restart(),t.visible&&t.scene.screen.close(t.name),s&&s()}}))},n.runAnim=function(){this.textNoSpaceLeft.setVisible(!0),this.textNoSpaceLeft.start(300)},n.createContent=function(){this.createText()},n.createText=function(){this.textNoSpaceLeft=new ay(this.scene,{text:"NO SPACE LEFT!",font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(80)}),this.add(this.textNoSpaceLeft),Phaser.Display.Align.In.Center(this.textNoSpaceLeft,this)},n.runPopupEntrancesAnimation=function(e,t){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:e,duration:t,onUpdate:function(e){var t=e.getValue();n.background.setAlpha(t)},onComplete:function(){n.runAnim()}})),this.tweenBackground.play()},t}(GameCore.Screen)),bC=us.Z.DEFAULT,TC=bC.KEY,CC=bC.FRAME,PC=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonRetry=void 0,s.contents=void 0,s.textLevelFail=void 0,s.buttonClose=void 0,s.livesTimer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.scene=t,s.createPopup(),s.createEmoji(),s.createTitle(),s.createTexts(),s.createButtons(),s.createLivesTimer(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.scene.enableInput(),this.runOpenAnimation()},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,355,{framePopupTop:CC.POPUP_TOP_1,framePopupMid:CC.POPUP_MID_1,framePopupBottom:CC.POPUP_BOTTOM_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,0)},n.createEmoji=function(){var e=this.scene.make.image({key:TC,frame:CC.EMOJI_LOSE});e.setWorldSize(200,200),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,-90)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:TC,frame:CC.TEXT_ALMOST_DONE});e.setWorldSize(106,12),this.title.add(e),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title,0,215),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createButtonClose=function(){this.buttonClose=new fs.Z(this.scene,TC,CC.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add(this.buttonClose),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,5)},n.createTexts=function(){this.createTextLevelFail()},n.createTextLevelFail=function(){this.textLevelFail=this.scene.make.image({key:TC,frame:CC.TEXT_LEVEL_FAIL}),this.textLevelFail.setWorldSize(121,14),this.popup.add(this.textLevelFail),Phaser.Display.Align.In.BottomCenter(this.textLevelFail,this.popup,0,-107)},n.createButtons=function(){this.createButtonBack(),this.createButtonRetry()},n.createButtonBack=function(){var e=this.scene.make.image({key:TC,frame:CC.ICON_DISCOVER_BLUE});e.setWorldSize(24,24),this.buttonBack=new fs.Z(this.scene,TC,CC.BUTTON_MINOR,56,56),this.buttonBack.setName("Back"),this.buttonBack.add(e),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.BottomCenter(this.buttonBack,this.popup,-127,-32)},n.clickButtonBack=function(){var e=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.clearFen(),e.scene.scene.switch(Ua.Co.LEVEL_SCENE)}))},n.createButtonRetry=function(){this.buttonRetry=new fs.Z(this.scene,TC,CC.BUTTON_BLUE_SMALL,237,56),this.buttonRetry.setName("Retry");var e=this.scene.make.image({key:TC,frame:CC.TEXT_TRY_AGAIN});e.setWorldSize(81,20),this.buttonRetry.add(e),Phaser.Display.Align.In.Center(e,this.buttonRetry,0,0),this.popup.add(this.buttonRetry),this.buttonRetry.onClick=this.clickButtonRetry.bind(this),Phaser.Display.Align.In.BottomCenter(this.buttonRetry,this.popup,33,-32)},n.clickButtonClose=function(){var e=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.clearFen(),e.scene.scene.switch(Ua.Co.LEVEL_SCENE)}))},n.clickButtonRetry=function(){var e=this,t=this.scene.storage.getState();nm(t)<1?this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN,{currentScreen:this}):(this.scene.storage.dispatch(pm()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){e.scene.handleRetryLevel()})))},n.createLivesTimer=function(){this.livesTimer=new tA(this.scene),this.livesTimer.setVisible(!1),this.add(this.livesTimer),Phaser.Display.Align.In.TopCenter(this.livesTimer,this,0,-62)},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.livesTimer.startIntervalTimer(),this.runPopupEntrancesAnimation(400,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.livesTimer.stopIntervalTimer(),this.livesTimer.setVisible(!1),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){var n=this;if(!this.popupShowUpAnimation){var i=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.livesTimer.setVisible(!0)}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),wC=us.Z.DEFAULT,IC=wC.KEY,kC=wC.FRAME,xC=function(e){function t(t){var n;return(n=e.call(this,t,IC,kC.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Daily"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:IC,frame:kC.ICON_CALENDER_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),_C=xC,OC=us.Z.DEFAULT,DC=OC.KEY,RC=OC.FRAME,MC=function(e){function t(t){var n;return(n=e.call(this,t,DC,RC.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Home"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:DC,frame:RC.ICON_HOME_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),LC=MC,BC=us.Z.DEFAULT,NC=BC.KEY,FC=BC.FRAME,GC=function(e){function t(t){var n;return(n=e.call(this,t,NC,FC.BUTTON_MINOR)||this).button.setWorldSize(56,56),n.setName("Journey"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:NC,frame:FC.ICON_DISCOVER_BLUE});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this)},t}(fs.Z),ZC=GC,UC=us.Z.DEFAULT,HC=UC.KEY,VC=UC.FRAME,WC=function(e){function t(t){var n;return(n=e.call(this,t,HC,VC.BUTTON_LONG_BLUE)||this).button.setWorldSize(311,50),n.setName("Replay"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:HC,frame:VC.ICON_REPLAY});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,-26,1)},n.createText=function(){var e=this.scene.make.image({key:HC,frame:VC.TEXT_REPLAY});e.setWorldSize(54,16),this.add(e),Phaser.Display.Align.In.Center(e,this,26,1)},t}(fs.Z),YC=WC,zC=us.Z.DEFAULT,KC=zC.KEY,jC=zC.FRAME,XC=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.backgroundContent=void 0,s.settingMusic=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingMusicContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonReplay=void 0,s.buttonHome=void 0,s.buttonJourney=void 0,s.buttonDaily=void 0,s.debuggerCurrentLevelText=void 0,s.debuggerCurrentLevel=0,s.handleClose=function(){s.runCloseAnimation()},s.handleSoundSetting=function(e){s.scene.player.setSetting("sound",e)},s.handleVibrateSetting=function(e){e&&kd(199),s.scene.player.setSetting("vibrate",e)},s.clickReplay=function(){var e=s.scene.storage.getState();if(nm(e)<1)return s.setVisible(!1),void s.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN);s.scene.storage.dispatch(pm()),s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.scene.screen.close(s.name),s.scene.handleRetryLevel();case 2:case"end":return e.stop()}}),e)}))))},s.clickButtonHome=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.scene.scene.switch(Ua.Co.DASHBOARD_SCENE);case 1:case"end":return e.stop()}}),e)}))))},s.clickButtonDaily=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.scene.scene.switch(Ua.Co.DAILY_SCENE);case 1:case"end":return e.stop()}}),e)}))))},s.scene=t,s.createPopup(),s.createTitle(),s.createSwitchButtons(),s.createButtons(),s.addItem(),s.arrangeItems(),s.createInput(),s.createDebuggerInputLevel(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.player.getPlayerSettings(),n=t.sound,i=t.vibrate;this.settingSound.updateStatus(n),this.settingVibrate.updateStatus(i),this.updateVibrateButton(),this.runOpenAnimation()},n.updateVibrateButton=function(){Pd()?this.settingVibrateContainer.revive():(this.settingVibrateContainer.kill(),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,-80))},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate.onClick=this.handleVibrateSetting},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,340),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:KC,frame:jC.TEXT_SETTING});e.setWorldSize(73,18),this.buttonClose=new fs.Z(this.scene,KC,jC.ICON_CLOSE,20,20),this.buttonClose.setName("Close"),this.title.add([e,this.buttonClose]),Phaser.Display.Align.In.Center(e,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,145,this.buttonClose.height/2)},n.createButtons=function(){this.createReplayButton(),this.createHomeButton(),this.createDailyButton(),this.createJourneyButton()},n.createReplayButton=function(){this.buttonReplay=new YC(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,0,10)},n.createHomeButton=function(){this.buttonHome=new LC(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome,Phaser.Display.Align.In.Center(this.buttonHome,this.buttonReplay,-90,96)},n.createJourneyButton=function(){this.buttonJourney=new ZC(this.scene),this.popup.add(this.buttonJourney),this.buttonJourney.onClick=this.clickButtonJourney.bind(this),Phaser.Display.Align.In.Center(this.buttonJourney,this.buttonReplay,0,96)},n.clickButtonJourney=function(){var e=this;this.runCloseAnimation(),this.scene.time.delayedCall(200,(function(){e.scene.scene.switch(Ua.Co.LEVEL_SCENE)}))},n.createDailyButton=function(){this.buttonDaily=new _C(this.scene),this.buttonDaily.onClick=this.clickButtonDaily,this.popup.add(this.buttonDaily),Phaser.Display.Align.In.Center(this.buttonDaily,this.buttonReplay,90,96)},n.createSwitchButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=e.vibrate;this.createSoundButton(t),this.createVibrateButton(n)},n.createVibrateButton=function(e){this.settingVibrateContainer=this.scene.make.container({});var t=this.scene.make.image({key:KC,frame:jC.ICON_VIBRATE});t.setWorldSize(32,32);var n=this.scene.make.image({key:KC,frame:jC.TEXT_VIBRATE});n.setWorldSize(50,11),this.settingVibrate=new Ey(this.scene,{enable:e,width:51,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([t,n,this.settingVibrate]),Phaser.Display.Align.In.Center(t,this.settingVibrateContainer,-135),Phaser.Display.Align.In.Center(n,t,50),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,127),this.popup.add(this.settingVibrateContainer),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this,0,-52)},n.createSoundButton=function(e){this.settingSoundContainer=this.scene.make.container({});var t=this.scene.make.image({key:KC,frame:jC.ICON_SOUND});t.setWorldSize(32,32);var n=this.scene.make.image({key:KC,frame:jC.TEXT_SOUND});n.setWorldSize(44,11),this.settingSound=new Ey(this.scene,{enable:e,width:51,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([t,n,this.settingSound]),Phaser.Display.Align.In.Center(t,this.settingSoundContainer,-135),Phaser.Display.Align.In.Center(n,t,50),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,127),this.popup.add(this.settingSoundContainer),Phaser.Display.Align.In.Center(this.settingSoundContainer,this,0,-102)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300),this.runPopupContentEntrancesAnimation(600,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.createDebuggerInputLevel=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){for(var t=this.scene.make.container({}),n=function(n){var i=e.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:e.scene.fontSize(34),origin:{x:.5,y:.5},text:""+n});t.add(i),i.setInteractive(),i.on("pointerdown",(function(){e.debuggerHandleClick(n)})),Phaser.Display.Align.In.Center(i,t,20*n)},i=0;i<10;i++)n(i);this.add(t),Phaser.Display.Align.In.Center(t,this.popup,-100,190),this.debuggerCurrentLevelText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Level 0"}),this.add(this.debuggerCurrentLevelText),Phaser.Display.Align.In.Center(this.debuggerCurrentLevelText,this.popup,0,210);var a=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Go"});this.add(a),a.setInteractive(),a.on("pointerdown",(function(){e.close(),e.scene.time.delayedCall(300,(function(){e.scene.levelManager.setLevel(e.debuggerCurrentLevel),e.scene.startGame()}))})),Phaser.Display.Align.In.Center(a,this.popup,0,230);var s=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Clear"});s.setInteractive(),s.on("pointerdown",(function(){e.debuggerCurrentLevel=0,e.debuggerCurrentLevelText.setText("Level "+String(e.debuggerCurrentLevel))})),this.add(s),Phaser.Display.Align.In.Center(s,this.popup,50,230)}},n.debuggerHandleClick=function(e){var t=this.debuggerCurrentLevel+""+e;this.debuggerCurrentLevel=parseInt(t),this.debuggerCurrentLevelText.setText("Level "+String(this.debuggerCurrentLevel))},t}(GameCore.Screen),qC=XC,JC=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidTileMap",i.message=t||"This tile is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,k.Z)(Error)),QC=us.Z.GAMEPLAY_32,$C=QC.KEY,eP=QC.FRAME,tP=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.imageGem=void 0,n.text=void 0,n.scene=t,n.init(),n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.createImageGem(),this.createText()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:$C,frame:eP.ICON_STAR_1}),this.imageGem.setWorldSize(40,40),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,-20,0)},n.createText=function(){this.text=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(42),origin:{x:.5,y:.5},text:"0"}),this.text.setTint(262685),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,20,3)},n.updateGem=function(e){this.imageGem.setFrame(e)},n.updateText=function(e){this.text.setText("x"+e)},n.getFrame=function(){return this.imageGem.frame.name},t}(Phaser.GameObjects.Container),nP=us.Z.DEFAULT,iP=nP.KEY,aP=nP.FRAME,sP=us.Z.GAMEPLAY_32.KEY,rP=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.listItems=[],s.playButton=void 0,s.targetImages=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.listAnimCollectionItem=[],s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.closeTimer=void 0,s.handleClose=function(){var e;null==(e=s.closeTimer)||e.remove(),s.runCloseAnimation()},s.scene=t,s.createPopup(),s.createTitle(),s.addItem(),s.createButtonPlay(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(t){var n=this;e.prototype.open.call(this,t);var i=this.getData(["duration"])[0];this.hideAllCollectionItems(),this.createCollectionItems(),this.alginCollectionItems(),this.runOpenAnimation(),this.closeTimer=this.scene.time.delayedCall(i,(function(){n.handleClose()}))},n.createCollectionItems=function(){for(var e=this.getData(["jsonTarget"])[0],t=te()(e),n=0;n<t.length;n++){var i=t[n],a=this.getCollectionItemFree(n);a.updateGem(ov[i]),a.updateText(e[i])}},n.getCollectionItemFree=function(e){var t=this.listItems[e];return t||(t=new tP(this.scene),this.popup.add(t),this.listItems.push(t)),t.setVisible(!0),t},n.alginCollectionItems=function(){var e;this.targetImages=[];for(var t=E()(e=this.listItems).call(e,(function(e){return e.visible})),n=t.length,i=263/(n+1)+5,a=-i*(n-1)/2,s=0;s<n;s++){var r=t[s];Phaser.Display.Align.In.Center(r,this.popup,a+i*s,-35);var o=r.getFrame(),c=this.scene.make.image({key:sP,frame:o});c.setWorldSize(22,22),c.setVisible(!1),this.targetImages.push(c),Phaser.Display.Align.In.Center(c,this.popup,a+i*s+this.scene.gameZone.width/2,this.scene.gameZone.height/2+20)}},n.hideAllCollectionItems=function(){for(var e=0;e<this.listItems.length;e++){this.listItems[e].setVisible(!1)}},n.moveGemsToCollectItems=function(){var e=this;this.resetPositionTargetImages();for(var t=this.scene.header.collectItems,n=t.getTargetKeys(),i=this.scene.gameZone.width/2,a=function(a){if(!e.targetImages[a])return"continue";var s=n[a],r=t.getPositionCollectionItem(s),o=i+r.x,c=r.y-33;e.targetImages[a].setAlpha(1),e.targetImages[a].setVisible(!0);var h=e.getFreeAnim(),l=Phaser.Math.Between(500,1e3);h.setTarget(e.targetImages[a]),h.runGemMoveToPosition(0,l,o,c).on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){e.scene.header.collectItems.showCollectItemByKey(s),e.targetImages[a].setVisible(!1),a==e.targetImages.length-1&&e.scene.main.board.handleTweenStartMission()}))},s=0;s<n.length;s++)a(s)},n.resetPositionTargetImages=function(){for(var e,t=E()(e=this.listItems).call(e,(function(e){return e.visible})),n=263/(t.length+1)+5,i=-n*(t.length-1)/2,a=0;a<t.length;a++){var s;this.targetImages[a]&&(null==(s=this.targetImages[a])||s.setVisible(!1),Phaser.Display.Align.In.Center(this.targetImages[a],this.popup,i+n*a+this.scene.gameZone.width/2,this.scene.gameZone.height/2))}},n.getFreeAnim=function(){var e=new yb(this.scene);return this.listAnimCollectionItem.push(e),e},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,280,{framePopupTop:aP.POPUP_TOP_1,framePopupMid:aP.POPUP_MID_1,framePopupBottom:aP.POPUP_BOTTOM_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:iP,frame:aP.TEXT_MISSION});e.setWorldSize(71,15),this.title.add([e]),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title,0,30),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.createButtonPlay=function(){this.playButton=new fs.Z(this.scene,iP,aP.BUTTON_LONG_BLUE,311,50),this.popup.add(this.playButton);var e=this.scene.make.image({key:iP,frame:aP.TEXT_PLAY});this.playButton.add(e),this.playButton.onClick=this.handleClose,e.setWorldSize(33,16),Phaser.Display.Align.In.BottomCenter(this.playButton,this.popup,0,-20)},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300),this.runPopupContentEntrancesAnimation(600,300))},n.runCloseAnimation=function(){var e,t,n=this;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.scene.time.delayedCall(50,(function(){n.moveGemsToCollectItems()})),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),oP=rP,cP=vs.STATUS,hP=us.Z.TUTORIAL,lP=hP.KEY,uP=hP.FRAME,pP=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.step=void 0,n.listPositionStart=void 0,n.listPositionTo=void 0,n.positionStart=void 0,n.positionTo=void 0,n.handFrame=void 0,n.tweenHand=void 0,n.validTargetPosition=function(e){var t={x:0,y:0};switch(n.step){case 0:case 1:t={x:3,y:3}}return t.x===e.x&&t.y===e.y},n.scene=t,n.step=0,n.initPosition(),n.createHand(),n}(0,o.Z)(t,e);var n=t.prototype;return n.start=function(){this.isRunning()||(this.setState(cP.RUNNING),this.handleStep())},n.initPosition=function(){var e=this.scene.gameZone,t=e.width,n=e.height,i=n/2+200,a=i+(n-85-i)/2;this.listPositionStart=[{x:t/2-90,y:a},{x:t/2+30,y:a+10}],this.listPositionTo=[{x:t/2-15,y:n/2-30},{x:t/2+55,y:n/2+30}]},n.createHand=function(){this.handFrame=this.scene.make.image({key:lP,frame:uP.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(ms.Z.ON_TOP),this.handFrame.setWorldSize(64,55)},n.createTweenHand=function(){this.tweenHand=this.scene.add.tween({paused:!0,repeatDelay:500,targets:this.handFrame,repeat:-1,x:{from:this.positionStart.x,to:this.positionTo.x},y:{from:this.positionStart.y,to:this.positionTo.y},duration:1500,ease:Phaser.Math.Easing.Sine.InOut}),this.tweenHand.play()},n.handleStep=function(){switch(this.positionStart=this.listPositionStart[this.step],this.positionTo=this.listPositionTo[this.step],this.handFrame.setVisible(!0),this.handFrame.setPosition(this.positionStart.x,this.positionStart.y),this.createTweenHand(),this.step){case 0:this.handleStep1();break;case 1:this.handleStep2()}},n.handleStep1=function(){this.scene.main.board.dataBoard[3][3].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[3][4].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[4][3].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0)},n.handleStep2=function(){this.scene.main.board.dataBoard[5][3].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[5][4].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[5][5].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[3][5].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[4][5].cell.setFrame(us.Z.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0)},n.handleCompleteTutorial=function(){this.setState(cP.STOPPED),this.stopAnimHand()},n.nextStep=function(){this.handFrame.setVisible(!1),this.step++,this.step>=2?this.handleCompleteTutorial():this.handleStep()},n.stopAnimHand=function(){var e;this.handFrame.setVisible(!1),null==(e=this.tweenHand)||e.stop()},n.runAnimHand=function(){this.handFrame.setVisible(!0),this.tweenHand.play()},n.validStep=function(e){return this.step===e},n.reset=function(){this.setState(cP.STOPPED),this.stopAnimHand(),this.step=0},t}(As),dP=pP,fP=function(e){return e[Vi]},mP=((0,K.P1)([function(e){return fP(e).isRequesting}],(function(e){return e})),(0,K.P1)([function(e){return fP(e).leaders}],(function(e){return e})),(0,K.P1)([function(e){return fP(e).time}],(function(e){return e}))),gP=us.Z.DEFAULT,vP=gP.KEY,yP=gP.FRAME,SP=function(e){function t(t){var n;return(n=e.call(this,t,vP,yP.BUTTON_MINOR_BIG)||this).button.setWorldSize(311,56),n.setName("Home"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:vP,frame:yP.ICON_HOME_BLUE});e.setWorldSize(31,28),this.add(e),Phaser.Display.Align.In.Center(e,this,-22,0)},n.createText=function(){var e=this.scene.make.image({key:vP,frame:yP.TEXT_HOME_BLUE});e.setWorldSize(42,11),this.add(e),Phaser.Display.Align.In.Center(e,this,22,0)},t}(fs.Z),EP=SP,AP=us.Z.GAMEPLAY,bP=AP.KEY,TP=AP.FRAME,CP=us.Z.GAMEPLAY_32,PP=CP.KEY,wP=CP.FRAME,IP=GameCore.Configs.Board,kP=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).scene=void 0,a.listCells=[],a.scene=t,a.setSize(n,i),a.createBoard(),a.initBoardCells(),a.scene.add.existing((0,as.Z)(a)),a}(0,o.Z)(t,e);var n=t.prototype;return n.createBoard=function(){var e=this.scene.make.image({key:bP,frame:TP.BOARD});e.setWorldSize(this.width,this.height),this.add(e)},n.spawnCell=function(e){return this.scene.make.image({key:PP,frame:e})},n.initBoardCells=function(){for(var e=0;e<IP.rows;e++){this.listCells[e]=[];for(var t=0;t<IP.cols;t++){var n=13*t-54+.5*t,i=13*e-54+.5*e,a=this.spawnCell(wP.GEM);a.setVisible(!1),a.setWorldSize(13,13),this.add(a),this.listCells[e].push(a),Phaser.Display.Align.In.Center(a,this,n,i)}}},n.resetCellBoard=function(){for(var e=0;e<IP.rows;e++)for(var t=0;t<IP.cols;t++){this.listCells[e][t].setVisible(!1)}},n.drawBoard=function(){this.resetCellBoard();var e=this.scene.storage.getState(),t=Kc(e),n=jc(e),i=em[t];n&&(i=rC()),i||(i=em[em.length-1]);var a=this.scene.make.tilemap({key:i.key}).layers;if((0,mm.isArray)(a)){var s=a[0].data;if((0,mm.isArray)(s))for(var r=0;r<s.length;r++)for(var o=s[r],c=0;c<o.length;c++){var h=o[c];if(!(h.index<0)){var l=rv[h.index-1],u=this.listCells[r][c];u.setFrame(l),u.setVisible(!0)}}}},t}(Phaser.GameObjects.Container),xP=kP,_P=us.Z.DEFAULT,OP=_P.KEY,DP=_P.FRAME,RP=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonHome=void 0,s.contents=void 0,s.miniBoard=void 0,s.avatar=void 0,s.backgroundContent=void 0,s.textTime=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonClose=void 0,s.leaderItems=void 0,s.scene=t,s.createPopup(),s.createContentBackground(),s.createMiniBoard(),s.createAvatar(),s.createTextTimeComplete(),s.createTitle(),s.createButtons(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.loadAvatar(),this.updateTextTime(),this.miniBoard.drawBoard(),this.runOpenAnimation()},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,-10,343,321,{forceHeightTop:47}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,0)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:OP,frame:DP.DAILY_BACKGROUND}),this.backgroundContent.setWorldSize(303,152),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-46)},n.createMiniBoard=function(){this.miniBoard=new xP(this.scene,120,120),this.popup.add(this.miniBoard),Phaser.Display.Align.In.LeftCenter(this.miniBoard,this.backgroundContent,-16,0)},n.createAvatar=function(){this.avatar=new Yp(this.scene,{key:OP,frame:DP.AVATAR_BORDER,background:DP.AVATAR_BACKGROUND,width:70,height:70,radius:10,borderWidth:10}),this.avatar.background.setVisible(!1),this.avatar.avtFrame.setVisible(!1),this.popup.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this.backgroundContent,60,-30)},n.createTextTimeComplete=function(){this.textTime=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(28),origin:{x:.5,y:.5}}),this.textTime.setTint(0),this.popup.add(this.textTime),Phaser.Display.Align.In.Center(this.textTime,this.avatar,0,50)},n.updateTextTime=function(){var e=this.scene.game.storage.getState(),t=mP(e);this.textTime.setText(this.secondsToHms(t))},n.secondsToHms=function(e){var t,n,i,a=Math.round(e/1e3%60),s=Math.floor(e/6e4%60),r=Math.floor(e/36e5%24);return Ne()(t="0"+r).call(t,-2)+":"+Ne()(n="0"+s).call(n,-2)+":"+Ne()(i="0"+a).call(i,-2)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:OP,frame:DP.TEXT_RESULT});e.setWorldSize(70,18),this.buttonClose=new fs.Z(this.scene,OP,DP.ICON_CLOSE,20,20),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([e,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title,0,0),Phaser.Display.Align.In.Center(this.buttonClose,this.title,140,0),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.clickButtonClose=function(){this.runCloseAnimation()},n.createButtons=function(){this.createButtonHome()},n.createButtonHome=function(){this.buttonHome=new EP(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome.bind(this),Phaser.Display.Align.In.BottomCenter(this.buttonHome,this.popup,0,-40)},n.clickButtonHome=function(){var e=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.scene.scene.switch(Ua.Co.DASHBOARD_SCENE);case 1:case"end":return t.stop()}}),t)}))))},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.storage.dispatch(Bl(!0)),n.scene.screen.open(ps.o4.MINI_JOURNEY_SCREEN)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.loadAvatar=function(){var e=this.scene.player.getPlayer(),t=e.playerId,n=e.photo;this.avatar.loadPhoto(t,n,100)},t}(GameCore.Screen),MP=GameCore.Configs,LP=MP.OtherHost,BP=MP.DailyChallenge,NP=function(){var e=(0,r.Z)(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yt("leaderboards/"+BP.LeaderBoardId+"/players/"+t,{score:n},{},LP);case 2:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),FP=function(){var e=(0,r.Z)(h().mark((function e(t,n){var i,a,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[],a=BP.Prefix+"/"+BP.LeaderBoardId+"/leaders"){e.next=4;break}return e.abrupt("return",i);case 4:return e.next=6,vt(a+"?limit="+t+"&offset="+n,{},LP);case 6:if(s=e.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){e.next=10;break}return e.abrupt("return",i);case 10:return i=r,e.abrupt("return",i);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function GP(e,t){var n="undefined"!==typeof oh()&&hh()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return ZP(e,t);var i=Ne()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return sh()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ZP(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ZP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var UP,HP=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n){var a,s,r,o,c;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.time,s=e.limit,r=e.offset,o=window.game.player,c=o.getPlayerId(),n({type:Wi,payload:{}}),n(YP(a)),t.next=8,NP(c,a);case 8:return t.next=10,(0,ht.qZ)(500);case 10:n(VP({limit:s,offset:r})),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),(0,i.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e){return t.apply(this,arguments)}}()},VP=function(e){return function(){var t=(0,r.Z)(h().mark((function t(n){var a,s,r,o,c,l,u,p,d,f,m,g,v,y,S,E,A,T,C;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:Wi,payload:{}}),a=e.limit,s=e.offset,r=window.game,o=r.player,c=r.profile,l=o.getPlayerId(),o.getConnectedPlayerIds(5,0).push(l),t.next=9,FP(a,s);case 9:return u=t.sent,p=b()(u).call(u,(function(e){return e.playerId})),p.push(o.getPlayerId()),t.next=14,c.requestProfiles(p);case 14:d=c.getProfiles(),f={},m=GP(u);case 17:if((g=m()).done){t.next=26;break}if(v=g.value,y=v.playerId,S=v.score,E=v.rank,d[y]){t.next=22;break}return t.abrupt("continue",24);case 22:A=d[y],T=A.name,C=A.photo,f[y]={playerId:y,name:T,photo:C,score:S,rank:E};case 24:t.next=17;break;case 26:n(WP(f)),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(0),n(WP([])),(0,i.tO)(t.t0);case 33:case"end":return t.stop()}}),t,null,[[0,29]])})));return function(e){return t.apply(this,arguments)}}()},WP=function(e){return{type:Yi,payload:{leaders:e}}},YP=function(e){return{type:zi,payload:{time:e}}},zP=us.Z.DEFAULT,KP=zP.KEY,jP=zP.FRAME,XP=us.Z.GAMEPLAY,qP=XP.KEY,JP=XP.FRAME,QP=us.Z.GAMEPLAY_32,$P=QP.KEY,ew=QP.FRAME,tw=GameCore.Configs,nw=tw.Network,iw=tw.Board,aw=function(e){function t(t,n,i,a){var s;(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.textCollect=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.collectTargetsContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var e=s.getData(["onClose"])[0];s.scene.screen.close(s.name),s.scene.scene.switch(Ua.Co.DASHBOARD_SCENE),e&&e()}))},s.decodeMathData=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}},s.scene=t;try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5)}catch(r){}return s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(h().mark((function t(n){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),t.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var e=this.scene.storage.getState(),t=Kc(e),n=em[t];n||(n=em[em.length-1]);var a=n,s=a.key,r=a.mapJson;if(this.scene.cache.tilemap.exists(s))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(s,r),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(o){(0,i.tO)(o)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.scene.storage.getState(),!Kc(t)){e.next=5;break}return e.abrupt("return");case 5:return this.showLoadingScreen(),e.next=8,this.scene.storage.dispatch(Tl());case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,i.tO)(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading level...",duration:nw.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(ps.o4.NOTIFY_SCREEN)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,500,{forceHeightTop:47}),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,0)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:KP,frame:jP.TEXT_JOURNEY});e.setTint(262685),e.setWorldSize(89,22),this.buttonClose=new fs.Z(this.scene,KP,jP.ICON_CLOSE,20,20),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add(this.buttonClose),this.title.add(e),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,148,-3),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-13)},n.createTargetItems=function(){this.collectTargetsContainer=this.scene.add.container(),this.textCollect=this.scene.make.image({key:KP,frame:jP.TEXT_COLLECT}),this.textCollect.setWorldSize(63,14),this.collectTargetsContainer.add(this.textCollect),this.popup.add(this.collectTargetsContainer),Phaser.Display.Align.In.Center(this.textCollect,this.collectTargetsContainer,0,-75)},n.drawTargetItems=function(){var e,t,n=this.scene.storage.getState(),i=Kc(n),a=em[i];a||(a=em[em.length-1]);var s=this.scene.make.tilemap({key:a.key}).properties;if(s&&(0,mm.isArray)(s)&&!(s.length<2)){for(var r=s[0].value,o=Jf()(e=Jf()(t=Jf()(r).call(r,"{",'{"')).call(t,", ",', "')).call(e,":",'":'),c=JSON.parse(o),h=te()(c),l=[],u=0;u<h.length;u++){var p=h[u],d=rv[p];ce()(l).call(l,d)||l.push(d)}var f=this.calcPosition(l.length);l=[];for(var m=0,g=0;g<h.length;g++){var v=h[g],y=rv[v],S=c[v];if(!ce()(l).call(l,y)){var E=this.targetData[g];E||(E=this.spawnTargetItem(y,S));var A=E,b=A.container,T=A.text,C=A.gem;b.setVisible(!0),T.setText("x"+(S||1)),C.setFrame(y),this.targetData.push(E),this.collectTargetsContainer.add(b),Phaser.Display.Align.In.Center(b,this.textCollect,f[m]+80,0),l.push(y),m++}}var P=this.textCollect.width+41*h.length;Phaser.Display.Align.In.TopCenter(this.collectTargetsContainer,this.popup,-P/2,-139)}},n.spawnTargetItem=function(e,t){var n=this.scene.make.container({}),i=this.scene.make.image({key:$P,frame:e});i.setWorldSize(30,30);var a=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(35),origin:{x:0,y:.5},text:"x"+t});return a.setTint(262685),n.add([i,a]),Phaser.Display.Align.In.Center(i,n,-10,0),Phaser.Display.Align.In.LeftCenter(a,i,-35,2),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(e){for(var t=[],n=0;n<e;n++)t.push(70*n);return t},n.createBoard=function(){var e=this.scene.make.image({key:qP,frame:JP.BOARD});e.setWorldSize(310.5,310.5),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,3),this.initCellBoard()},n.initCellBoard=function(){for(var e=0;e<iw.rows;e++){this.boardCellData[e]=[];for(var t=0;t<iw.cols;t++){var n=33.3*t-137+1*t,i=33.3*e-134+1*e,a=ew.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[e].push(s)}}},n.updateCellBoard=function(){var e=this.scene.storage.getState(),t=Yc(e).data.fen;if(t){var n=t.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var e=0;e<this.targetData.length;e++){var t,n;null==(t=this.targetData[e])||null==(n=t.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var e=0;e<iw.rows;e++)for(var t=0;t<iw.cols;t++){this.boardCellData[e][t].setFrame(ew.GEM_TRANSPARENT)}},n.drawBoardByFen=function(e){for(var t=Eu()(e).call(e).split("/"),n=0;n<t.length;n++)for(var i=t[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=Pv(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var e=this.scene.storage.getState(),t=Kc(e),n=em[t];n||(n=em[em.length-1]);var i=this.scene.make.tilemap({key:n.key}).layers;if((0,mm.isArray)(i)){var a=i[0].data;if((0,mm.isArray)(a))for(var s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var c=r[o];if(!(c.index<0)){var h=rv[c.index-1];this.boardCellData[s][o].setFrame(h)}}}},n.spawnCellBoard=function(e,t,n){var i=this.scene.make.image({key:$P,frame:e});return i.setWorldSize(32,32),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,t,n),i},n.createButtonPlay=function(){this.buttonPlay=new fs.Z(this.scene,KP,jP.BUTTON_LONG_BLUE,311,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var e=this.scene.make.image({key:KP,frame:jP.TEXT_PLAY});e.setWorldSize(33,16),this.buttonPlay.add([e]),Phaser.Display.Align.In.Center(e,this.buttonPlay),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.BottomCenter(this.buttonPlay,this.popup,0,-25)},n.handlePlay=function(){var e=this,t=this.scene.storage.getState();nm(t)<1?this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN):(this.scene.storage.dispatch(pm()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){e.scene.screen.close(e.name);var t=e.scene.storage.getState(),n=Kc(t);n>em.length||(e.scene.analytics.levelStart(n,void 0,e.getLevelName(n)),e.scene.storage.dispatch(Gl()),e.scene.handleRetryLevel())})))},n.getLevelName=function(e){var t;return"journey_"+ls()(t=GameCore.Utils.Number).call(t,e,4,"0")},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),sw=us.Z.DEFAULT,rw=sw.KEY,ow=sw.FRAME,cw=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.textScore=void 0,s.titleFrame=void 0,s.playButton=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.closeTimer=void 0,s.handleClose=function(){var e;null==(e=s.closeTimer)||e.remove(),s.runCloseAnimation()},s.scene=t,s.createPopup(),s.createTitle(),s.createTextScore(),s.addItem(),s.createButtonPlay(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(t){var n=this;e.prototype.open.call(this,t);var i=this.scene.targetMissionManager.getTargetValue();this.textScore.setText(""+i);var a=this.getData(["duration"])[0];this.runOpenAnimation(),this.closeTimer=this.scene.time.delayedCall(a,(function(){n.handleClose()}))},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(160),text:"0",origin:{x:.5,y:.5}}),this.textScore.setTint(3552586),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.popup,0,-30)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,280,{forceHeightTop:47,framePopupTop:ow.POPUP_TOP_1,framePopupMid:ow.POPUP_MID_1,framePopupBottom:ow.POPUP_BOTTOM_1}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:rw,frame:ow.TEXT_MISSION}),this.titleFrame.setWorldSize(71,15),this.title.add([this.titleFrame]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,18),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.createButtonPlay=function(){this.playButton=new fs.Z(this.scene,rw,ow.BUTTON_LONG_BLUE,311,50),this.popup.add(this.playButton);var e=this.scene.make.image({key:rw,frame:ow.TEXT_PLAY});this.playButton.add(e),this.playButton.onClick=this.handleClose,e.setWorldSize(33,16),Phaser.Display.Align.In.BottomCenter(this.playButton,this.popup,0,-40)},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300),this.runPopupContentEntrancesAnimation(600,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),hw=cw,lw=function(){function e(e){this.scene=void 0,this.bubbleDrop=void 0,this.scene=e,this.init()}var t=e.prototype;return t.init=function(){this.bubbleDrop=new gp(this.scene,{text:"STREAK 0X"})},t.runEffectBubbleDrop=function(e,t,n){var i=this.scene.gameZone.width,a=0,s=this.bubbleDrop.calTotalWidthListText("STREAK "+e+"X"),r=t-s,o=i-s-t;r<0&&(a=Math.abs(r/2)),o<0&&(a=o/2),this.bubbleDrop.updateText(e+"X STREAK",t+a,n),this.bubbleDrop.start(0,650)},t.runEffectBubbleCombo=function(e,t,n){var i=this.scene.gameZone.width,a=0,s=this.bubbleDrop.calTotalWidthListTextCombo(e+"X COMBO"),r=t-s,o=i-s-t;r<0&&(a=Math.abs(r/2)),o<0&&(a=o/2),this.bubbleDrop.updateTextCombo(e+"X COMBO",t+a,n),this.bubbleDrop.start(0,650)},e}(),uw=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.textScoreReached=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.starSuperTwinkle=void 0,s.open=function(t){e.prototype.open.call((0,as.Z)(s),t),s.scene.enableInput(),s.runPopupEntrancesAnimation(300,300),s.textScoreReached.restart(),s.scene.audio.playSound(ds.Z.SCORE_REACHED)},s.close=function(){e.prototype.close.call((0,as.Z)(s))},s.scene=t,s.setDepth(ps.Ks.POPUP),s.background.setAlpha(0),s.createContent(),s}(0,o.Z)(t,e);var n=t.prototype;return n.runPopupEntrancesAnimation=function(e,t){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:e,duration:t,onUpdate:function(e){var t=e.getValue();n.background.setAlpha(t)},onComplete:function(){n.textScoreReached.start(),n.starSuperTwinkle.playConfettiAnimation(),n.handleDelegate(),n.runAnim()}})),this.tweenBackground.play()},n.handleDelegate=function(){var e,t=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(e=this.closeTimerEvent)||e.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){t.visible&&t.scene.screen.close(t.name),s&&s()}}))},n.runAnim=function(){},n.createContent=function(){this.createText(),this.createAnim()},n.createText=function(){this.textScoreReached=new ay(this.scene,{text:"SCORE REACHED!",font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(80)}),this.add(this.textScoreReached),Phaser.Display.Align.In.Center(this.textScoreReached,this)},n.createAnim=function(){this.starSuperTwinkle=new fy(this.scene),this.add(this.starSuperTwinkle),this.add(this.starSuperTwinkle.getImages())},t}(GameCore.Screen),pw=GameCore.Configs,dw=pw.Board,fw=pw.Network,mw=us.Z.GAMEPLAY_32.FRAME,gw=function(e){function t(){for(var t,n,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=e.call.apply(e,y()(t=[this]).call(t,s))||this).lastTimeInputEnabled=0,n.tutorialManager=void 0,n.levelManager=void 0,n.mapManager=void 0,n.targetMissionManager=void 0,n.effectManager=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.isGameOver=void 0,n.isLevelComplete=void 0,n.restartCurrentLevel=0,n.startGameAt=void 0,n.endGameAt=void 0,n.run=function(){var e=n.storage.getState();!0!==dc(e)&&n.storage.dispatch(Bl(!0)),n.preloadNextLevel(),n.startGame(),n.analytics.levelStart(n.levelManager.getLevel(),void 0,n.getLevelName())},n.sleep=function(){n.screen.close(ps.o4.MINI_JOURNEY_SCREEN)},n.create=function(){e.prototype.create.call((0,as.Z)(n)),n.createBackground(Ia.Z.BACKGROUND.KEY),n.createTutorialManager(),n.createLevelManager(),n.createMapManager(),n.createTargetMissionManager(),n.createHeader(),n.createMain(),n.createFooter(),n.createEffectManager(),n.createScreens(),n.createInput(),n.input.setTopOnly(!0),n.preLoadAds()},n.onConfirm=function(){FBInstant.player.setDataAsync({level:1}),n.storage.dispatch(wl(1)),n.levelManager.setLevel(1),n.screen.close(ps.o4.START_OVER_SCREEN),n.screen.close(ps.o4.MISSION_COLLECTION_COMPLETE_SCREEN),n.handleRestartLevel()},n.handleClickStartOver=function(){n.screen.open(ps.o4.START_OVER_SCREEN,{onConfirm:n.onConfirm})},n.handlePauseGame=function(){n.isGameOver||n.isLevelComplete||(0,as.Z)(n).screen.open(ps.o4.SETTINGS_SCREEN)},n.handleShowMidRollAd=function(){var e=(0,r.Z)(h().mark((function e(t){var a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!0),a=n.game.globalScene,e.prev=2,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){e.next=6;break}return e.abrupt("return");case 6:return a.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading ads...",duration:fw.Timeout,loading:!0}),e.next=9,n.ads.showMidRollAdAsync();case 9:n.analytics.showInterstitialAd(n.getSceneName()),e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return");case 15:return e.prev=15,a.screen.close(ps.o4.NOTIFY_SCREEN),n.audio.playMusic(),n.ads.preloadMidRollAdAsync().catch(i.tO),n.audio.playMusic(),e.finish(15);case 21:case"end":return e.stop()}}),e,null,[[2,12,15,21]])})));return function(t){return e.apply(this,arguments)}}(),n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run),this.events.on(Phaser.Scenes.Events.SLEEP,this.sleep)},n.preLoadAds=function(){this.ads.preloadMidRollAdAsync().catch((function(e){})),this.ads.preloadRewardedVideoAsync().catch((function(e){}))},n.createHeader=function(){this.header=new gT(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createTutorialManager=function(){this.tutorialManager=new dP(this)},n.createLevelManager=function(){this.levelManager=new oC(this)},n.createMapManager=function(){this.mapManager=new cC(this)},n.createEffectManager=function(){this.effectManager=new lw(this)},n.createTargetMissionManager=function(){this.targetMissionManager=new hC},n.createMain=function(){this.main=new Hb(this)},n.createFooter=function(){this.footer=new nC(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.createScreens=function(){this.createMissionScoreCompleteScreen(),this.createMissionCollectionCompleteScreen(),this.createCollectionCompletedScreen(),this.createNoSpaceLeftScreen(),this.createMissionFailScreen(),this.createSettingScreen(),this.createCollectionItemsScreen(),this.createDailyChallengeModeScreen(),this.createMiniJourneyScreen(),this.createTargetScoreScreen(),this.createClaimHeartScreen(),this.createStartOverScreen(),this.createScoreReachedScreen()},n.createScoreReachedScreen=function(){this.screen.add(ps.o4.SCORE_REACHED_SCREEN,uw)},n.createCollectionCompletedScreen=function(){this.screen.add(ps.o4.COLLISION_COMPLETED_SCREEN,uC)},n.createMissionScoreCompleteScreen=function(){this.screen.add(ps.o4.MISSION_SCORE_COMPLETE_SCREEN,mC)},n.createMissionCollectionCompleteScreen=function(){this.screen.add(ps.o4.MISSION_COLLECTION_COMPLETE_SCREEN,SC)},n.createDailyChallengeModeScreen=function(){this.screen.add(ps.o4.DAILY_CHALLENGE_SCREEN,RP)},n.createMissionFailScreen=function(){this.screen.add(ps.o4.MISSION_FAIL_SCREEN,PC)},n.createNoSpaceLeftScreen=function(){this.screen.add(ps.o4.NO_SPACE_LEFT_SCREEN,AC)},n.createSettingScreen=function(){this.screen.add(ps.o4.SETTINGS_SCREEN,qC)},n.createCollectionItemsScreen=function(){this.screen.add(ps.o4.COLLECTION_ITEMS_SCREEN,oP)},n.createMiniJourneyScreen=function(){this.screen.add(ps.o4.MINI_JOURNEY_SCREEN,aw)},n.createTargetScoreScreen=function(){this.screen.add(ps.o4.TARGET_SCORE_SCREEN,hw)},n.createClaimHeartScreen=function(){this.screen.add(ps.o4.CLAIM_HEART_SCREEN,EA)},n.createStartOverScreen=function(){this.screen.add(ps.o4.START_OVER_SCREEN,PA)},n.openLevelScreen=function(){this.screen.open(ps.o4.LEVEL_SCREEN)},n.handleNextLevel=function(){var e=this.levelManager.getNextLevelConfig();if(e){var t=e.key;this.cache.tilemap.exists(t)?this.handleLoadMapComplete():(this.preloadNextLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadMapComplete.bind(this)))}else{this.levelManager.increaseLevel();var n=this.levelManager.getLevel();FBInstant.player.setDataAsync({level:n})}},n.handleSwitchJourney=function(){var e=this.levelManager.getLevelConfig();if(e){var t=e.key;this.cache.tilemap.exists(t)?this.handleSwitchMode():(this.preloadCurrentLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadMapComplete.bind(this)))}},n.handleSwitchMode=function(){var e,t=this.levelManager.getLevel();this.storage.dispatch((e={data:"",level:t,listPieceMap:[]},function(t,n){var i=window.game.player.getPlayerId(),a=n(),r=Yc(a),o=(0,s.Z)({},r,e),c=o.data;o.data=rl(c),t(dl(o)),(0,Fh.vk)(sl.JourneyMatchStore+"-"+i,o)})),FBInstant.player.setDataAsync({level:t}),this.mapManager.reloadMap(),this.clearFen()},n.handleLoadMapComplete=function(){this.levelManager.increaseLevel();var e=this.levelManager.getLevel();FBInstant.player.setDataAsync({level:e}),this.mapManager.reloadMap()},n.handleGuideIfLevel1=function(){var e=this.storage.getState();jc(e)||1===this.levelManager.getLevel()&&this.tutorialManager.start()},n.startGame=function(){try{var e,t;this.isGameOver=!1,this.isLevelComplete=!1,this.mapManager.reloadMap(),null==(e=this.tutorialManager)||e.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces(),this.loadTargetByMap(),this.header.start(),null==(t=this.header.mainScoreBlock.addScore)||t.stop().remove(),this.header.mainScoreBlock.setScore(0),this.header.mainScoreBlock.setScoreText(0),this.header.progressBar.hideProgressBar(),this.header.progressBar.setPercent(0),this.loadBoardAndPieces(),this.loadTargetAmountByFen(),this.restartCurrentLevel=0,this.openMissionScreen()}catch(n){this.handleRestartLevel(),(0,i.R0)(n,{scene:"Journey scene"})}},n.startGameAfterCollectionItemsScreenClose=function(){var e;this.startGameAt=(new Date).getTime();var t=this.storage.getState(),n=jc(t),i=((null==(e=Yc(t))?void 0:e.data)||{}).fen;!i||n?(this.footer.pieces.start(),this.handleGuideIfLevel1()):this.loadPiecesByFen(i)},n.openMissionScreen=function(){switch(this.targetMissionManager.getTargetType()){case Cb:this.openCollectionItemsScreen();break;case Tb:this.openTargetScoreScreen()}},n.openCollectionItemsScreen=function(){var e=this,t=this.header.collectItems.getJsonTarget();this.header.collectItems.hideListCollectItems(),this.disableInput(),this.time.delayedCall(500,(function(){e.enableInput(),e.screen.open(ps.o4.COLLECTION_ITEMS_SCREEN,{jsonTarget:t,duration:2e3})}))},n.openTargetScoreScreen=function(){var e=this;this.disableInput(),this.time.delayedCall(500,(function(){e.enableInput(),e.screen.open(ps.o4.TARGET_SCORE_SCREEN,{duration:2e3})}))},n.showCollectItems=function(){this.header.collectItems.showListCollectItems()},n.loadBoardAndPieces=function(){var e,t=this.storage.getState(),n=jc(t),i=((null==(e=Yc(t))?void 0:e.data)||{}).fen,a=null,s=null;if(i&&!n){var r=this.main.board.getBoardByFen(i);return a=this.handleDynamicFenSize(r),s=this.footer.pieces.getPiecesByFen(i),this.isFenGameOver(a,s)?(this.clearFen(),this.loadBoardByMap(),void this.loadPiecesByMap()):void this.loadBoardByFen(i)}this.loadBoardByMap(),this.loadPiecesByMap()},n.loadBoardByFen=function(e){var t=this.main.board.getBoardByFen(e);this.main.board.startGame(t,e)},n.loadBoardByMap=function(){for(var e=this.mapManager.getTileMap().layers,t=e.length,n=0;n<t;n++)for(var a=e[n].data,s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var c=r[o];if(!(c.index<0)){var h=this.main.board.getFrameByMapItemIndex(c.index-1);h&&h!==mw.GEM_TRANSPARENT||(h=this.main.board.getFrameByMapItemIndex(1),(0,i.R0)(new Error("MapByBoardError"),{index:c.index,level:this.levelManager.getLevel(),row:s,col:o})),this.main.board.setFrameBoardByIndex(s,o,h)}}this.main.board.fadeIn()},n.loadPiecesByFen=function(e){var t=this.footer.pieces.getPiecesByFen(e);this.footer.pieces.showAvailablePieces(t),this.loadListPieceMapByFen()},n.loadListPieceMapByFen=function(){var e=this.storage.getState(),t=Yc(e).listPieceMap;t&&0!==t.length&&this.footer.pieces.setListPieceMap(t)},n.loadPiecesByMap=function(){this.footer.pieces.buildPiecesByMap();var e=this.mapManager.getTileMap().getObjectLayer("spawnOrder");if(e)for(var t=e.objects,n=0;n<t.length;n++){var i=t[n],a=i.type,r=i.properties,o=this.footer.pieces.getPieceDataByType(a);r&&(o=(0,s.Z)({},o,{properties:r})),o&&this.footer.pieces.addItemPieceMap(o)}},n.loadTargetByMap=function(){var e=this.mapManager.getTileMap().properties;if(!e||!(0,mm.isArray)(e)||e.length<2)throw new JC;var t=e[0].value,n=e[1].value;this.targetMissionManager.setTargetValue(t),this.targetMissionManager.setTargetType(n)},n.loadTargetAmountByFen=function(){var e;this.header.collectItems.resetTextAmount();var t=this.storage.getState();if(!jc(t)){var n=((null==(e=Yc(t))?void 0:e.data)||{}).jsonAmount;n&&0!==te()(n).length&&this.header.collectItems.updateJsonAmountByFen(n)}},n.getTextDay=function(){var e,t=new Date,n="0"+t.getDate(),i="0"+(t.getMonth()+1),a=Ne()(e=String(t.getFullYear())).call(e,-2);return Ne()(i).call(i,-2)+"/"+Ne()(n).call(n,-2)+"/"+a},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.handleRestartLevel=function(){this.restartCurrentLevel>0||(this.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Restarting map...",duration:fw.Timeout,loading:!0}),this.restartCurrentLevel++,this.preloadCurrentLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this)),this.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR),this.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadCurrentMapError.bind(this)))},n.handleGameOver=function(){this.isGameOver=!0,this.screen.open(ps.o4.GAME_OVER_SCREEN)},n.handleRequestFinishGame=function(){var e=this;this.isGameOver=!0,this.clearFen();var t=this.storage.getState();if(jc(t)){var n,a=sC(),s=ls()(n=GameCore.Utils.Number).call(n,a,4,"0");this.analytics.event(Ht._.DAILY_CHALLENGE_FAIL,{level:a,levelName:"daily_challenge_"+s})}else this.analytics.levelFail(this.levelManager.getLevel(),void 0,this.getLevelName());this.screen.open(ps.o4.NO_SPACE_LEFT_SCREEN,{duration:3e3,onClose:function(){e.handleShowMidRollAd().catch(i.tO),e.screen.open(ps.o4.MISSION_FAIL_SCREEN)}})},n.checkAnimPlaying=function(){var e=this.tweens.getAllTweens();return!(!e||0===e.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(e){return e.piece.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.handleUpdateScore=function(e){var t=this.header.mainScoreBlock.score+e;this.storage.dispatch(function(e){return{type:zn,payload:{score:e}}}(t))},n.handleAddScoreAnim=function(e){this.header.mainScoreBlock.animAddScore(e)},n.updateProgressTargetScore=function(e){var t=this.header.progressBar.getTargetScore();this.header.progressBar.setPercent(e/t)},n.handleCompleteScoreMission=function(){var e=this;if(!this.isGameOver&&this.targetMissionManager.getTargetType()===Tb&&!(this.header.mainScoreBlock.score<parseInt(this.targetMissionManager.getTargetValue()))){this.isGameOver=!0;var t=this.storage.getState(),n=jc(t);this.screen.open(ps.o4.SCORE_REACHED_SCREEN,{duration:4e3,onClose:function(){if(n){var t=(new Date).getTime()-e.startGameAt;return e.storage.dispatch(HP({time:t,limit:100,offset:0})),e.storage.dispatch(Pl()),void e.screen.open(ps.o4.DAILY_CHALLENGE_SCREEN)}e.handleNextLevel(),e.screen.open(ps.o4.MISSION_SCORE_COMPLETE_SCREEN)}})}},n.canUpdateFenMatch=function(){var e=this.storage.getState(),t=jc(e);return!(this.isGameOver||this.isLevelComplete||t)},n.updateMatchData=function(){var e;if(this.canUpdateFenMatch()){var t=this.getFen(),n=this.storage.getState(),i=Yc(n).data||{},a=zc(n),r=Xc(n)||0,o=this.levelManager.getLevel(),c=this.header.collectItems.getJsonAmount(),h=this.footer.pieces.getListPieceMap();this.storage.dispatch(ll(a,{score:r,data:(0,s.Z)({},i,{fen:t,jsonAmount:(0,s.Z)({},c)}),level:o,updateAt:Date.now(),listPieceMap:y()(e=[]).call(e,h)}))}},n.clearFen=function(){var e=this.storage.getState(),t=zc(e),n=Xc(e).score,i=void 0===n?0:n,a=this.levelManager.getLevel();this.storage.dispatch(ll(t,{score:i,data:{fen:"",jsonAmount:{}},level:a,listPieceMap:[],updateAt:Date.now()}))},n.update=function(e){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=e:e-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=e)},n.isFenGameOver=function(e,t){for(var n=[],i=0;i<t.length;i++){var a=t[i],s=a.type,r=a.direction,o=a.isReverse;switch(s){case Um:case Hm:case Vm:n.push({data:wT.getData(s,r,o)});break;case Wm:case Ym:case zm:case Km:n.push({data:kT.getData(s,r)});break;case jm:case Xm:case qm:n.push({data:_T.getData(s)});break;case Qm:n.push({data:DT.getData(r)});break;case $m:n.push({data:BT.getData(r)});break;case sg:n.push({data:HT.getData(r)});break;case tg:case ng:case ig:case ag:n.push({data:ZT.getData(s,r)});break;case Jm:n.push({data:MT.getData(r)});break;case eg:n.push({data:FT.getData()})}}return yv(e,n)},n.handleDynamicFenSize=function(e){var t,n,i=0;if((n=e.length)&&(i=e[0].length),0===n||0===i)return e;var a=y()(t=[]).call(t,e);if(n>dw.rows)rs()(a).call(a,dw.rows,n-dw.rows);else if(i<dw.rows)for(var s=0;s<dw.rows-n;s++){var r;a.push(cs()(r=new Array(n)).call(r,{value:0,frame:mw.GEM_TRANSPARENT}))}return i>dw.cols?a.forEach((function(e){rs()(e).call(e,dw.cols,i-dw.cols)})):i<dw.cols&&a.forEach((function(e){for(var t=0;t<dw.cols-i;t++)e.push({value:0,frame:mw.GEM_TRANSPARENT})})),a},n.handleCollectionItemsComplete=function(){var e=this;if(this.targetMissionManager.getTargetType()!==Tb&&this.header.collectItems.checkCompleteMission()){this.endGameAt=(new Date).getTime(),this.clearFen(),this.audio.playSound(ds.Z.TARGET_REACHED);var t=this.levelManager.getLevel(),n=this.storage.getState();if(Yc(n).challengeMode){var a,s=sC(),o=ls()(a=GameCore.Utils.Number).call(a,s,4,"0");this.handleSwitchJourney(),this.analytics.event(Ht._.DAILY_CHALLENGE_END,{level:s,levelName:"daily_challenge_"+o})}else this.handleNextLevel(),this.analytics.levelComplete(t,void 0,this.getLevelName());t>em.length-1&&this.time.delayedCall(2e3,(function(){e.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"UPDATING NEW LEVELS...",duration:1e3}),e.time.delayedCall(1e3,(function(){e.scene.switch(Ua.Co.LEVEL_SCENE)}))})),this.screen.open(ps.o4.COLLISION_COMPLETED_SCREEN,{duration:3e3,onClose:function(){var t=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLevelComplete=!1,t.next=3,e.handleShowMidRollAd().catch(i.tO);case 3:e.showPopupCompleteScreenAfterCollectionCompleted();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})}},n.showPopupCompleteScreenAfterCollectionCompleted=function(){var e=(0,r.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.storage.getState(),!jc(t)){e.next=8;break}return n=this.endGameAt-this.startGameAt,this.storage.dispatch(HP({time:n,limit:100,offset:0})),this.storage.dispatch(Pl()),this.screen.open(ps.o4.DAILY_CHALLENGE_SCREEN),e.abrupt("return");case 8:this.screen.open(ps.o4.MISSION_COLLECTION_COMPLETE_SCREEN);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setLevelCompleted=function(e){this.targetMissionManager.getTargetType()!==Tb&&(this.isLevelComplete=e)},n.handleRetryLevel=function(){var e=this.storage.getState();if(Yc(e).challengeMode){var t,n=sC(),i=ls()(t=GameCore.Utils.Number).call(t,n,4,"0");this.analytics.event(Ht._.DAILY_CHALLENGE_BEGIN,{level:n,levelName:"daily_challenge_"+i})}else this.analytics.levelStart(this.levelManager.getLevel(),void 0,this.getLevelName());this.header.progressBar.reset(),this.clearFen(),this.startGame()},n.preloadNextLevel=function(){var e=this.levelManager.getNextLevelConfig();if(e){var t=e.key,n=e.mapJson;"level-from-json"!==t&&(this.cache.tilemap.exists(t)||(this.load.tilemapTiledJSON(t,n),this.load.start()))}},n.preloadCurrentLevel=function(){var e=this.levelManager.getLevelConfig();if(e){var t=e.key,n=e.mapJson;this.cache.tilemap.exists(t)?this.handleLoadCurrentMapComplete():(this.load.tilemapTiledJSON(t,n),this.load.start())}},n.handleLoadCurrentMapComplete=function(){var e=this.game.globalScene;this.mapManager.reloadMap(),this.clearFen(),this.startGame(),e.screen.close(ps.o4.NOTIFY_SCREEN)},n.handleLoadCurrentMapError=function(e){var t=this.game.globalScene,n=new lS("Load resources at LoadScene failed.");(0,i.R0)(n,{file:null==e?void 0:e.url}),t.screen.close(ps.o4.NOTIFY_SCREEN)},n.getLevelName=function(){var e,t=this.levelManager.getLevel();return"journey_"+ls()(e=GameCore.Utils.Number).call(e,t,4,"0")},t}(Ql.Z),vw=gw;null==(UP=void 0)||UP.accept(GameCore.LiveUpdate.Scene(Ua.Co.JOURNEY_SCENE));var yw=vw,Sw=us.Z.DEFAULT,Ew=Sw.KEY,Aw=Sw.FRAME,bw=function(e){function t(t){var n;return(n=e.call(this,t)||this).createIcon(),n.scene.add.existing((0,as.Z)(n)),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:Ew,frame:Aw.LET_GO});e.setWorldSize(144,134),this.add(e)},t}(Phaser.GameObjects.Container),Tw=bw,Cw=us.Z.DEFAULT,Pw=Cw.KEY,ww=Cw.FRAME,Iw=function(e){function t(t){var n;return(n=e.call(this,t,Pw,ww.BUTTON_LONG_BLUE)||this).button.setWorldSize(343,56),n.setName("Play"),n.createText(),n}return(0,o.Z)(t,e),t.prototype.createText=function(){var e=this.scene.make.image({key:Pw,frame:ww.TEXT_PLAY});e.setWorldSize(33,16),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),kw=Iw,xw=us.Z.DEFAULT,_w=xw.KEY,Ow=xw.FRAME,Dw=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.text=void 0,n.createBackground(),n.createText(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:_w,frame:Ow.CALENDAR_BG_GREY}),this.background.setWorldSize(44,44),this.add(this.background)},n.createText=function(){this.text=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(25),origin:{x:.5,y:.5}}),this.add(this.text)},n.setText=function(e){this.text.setText(e)},n.setTint=function(e){this.text.setTint(e)},n.setBackground=function(e){this.background.setFrame(e)},t}(Phaser.GameObjects.Container),Rw=Dw,Mw=us.Z.DEFAULT,Lw=Mw.KEY,Bw=Mw.FRAME,Nw=["MON","TUE","WED","THU","FRI","SAT","SUN"],Fw=["January","February","March","April","May","June","July","August","September","October","November","December"],Gw=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.title=void 0,n.listCalendarItem=[],n.currentDate=new Date,n.createBackground(),n.createTitle(),n.createArrowTitle(),n.createTitleDay(),n.drawDayOfCurrentMonth(n.currentDate),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.add.container(),this.background.setSize(343,370);var e=this.scene.make.image({key:Lw,frame:Bw.BG_WHITE_TOP});this.background.add(e);var t=this.scene.make.image({key:Lw,frame:Bw.BG_WHITE_BOT});this.background.add(t);var n=this.scene.make.image({key:Lw,frame:Bw.BG_WHITE_BOT});this.background.add(n),e.setWorldSize(this.background.width,this.background.width*e.height/e.width),t.setWorldSize(this.background.width,this.background.width*t.height/t.width),n.setWorldSize(this.background.width,this.background.height-e.displayHeight-t.displayHeight),Phaser.Display.Align.In.Center(e,this.background,0,-n.displayHeight/2-e.displayHeight/2),Phaser.Display.Align.In.Center(n,this.background),Phaser.Display.Align.In.Center(t,this.background,0,n.displayHeight/2+t.displayHeight/2),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,-102)},n.createTitle=function(){this.title=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(28),text:"May 2022",origin:{x:.5,y:.5}}),this.title.setTint(262685),this.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.background,0,-16)},n.createArrowTitle=function(){var e=this.scene.make.image({key:Lw,frame:Bw.ICON_ARROW_LEFT});e.setWorldSize(9,16),e.setInteractive().input.hitArea.setTo(0,0,40,40),e.on(Phaser.Input.Events.POINTER_DOWN,this.clickPrevMonth.bind(this));var t=this.scene.make.image({key:Lw,frame:Bw.ICON_ARROW_RIGHT});t.setWorldSize(9,16),t.setInteractive().input.hitArea.setTo(0,0,40,40),t.on(Phaser.Input.Events.POINTER_DOWN,this.clickNextMonth.bind(this)),this.add([e,t]),Phaser.Display.Align.In.Center(e,this.title,-139,0),Phaser.Display.Align.In.Center(t,this.title,139,0)},n.getStartX=function(){return-139},n.getDistance=function(){return 280/(Nw.length-1)},n.getAmountDataInMonth=function(){var e=new Date,t=e.getMonth(),n=e.getFullYear();return new Date(n,t,0).getDate()},n.createTitleDay=function(){for(var e=this.getDistance(),t=this.getStartX(),n=0;n<Nw.length;n++){var i=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(21),text:Nw[n],origin:{x:.5,y:.5}});i.setTint(3304186),this.add(i),Phaser.Display.Align.In.Center(i,this.title,t+n*e,44)}},n.drawDayOfCurrentMonth=function(e){this.hideListCalendarItem(),this.currentDate=e,this.setTitle(),e.setDate(7);for(var t=new Date(e.getFullYear(),e.getMonth(),0).getDate(),n=e.getDay(),i=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),a=this.getStartX(),s=this.getDistance(),r=73,o=0,c=0,h=7-new Date(e.getFullYear(),e.getMonth()+1,0).getDay(),l=0;l<n;l++){var u=this.spawnCalendarItem(c);7===o&&(r+=47,o=0),u.setText(""+(t+l-n+1)),u.setTint(6842231),u.setBackground(Bw.CALENDAR_BG_GREY),this.add(u),Phaser.Display.Align.In.Center(u,this.title,a+l*s,r),o++,c++}for(var p=o,d=p+1;d<=i+p;d++){7===o&&(r+=47,o=0);var f=this.spawnCalendarItem(c);f.setText(""+(d-p)),f.setTint(262685);var m=Bw.CALENDAR_BG_LIGHT_BLUE;this.isToDay(d-p,this.currentDate.getMonth(),this.currentDate.getFullYear())&&(m=Bw.CALENDAR_BG_BLUE,f.setTint(16777215)),f.setBackground(m),this.add(f),Phaser.Display.Align.In.Center(f,this.title,a+((d%7===0?7:d%7)-1)*s,r),o++,c++}h<42-c&&(h=42-c);for(var g=(p=o)+1;g<=p+h;g++){7===o&&(r+=47,o=0);var v=this.spawnCalendarItem(c);v.setText(""+(g-p)),v.setTint(6842231),v.setBackground(Bw.CALENDAR_BG_GREY),this.add(v),Phaser.Display.Align.In.Center(v,this.title,a+((g%7===0?7:g%7)-1)*s,r),o++,c++}},n.isToDay=function(e,t,n){var i=new Date;return i.getFullYear()===n&&i.getMonth()===t&&i.getDate()===e},n.spawnCalendarItem=function(e){var t=null;return this.listCalendarItem[e]&&(t=this.listCalendarItem[e]),t||(t=new Rw(this.scene),this.listCalendarItem.push(t)),t.setVisible(!0),t},n.clickNextMonth=function(){var e=this.currentDate;e=11===e.getMonth()?new Date(e.getFullYear()+1,0,1):new Date(e.getFullYear(),e.getMonth()+1,1),this.drawDayOfCurrentMonth(e)},n.clickPrevMonth=function(){var e=this.currentDate;e=0===e.getMonth()?new Date(e.getFullYear()-1,11,1):new Date(e.getFullYear(),e.getMonth()-1,1),this.drawDayOfCurrentMonth(e)},n.hideListCalendarItem=function(){this.listCalendarItem.forEach((function(e){e.setVisible(!1)}))},n.setTitle=function(){var e=Fw[this.currentDate.getMonth()]+" "+this.currentDate.getFullYear();this.title.setText(e)},t}(Phaser.GameObjects.Container),Zw=Gw,Uw=us.Z.DEFAULT,Hw=(Uw.KEY,Uw.FRAME,function(e){function t(t){var n;return(n=e.call(this,t)||this).buttonPlay=void 0,n.calendar=void 0,n.createCalendar(),n.createButtonPlay(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createCalendar=function(){this.calendar=new Zw(this.scene),this.add(this.calendar)},n.createButtonPlay=function(){this.buttonPlay=new kw(this.scene),this.buttonPlay.onClick=this.handlePlay.bind(this),this.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.calendar,0,132)},n.handlePlay=function(){var e=this.scene.storage.getState(),t=Kc(e),n=nm(e);t>em.length||(n<1?this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN):(this.scene.storage.dispatch(pm()),this.scene.storage.dispatch(Cl()),this.scene.storage.dispatch(Gl()),this.scene.analytics.event(Ht._.DAILY_CHALLENGE_BEGIN)))},t}(Phaser.GameObjects.Container)),Vw=Hw,Ww=GameCore.Configs.Network,Yw=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).main=void 0,n.header=void 0,n.footer=void 0,n.run=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.loadLevelConfig();case 1:case"end":return e.stop()}}),e)}))),n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.loadLevelConfig=function(){try{this.showLoadingScreen();var e=rC(),t=e.key,n=e.mapJson;if(this.cache.tilemap.exists(t))return void this.handleLoadCurrentMapComplete();this.load.tilemapTiledJSON(t,n),this.load.start(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(a){(0,i.tO)(a)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen()},n.showLoadingScreen=function(){this.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading level...",duration:Ww.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.game.globalScene.screen.close(ps.o4.NOTIFY_SCREEN)},n.create=function(){e.prototype.create.call(this),this.createBackground(Ia.Z.BACKGROUND.KEY),this.createHeaderBar(),this.createMainContent(),this.createFooterBar(),this.createClaimHeartScreen()},n.createHeaderBar=function(){this.header=new Tw(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone,0,-70)},n.createMainContent=function(){this.main=new Vw(this),Phaser.Display.Align.In.Center(this.main,this.gameZone)},n.createFooterBar=function(){this.footer=new zE(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone,0,0)},n.createClaimHeartScreen=function(){this.screen.add(ps.o4.CLAIM_HEART_SCREEN,EA)},t}(Ql.Z);var zw=Yw,Kw=us.Z.DEFAULT,jw=Kw.KEY,Xw=Kw.FRAME,qw=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n.createArrowLeft(),n.createHeader(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createArrowLeft=function(){var e=new fs.Z(this.scene,jw,Xw.ICON_ARROW_LEFT,9,16);e.onClick=this.handleBack.bind(this),this.add(e);var t=this.scene.gameZone.width;Phaser.Display.Align.In.Center(e,this,-t/2+24.5+e.width/2,0)},n.handleBack=function(){var e=this.scene.storage.getState(),t=(0,xp.V)(e);this.scene.scene.switch(t)},n.createHeader=function(){var e=this.scene.make.image({key:jw,frame:Xw.TEXT_RANKING_DARK});e.setWorldSize(74,20),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(Phaser.GameObjects.Container),Jw=qw;function Qw(e,t){var n="undefined"!==typeof oh()&&hh()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return $w(e,t);var i=Ne()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return sh()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return $w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var eI=GameCore.Configs.LeadersBoard,tI=eI.UseMock,nI=eI.Limit,iI=function(e,t,n,a){return void 0===n&&(n=nI),void 0===a&&(a=0),function(){var s=(0,r.Z)(h().mark((function s(r){var o,c,l,u,p,d,f,m,g,v,y,S,A,T,C,P,w,I,k;return h().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,o=window.game.player,c=o.getPlayerId(),r(sI()),r({type:Ai,payload:{leaderboardId:e,type:t,limit:n,offset:a}}),!tI){s.next=12;break}return s.next=8,(0,ht.qZ)(1e3);case 8:return 145,p=b()(l=cs()(u=new Array(n)).call(u,null)).call(l,(function(e,t){var n=(t+1)*(a+1);return{playerId:145===t?c:"0"+n,name:145===t?"Current Player":"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:n,score:Math.floor(1e5/n)}})),r(aI(p,t)),s.abrupt("return");case 12:if(d=[],t!==Bo){s.next=19;break}return s.next=16,Xo({limit:n,offset:a});case 16:d=s.sent,s.next=27;break;case 19:if(t!==No){s.next=27;break}return(f=o.getConnectedPlayerIds(n,a)).push(c),m=GameCore.Utils.Array.unique(f),s.next=25,Qo({playerIds:m,limit:m.length});case 25:d=s.sent,m.forEach((function(e){var t=E()(d).call(d,(function(t){return t.playerId===e}));t&&0!==t.length||d.push({playerId:e,score:0})}));case 27:return g=b()(d).call(d,(function(e){return e.playerId})),g.push(o.getPlayerId()),s.next=31,profile.requestProfiles(g);case 31:for(profile.getProfiles(),v={},y=Qw(d);!(S=y()).done;)A=S.value,T=A.playerId,C=A.score,P=A.rank,w=A.getPlayer(),I=w.getPhoto(),k=w.getName(),v[T]={playerId:T,name:k,photo:I,score:C,rank:P};r(aI(v,t)),s.next=42;break;case 38:s.prev=38,s.t0=s.catch(0),r(aI([],t)),(0,i.tO)(s.t0);case 42:case"end":return s.stop()}}),s,null,[[0,38]])})));return function(e){return s.apply(this,arguments)}}()},aI=function(e,t){return{type:bi,payload:{leaders:e,type:t}}},sI=function(){return{type:Ti,payload:{}}},rI=function(e){return e[gi]},oI=((0,K.P1)([function(e){return rI(e).leaderboardId}],(function(e){return e})),(0,K.P1)([function(e){return rI(e).leaders}],(function(e){return e}))),cI=(0,K.P1)([function(e){return rI(e).isRequesting}],(function(e){return e})),hI=n(51743),lI={targets:[],props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}},uI=function(e){function t(t){return e.call(this,lI,t)||this}return(0,o.Z)(t,e),t}(Zf.Z),pI={targets:[],props:{alpha:{start:0,to:1,duration:500,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:Phaser.Math.Easing.Back.Out}},delay:0},dI=function(e){function t(t){return e.call(this,pI,t)||this}return(0,o.Z)(t,e),t}(Zf.Z),fI=us.Z.DEFAULT,mI=fI.KEY,gI=fI.FRAME,vI=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).buttonPlay=void 0,i.buttonShare=void 0,i.buttonChallenge=void 0,i.avatar=void 0,i.username=void 0,i.rankIcon=void 0,i.rankText=void 0,i.score=void 0,i.scoreText=void 0,i.background=void 0,i.showPopUp=void 0,i.showItems=void 0,i.payload=void 0,i.handleChallengeFriend=function(){var e=i.payload.playerId;i.scene.storage.dispatch(Ul(e))},i.handleShare=function(){i.scene.storage.dispatch(Ah())},i.createBackground(),i.updateSize(),i.createAvatar(),i.createUsername(),i.createRank(),i.createScore(),i.createButtonShare(),i.createButtonPlay(),i.createButtonChallenge(),n&&i.updateInfo(n),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=(0,s.Z)({scoreRight:!0,isHighlight:!1,useChallenge:!1},e),this.updateBackground(),this.updateAvatar(),this.updateUsername(),this.updateRank(),this.updateScore(),this.updateButton(),this.alignScoreAndButton()},n.createBackground=function(){this.background=this.scene.make.image({key:mI,frame:gI.BLANK}),this.background.setWorldSize(343,64),this.background.setVisible(!1),this.add(this.background)},n.updateBackground=function(){this.background.setVisible(!0),this.background.setFrame(gI.LEADERBOARD_BG_ITEM),this.background.setWorldSize(343,64)},n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n+12)},n.createAvatar=function(){this.avatar=new Yp(this.scene,{key:mI,frame:gI.AVATAR_BORDER,background:gI.AVATAR_BACKGROUND,width:64,height:64}),this.avatar.background.setVisible(!1),this.avatar.avtFrame.setVisible(!1),this.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this,-85)},n.updateAvatar=function(){var e=this.payload,t=e.playerId,n=e.photo;this.avatar.loadPhoto(t,n,100)},n.getShortName=function(e){return e.length>12?e.substring(0,9)+"...":e},n.createUsername=function(){this.username=this.scene.make.text({text:this.getShortName(""),style:{fontFamily:gs.Z.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:0,y:.5}}),this.username.setHighQuality(),this.username.setTint(7485207),this.username.setVisible(!1),this.add(this.username),Phaser.Display.Align.In.Center(this.username,this.avatar,40,1)},n.updateUsername=function(){if(this.payload.useChallenge)this.username.setVisible(!1);else{var e=this.payload.name;this.username.setVisible(!0),this.username.setText(this.getShortName(e))}},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var e=this.payload.rank;if(e<0)return this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),void this.rankText.setText("99+");this.updateRankIcon(e),this.updateRankText(e)},n.getRankIconFrame=function(e){var t=gI.ICON_CUP_GOLD;switch(e){case 1:t=gI.ICON_CUP_GOLD;break;case 2:t=gI.ICON_CUP_SILVER;break;case 3:t=gI.ICON_CUP_COPPER}return t},n.createRankIcon=function(e){var t=this.getRankIconFrame(e);this.rankIcon=this.scene.make.image({key:mI,frame:t}),this.rankIcon.setWorldSize(29,34),this.add(this.rankIcon),Phaser.Display.Align.In.LeftCenter(this.rankIcon,this.background,-17)},n.updateRankIcon=function(e){if(e>3)this.rankIcon.setVisible(!1);else{this.rankIcon.setVisible(!0);var t=this.getRankIconFrame(e);this.rankIcon.setFrame(t)}},n.createRankText=function(e){var t;this.rankText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5}}),this.rankText.setTint(3552586),this.rankText.setText(Ne()(t="0"+e).call(t,-2)),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,1)},n.updateRankText=function(e){var t;e<=3?this.rankText.setVisible(!1):(this.rankText.setVisible(!0),this.rankText.setText(Ne()(t="0"+e).call(t,-2)),this.rankText.setFont(gs.Z.FONT_WEIGHT_600.KEY),this.rankText.setTint(3552586))},n.createScore=function(){this.score=this.scene.add.container(),this.scoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(28),origin:{x:.5,y:.5},text:"132500"}),this.scoreText.setTint(3552586),this.score.add([this.scoreText]),this.add(this.score)},n.updateScore=function(){var e=this.payload.score;this.scoreText.setText(e)},n.createButtonPlay=function(){this.buttonPlay=new fs.Z(this.scene,mI,gI.BUTTON_CHALLENGE_LIGHT,54,36),this.buttonPlay.setName("ChallengeFriend"),Phaser.Display.Align.In.RightCenter(this.buttonPlay,this,-18,2),this.buttonPlay.onClick=this.handleChallengeFriend,this.add(this.buttonPlay)},n.createButtonShare=function(){this.buttonShare=new fs.Z(this.scene,mI,gI.BUTTON_LONG_MINOR,94,32),this.buttonShare.setName("Share"),Phaser.Display.Align.In.RightCenter(this.buttonShare,this,-18,1),this.buttonShare.onClick=this.handleShare;var e=this.scene.make.image({key:mI,frame:gI.TEXT_SHARE});e.setWorldSize(37,9),e.setTint(3304186),this.buttonShare.add(e),this.add(this.buttonShare)},n.createButtonChallenge=function(){this.buttonChallenge=new fs.Z(this.scene,mI,gI.BUTTON_LONG_MINOR,94,32),this.buttonChallenge.setName("Challenge");var e=this.scene.make.image({key:mI,frame:gI.TEXT_CHALLENGE});e.setWorldSize(68,9),this.buttonChallenge.onClick=this.handleChallengeFriend,this.buttonChallenge.add(e),this.add(this.buttonChallenge),Phaser.Display.Align.In.Center(e,this.buttonChallenge,0,0),Phaser.Display.Align.In.RightCenter(this.buttonChallenge,this,-18,1)},n.updateButton=function(){var e=this.payload,t=e.isHighlight;if(!e.useChallenge)return this.buttonShare.setVisible(!1),this.buttonPlay.setVisible(!1),void this.buttonChallenge.setVisible(!1);this.buttonShare.setVisible(!1),this.buttonPlay.setVisible(!1),this.buttonChallenge.setVisible(!0),t&&(this.buttonShare.setVisible(!0),this.buttonPlay.setVisible(!1),this.buttonChallenge.setVisible(!1))},n.alignScoreAndButton=function(){this.payload.useChallenge?Phaser.Display.Align.In.Center(this.score,this.avatar,78,2.5):Phaser.Display.Align.In.Center(this.score,this.avatar,213,2.5)},n.runShowPopUpAnimation=function(e,t){this.scene.tweens.killTweensOf(this),this.showPopUp=new dI({targets:[this],delay:e,duration:t,props:{y:{start:this.y+70,to:this.y}}}),this.showPopUp.play()},n.runShowItemAnimation=function(e,t){var n=this.getAll();this.scene.tweens.killTweensOf(n),this.showItems=new uI({targets:n,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{scale:{duration:1e3,getStart:function(e){return.8*e.scale},getEnd:function(e){return e.scale},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}}),this.showItems.play()},n.runShowUpAnimation=function(e,t){void 0===e&&(e=0),void 0===t&&(t=300);var n=100*e;this.runShowPopUpAnimation(n,t),this.runShowItemAnimation(n,t)},n.setFrameBackground=function(e){this.background.setFrame(e)},n.setRankLight=function(){this.rankText.setFont(gs.Z.FONT_WEIGHT_600.KEY)},t}(Phaser.GameObjects.Container),yI=vI;function SI(e,t){var n="undefined"!==typeof oh()&&hh()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return EI(e,t);var i=Ne()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return sh()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return EI(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function EI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}us.Z.DEFAULT.FRAME;var AI=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.currentPlayerId=void 0,n.scroller=void 0,n.scene=t;var i=n.scene.player;return n.currentPlayerId=i.getPlayerId(),n.createReuseScroller(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createReuseScroller=function(){this.scroller=new GA(this.scene,{classType:yI,listConfigs:[],width:343,height:400,padding:0,marginTop:0,marginBottom:0}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(us.Z.DEFAULT.KEY,us.Z.DEFAULT.FRAME.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,60),this.add(this.scroller)},n.updateData=function(e,t){var n=yi()(e)||[];if(!(n.length<1)){for(var i,a=[],s=SI(Ei()(n).call(n,(function(e,t){return+t.score-+e.score})));!(i=s()).done;){var r=i.value,o=r.playerId,c=r.photo,h=r.score,l=r.name,u=r.rank;if(o){var p=this.currentPlayerId===o,d={playerId:o,photo:c,name:l,rank:u,score:h,scoreRight:t===Bo,useChallenge:t===No,isHighlight:p};a.push(d)}}this.scroller.updateConfig(a),this.showLeaders()}},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var e=this,t=this.getLeaders();if(!(t.length<1)){for(var n=Math.min(t.length,6),i=0;i<n;i++){var a=t[i];a&&(a.setVisible(!0),a.runShowUpAnimation(i,300))}var s=300+100*n+250;this.scene.time.delayedCall(s,(function(){e.scroller.setEnable(!0)}))}},t}(Phaser.GameObjects.Container),bI=AI,TI=us.Z.DEFAULT,CI=TI.KEY,PI=TI.FRAME,wI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tabWorld=void 0,n.tabFriends=void 0,n.textFriends=void 0,n.textWorld=void 0,n.scene=t,n.createTabFriends(),n.createTabWorld(),n}(0,o.Z)(t,e);var n=t.prototype;return n.selectTabFriends=function(){this.tabFriends.button.setFrame(PI.BUTTON_BLUE_SMALL),this.tabWorld.button.setFrame(PI.BUTTON_GREY_SMALL)},n.selectTabWorld=function(){this.tabFriends.button.setFrame(PI.BUTTON_GREY_SMALL),this.tabWorld.button.setFrame(PI.BUTTON_BLUE_SMALL)},n.createTabFriends=function(){this.tabFriends=new fs.Z(this.scene,CI,PI.BUTTON_BLUE_SMALL,169,40),this.textFriends=this.scene.make.image({key:CI,frame:PI.TEXT_FRIENDS}),this.tabFriends.setName("FriendsTab"),this.textFriends.setWorldSize(47,11),this.tabFriends.add(this.textFriends),Phaser.Display.Align.In.Center(this.textFriends,this.tabFriends),Phaser.Display.Align.In.Center(this.tabFriends,this,-86,-157),this.add(this.tabFriends)},n.createTabWorld=function(){this.tabWorld=new fs.Z(this.scene,CI,PI.BUTTON_GREY_SMALL,169,40),this.tabWorld.button.flipX=!0,this.textWorld=this.scene.make.image({key:CI,frame:PI.TEXT_WORLD}),this.tabWorld.setName("WorldTab"),this.textWorld.setWorldSize(40,11),this.tabWorld.add(this.textWorld),Phaser.Display.Align.In.Center(this.textWorld,this.tabWorld),Phaser.Display.Align.In.Center(this.tabWorld,this,86,-157),this.add(this.tabWorld)},n.enableTabFriend=function(){this.textFriends.setFrame(PI.TEXT_FRIENDS),this.textFriends.setWorldSize(47,11)},n.disableTabFriend=function(){this.textFriends.setFrame(PI.TEXT_FRIENDS_DISABLE),this.textFriends.setWorldSize(47,11)},n.enableTabWorld=function(){this.textWorld.setFrame(PI.TEXT_WORLD),this.textWorld.setWorldSize(40,11)},n.disableTabWorld=function(){this.textWorld.setFrame(PI.TEXT_WORLD_DISABLE),this.textWorld.setWorldSize(40,11)},t}(Phaser.GameObjects.Container),II=wI,kI=function(e){function t(t){var n;return(n=e.call(this,t)||this).tabs=void 0,n.leaders=void 0,n.loading=void 0,n.message=void 0,n.messageAnimation=void 0,n.setSize(310,230),n.createLoading(),n.createMessage(),n.createContents(),n.createAnimation(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.showLoading=function(e){this.loading.setVisible(e),this.showMessage(!1)},n.showMessage=function(e,t){this.message.setVisible(e),t&&(this.message.setText(t),this.messageAnimation.play())},n.createLoading=function(){this.loading=new Vp.Z(this.scene),this.loading.setVisible(!1),this.add(this.loading)},n.createMessage=function(){this.message=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.message.setTint(3304186),this.add(this.message),Phaser.Display.Align.In.Center(this.message,this)},n.createContents=function(){this.createLeaders(),this.createTabs()},n.createLeaders=function(){this.leaders=new bI(this.scene),this.add(this.leaders),Phaser.Display.Align.In.Center(this.leaders,this,0,-46)},n.createTabs=function(){this.tabs=new II(this.scene),this.add(this.tabs),Phaser.Display.Align.In.TopCenter(this.tabs,this,0,-40)},n.createAnimation=function(){this.messageAnimation=new hI.Z({targets:[this.message],duration:60,repeat:2})},t}(Phaser.GameObjects.Container),xI=kI,_I=GameCore.Configs.LeadersBoard,OI=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.board=void 0,n.isRequesting=void 0,n.isSwitchable=void 0,n.tabId=void 0,n.offset=void 0,n.isStateChanged=void 0,n.handleSelectFriendTab=function(){n.isRequesting||n.isSwitchable&&(n.isSwitchable=!1,n.selectFriendTab())},n.handleSelectWorldTab=function(){n.isRequesting||n.isSwitchable&&(n.isSwitchable=!1,n.selectWorldTab())},n.scene=t,n.createBoard(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createBoard=function(){var e=this;this.board=new xI(this.scene),this.board.tabs.tabWorld.onClick=this.handleSelectWorldTab,this.board.tabs.tabFriends.onClick=this.handleSelectFriendTab,this.add(this.board),Phaser.Display.Align.In.Center(this.board,this,0,0);var t=[{selector:cI,callback:function(t){if(e.isRequesting=t,e.board.showLoading(t),!1===t){if(!e.scene)return;var n=e.scene.game.storage.getState(),i=oI(n),a=te()(i).length;i&&0!==a?e.board.leaders.updateData(i,e.tabId):e.board.showMessage(!0,"Leaderboard is empty!"),e.scene.time.delayedCall(600,(function(){e.isSwitchable=!0}))}}}];this.handleStateChange(t)},n.handleStateChange=function(e){var t=this;this.isStateChanged||(e.forEach((function(e){var n=e.selector,i=e.callback;t.scene.storage.watch(n,i)})),this.isStateChanged=!0)},n.loadDataFriendTab=function(){this.scene.storage.dispatch(sI()),this.scene.storage.dispatch(iI(_I.LeaderboardId,No,_I.Limit,this.offset))},n.selectFriendTab=function(){this.tabId=No,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.board.tabs.selectTabFriends(),this.loadDataFriendTab(),this.board.tabs.enableTabFriend(),this.board.tabs.disableTabWorld()},n.selectWorldTab=function(){this.tabId=Bo,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.board.tabs.selectTabWorld(),this.scene.storage.dispatch(sI()),this.scene.storage.dispatch(iI(_I.LeaderboardId,Bo,_I.Limit,this.offset)),this.board.tabs.disableTabFriend(),this.board.tabs.enableTabWorld()},n.exampleLeadersData=function(){return[{playerId:"1",rank:1,photo:"",name:"Nguyen Vu",score:"123456"},{playerId:"2",rank:2,photo:"",name:"Sang Le",score:"12345"},{playerId:"3",rank:3,photo:"",name:"Trinh Cong Son",score:"1234"},{playerId:"4",rank:4,photo:"",name:"Phan Dinh Phung",score:"123"},{playerId:"5",rank:5,photo:"",name:"Hai Ba Trung",score:"12"},{playerId:"6",rank:6,photo:"",name:"Ngo Quyen",score:"1"},{playerId:"7",rank:7,photo:"",name:"Sun Data",score:"1"}]},t}(Phaser.GameObjects.Container),DI=OI,RI=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,y()(t=[this]).call(t,a))||this).main=void 0,n.header=void 0,n.footer=void 0,n.run=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.main.selectFriendTab();case 1:case"end":return e.stop()}}),e)}))),n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.create=function(){e.prototype.create.call(this),this.createBackground(Ia.Z.BACKGROUND.KEY),this.createHeaderBar(),this.createMainContent(),this.createFooterBar()},n.createHeaderBar=function(){this.header=new Jw(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone,0,-30)},n.createMainContent=function(){this.main=new DI(this),this.main.selectFriendTab(),Phaser.Display.Align.In.TopCenter(this.main,this.gameZone,0,-310)},n.createFooterBar=function(){this.footer=new zE(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone,0)},t}(Ql.Z);var MI=RI,LI=us.Z.DEFAULT,BI=LI.KEY,NI=LI.FRAME,FI=function(e){function t(t){var n;return(n=e.call(this,t,BI,NI.BLANK)||this).button.setVisible(!1),n.setName("Setting"),n.createIcon(),n}return(0,o.Z)(t,e),t.prototype.createIcon=function(){var e=this.scene.make.image({key:BI,frame:NI.ICON_SETTING});e.setWorldSize(19,21),this.add(e),Phaser.Display.Align.In.Center(e,this,0,0)},t}(fs.Z),GI=FI,ZI=us.Z.DEFAULT,UI=ZI.KEY,HI=ZI.FRAME,VI=function(e){function t(t){var n;return(n=e.call(this,t)||this).header=void 0,n.subHeader=void 0,n.settingButton=void 0,n.createHeader(),n.createSubHeader(),n.createSettingButton(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createHeader=function(){this.header=this.scene.make.image({key:UI,frame:HI.TEXT_WELCOME}),this.header.setWorldSize(53,8),this.add(this.header),Phaser.Display.Align.In.LeftCenter(this.header,this,172,24)},n.createSubHeader=function(){this.subHeader=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(36),origin:{x:0,y:.5}}),this.subHeader.setTint(262685),this.add(this.subHeader),Phaser.Display.Align.In.LeftCenter(this.subHeader,this.header,2,27)},n.setBestScoreFrame=function(){this.header.setFrame(HI.TEXT_BEST_SCORE),this.header.setWorldSize(58,8)},n.setSubHeader=function(e){void 0===e&&(e=""),this.subHeader.setText(""+e.normalize("NFD").replace(/[\u0300-\u036f]/g,""))},n.createSettingButton=function(){this.settingButton=new GI(this.scene),this.add(this.settingButton),Phaser.Display.Align.In.Center(this.settingButton,this,159,41)},t}(Phaser.GameObjects.Container),WI=VI,YI=us.Z.DEFAULT,zI=YI.KEY,KI=YI.FRAME,jI=function(e){function t(t){var n;return(n=e.call(this,t,zI,KI.BUTTON_LONG_BLUE)||this).text=void 0,n.button.setWorldSize(343,56),n.setName("Start"),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createText=function(){this.text=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.text.setTint(16777215),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,0)},n.setText=function(e){this.text.setText("Start level "+e)},t}(fs.Z),XI=jI,qI=us.Z.DEFAULT,JI=qI.KEY,QI=qI.FRAME,$I=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).background=void 0,i.text=void 0,i.payload=void 0,n&&i.updateInfo(n),i.createBackground(),i.createText(),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:JI,frame:QI.LEVEL_LOCKED}),this.background.setWorldSize(50,50),this.add(this.background)},n.createText=function(){this.text=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,0)},n.setBackground=function(e){this.background.setFrame(e)},n.setText=function(e){this.text.setText(""+e)},n.updateInfo=function(e){this.payload=(0,s.Z)({},e),this.updateText(),this.updateBackground()},n.updateBackground=function(){this.background.setVisible(!0)},n.updateText=function(){this.text.setText(""+this.payload.text),Phaser.Display.Align.In.Center(this.text,this.background,0,0)},t}(Phaser.GameObjects.Container),ek=$I,tk=us.Z.DEFAULT,nk=(tk.KEY,tk.FRAME),ik=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).levelItem1=void 0,i.levelItem2=void 0,i.levelItem3=void 0,i.payload=void 0,i.init(),n&&i.updateInfo(n),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.updateSize(),this.createLevelItem()},n.updateSize=function(){this.setSize(325,64)},n.updateInfo=function(e){this.updateLevelItem()},n.createLevelItem=function(){this.levelItem1=new ek(this.scene,{text:1,frame:nk.LEVEL_LOCKED}),this.add(this.levelItem1),Phaser.Display.Align.In.Center(this.levelItem1,this,-120,0),this.levelItem2=new ek(this.scene,{text:2,frame:nk.LEVEL_LOCKED}),this.add(this.levelItem2),this.levelItem2.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem2,this,-40,0),this.levelItem3=new ek(this.scene,{text:3,frame:nk.LEVEL_LOCKED}),this.add(this.levelItem3),this.levelItem3.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem3,this,40,0)},n.updateLevelItem=function(){this.levelItem1.setBackground(this.payload.levelItem1.frame),this.levelItem1.setText(this.payload.levelItem1.text),this.levelItem1.updateText(),this.levelItem2.setBackground(this.payload.levelItem1.frame),this.levelItem2.setText(this.payload.levelItem1.text),this.levelItem2.updateText(),this.levelItem3.setBackground(this.payload.levelItem1.frame),this.levelItem3.setText(this.payload.levelItem1.text),this.levelItem3.updateText()},t}(Phaser.GameObjects.Container),ak=GameCore.Configs.Network,sk=us.Z.DEFAULT,rk=(sk.KEY,sk.FRAME),ok=function(e){function t(t){var n;return(n=e.call(this,t)||this).buttonStart=void 0,n.firstRoad=void 0,n.setSizeContainer(),n.createRoadLevel(),n.createButtonStart(),n.showLoadingScreen(),n.mapStateChange(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.setSizeContainer=function(){var e=this.scene.ads.getBannerHeight(),t=this.scene.world.getWorldSize(),n=t.width,i=t.height-e;this.setSize(n,i)},n.createRoadLevel=function(){this.firstRoad=new ik(this.scene,{levelItem1:{text:1,frame:rk.LEVEL_PLAYED},levelItem2:{text:2,frame:rk.LEVEL_PLAYING},levelItem3:{text:3,frame:rk.LEVEL_LOCKED}}),this.firstRoad.setVisible(!1),this.add(this.firstRoad),Phaser.Display.Align.In.Center(this.firstRoad,this,0,25)},n.createButtonStart=function(){this.buttonStart=new XI(this.scene),this.buttonStart.onClick=this.handlePlay.bind(this),this.add(this.buttonStart),Phaser.Display.Align.In.BottomCenter(this.buttonStart,this,0,-120)},n.updateInfo=function(){var e=this.scene.storage.getState(),t=Kc(e)||0;this.buttonStart.setText(""+t),t&&this.hideLoadingScreen()},n.loadLevelConfig=function(){try{var e=this.scene.storage.getState(),t=Kc(e);0===t&&(t=1);var n=em[t];n||(n=em[em.length-1]);var a=n,s=a.key,r=a.mapJson;if(this.scene.cache.tilemap.exists(s))return;this.scene.load.tilemapTiledJSON(s,r),this.scene.load.start()}catch(o){(0,i.tO)(o)}},n.mapStateChange=function(){var e=this,t=[{selector:Rc,callback:function(t){t||(e.hideLoadingScreen(),e.updateInfo(),e.loadLevelConfig())}},{selector:Kc,callback:function(t){t&&e.updateInfo()}}];this.handleStateChange(t)},n.handleStateChange=function(e){var t=this;e.forEach((function(e){var n=e.selector,i=e.callback;t.scene.storage.watch(n,i)}))},n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading level...",duration:ak.Timeout,loading:!0})},n.hideLoadingScreen=function(){var e;(null==(e=this.scene)?void 0:e.game).globalScene.screen.close(ps.o4.NOTIFY_SCREEN)},n.handlePlay=function(){var e=this.scene.storage.getState();if(nm(e)<1)this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN);else{this.scene.storage.dispatch(pm());var t=Kc(e);this.scene.storage.dispatch(Pl()),this.scene.analytics.levelStart(t,void 0,this.getLevelName(t)),this.scene.storage.dispatch(Gl())}},n.getLevelName=function(e){var t;return"journey_"+ls()(t=GameCore.Utils.Number).call(t,e,4,"0")},t}(Phaser.GameObjects.Container),ck=ok,hk=us.Z.DEFAULT,lk=hk.KEY,uk=hk.FRAME,pk=function(e){function t(t){var n;return(n=e.call(this,t,lk,uk.BUTTON_LONG_ORANGE)||this).button.setWorldSize(343,56),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:lk,frame:uk.ICON_PLAY});e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.Center(e,this,-40)},n.createText=function(){var e=this.scene.make.image({key:lk,frame:uk.TEXT_CONTINUE});e.setWorldSize(73,13),this.add(e),Phaser.Display.Align.In.Center(e,this,20)},t}(fs.Z),dk=pk,fk=us.Z.DEFAULT,mk=fk.KEY,gk=fk.FRAME,vk=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).logo=void 0,a.drawLogo(),t.add.existing((0,as.Z)(a)),a}return(0,o.Z)(t,e),t.prototype.drawLogo=function(){this.logo=this.scene.make.image({key:mk,frame:gk.BOARD}),this.logo.setWorldSize(73,73),this.add(this.logo)},t}(Phaser.GameObjects.Container),yk=vk,Sk=us.Z.DEFAULT,Ek=Sk.KEY,Ak=Sk.FRAME,bk=function(e){function t(t){var n;return(n=e.call(this,t,Ek,Ak.BUTTON_LONG_BLUE)||this).button.setWorldSize(343,56),n.setName("PlaySingle"),n.createIcon(),n.createText(),n}(0,o.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:Ek,frame:Ak.ICON_PLUS});e.setWorldSize(22,22),this.add(e),Phaser.Display.Align.In.Center(e,this,-50,-2)},n.createText=function(){var e=this.scene.make.image({key:Ek,frame:Ak.TEXT_NEW_GAME});e.setWorldSize(85,16),this.add(e),Phaser.Display.Align.In.Center(e,this,20,0)},t}(fs.Z),Tk=bk,Ck=us.Z.DEFAULT,Pk=Ck.KEY,wk=Ck.FRAME,Ik=function(e){function t(t){var n;return(n=e.call(this,t)||this).logo=void 0,n.continueButton=void 0,n.playSingleButton=void 0,n.playSingleButtonAnimation=void 0,n.createLogo(),n.createContinueButton(),n.createPlaySingleButton(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createLogo=function(){this.logo=new yk(this.scene,0,0),this.add(this.logo);var e=this.scene.make.image({key:Pk,frame:wk.TEXT_BLOCK_PUZZLE_SUDOKU});e.setWorldSize(245,73),this.add(e),Phaser.Display.Align.In.Center(this.logo,this,0,-192),Phaser.Display.Align.In.Center(e,this,0,-84)},n.createContinueButton=function(){this.continueButton=new dk(this.scene),this.continueButton.setVisible(!1),this.add(this.continueButton),Phaser.Display.Align.In.Center(this.continueButton,this,0,70)},n.createPlaySingleButton=function(){this.playSingleButton=new Tk(this.scene),this.add(this.playSingleButton),Phaser.Display.Align.In.Center(this.playSingleButton,this,0,70)},n.hideContinueButton=function(){this.continueButton.setVisible(!1),this.playSingleButton.setVisible(!0)},n.showContinueButton=function(){this.continueButton.setVisible(!0),this.playSingleButton.setVisible(!1)},t}(Phaser.GameObjects.Container),kk=Ik,xk=us.Z.DEFAULT,_k=xk.KEY,Ok=xk.FRAME,Dk=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).buttonPlay=void 0,i.buttonShare=void 0,i.buttonChallenge=void 0,i.avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.score=void 0,i.scoreText=void 0,i.background=void 0,i.showPopUp=void 0,i.showItems=void 0,i.payload=void 0,i.handleChallengeFriend=function(){var e=i.payload.playerId;i.scene.storage.dispatch(Ul(e))},i.handleShare=function(){i.scene.storage.dispatch(Ah())},i.createBackground(),i.updateSize(),i.createAvatar(),i.createRank(),i.createScore(),i.createButtonShare(),i.createButtonPlay(),i.createButtonChallenge(),n&&i.updateInfo(n),i.scene.add.existing((0,as.Z)(i)),i}(0,o.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=(0,s.Z)({scoreRight:!0,isHighlight:!1,useChallenge:!1},e),this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateScore(),this.updateButton(),this.alignScoreAndButton()},n.createBackground=function(){this.background=this.scene.make.image({key:_k,frame:Ok.BLANK}),this.background.setWorldSize(343,64),this.background.setVisible(!1),this.add(this.background)},n.updateBackground=function(){this.background.setVisible(!0),this.background.setFrame(Ok.LEADERBOARD_BG_ITEM),this.background.setWorldSize(343,64)},n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n+12)},n.createAvatar=function(){this.avatar=new Yp(this.scene,{key:_k,background:Ok.AVATAR_BACKGROUND,width:52,height:52}),this.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this,-85)},n.updateAvatar=function(){var e=this.payload,t=e.playerId,n=e.photo;this.avatar.loadPhoto(t,n)},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var e=this.payload.rank;if(e<0)return this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),void this.rankText.setText("99+");this.updateRankIcon(e),this.updateRankText(e)},n.getRankIconFrame=function(e){var t=Ok.ICON_CUP_GOLD;switch(e){case 1:t=Ok.ICON_CUP_GOLD;break;case 2:t=Ok.ICON_CUP_SILVER;break;case 3:t=Ok.ICON_CUP_COPPER}return t},n.createRankIcon=function(e){var t=this.getRankIconFrame(e);this.rankIcon=this.scene.make.image({key:_k,frame:t}),this.rankIcon.setWorldSize(28,24),this.add(this.rankIcon),Phaser.Display.Align.In.LeftCenter(this.rankIcon,this.background,-17)},n.updateRankIcon=function(e){if(e>3)this.rankIcon.setVisible(!1);else{this.rankIcon.setVisible(!0);var t=this.getRankIconFrame(e);this.rankIcon.setWorldSize(28,24),this.rankIcon.setFrame(t)}},n.createRankText=function(e){var t;this.rankText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5}}),this.rankText.setText(Ne()(t="0"+e).call(t,-2)),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,1)},n.updateRankText=function(e){var t;e<=3?this.rankText.setVisible(!1):(this.rankText.setVisible(!0),this.rankText.setText(Ne()(t="0"+e).call(t,-2)),this.rankText.setFont(gs.Z.FONT_WEIGHT_600.KEY),this.rankText.setTint(3552586))},n.createScore=function(){this.score=this.scene.add.container(),this.scoreText=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(28),origin:{x:.5,y:.5},text:"132500"}),this.score.add([this.scoreText]),this.add(this.score),Phaser.Display.Align.In.Center(this.score,this.avatar,58,0)},n.updateScore=function(){var e=this.payload.score;this.scoreText.setText(e)},n.createButtonPlay=function(){this.buttonPlay=new fs.Z(this.scene,_k,Ok.BUTTON_CHALLENGE_LIGHT,54,36),this.buttonPlay.setName("ChallengeFriend"),Phaser.Display.Align.In.RightCenter(this.buttonPlay,this,-18,2),this.buttonPlay.onClick=this.handleChallengeFriend,this.add(this.buttonPlay)},n.createButtonShare=function(){this.buttonShare=new fs.Z(this.scene,_k,Ok.BUTTON_SHARE_DARK,54,36),this.buttonShare.setName("Share"),Phaser.Display.Align.In.RightCenter(this.buttonShare,this,-18,2),this.buttonShare.onClick=this.handleShare,this.add(this.buttonShare)},n.createButtonChallenge=function(){this.buttonChallenge=new fs.Z(this.scene,_k,Ok.BUTTON_LONG_MINOR,93,32),this.buttonChallenge.setName("Challenge");var e=this.scene.make.image({key:_k,frame:Ok.TEXT_CHALLENGE});e.setWorldSize(68,9),this.buttonChallenge.onClick=this.handleChallengeFriend,this.buttonChallenge.add(e),this.add(this.buttonChallenge),Phaser.Display.Align.In.Center(e,this.buttonChallenge,0,0),Phaser.Display.Align.In.RightCenter(this.buttonChallenge,this,-18,1)},n.updateButton=function(){var e=this.payload;e.isHighlight;if(!e.useChallenge)return this.buttonShare.setVisible(!1),this.buttonPlay.setVisible(!1),void this.buttonChallenge.setVisible(!1);this.buttonShare.setVisible(!1),this.buttonPlay.setVisible(!1),this.buttonChallenge.setVisible(!0)},n.alignScoreAndButton=function(){this.payload.useChallenge?Phaser.Display.Align.In.Center(this.score,this.avatar,58,0):Phaser.Display.Align.In.Center(this.score,this.avatar,163,0)},n.runShowPopUpAnimation=function(e,t){this.scene.tweens.killTweensOf(this),this.showPopUp=new dI({targets:[this],delay:e,duration:t,props:{y:{start:this.y+70,to:this.y}}}),this.showPopUp.play()},n.runShowItemAnimation=function(e,t){var n=this.getAll();this.scene.tweens.killTweensOf(n),this.showItems=new uI({targets:n,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{scale:{duration:1e3,getStart:function(e){return.8*e.scale},getEnd:function(e){return e.scale},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}}),this.showItems.play()},n.runShowUpAnimation=function(e,t){void 0===e&&(e=0),void 0===t&&(t=300);var n=100*e;this.runShowPopUpAnimation(n,t),this.runShowItemAnimation(n,t)},n.setFrameBackground=function(e){this.background.setFrame(e)},n.setRankLight=function(){this.rankText.setFont(gs.Z.FONT_WEIGHT_600.KEY)},t}(Phaser.GameObjects.Container),Rk=Dk;function Mk(e,t){var n="undefined"!==typeof oh()&&hh()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return Lk(e,t);var i=Ne()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return sh()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Lk(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Lk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}us.Z.DEFAULT.FRAME;var Bk=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.currentPlayerId=void 0,n.scroller=void 0,n.scene=t;var i=n.scene.player;return n.currentPlayerId=i.getPlayerId(),n.createReuseScroller(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createReuseScroller=function(){this.scroller=new GA(this.scene,{classType:Rk,listConfigs:[],width:343,height:532,padding:0,marginTop:0,marginBottom:0}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(us.Z.DEFAULT.KEY,us.Z.DEFAULT.FRAME.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,60),this.add(this.scroller)},n.updateData=function(e,t){var n=yi()(e)||[];if(!(n.length<1)){for(var i,a=[],s=Mk(Ei()(n).call(n,(function(e,t){return+t.score-+e.score})));!(i=s()).done;){var r=i.value,o=r.playerId,c=r.photo,h=r.score,l=r.name,u=r.rank;if(o){var p=this.currentPlayerId===o,d={playerId:o,photo:c,name:l,rank:u,score:h,scoreRight:t===Bo,useChallenge:t===No,isHighlight:p};a.push(d)}}this.scroller.updateConfig(a),this.showLeaders()}},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var e=this,t=this.getLeaders();if(!(t.length<1)){for(var n=Math.min(t.length,6),i=0;i<n;i++){var a=t[i];a&&(a.setVisible(!0),a.runShowUpAnimation(i,300))}var s=300+100*n+250;this.scene.time.delayedCall(s,(function(){e.scroller.setEnable(!0)}))}},t}(Phaser.GameObjects.Container),Nk=Bk,Fk=us.Z.DEFAULT,Gk=Fk.KEY,Zk=Fk.FRAME,Uk=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tabWorld=void 0,n.tabFriends=void 0,n.textFriends=void 0,n.textWorld=void 0,n.scene=t,n.createTabFriends(),n.createTabWorld(),n}(0,o.Z)(t,e);var n=t.prototype;return n.selectTabFriends=function(){this.tabFriends.button.setFrame(Zk.BUTTON_BLUE_SMALL),this.tabWorld.button.setFrame(Zk.BUTTON_GREY_SMALL)},n.selectTabWorld=function(){this.tabFriends.button.setFrame(Zk.BUTTON_GREY_SMALL),this.tabWorld.button.setFrame(Zk.BUTTON_BLUE_SMALL)},n.createTabFriends=function(){this.tabFriends=new fs.Z(this.scene,Gk,Zk.BUTTON_BLUE_SMALL,169,40),this.textFriends=this.scene.make.image({key:Gk,frame:Zk.TEXT_FRIENDS}),this.tabFriends.setName("FriendsTab"),this.textFriends.setWorldSize(47,11),this.tabFriends.add(this.textFriends),Phaser.Display.Align.In.Center(this.textFriends,this.tabFriends),Phaser.Display.Align.In.Center(this.tabFriends,this,-86,-157),this.add(this.tabFriends)},n.createTabWorld=function(){this.tabWorld=new fs.Z(this.scene,Gk,Zk.BUTTON_GREY_SMALL,169,40),this.tabWorld.button.flipX=!0,this.textWorld=this.scene.make.image({key:Gk,frame:Zk.TEXT_WORLD}),this.tabWorld.setName("WorldTab"),this.textWorld.setWorldSize(40,11),this.tabWorld.add(this.textWorld),Phaser.Display.Align.In.Center(this.textWorld,this.tabWorld),Phaser.Display.Align.In.Center(this.tabWorld,this,86,-157),this.add(this.tabWorld)},n.enableTabFriend=function(){this.textFriends.setFrame(Zk.TEXT_FRIENDS),this.textFriends.setWorldSize(47,11)},n.disableTabFriend=function(){this.textFriends.setFrame(Zk.TEXT_FRIENDS_DISABLE),this.textFriends.setWorldSize(47,11)},n.enableTabWorld=function(){this.textWorld.setFrame(Zk.TEXT_WORLD),this.textWorld.setWorldSize(40,11)},n.disableTabWorld=function(){this.textWorld.setFrame(Zk.TEXT_WORLD_DISABLE),this.textWorld.setWorldSize(40,11)},t}(Phaser.GameObjects.Container),Hk=Uk,Vk=function(e){function t(t){var n;return(n=e.call(this,t)||this).tabs=void 0,n.leaders=void 0,n.loading=void 0,n.message=void 0,n.messageAnimation=void 0,n.setSize(310,430),n.createLoading(),n.createMessage(),n.createContents(),n.createAnimation(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.showLoading=function(e){this.loading.setVisible(e),this.showMessage(!1)},n.showMessage=function(e,t){this.message.setVisible(e),t&&(this.message.setText(t),this.messageAnimation.play())},n.createLoading=function(){this.loading=new Vp.Z(this.scene),this.loading.setVisible(!1),this.add(this.loading)},n.createMessage=function(){this.message=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_500.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.message.setTint(10317116),this.add(this.message),Phaser.Display.Align.In.Center(this.message,this)},n.createContents=function(){this.createLeaders(),this.createTabs()},n.createLeaders=function(){this.leaders=new Nk(this.scene),this.add(this.leaders),Phaser.Display.Align.In.Center(this.leaders,this,0,-61)},n.createTabs=function(){this.tabs=new Hk(this.scene),this.add(this.tabs),Phaser.Display.Align.In.TopCenter(this.tabs,this,0,-52.5)},n.createAnimation=function(){this.messageAnimation=new hI.Z({targets:[this.message],duration:60,repeat:2})},t}(Phaser.GameObjects.Container),Wk=Vk,Yk=GameCore.Configs.LeadersBoard,zk=us.Z.DEFAULT,Kk=zk.KEY,jk=zk.FRAME,Xk=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.board=void 0,n.isRequesting=void 0,n.isSwitchable=void 0,n.tabId=void 0,n.offset=void 0,n.isStateChanged=void 0,n.handleSelectFriendTab=function(){n.isRequesting||n.isSwitchable&&n.selectFriendTab()},n.handleSelectWorldTab=function(){n.isRequesting||n.isSwitchable&&n.selectWorldTab()},n.scene=t,n.createArrowLeft(),n.createHeader(),n.createBoard(),n.scene.add.existing((0,as.Z)(n)),n}(0,o.Z)(t,e);var n=t.prototype;return n.createArrowLeft=function(){var e=new fs.Z(this.scene,Kk,jk.ICON_ARROW_LEFT,9,16);e.onClick=this.handleClickArrowLeft.bind(this),this.add(e);var t=this.scene.gameZone,n=t.width,i=t.height;Phaser.Display.Align.In.Center(e,this,-n/2+24.5+e.width/2,-i/2+22+e.height/2)},n.handleClickArrowLeft=function(){this.scene.header.setVisible(!0),this.scene.main.setVisible(!0),this.setVisible(!1)},n.createHeader=function(){var e=this.scene.make.image({key:Kk,frame:jk.TEXT_RANKING_DARK});e.setWorldSize(74,20),this.add(e);var t=this.scene.gameZone.height;Phaser.Display.Align.In.Center(e,this,0,-t/2+22+e.height/2)},n.createBoard=function(){var e=this;this.board=new Wk(this.scene),this.board.tabs.tabWorld.onClick=this.handleSelectWorldTab,this.board.tabs.tabFriends.onClick=this.handleSelectFriendTab,this.selectFriendTab(),this.add(this.board),Phaser.Display.Align.In.Center(this.board,this,0,0);var t=[{selector:cI,callback:function(t){if(e.isRequesting=t,e.board.showLoading(t),!1===t){if(!e.scene)return;var n=e.scene.game.storage.getState(),i=oI(n);e.isSwitchable=!0,i&&0!==te()(i).length?e.board.leaders.updateData(i,e.tabId):e.board.showMessage(!0,"Leaderboard is empty!")}}}];this.handleStateChange(t)},n.handleStateChange=function(e){var t=this;this.isStateChanged||(e.forEach((function(e){var n=e.selector,i=e.callback;t.scene.storage.watch(n,i)})),this.isStateChanged=!0)},n.selectFriendTab=function(){this.tabId=No,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.board.tabs.selectTabFriends(),this.scene.storage.dispatch(sI()),this.scene.storage.dispatch(iI(Yk.LeaderboardId,No,Yk.Limit,this.offset)),this.board.tabs.enableTabFriend(),this.board.tabs.disableTabWorld()},n.selectWorldTab=function(){this.tabId=Bo,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.board.tabs.selectTabWorld(),this.scene.storage.dispatch(sI()),this.scene.storage.dispatch(iI(Yk.LeaderboardId,Bo,Yk.Limit,this.offset)),this.board.tabs.disableTabFriend(),this.board.tabs.enableTabWorld()},n.exampleLeadersData=function(){return[{playerId:"1",rank:1,photo:"",name:"A",score:"123456"},{playerId:"2",rank:2,photo:"",name:"B",score:"12345"},{playerId:"3",rank:3,photo:"",name:"C",score:"1234"},{playerId:"4",rank:4,photo:"",name:"D",score:"123"},{playerId:"5",rank:5,photo:"",name:"E",score:"12"},{playerId:"6",rank:6,photo:"",name:"F",score:"1"},{playerId:"7",rank:7,photo:"",name:"G",score:"1"}]},t}(Phaser.GameObjects.Container),qk=Xk,Jk=us.Z.DEFAULT,Qk=Jk.KEY,$k=Jk.FRAME,ex=us.Z.GAMEPLAY,tx=ex.KEY,nx=ex.FRAME,ix=us.Z.GAMEPLAY_32,ax=ix.KEY,sx=ix.FRAME,rx=GameCore.Configs,ox=rx.Network,cx=rx.Board,hx=function(e){function t(t,n,i,a){var s;(s=e.call(this,t,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var e=s.getData(["onClose"])[0];s.scene.screen.close(s.name),e&&e()}))},s.decodeMathData=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}},s.scene=t;try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5)}catch(r){}return s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(h().mark((function t(n){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.prototype.open.call(this,n),this.showLoadingScreen(),this.loadLevelConfig();case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var e=rC(),t=e.key,n=e.mapJson;if(this.scene.cache.tilemap.exists(t))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(t,n),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(a){(0,i.tO)(a)}},n.handleLoadCurrentMapComplete=function(){this.startGame(),this.hideLoadingScreen()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.scene.storage.getState(),!Kc(t)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.scene.storage.dispatch(Tl());case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,i.tO)(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading level...",duration:ox.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(ps.o4.NOTIFY_SCREEN)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:Qk,frame:$k.TEXT_DAILY_CHALLENGE});e.setWorldSize(242,21),this.buttonClose=new fs.Z(this.scene,Qk,$k.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([e,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var e=this.scene.make.image({key:Qk,frame:$k.TEXT_COLLECT});e.setWorldSize(91,15);var t=this.scene.make.image({key:Qk,frame:$k.POPUP_MID_1});t.setWorldSize(200,37),this.popup.add([e,t]),Phaser.Display.Align.In.Center(e,this.popup,0,-155),Phaser.Display.Align.In.Center(t,this.popup,0,-125)},n.drawTargetItems=function(){var e,t,n=rC().key,i=this.scene.make.tilemap({key:n}).properties;if(i&&(0,mm.isArray)(i)&&!(i.length<2))for(var a=i[0].value,s=Jf()(e=Jf()(t=Jf()(a).call(a,"{",'{"')).call(t,", ",', "')).call(e,":",'":'),r=JSON.parse(s),o=te()(r),c=this.calcPosition(o.length),h=0;h<o.length;h++){var l=o[h],u=rv[l],p=r[l],d=this.targetData[h];d||(d=this.spawnTargetItem(u,p));var f=d,m=f.container,g=f.text,v=f.gem;m.setVisible(!0),g.setText("x"+p),v.setFrame(u),this.targetData.push(d),Phaser.Display.Align.In.Center(m,this.popup,c[h],-130)}},n.spawnTargetItem=function(e,t){var n=this.scene.make.container({}),i=this.scene.make.image({key:ax,frame:e});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+t});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(e){for(var t=[],n=150/(e+1),i=n*(e-1)/2,a=0;a<e;a++)t.push(n*a-i);return t},n.createBoard=function(){var e=this.scene.make.image({key:tx,frame:nx.BOARD});e.setWorldSize(200,184),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var e=0;e<cx.rows;e++){this.boardCellData[e]=[];for(var t=0;t<cx.cols;t++){var n=20*t-86.5+1.65*t,i=19*e-92+1*e,a=sx.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[e].push(s)}}},n.updateCellBoard=function(){this.drawBoardByMap()},n.resetTarget=function(){for(var e=0;e<this.targetData.length;e++){var t,n;null==(t=this.targetData[e])||null==(n=t.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var e=0;e<cx.rows;e++)for(var t=0;t<cx.cols;t++){this.boardCellData[e][t].setFrame(sx.GEM_TRANSPARENT)}},n.drawBoardByFen=function(e){for(var t=Eu()(e).call(e).split("/"),n=0;n<t.length;n++)for(var i=t[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=Pv(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var e=rC().key,t=this.scene.make.tilemap({key:e}).layers;if((0,mm.isArray)(t)){var n=t[0].data;if((0,mm.isArray)(n))for(var i=0;i<n.length;i++)for(var a=n[i],s=0;s<a.length;s++){var r=a[s];if(!(r.index<0)){var o=rv[r.index-1];this.boardCellData[i][s].setFrame(o)}}}},n.spawnCellBoard=function(e,t,n){var i=this.scene.make.image({key:ax,frame:e});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,t,n),i},n.createButtonPlay=function(){this.buttonPlay=new fs.Z(this.scene,Qk,$k.BUTTON_BLUE_SMALL_TALL,118,47),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var e=this.scene.make.image({key:Qk,frame:$k.TEXT_PLAY});e.setWorldSize(50,15);var t=this.scene.make.image({key:Qk,frame:$k.ICON_PLAY});t.setWorldSize(26,26),this.buttonPlay.add([e,t]),Phaser.Display.Align.In.Center(e,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(t,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var e=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){e.scene.screen.close(e.name);var t=e.scene.storage.getState();Kc(t)>em.length||(e.scene.storage.dispatch(Cl()),e.scene.storage.dispatch(Gl()),e.scene.analytics.event(Ht._.DAILY_CHALLENGE_BEGIN))}))},n.getLevelName=function(e){var t;return"journey_"+ls()(t=GameCore.Utils.Number).call(t,e,4,"0")},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),lx=us.Z.DEFAULT,ux=lx.KEY,px=lx.FRAME,dx=us.Z.GAMEPLAY,fx=dx.KEY,mx=dx.FRAME,gx=us.Z.GAMEPLAY_32,vx=gx.KEY,yx=gx.FRAME,Sx=GameCore.Configs,Ex=Sx.Network,Ax=Sx.Board,bx=function(e){function t(t,n,i,a){var s;(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.textCollect=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.collectTargetsContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var e=s.getData(["onClose"])[0];s.scene.screen.close(s.name),e&&e()}))},s.decodeMathData=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}};try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5)}catch(r){}return s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){var t=(0,r.Z)(h().mark((function t(n){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.open.call(this,n),t.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var e=this.scene.storage.getState(),t=Kc(e),n=em[t];n||(n=em[em.length-1]);var a=n,s=a.key,r=a.mapJson;if(this.scene.cache.tilemap.exists(s))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(s,r),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(o){(0,i.tO)(o)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var e=(0,r.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.scene.storage.getState(),!Kc(t)){e.next=5;break}return e.abrupt("return");case 5:return this.showLoadingScreen(),e.next=8,this.scene.storage.dispatch(Tl());case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,i.tO)(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(ps.o4.NOTIFY_SCREEN,{message:"Loading level...",duration:Ex.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(ps.o4.NOTIFY_SCREEN)},n.createPopup=function(){this.popup=new Ps.Z(this.scene,0,0,343,500,{forceHeightTop:47}),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,0)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:ux,frame:px.TEXT_JOURNEY});e.setTint(262685),e.setWorldSize(89,22),this.buttonClose=new fs.Z(this.scene,ux,px.ICON_CLOSE,20,20),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add(this.buttonClose),this.title.add(e),this.popup.add(this.title),Phaser.Display.Align.In.Center(e,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,148,-3),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-13)},n.createTargetItems=function(){this.collectTargetsContainer=this.scene.add.container(),this.textCollect=this.scene.make.image({key:ux,frame:px.TEXT_COLLECT}),this.textCollect.setWorldSize(63,14),this.collectTargetsContainer.add(this.textCollect),this.popup.add(this.collectTargetsContainer),Phaser.Display.Align.In.Center(this.textCollect,this.collectTargetsContainer,0,-75)},n.drawTargetItems=function(){var e,t,n=this.scene.storage.getState(),i=Kc(n),a=em[i];a||(a=em[em.length-1]);var s=this.scene.make.tilemap({key:a.key}).properties;if(s&&(0,mm.isArray)(s)&&!(s.length<2)){for(var r=s[0].value,o=Jf()(e=Jf()(t=Jf()(r).call(r,"{",'{"')).call(t,", ",', "')).call(e,":",'":'),c=JSON.parse(o),h=te()(c),l=[],u=0;u<h.length;u++){var p=h[u],d=rv[p];ce()(l).call(l,d)||l.push(d)}var f=this.calcPosition(l.length);l=[];for(var m=0,g=0;g<h.length;g++){var v=h[g],y=rv[v],S=c[v];if(!ce()(l).call(l,y)){var E=this.targetData[g];E||(E=this.spawnTargetItem(y,S));var A=E,b=A.container,T=A.text,C=A.gem;b.setVisible(!0),T.setText("x"+(S||1)),C.setFrame(y),this.targetData.push(E),this.collectTargetsContainer.add(b),Phaser.Display.Align.In.Center(b,this.textCollect,f[m]+80,0),l.push(y),m++}}var P=this.textCollect.width+41*h.length;Phaser.Display.Align.In.TopCenter(this.collectTargetsContainer,this.popup,-P/2,-139)}},n.spawnTargetItem=function(e,t){var n=this.scene.make.container({}),i=this.scene.make.image({key:vx,frame:e});i.setWorldSize(30,30);var a=this.scene.make.bitmapText({font:gs.Z.FONT_WEIGHT_600.KEY,size:this.scene.fontSize(35),origin:{x:0,y:.5},text:"x"+t});return a.setTint(262685),n.add([i,a]),Phaser.Display.Align.In.Center(i,n,-10,0),Phaser.Display.Align.In.LeftCenter(a,i,-35,2),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(e){for(var t=[],n=0;n<e;n++)t.push(70*n);return t},n.createBoard=function(){var e=this.scene.make.image({key:fx,frame:mx.BOARD});e.setWorldSize(310.5,310.5),this.popup.add(e),Phaser.Display.Align.In.Center(e,this.popup,0,3),this.initCellBoard()},n.initCellBoard=function(){for(var e=0;e<Ax.rows;e++){this.boardCellData[e]=[];for(var t=0;t<Ax.cols;t++){var n=33.3*t-137+1*t,i=33.3*e-134+1*e,a=yx.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[e].push(s)}}},n.updateCellBoard=function(){var e=this.scene.storage.getState(),t=Yc(e).data.fen;if(t){var n=t.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var e=0;e<this.targetData.length;e++){var t,n;null==(t=this.targetData[e])||null==(n=t.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var e=0;e<Ax.rows;e++)for(var t=0;t<Ax.cols;t++){this.boardCellData[e][t].setFrame(yx.GEM_TRANSPARENT)}},n.drawBoardByFen=function(e){for(var t=Eu()(e).call(e).split("/"),n=0;n<t.length;n++)for(var i=t[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=Pv(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var e=this.scene.storage.getState(),t=Kc(e),n=em[t];n||(n=em[em.length-1]);var i=this.scene.make.tilemap({key:n.key}).layers;if((0,mm.isArray)(i)){var a=i[0].data;if((0,mm.isArray)(a))for(var s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var c=r[o];if(!(c.index<0)){var h=rv[c.index-1];this.boardCellData[s][o].setFrame(h)}}}},n.spawnCellBoard=function(e,t,n){var i=this.scene.make.image({key:vx,frame:e});return i.setWorldSize(32,32),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,t,n),i},n.createButtonPlay=function(){this.buttonPlay=new fs.Z(this.scene,ux,px.BUTTON_LONG_BLUE,311,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var e=this.scene.make.image({key:ux,frame:px.TEXT_PLAY});e.setWorldSize(33,16),this.buttonPlay.add([e]),Phaser.Display.Align.In.Center(e,this.buttonPlay),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.BottomCenter(this.buttonPlay,this.popup,0,-25)},n.handlePlay=function(){var e=this,t=this.scene.storage.getState();nm(t)<1?this.scene.screen.open(ps.o4.CLAIM_HEART_SCREEN):(this.scene.storage.dispatch(pm()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){e.scene.screen.close(e.name);var t=e.scene.storage.getState(),n=Kc(t);n>em.length||(e.scene.analytics.levelStart(n,void 0,e.getLevelName(n)),e.scene.storage.dispatch(Gl()))})))},n.getLevelName=function(e){var t;return"journey_"+ls()(t=GameCore.Utils.Number).call(t,e,4,"0")},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),Tx=us.Z.DEFAULT,Cx=Tx.KEY,Px=Tx.FRAME,wx=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingMusicContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(e){s.scene.player.setSetting("music",e),e?s.scene.audio.playMusic():s.scene.audio.pauseMusic()},s.handleSoundSetting=function(e){s.scene.player.setSetting("sound",e)},s.handleVibrateSetting=function(e){e&&kd(199),s.scene.player.setSetting("vibrate",e)},s.createPopup(),s.createTitle(),s.createButtons(),s.addItem(),s.arrangeItems(),s.createInput(),s.setDepth(ps.Ks.POPUP),s.background.setAlpha(.5),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.player.getPlayerSettings(),n=t.sound,i=t.vibrate;this.settingSound.updateStatus(n),this.settingVibrate.updateStatus(i),this.updateVibrateButton(),this.runOpenAnimation()},n.updateVibrateButton=function(){Pd()?this.settingVibrateContainer.revive():(this.settingVibrateContainer.kill(),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,0))},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate.onClick=this.handleVibrateSetting},n.createPopup=function(){var e=226;Pd()||(e=126),this.popup=new Ps.Z(this.scene,0,0,343,e),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var e=this.scene.make.image({key:Cx,frame:Px.TEXT_SETTING});e.setWorldSize(73,18),this.buttonClose=new fs.Z(this.scene,Cx,Px.ICON_CLOSE,20,20),this.buttonClose.setName("Close"),this.title.add([e,this.buttonClose]),Phaser.Display.Align.In.Center(e,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,145,2)},n.createButtons=function(){var e=this.scene.player.getPlayerSettings(),t=e.sound,n=e.vibrate;this.createSoundButton(t),this.createVibrateButton(n)},n.createVibrateButton=function(e){this.settingVibrateContainer=this.scene.make.container({});var t=this.scene.make.image({key:Cx,frame:Px.ICON_VIBRATE});t.setWorldSize(32,32);var n=this.scene.make.image({key:Cx,frame:Px.TEXT_VIBRATE});n.setWorldSize(50,11),this.settingVibrate=new Ey(this.scene,{enable:e,width:51,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([t,n,this.settingVibrate]),Phaser.Display.Align.In.Center(t,this.settingVibrateContainer,-135),Phaser.Display.Align.In.Center(n,t,50),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,127),this.popup.add(this.settingVibrateContainer),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this,0,22)},n.createSoundButton=function(e){this.settingSoundContainer=this.scene.make.container({});var t=this.scene.make.image({key:Cx,frame:Px.ICON_SOUND});t.setWorldSize(32,32);var n=this.scene.make.image({key:Cx,frame:Px.TEXT_SOUND});n.setWorldSize(44,11),this.settingSound=new Ey(this.scene,{enable:e,width:51,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([t,n,this.settingSound]),Phaser.Display.Align.In.Center(t,this.settingSoundContainer,-135),Phaser.Display.Align.In.Center(n,t,50),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,127),this.popup.add(this.settingSoundContainer),Phaser.Display.Align.In.Center(this.settingSoundContainer,this,0,-32)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var e,t;null!=(e=this.popupShowUpAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(ds.Z.POPUP_SHOW),this.runFadeInMaskAnimation(100,300),this.runPopupEntrancesAnimation(400,300),this.runPopupContentEntrancesAnimation(600,300))},n.runCloseAnimation=function(){var e,t;null!=(e=this.popupFadeOutAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(e,t){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Cs.Z({targets:[this.popup],delay:e,duration:t,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new Ts.Z({targets:this.contents.getChildren(),duration:t,delay:e,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(e,t){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new bs.Z({targets:[this.popup],delay:e,duration:t,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(e,t){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new nf.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(e,t){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new bs.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},t}(GameCore.Screen),Ix=wx,kx=GameCore.Configs.Match,xx=us.Z.DEFAULT,_x=xx.KEY,Ox=xx.FRAME,Dx=function(e){function t(){for(var t,n,a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=e.call.apply(e,y()(t=[this]).call(t,s))||this).main=void 0,n.header=void 0,n.footer=void 0,n.rankMainContent=void 0,n.journeyMain=void 0,n.run=function(){n.checkAndAddShortcut(),n.checkIsNewPlayer(),n.ads.showBannerAdAsync().catch(i.tO)},n.onCreate=function(){var e=n.storage.getState(),t=dc(e);null===t?n.storage.dispatch(Bl(!1)):!1===t&&n.showMiniJourneyScreen(),n.run()},n.onResume=function(){n.run()},n.onWake=function(){n.run();var e=n.storage.getState();dc(e)||n.showMiniJourneyScreen()},n.clickPlayWithFriend=function(){n.storage.dispatch(Hl())},n.clickPlaySolo=function(){n.storage.dispatch(Fl())},n.clickContinue=function(){n.storage.dispatch((function(e){try{e(fl()),e(Kl(xa))}catch(t){(0,i.tO)(t)}}))},n.clickSetting=function(){n.screen.open(ps.o4.SETTINGS_SCREEN)},n}(0,o.Z)(t,e);var n=t.prototype;return n.showDailyChallengeScreen=function(){this.storage.dispatch(Bl(!0)),this.screen.open(ps.o4.DAILY_CHALLENGE_SCREEN)},n.checkAndAddShortcut=function(){var e=this.storage.getState();La(e)===xa&&this.facebook.attemptToAddShortcut()},n.preload=function(){this.events.on("wake",this.onWake),this.events.on("resume",this.onResume),this.events.on("create",this.onCreate)},n.create=function(){e.prototype.create.call(this),this.createBackground(Ia.Z.BACKGROUND.KEY),this.createHeaderBar(),this.createMainContent(),this.createFooterBar(),this.createDecorate(),this.createScreens()},n.updateJourneyContent=function(){this.journeyMain.updateInfo()},n.checkIsNewPlayer=function(){var e=this.player.getPlayer().name,t=this.player.getBestScore(),n=this.player.getPlayerData()||{},i=this.storage.getState(),a=Jc(i),s=t;n.score&&n.score>t&&(s=n.score),a&&a.score>s&&(s=a.score),t?(this.header.setBestScoreFrame(),this.header.setSubHeader(""+s)):this.header.setSubHeader(e);var r=(0,Fh.Th)(kx.SingleMatchStore)||{};r.data&&0!==te()(r.data).length?this.main.showContinueButton():this.main.hideContinueButton()},n.createHeaderBar=function(){this.header=new WI(this),this.header.settingButton.onClick=this.clickSetting,Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createMainContent=function(){this.main=new kk(this),this.main.setDepth(ms.Z.LOGO),this.main.playSingleButton.onClick=this.clickPlaySolo,this.main.continueButton.onClick=this.clickContinue,Phaser.Display.Align.In.Center(this.main,this.gameZone)},n.createFooterBar=function(){this.footer=new zE(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone,0)},n.createRankMainContent=function(){this.rankMainContent?this.rankMainContent.setVisible(!0):(this.rankMainContent=new qk(this),Phaser.Display.Align.In.Center(this.rankMainContent,this.gameZone))},n.createJourneyContent=function(){this.journeyMain?this.journeyMain.setVisible(!0):(this.journeyMain=new ck(this),Phaser.Display.Align.In.Center(this.journeyMain,this.gameZone))},n.createDecorate=function(){var e=this.world.getWorldSize(),t=(e.width,e.height,this.make.image({key:_x,frame:Ox.D_ICON_1}));t.setWorldSize(102,92),t.setAlpha(.5),Phaser.Display.Align.In.RightCenter(t,this.gameZone,0,-200);var n=this.make.image({key:_x,frame:Ox.D_ICON_2});n.setWorldSize(88,176),n.setAlpha(.5),Phaser.Display.Align.In.LeftCenter(n,this.gameZone,0,-112);var i=this.make.image({key:_x,frame:Ox.D_ICON_3});i.setWorldSize(96,91),i.setAlpha(.5),Phaser.Display.Align.In.RightCenter(i,this.gameZone,0,-20);var a=this.make.image({key:_x,frame:Ox.D_ICON_4});a.setWorldSize(132,93),a.setAlpha(.5),Phaser.Display.Align.In.BottomLeft(a,this.gameZone,0,-130)},n.createScreens=function(){this.createSettingsScreen(),this.createDailyChallengeScreen(),this.createMiniJourneyScreen(),this.createClaimHeartScreen()},n.createSettingsScreen=function(){this.screen.add(ps.o4.SETTINGS_SCREEN,Ix)},n.createDailyChallengeScreen=function(){this.screen.add(ps.o4.DAILY_CHALLENGE_SCREEN,hx)},n.createMiniJourneyScreen=function(){this.screen.add(ps.o4.MINI_JOURNEY_SCREEN,bx)},n.createClaimHeartScreen=function(){this.screen.add(ps.o4.CLAIM_HEART_SCREEN,EA)},n.showMiniJourneyScreen=function(){this.storage.dispatch(Bl(!0)),this.screen.open(ps.o4.MINI_JOURNEY_SCREEN)},t}(Ql.Z);var Rx=Dx,Mx=["Enable"],Lx=function(e){function t(t){return e.call(this,t)||this}(0,o.Z)(t,e);var c=t.prototype;return c.boot=function(){var t=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.boot.call(this),this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),t.next=6,this.addDevPlugins();case 6:return t.next=8,this.initAdsAsync();case 8:this.addScenes(),this.addDevScenes(),this.initWorld(),this.initStorage(),this.initLanguage(),this.initVisibilityChangeHandler(),this.initUtils(),this.initRollbar(),this.initConsole(),this.initDebugger(),this.initStatistics(),this.initParticleEditor(),this.initProfilerPlugin(),this.initAdaptivePerformance(),this.handleShowInterAdWhenStartGame();case 23:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),c.start=function(){e.prototype.start.call(this)},c.updateFps=function(e){void 0===e&&(e=60),this.getFps()!==e&&this.setFps(e)},c.getFps=function(){return this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf?this.scene.game.loop.raf.fps:5},c.setFps=function(e){this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf&&"function"===typeof this.scene.game.loop.raf.updateFps&&this.scene.game.loop.raf.updateFps(e)},c.addExtraGameObjectMethods=function(){var e=new g(this);e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality(),e.addSetLineHeightForBitmapText()},c.addExtraFBInstantFunctions=function(){var e=new l.Z(this.facebook);this.facebook.getLocale=e.getLocale,this.facebook.shareAsync=e.shareAsync,this.facebook.inviteAsync=e.inviteAsync,this.facebook.switchAsync=e.switchAsync,this.facebook.chooseAsync=e.chooseAsync,this.facebook.createAsync=e.createAsync,this.facebook.sendMessage=e.sendMessage,this.facebook.getContextID=e.getContextID,this.facebook.getPlayerToken=e.getPlayerToken,this.facebook.matchPlayerAsync=e.matchPlayerAsync,this.facebook.getContextPlayers=e.getContextPlayers,this.facebook.setLoadingProgress=e.setLoadingProgress,this.facebook.attemptToAddShortcut=e.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=e.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=e.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=e.getRewardedVideoAsync,this.facebook.sendNotificationAsync=e.sendNotificationAsync,this.facebook.getInterstitialAdAsync=e.getInterstitialAdAsync,e.injectTournament(),this.facebook.progressLoading=new f(this)},c.addPlugins=function(){this.plugins.install("Storage",ha,!0,"storage"),this.plugins.install("Rollbar",Gt,!0,"rollbar"),this.plugins.install("AdsManager",L,!0,"ads"),this.plugins.install("AuthManager",$,!0,"auth"),this.plugins.install("AudioManager",H,!0,"audio"),this.plugins.install("WorldManager",ya,!0,"world"),this.plugins.install("PlayerManager",at,!0,"player"),this.plugins.install("LanguageManager",Ka,!0,"lang"),this.plugins.install("ProfileManager",It,!0,"profile"),this.plugins.install("AnalyticsManager",F,!0,"analytics"),this.plugins.install("AdaptivePerformance",de,!0,"performance"),this.plugins.install("VisibilityChangeHandler",CE,!0,"visibility"),this.plugins.installScenePlugin("textStyler",ma,"textStyler"),this.plugins.installScenePlugin("ScreenManager",Kt,"screen"),this.plugins.installScenePlugin("FrameCapture",re,"frameCapture"),this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),window.SpinePlugin&&this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.rollbar=this.plugins.get("Rollbar"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.player=this.plugins.get("PlayerManager"),this.lang=this.plugins.get("LanguageManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.performance=this.plugins.get("AdaptivePerformance"),this.visibility=this.plugins.get("VisibilityChangeHandler")},c.addDevPlugins=function(){var e=(0,r.Z)(h().mark((function e(){var t,i,a,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([n.e(7),n.e(716)]).then(n.bind(n,15716));case 4:return t=e.sent.default,e.next=7,Promise.all([n.e(498),n.e(868),n.e(227)]).then(n.bind(n,19227));case 7:return i=e.sent.default,e.next=10,n.e(315).then(n.bind(n,79315));case 10:return a=e.sent.default,e.next=13,Promise.all([n.e(498),n.e(883)]).then(n.bind(n,59883));case 13:return s=e.sent.default,e.next=16,Promise.all([n.e(498),n.e(516)]).then(n.bind(n,76516));case 16:r=e.sent.default,this.plugins.install("Console",t,!0,"console"),this.plugins.install("Debugger",i,!0,"debugger"),this.plugins.install("Statistics",a,!0,"statistics"),this.plugins.install("Profiler",s,!0,"profiler"),this.plugins.install("ParticleEditor",r,!0,"particle-editor"),this.eruda=this.plugins.get("Console"),this.debugger=this.plugins.get("Debugger"),this.statistics=this.plugins.get("Statistics"),this.profiler=this.plugins.get("Profiler"),this.particleEditor=this.plugins.get("ParticleEditor");case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.addScenes=function(){this.scene.add(Ua.Co.BOOT_SCENE,is,!0),this.scene.add(Ua.Co.LOAD_SCENE,bE,!1),this.scene.add(Ua.Co.GAME_SCENE,rS,!1),this.scene.add(Ua.Co.LEVEL_SCENE,lb,!1),this.scene.add(Ua.Co.JOURNEY_SCENE,yw,!1),this.scene.add(Ua.Co.DAILY_SCENE,zw,!1),this.scene.add(Ua.Co.RANKING_SCENE,MI,!1),this.scene.add(Ua.Co.DASHBOARD_SCENE,Rx,!1),this.scene.add(Ua.Co.GLOBAL_SCENE,oS.Z,!1)},c.addDevScenes=function(){var e=(0,r.Z)(h().mark((function e(){var t,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.e(817).then(n.bind(n,3817));case 4:return t=e.sent.default,e.next=7,n.e(161).then(n.bind(n,63161));case 7:i=e.sent.default,this.scene.add(Ua.Co.TEST_SCENE,t,!1),this.scene.add(Ua.Co.ANIMATIONS_SCENE,i,!1);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.initAdsAsync=function(){var e=(0,r.Z)(h().mark((function e(){var t,i,a,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads,PE.Z.setGame(this),i=PE.Z,!t.Mockup.Enable){e.next=8;break}return e.next=6,n.e(658).then(n.bind(n,17658));case 6:a=e.sent.default,i=a;case 8:(r=(0,s.Z)({},t.InterstitialAdOptions)).showWhenStartGame&&(r.secondsFirstTime=0),this.ads.configure(i,(0,s.Z)({},t,{InterstitialAdOptions:r}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.initWorld=function(){var e=GameCore.Configs.Game,t=e.AutoResize,n=e.PortraitRatio,i=e.PortraitWidth,a=e.PortraitHeight,s=e.LandscapeRatio,r=e.LandscapeWidth,o=e.LandscapeHeight,c=t,h=e.DisableLandscape,l=e.FullSizeOnLandscape,u=n,p=i,d=a,f=s,m=r,g=o;this.world.configure({autoResize:c,portraitRatio:u,portraitWidth:p,portraitHeight:d,landscapeRatio:f,landscapeWidth:m,landscapeHeight:g,disableLandscape:h,fullSizeOnLandscape:l}),this.world.resize(e.ForcePixelRatio)},c.initStorage=function(){var e=new Za(this);this.storage.setInitiator(e)},c.initLanguage=function(){var e=this.facebook.getLocale();this.lang.configure({locale:e,upperCaseText:!0})},c.initVisibilityChangeHandler=function(){this.visibility.configure()},c.initUtils=function(){this.handlePauseAudio()},c.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},c.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var e=GameCore.Configs.Debugger,t=e.ShowInspector,n=e.ShowMonitoring;(t||n)&&this.debugger.configure(GameCore.Configs.Debugger)}},c.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics.configure(GameCore.Configs.Statistics))},c.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},c.initProfilerPlugin=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ProfilerPlugin.Enable&&this.profiler.configure())},c.initAdaptivePerformance=function(){var e=GameCore.Configs.Performance,t=e.Enable,n=(0,a.Z)(e,Mx);if(t){var i=this.world.getPixelRatio();this.performance.configure((0,s.Z)({pixelRatio:i},n)),this.performance.active()}},c.initRollbar=function(){GameCore.Configs.Rollbar.Enable&&this.rollbar.setup()},c.handlePauseAudio=function(){var e=this;this.sound.pauseOnBlur=!1,this.visibility.addEventVisible((function(){e.audio.playMusic()})),this.visibility.addEventHidden((function(){e.audio.pauseMusic()}))},c.removeUnusedPipelines=function(){var e=this.renderer;if(e instanceof Phaser.Renderer.WebGL.WebGLRenderer){var t=e.pipelines,n=Phaser.Renderer.WebGL.Pipelines;if(n)[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POSTFX_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(e){var n;null==(n=t.get(e))||n.destroy(),t.remove(e)}))}},c.handleShowInterAdWhenStartGame=function(){var e=(0,r.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Configs.Ads.InterstitialAdOptions.showWhenStartGame){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,this.audio.stopMusic(),this.audio.muteAll(),e.next=8,this.ads.preloadPreRollAdAsync();case 8:return e.next=10,this.ads.showPreRollAdAsync();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),(0,i.tO)(e.t0);case 15:return e.prev=15,this.audio.unmuteAll(),this.audio.playMusic(),e.finish(15);case 19:case"end":return e.stop()}}),e,this,[[3,12,15,19]])})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.Game),Bx=Lx,Nx=GameCore.Configs.Debugger.ShowInspector,Fx={parent:"app",type:Phaser.AUTO,width:0,height:0,scale:{autoRound:!0},dom:{createContainer:!1},loader:{maxParallelDownloads:6,crossOrigin:"no-cros",baseURL:"./resource/v5/"},audio:{},input:{gamepad:!1,keyboard:Nx,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,fps:{},render:{pixelArt:!1,antialias:!0,antialiasGL:!0,transparent:!0,desynchronized:!1,powerPreference:"low-power",clearBeforeRender:!1,roundPixels:!1},plugins:{global:[]}};(0,i.j6)();var Gx=setInterval((function(){window.__analyticsInitiated&&(window.__fbGameReady=!1,clearInterval(Gx),clearInterval(window.__fbInstantLoadingTimer),GameSDK.setLoadingProgress(30),gtag("event","app_initialize",{send_to:["GA"]}),function(){try{var e=new Bx(Fx);window.game=e}catch(t){(0,i.tO)(t)}}())}),50)},71944:function(e,t,n){"use strict";n.d(t,{_:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",DAILY_CHALLENGE_BEGIN:"daily_challenge_begin",DAILY_CHALLENGE_FAIL:"daily_challenge_fail",DAILY_CHALLENGE_END:"daily_challenge_end",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score"}},46352:function(e,t,n){"use strict";var i=n(90143),a=function(){function e(e,t,n,a){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=e,this.name=t,this.photo=n||i.Z.AVATAR.FILE,this.locale=a||"en_US"}return e.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale}},e}();t.Z=a},55481:function(e,t,n){"use strict";n.d(t,{I:function(){return a}});var i=n(98297),a=function(e){return{type:i.DW,payload:{sceneKey:e}}}},72898:function(e,t,n){"use strict";n.d(t,{$:function(){return a},V:function(){return s}});var i=n(20573),a=(0,i.P1)([function(e){return e.scene.currentSceneKey}],(function(e){return e})),s=(0,i.P1)([function(e){return e.scene.prevSceneKey}],(function(e){return e}))},39482:function(e,t,n){"use strict";n.d(t,{Gm:function(){return r},ne:function(){return o},qZ:function(){return s}});var i=n(6226),a=n.n(i),s=(n(24278),function(e){return new(a())((function(t){return setTimeout(t,e)}))}),r=function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()},o=function(e){var t=e/1e3,n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60);return{hours:n,minutes:i,seconds:Math.floor(t-3600*n-60*i)}}},93397:function(e,t,n){"use strict";n.d(t,{R0:function(){return r},Tv:function(){return s},j6:function(){return i},sw:function(){return a},tO:function(){return o}});n(70268),n(47273),n(35627),n(11882);var i=function(){var e=setInterval((function(){window.Sentry&&clearInterval(e)}),100)},a=function(e,t){window.Sentry&&window.Sentry.addBreadcrumb({category:e,message:t})},s=function(e){window.Sentry&&window.Sentry.setUser(e)},r=function(e,t){e&&window.Sentry.withScope((function(e){e.setExtras(t)}))},o=function(e){}}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,n.amdO={},function(){var e=[];n.O=function(t,i,a,s){if(!i){var r=1/0;for(l=0;l<e.length;l++){i=e[l][0],a=e[l][1],s=e[l][2];for(var o=!0,c=0;c<i.length;c++)(!1&s||r>=s)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(o=!1,s<r&&(r=s));if(o){e.splice(l--,1);var h=a();void 0!==h&&(t=h)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[i,a,s]}}(),n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,i){return n.f[i](e,t),t}),[]))},n.u=function(e){return e+"."+{7:"e72fca1bc7291a178db5",8:"83f2d1f4fd0cb11a9fda",161:"e6ef1c406a4bec4b15a2",227:"4ed79508e72930b5ef6b",311:"a35dea9d823d4b95a5d4",315:"b114a61489f79c16bd8b",357:"510f74a32d39d7ebd33e",498:"c3cc35a2a4a08d4d58f5",516:"19465843a99d77d2ba23",658:"576b1bb6158c70b49b3b",716:"3e50192976cc8b1af625",817:"81ed669a2c5470008022",868:"3f9f46a115ba9e6a4d0f",883:"68a1c18d9b0a231c9c6b"}[e]+".js"},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="game-core:";n.l=function(i,a,s,r){if(e[i])e[i].push(a);else{var o,c;if(void 0!==s)for(var h=document.getElementsByTagName("script"),l=0;l<h.length;l++){var u=h[l];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=i),e[i]=[a];var p=function(t,n){o.onerror=o.onload=null,clearTimeout(d);var a=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((function(e){return e(n)})),t)return t(n)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var a=i.length-1;a>-1&&!e;)e=i[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),function(){var e={757:0};n.f.j=function(t,i){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)i.push(a[2]);else{var s=new Promise((function(n,i){a=e[t]=[n,i]}));i.push(a[2]=s);var r=n.p+n.u(t),o=new Error;n.l(r,(function(i){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var s=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",o.name="ChunkLoadError",o.type=s,o.request=r,a[1](o)}}),"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,s,r=i[0],o=i[1],c=i[2],h=0;if(r.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(c)var l=c(n)}for(t&&t(i);h<r.length;h++)s=r[h],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(l)},i=self.webpackChunkgame_core=self.webpackChunkgame_core||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}(),n.O(void 0,[216,630,542],(function(){return n(57147)})),n.O(void 0,[216,630,542],(function(){return n(63367)})),n.O(void 0,[216,630,542],(function(){return n(16977)})),n.O(void 0,[216,630,542],(function(){return n(10793)})),n.O(void 0,[216,630,542],(function(){return n(6649)})),n.O(void 0,[216,630,542],(function(){return n(64413)})),n.O(void 0,[216,630,542],(function(){return n(13391)}));var i=n.O(void 0,[216,630,542],(function(){return n(45211)}));i=n.O(i)})();